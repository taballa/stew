cscope 15 F:\Site\stew"               0000438817
	@F:\Site\stew\1\_lp\core\config\core.config.php

1 <?
php


3 
	g$GLOBALS
['config']['default_controller'] = 'default';

4 
	g$GLOBALS
['config']['default_action'] = 'index';

5 
	g$GLOBALS
['config']['default_language'] = 'zh_cn';

	@F:\Site\stew\1\_lp\core\controller\core.class.php

1 <?
php


3 ifĞ!
defšed
('IN'èè
d›
('bad„equest');

6 şas 
	ccÜeCÚŒŞËr


8 
funùiÚ
 
	$__cÚ¡ruù
()

11 
$mod–_funùiÚ_fe
 = 
AROOT
 . 'mod–' . 
DS
 . 
	`g
('c') . '.function.php';

12 ifĞ
	`fe_exi¡s
Ğ
$mod–_funùiÚ_fe
 ) )

13 
	`»quœe_Úû
Ğ
$mod–_funùiÚ_fe
 );

16 
$cmod–
 = 
CROOT
 . 'mod–' . 
DS
 . 
	`g
('c') . '.function.php';

17 ifĞ
	`fe_exi¡s
Ğ
$cmod–
 ) ) 
	`»quœe_Úû
( $cmodel );

21 
public
 
funùiÚ
 
	$šdex
()

24 
	}
}

	@F:\Site\stew\1\_lp\core\lib\core.function.php

1 <?
php


3 
funùiÚ
 
	$Œªsüibe
(
$aLi¡
, 
$aIsTİLev–
 = 
Œue
)

5 
$gpcLi¡
 = 
	`¬¿y
();

6 
$isMagic
 = 
	`g‘_magic_quÙes_gpc
();

8 
	`fÜ—ch
 (
$aLi¡
 
as
 
$key
 => 
$v®ue
) {

9 ià(
	`is_¬¿y
(
$v®ue
)) {

10 
$decodedKey
 = (
$isMagic
 && !
$aIsTİLev–
)?
	`¡r¦ashes
(
$key
):$key;

11 
$decodedV®ue
 = 
	`Œªsüibe
(
$v®ue
, 
çl£
);

13 
$decodedKey
 = 
	`¡r¦ashes
(
$key
);

14 
$decodedV®ue
 = (
$isMagic
)?
	`¡r¦ashes
(
$v®ue
):$value;

16 
$gpcLi¡
[
$decodedKey
] = 
$decodedV®ue
;

18  
$gpcLi¡
;

19 
	}
}

21 
	g$_GET
 = 
Œªsüibe
Ğ
$_GET
 );

22 
	g$_POST
 = 
Œªsüibe
Ğ
$_POST
 );

23 
	g$_REQUEST
 = 
Œªsüibe
Ğ
$_REQUEST
 );

26 
funùiÚ
 
	$v
Ğ
$¡r
 )

28  
	`is£t
Ğ
$_REQUEST
[
$¡r
] ) ? $_REQUEST[$¡r] : 
çl£
;

29 
	}
}

31 
funùiÚ
 
	$z
Ğ
$¡r
 )

33  
	`¡r_gs
Ğ
$¡r
 );

34 
	}
}

36 
funùiÚ
 
	$c
Ğ
$¡r
 )

38  
	`is£t
Ğ
$GLOBALS
['cÚfig'][
$¡r
] ) ? $GLOBALS['cÚfig'][$¡r] : 
çl£
;

39 
	}
}

41 
funùiÚ
 
	$g
Ğ
$¡r
 )

43  
	`is£t
Ğ
$GLOBALS
[
$¡r
] ) ? $GLOBALS[$¡r] : 
çl£
;

44 
	}
}

46 
funùiÚ
 
	$t
Ğ
$¡r
 )

48  
	`Œim
(
$¡r
);

49 
	}
}

51 
funùiÚ
 
	$u
Ğ
$¡r
 )

53  
	`u¾’code
Ğ
$¡r
 );

54 
	}
}

57 
funùiÚ
 
»nd”
Ğ
$d©a
 = 
NULL
 , 
$Ïyout
 = NULL , 
$sh¬p
 = 'default' )

59 ifĞ
$Ïyout
 =ğ
nuÎ
 )

61 ifĞ
is_ajax_»que¡
() )

63 
$Ïyout
 = 'ajax';

65 
–£if
Ğ
is_mobe_»que¡
() )

67 
	g$Ïyout
 = 'mobile';

71 
	g$Ïyout
 = 'web';

75 
	g$GLOBALS
['Ïyout'] = 
$Ïyout
;

76 
	g$GLOBALS
['sh¬p'] = 
$sh¬p
;

78 
	g$Ïyout_fe
 = 
AROOT
 . 'v›w/Ïyout/' . 
$Ïyout
 . '/' . 
$sh¬p
 . '.tpl.html';

79 ifĞ
fe_exi¡s
Ğ
$Ïyout_fe
 ) )

81 @
exŒaù
Ğ
$d©a
 );

82 
»quœe
Ğ
$Ïyout_fe
 );

86 
	g$Ïyout_fe
 = 
CROOT
 . 'v›w/Ïyout/' . 
$Ïyout
 . '/' . 
$sh¬p
 . '.tpl.html';

87 ifĞ
fe_exi¡s
Ğ
$Ïyout_fe
 ) )

89 @
exŒaù
Ğ
$d©a
 );

90 
»quœe
Ğ
$Ïyout_fe
 );

95 
funùiÚ
 
	$ajax_echo
Ğ
$šfo
 )

97 ifĞ!
	`h—d”s_£Á
() )

99 
	`h—d”
("Content-Type:text/html;charset=utf-8");

100 
	`h—d”
("Expires: Thu, 01 Jan 1970 00:00:01 GMT");

101 
	`h—d”
("Cache-Control:‚o-cache, must-revalidate");

102 
	`h—d”
("Pragma:‚o-cache");

105 
echo
 
$šfo
;

106 
	}
}

109 
funùiÚ
 
šfo_·ge
Ğ
$šfo
 , 
$t™Ë
 = 'ç³»ç»Ÿæ¶ˆæ¯' )

111 ifĞ
is_ajax_»que¡
() )

112 
$Ïyout
 = 'ajax';

114 
	g$Ïyout
 = 'web';

116 
	g$d©a
['tİ_t™Ë'] = 
$d©a
['t™Ë'] = 
$t™Ë
;

117 
	g$d©a
['šfo'] = 
$šfo
;

119 
»nd”
Ğ
$d©a
 , 
$Ïyout
 , 'info' );

123 
funùiÚ
 
	$is_ajax_»que¡
()

125 
$h—d”s
 = 
	`­ache_»que¡_h—d”s
();

126  (
	`is£t
Ğ
$h—d”s
['X-Requested-With'] ) && ( $headers['X-Requested-With'] == 'XMLHttpRequest' )) || (isset( $headers['x-requested-with'] ) && ($headers['x-requested-with'] == 'XMLHttpRequest' ));

127 
	}
}

129 ià(!
funùiÚ_exi¡s
('apache_request_headers'))

131 
funùiÚ
 
­ache_»que¡_h—d”s
()

133 
fÜ—ch
(
$_SERVER
 
as
 
$key
=>
$v®ue
)

135 ià(
sub¡r
(
$key
,0,5)=="HTTP_")

137 
$key
=
¡r_»¶aû
(" ","-",
ucwÜds
(
¡¹Şow”
(¡r_»¶aû("_"," ",
sub¡r
($key,5)))));

138 
	g$out
[
$key
]=
$v®ue
;

142 
	g$out
[
$key
]=
$v®ue
;

146  
	g$out
;

150 
funùiÚ
 
	$is_mobe_»que¡
()

152 
$_SERVER
['ALL_HTTP'] = 
	`is£t
($_SERVER['ALL_HTTP']) ? $_SERVER['ALL_HTTP'] : '';

154 
$mobe_brow£r
 = '0';

156 if(
	`´eg_m©ch
('/(up.brow£r|up.lšk|mmp|symbŸn|sm¬hÚe|midp|w­|phÚe|hÚe|ad|od|ªdroid|xoom)/i', 
	`¡¹Şow”
(
$_SERVER
['HTTP_USER_AGENT'])))

157 
$mobe_brow£r
++;

159 if((
	`is£t
(
$_SERVER
['HTTP_ACCEPT'])è
	`ªd
 (
	`¡½os
(
	`¡¹Şow”
($_SERVER['HTTP_ACCEPT']),'­¶iÿtiÚ/vnd.w­.xhtml+xml'è!=ğ
çl£
))

160 
$mobe_brow£r
++;

162 if(
	`is£t
(
$_SERVER
['HTTP_X_WAP_PROFILE']))

163 
$mobe_brow£r
++;

165 if(
	`is£t
(
$_SERVER
['HTTP_PROFILE']))

166 
$mobe_brow£r
++;

168 
$mobe_ua
 = 
	`¡¹Şow”
(
	`sub¡r
(
$_SERVER
['HTTP_USER_AGENT'],0,4));

169 
$mobe_ag’ts
 = 
	`¬¿y
(

181 if(
	`š_¬¿y
(
$mobe_ua
, 
$mobe_ag’ts
))

182 
$mobe_brow£r
++;

184 if(
	`¡½os
(
	`¡¹Şow”
(
$_SERVER
['ALL_HTTP']), 'İ”amši'è!=ğ
çl£
)

185 
$mobe_brow£r
++;

188 if(
	`¡½os
(
	`¡¹Şow”
(
$_SERVER
['HTTP_USER_AGENT']), 'wšdows'è!=ğ
çl£
)

189 
$mobe_brow£r
=0;

192 if(
	`¡½os
(
	`¡¹Şow”
(
$_SERVER
['HTTP_USER_AGENT']), 'wšdow phÚe'è!=ğ
çl£
)

193 
$mobe_brow£r
++;

195 if(
$mobe_brow£r
>0)

196  
Œue
;

198  
çl£
;

199 
	}
}

201 
funùiÚ
 
	$u£s
Ğ
$m
 )

203 
	`lßd
Ğ'lib/' . 
	`ba£Çme
(
$m
) );

204 
	}
}

206 
funùiÚ
 
	$lßd
Ğ
$fe_·th
 )

208 
$fe
 = 
AROOT
 . 
$fe_·th
;

209 ifĞ
	`fe_exi¡s
Ğ
$fe
 ) )

212 
	`»quœe
Ğ
$fe
 );

218 
	`»quœe
Ğ
CROOT
 . 
$fe_·th
 );

221 
	}
}

226 ifĞ
defšed
('SAE_APPNAME') )

227 
šşude_Úû
Ğ
CROOT
 . 'lib/db.sae.function.php' );

229 
šşude_Úû
Ğ
CROOT
 . 'lib/db.function.php' );

231 ià(!
funùiÚ_exi¡s
('_'))

233 
funùiÚ
 
_
Ğ
$¡ršg
 , 
$d©a
 = 
nuÎ
 )

235 ifĞ!
is£t
(
$GLOBALS
['i18n']) )

237 
$c
 = 
c
('default_language');

238 ifĞ
¡¾’
(
$c
è< 1 ) 
	g$c
 = 'zh_cn';

240 
	g$Ïng_fe
 = 
AROOT
 . 'loÿl' . 
DS
 . 
ba£Çme
(
$c
) . '.lang.php';

241 ifĞ
fe_exi¡s
Ğ
$Ïng_fe
 ) )

243 
šşude_Úû
Ğ
$Ïng_fe
 );

244 
	g$GLOBALS
['i18n'] = 
$c
;

247 
	g$GLOBALS
['i18n'] = 'zh_cn';

256 ifĞ
is£t
Ğ
$GLOBALS
['Ïnguage'][$GLOBALS['i18n']][
$¡ršg
] ) )

257 
	g$to
 = 
$GLOBALS
['Ïnguage'][$GLOBALS['i18n']][
$¡ršg
];

259 
	g$to
 = 
$¡ršg
;

261 ifĞ
	g$d©a
 =ğ
nuÎ
 )

262  
$to
;

265 ifĞ!
is_¬¿y
Ğ
$d©a
 ) ) 
	g$d©a
 = 
¬¿y
( $data );

266  
v¥rštf
Ğ
$to
 , 
$d©a
 );

	@F:\Site\stew\1\_lp\core\lib\db.function.php

1 <?
php


4 
funùiÚ
 
	$db
Ğ
$ho¡
 = 
nuÎ
 , 
$pÜt
 =‚uÎ , 
$u£r
 =‚uÎ , 
$·sswÜd
 =‚uÎ , 
$db_Çme
 =‚ull )

6 
$db_key
 = 
	`MD5
Ğ
$ho¡
 .'-'. 
$pÜt
 .'-'. 
$u£r
 .'-'. 
$·sswÜd
 .'-'. 
$db_Çme
 );

8 ifĞ!
	`is£t
Ğ
$GLOBALS
['LP_'.
$db_key
] ) )

10 
	`šşude_Úû
Ğ
AROOT
 . 'config/db.config.php' );

13 
$db_cÚfig
 = 
$GLOBALS
['config']['db'];

15 ifĞ
$ho¡
 =ğ
nuÎ
 ) $ho¡ = 
$db_cÚfig
['db_host'];

16 ifĞ
$pÜt
 =ğ
nuÎ
 ) $pÜˆğ
$db_cÚfig
['db_port'];

17 ifĞ
$u£r
 =ğ
nuÎ
 ) $u£¸ğ
$db_cÚfig
['db_user'];

18 ifĞ
$·sswÜd
 =ğ
nuÎ
 ) $·sswÜd = 
$db_cÚfig
['db_password'];

19 ifĞ
$db_Çme
 =ğ
nuÎ
 ) $db_Çmğ
$db_cÚfig
['db_name'];

21 ifĞ!
$GLOBALS
['LP_'.
$db_key
] = 
	`mysql_cÚÃù
Ğ
$ho¡
.':'.
$pÜt
 , 
$u£r
 , 
$·sswÜd
 , 
Œue
 ) )

24 
echo
 'can\'t connecto database';

25  
çl£
;

29 ifĞ
$db_Çme
 != '' )

31 ifĞ!
	`mysql_£Ëù_db
Ğ
$db_Çme
 , 
$GLOBALS
['LP_'.
$db_key
] ) )

33 
echo
 'ÿn\'ˆ£Ëù d©aba£ ' . 
$db_Çme
 ;

34  
çl£
;

39 
	`mysql_qu”y
Ğ"SET NAMES 'UTF8'" , 
$GLOBALS
['LP_'.
$db_key
] );

42  
$GLOBALS
['LP_'.
$db_key
];

43 
	}
}

45 
funùiÚ
 
	$s
Ğ
$¡r
 , 
$db
 = 
NULL
 )

47 ifĞ
$db
 =ğ
NULL
 ) $db = 
	`db
();

48  
	`mysql_»®_esÿ³_¡ršg
Ğ
$¡r
 , 
$db
 ) ;

50 
	}
}

53 
funùiÚ
 
	$´•¬e
Ğ
$sql
 , 
$¬¿y
 )

56 
	`fÜ—ch
Ğ
$¬¿y
 
as
 
$k
=>
$v
 )

57 
$¬¿y
[
$k
] = 
	`s
(
$v
 );

59 
$»g
 = '/\?([is])/i';

60 
$sql
 = 
	`´eg_»¶aû_ÿÎback
Ğ
$»g
 , 'prepair_string' , $sql );

61 
$couÁ
 = 
	`couÁ
Ğ
$¬¿y
 );

62  
$i
 = 0 ; $˜< 
$couÁ
; $i++ )

64 
$¡r
[] = '$¬¿y[' .
$i
 . ']';

67 
$¡©em’t
 = '$sqÈğ¥rštfĞ$sqÈ, ' . 
	`još
Ğ',' , 
$¡r
 ) . ' );';

68 
	`ev®
Ğ
$¡©em’t
 );

69  
$sql
;

71 
	}
}

73 
funùiÚ
 
	$´•aœ_¡ršg
Ğ
$m©ches
 )

75 ifĞ
$m©ches
[1] == 's' )  "'%s'";

76 ifĞ
$m©ches
[1] == 'i' )  "'%d'";

77 
	}
}

80 
funùiÚ
 
	$g‘_d©a
Ğ
$sql
 , 
$db
 = 
NULL
 )

82 ifĞ
$db
 =ğ
NULL
 ) $db = 
	`db
();

84 
$GLOBALS
['LP_LAST_SQL'] = 
$sql
;

85 
$d©a
 = 
	`A¼ay
();

86 
$i
 = 0;

87 
$»suÉ
 = 
	`mysql_qu”y
Ğ
$sql
 ,
$db
 );

89 ifĞ
	`mysql_”ºo
() != 0 )

90 
echo
 
	`mysql_”rÜ
(è.' ' . 
$sql
;

92  
$A¼ay
 = 
	`mysql_ãtch_¬¿y
(
$»suÉ
, 
MYSQL_ASSOC
 ) )

94 
$d©a
[
$i
++] = 
$A¼ay
;

97 ifĞ
	`mysql_”ºo
() != 0 )

98 
echo
 
	`mysql_”rÜ
(è.' ' . 
$sql
;

100 
	`mysql_ä“_»suÉ
(
$»suÉ
);

102 ifĞ
	`couÁ
Ğ
$d©a
 ) > 0 )

103  
$d©a
;

105  
çl£
;

106 
	}
}

108 
funùiÚ
 
	$g‘_lše
Ğ
$sql
 , 
$db
 = 
NULL
 )

110 
$d©a
 = 
	`g‘_d©a
Ğ
$sql
 , 
$db
 );

111  @
	`»£t
(
$d©a
);

112 
	}
}

114 
funùiÚ
 
	$g‘_v¬
Ğ
$sql
 , 
$db
 = 
NULL
 )

116 
$d©a
 = 
	`g‘_lše
Ğ
$sql
 , 
$db
 );

117  
$d©a
[ @
	`»£t
(@
	`¬¿y_keys
( $data )) ];

118 
	}
}

120 
funùiÚ
 
	$Ï¡_id
Ğ
$db
 = 
NULL
 )

122 ifĞ
$db
 =ğ
NULL
 ) $db = 
	`db
();

123  
	`g‘_v¬
Ğ"SELECT LAST_INSERT_ID(è" , 
$db
 );

124 
	}
}

126 
funùiÚ
 
	$run_sql
Ğ
$sql
 , 
$db
 = 
NULL
 )

128 ifĞ
$db
 =ğ
NULL
 ) $db = 
	`db
();

129 
$GLOBALS
['LP_LAST_SQL'] = 
$sql
;

130  
	`mysql_qu”y
Ğ
$sql
 , 
$db
 );

131 
	}
}

133 
funùiÚ
 
	$db_”ºo
Ğ
$db
 = 
NULL
 )

135 ifĞ
$db
 =ğ
NULL
 ) $db = 
	`db
();

136  
	`mysql_”ºo
Ğ
$db
 );

137 
	}
}

140 
funùiÚ
 
	$db_”rÜ
Ğ
$db
 = 
NULL
 )

142 ifĞ
$db
 =ğ
NULL
 ) $db = 
	`db
();

143  
	`mysql_”rÜ
Ğ
$db
 );

144 
	}
}

146 
funùiÚ
 
	$Ï¡_”rÜ
()

148 ifĞ
	`is£t
Ğ
$GLOBALS
['LP_DB_LAST_ERROR'] ) )

149  
$GLOBALS
['LP_DB_LAST_ERROR'];

150 
	}
}

152 
funùiÚ
 
	$şo£_db
Ğ
$db
 = 
NULL
 )

154 ifĞ
$db
 =ğ
NULL
 )

155 
$db
 = 
$GLOBALS
['LP_DB'];

157 
	`un£t
Ğ
$GLOBALS
['LP_DB'] );

158 
	`mysql_şo£
Ğ
$db
 );

159 
	}
}

	@F:\Site\stew\1\_lp\core\lib\db.sae.function.php

1 <?
php


3 
funùiÚ
 
	$db_»ad
Ğ
$ho¡
 = 
nuÎ
 , 
$pÜt
 =‚uÎ , 
$u£r
 =‚uÎ , 
$·sswÜd
 =‚uÎ , 
$db_Çme
 =‚ull )

5 
$db_key
 = 
	`MD5
Ğ'»ad-' . 
$ho¡
 .'-'. 
$pÜt
 .'-'. 
$u£r
 .'-'. 
$·sswÜd
 .'-'. 
$db_Çme
 );

7 ifĞ!
	`is£t
Ğ
$GLOBALS
['LP_'.
$db_key
] ) )

9 
	`šşude_Úû
Ğ
AROOT
 . 'config/db.config.php' );

12 
$db_cÚfig
 = 
$GLOBALS
['config']['db'];

14 ifĞ
$ho¡
 =ğ
nuÎ
 ) $ho¡ = 
$db_cÚfig
['db_host_read'];

15 ifĞ
$pÜt
 =ğ
nuÎ
 ) $pÜˆğ
$db_cÚfig
['db_port'];

16 ifĞ
$u£r
 =ğ
nuÎ
 ) $u£¸ğ
$db_cÚfig
['db_user'];

17 ifĞ
$·sswÜd
 =ğ
nuÎ
 ) $·sswÜd = 
$db_cÚfig
['db_password'];

18 ifĞ
$db_Çme
 =ğ
nuÎ
 ) $db_Çmğ
$db_cÚfig
['db_name'];

20 ifĞ!
$GLOBALS
['LP_'.
$db_key
] = 
	`mysql_cÚÃù
Ğ
$ho¡
.':'.
$pÜt
 , 
$u£r
 , 
$·sswÜd
 , 
Œue
 ) )

23 
echo
 'can\'t connecto database';

24  
çl£
;

28 ifĞ
$db_Çme
 != '' )

30 ifĞ!
	`mysql_£Ëù_db
Ğ
$db_Çme
 , 
$GLOBALS
['LP_'.
$db_key
] ) )

32 
echo
 'ÿn\'ˆ£Ëù d©aba£ ' . 
$db_Çme
 ;

33  
çl£
;

38 
	`mysql_qu”y
Ğ"SET NAMES 'UTF8'" , 
$GLOBALS
['LP_'.
$db_key
] );

41  
$GLOBALS
['LP_'.
$db_key
];

42 
	}
}

46 
funùiÚ
 
	$db
Ğ
$ho¡
 = 
nuÎ
 , 
$pÜt
 =‚uÎ , 
$u£r
 =‚uÎ , 
$·sswÜd
 =‚uÎ , 
$db_Çme
 =‚ull )

48 
$db_key
 = 
	`MD5
Ğ
$ho¡
 .'-'. 
$pÜt
 .'-'. 
$u£r
 .'-'. 
$·sswÜd
 .'-'. 
$db_Çme
 );

50 ifĞ!
	`is£t
Ğ
$GLOBALS
['LP_'.
$db_key
] ) )

52 
	`šşude_Úû
Ğ
AROOT
 . 'config/db.config.php' );

55 
$db_cÚfig
 = 
$GLOBALS
['config']['db'];

57 ifĞ
$ho¡
 =ğ
nuÎ
 ) $ho¡ = 
$db_cÚfig
['db_host'];

58 ifĞ
$pÜt
 =ğ
nuÎ
 ) $pÜˆğ
$db_cÚfig
['db_port'];

59 ifĞ
$u£r
 =ğ
nuÎ
 ) $u£¸ğ
$db_cÚfig
['db_user'];

60 ifĞ
$·sswÜd
 =ğ
nuÎ
 ) $·sswÜd = 
$db_cÚfig
['db_password'];

61 ifĞ
$db_Çme
 =ğ
nuÎ
 ) $db_Çmğ
$db_cÚfig
['db_name'];

63 ifĞ!
$GLOBALS
['LP_'.
$db_key
] = 
	`mysql_cÚÃù
Ğ
$ho¡
.':'.
$pÜt
 , 
$u£r
 , 
$·sswÜd
 , 
Œue
 ) )

66 
echo
 'can\'t connecto database';

67  
çl£
;

71 ifĞ
$db_Çme
 != '' )

73 ifĞ!
	`mysql_£Ëù_db
Ğ
$db_Çme
 , 
$GLOBALS
['LP_'.
$db_key
] ) )

75 
echo
 'ÿn\'ˆ£Ëù d©aba£ ' . 
$db_Çme
 ;

76  
çl£
;

81 
	`mysql_qu”y
Ğ"SET NAMES 'UTF8'" , 
$GLOBALS
['LP_'.
$db_key
] );

84  
$GLOBALS
['LP_'.
$db_key
];

85 
	}
}

87 
funùiÚ
 
	$s
Ğ
$¡r
 , 
$db
 = 
NULL
 )

89 ifĞ
$db
 =ğ
NULL
 ) $db = 
	`db
();

90  
	`mysql_»®_esÿ³_¡ršg
Ğ
$¡r
 , 
$db
 ) ;

92 
	}
}

95 
funùiÚ
 
	$´•¬e
Ğ
$sql
 , 
$¬¿y
 )

98 
	`fÜ—ch
Ğ
$¬¿y
 
as
 
$k
=>
$v
 )

99 
$¬¿y
[
$k
] = 
	`s
(
$v
 );

101 
$»g
 = '/\?([is])/i';

102 
$sql
 = 
	`´eg_»¶aû_ÿÎback
Ğ
$»g
 , 'prepair_string' , $sql );

103 
$couÁ
 = 
	`couÁ
Ğ
$¬¿y
 );

104  
$i
 = 0 ; $˜< 
$couÁ
; $i++ )

106 
$¡r
[] = '$¬¿y[' .
$i
 . ']';

109 
$¡©em’t
 = '$sqÈğ¥rštfĞ$sqÈ, ' . 
	`još
Ğ',' , 
$¡r
 ) . ' );';

110 
	`ev®
Ğ
$¡©em’t
 );

111  
$sql
;

113 
	}
}

115 
funùiÚ
 
	$´•aœ_¡ršg
Ğ
$m©ches
 )

117 ifĞ
$m©ches
[1] == 's' )  "'%s'";

118 ifĞ
$m©ches
[1] == 'i' )  "'%d'";

119 
	}
}

122 
funùiÚ
 
	$g‘_d©a
Ğ
$sql
 , 
$db
 = 
NULL
 )

124 ifĞ
$db
 =ğ
NULL
 ) $db = 
	`db_»ad
();

126 
$GLOBALS
['LP_LAST_SQL'] = 
$sql
;

127 
$d©a
 = 
	`A¼ay
();

128 
$i
 = 0;

129 
$»suÉ
 = 
	`mysql_qu”y
Ğ
$sql
 ,
$db
 );

131 ifĞ
	`mysql_”ºo
() != 0 )

132 
echo
 
	`mysql_”rÜ
(è.' ' . 
$sql
;

134  
$A¼ay
 = 
	`mysql_ãtch_¬¿y
(
$»suÉ
, 
MYSQL_ASSOC
 ) )

136 
$d©a
[
$i
++] = 
$A¼ay
;

139 ifĞ
	`mysql_”ºo
() != 0 )

140 
echo
 
	`mysql_”rÜ
(è.' ' . 
$sql
;

142 
	`mysql_ä“_»suÉ
(
$»suÉ
);

144 ifĞ
	`couÁ
Ğ
$d©a
 ) > 0 )

145  
$d©a
;

147  
çl£
;

148 
	}
}

150 
funùiÚ
 
	$g‘_lše
Ğ
$sql
 , 
$db
 = 
NULL
 )

152 
$d©a
 = 
	`g‘_d©a
Ğ
$sql
 , 
$db
 );

153  @
	`»£t
(
$d©a
);

154 
	}
}

156 
funùiÚ
 
	$g‘_v¬
Ğ
$sql
 , 
$db
 = 
NULL
 )

158 
$d©a
 = 
	`g‘_lše
Ğ
$sql
 , 
$db
 );

159  
$d©a
[ @
	`»£t
(@
	`¬¿y_keys
( $data )) ];

160 
	}
}

162 
funùiÚ
 
	$Ï¡_id
Ğ
$db
 = 
NULL
 )

164 ifĞ
$db
 =ğ
NULL
 ) $db = 
	`db
();

165  
	`g‘_v¬
Ğ"SELECT LAST_INSERT_ID(è" , 
$db
 );

166 
	}
}

168 
funùiÚ
 
	$run_sql
Ğ
$sql
 , 
$db
 = 
NULL
 )

170 ifĞ
$db
 =ğ
NULL
 ) $db = 
	`db
();

171 
$GLOBALS
['LP_LAST_SQL'] = 
$sql
;

172  
	`mysql_qu”y
Ğ
$sql
 , 
$db
 );

173 
	}
}

175 
funùiÚ
 
	$db_”ºo
Ğ
$db
 = 
NULL
 )

177 ifĞ
$db
 =ğ
NULL
 ) $db = 
	`db
();

178  
	`mysql_”ºo
Ğ
$db
 );

179 
	}
}

182 
funùiÚ
 
	$db_”rÜ
Ğ
$db
 = 
NULL
 )

184 ifĞ
$db
 =ğ
NULL
 ) $db = 
	`db
();

185  
	`mysql_”rÜ
Ğ
$db
 );

186 
	}
}

188 
funùiÚ
 
	$Ï¡_”rÜ
()

190 ifĞ
	`is£t
Ğ
$GLOBALS
['LP_DB_LAST_ERROR'] ) )

191  
$GLOBALS
['LP_DB_LAST_ERROR'];

192 
	}
}

194 
funùiÚ
 
	$şo£_db
Ğ
$db
 = 
NULL
 )

196 ifĞ
$db
 =ğ
NULL
 )

197 
$db
 = 
$GLOBALS
['LP_DB'];

199 
	`un£t
Ğ
$GLOBALS
['LP_DB'] );

200 
	`mysql_şo£
Ğ
$db
 );

201 
	}
}

	@F:\Site\stew\1\_lp\lp.init.php

1 <?
php


3 ifĞ!
defšed
('AROOT'èè
d›
('NO AROOT!');

4 ifĞ!
defšed
('DS'èè
defše
Ğ'DS' , 
DIRECTORY_SEPARATOR
 );

7 
defše
Ğ'IN' , 
Œue
 );

9 
defše
Ğ'ROOT' , 
dœÇme
Ğ
__FILE__
 ) . 
DS
 );

10 
defše
Ğ'CROOT' , 
ROOT
 . 'cÜe' . 
DS
 );

13 
”rÜ_»pÜtšg
(
E_ALL
^
E_NOTICE
);

14 
ši_£t
Ğ'di¥Ïy_”rÜs' , 
Œue
 );

16 
šşude_Úû
Ğ
CROOT
 . 'lib' . 
DS
 . 'core.function.php' );

17 @
šşude_Úû
Ğ
AROOT
 . 'lib' . 
DS
 . 'app.function.php' );

19 
šşude_Úû
Ğ
CROOT
 . 'cÚfig' . 
DS
 . 'core.config.php' );

20 
šşude_Úû
Ğ
AROOT
 . 'cÚfig' . 
DS
 . 'app.config.php' );

24 
	g$c
 = 
$GLOBALS
['c'] = 
v
('c'è? v('c'è: 
c
('default_controller');

25 
	g$a
 = 
$GLOBALS
['a'] = 
v
('a'è? v('a'è: 
c
('default_action');

27 
	g$c
 = 
ba£Çme
(
¡¹Şow”
Ğ
z
(
$c
) ));

28 
	g$a
 = 
ba£Çme
(
¡¹Şow”
Ğ
z
(
$a
) ));

30 
	g$po¡_fix
 = '.class.php';

32 
	g$cÚt_fe
 = 
AROOT
 . 'cÚŒŞËr' . 
DS
 . 
$c
 . 
$po¡_fix
;

33 
	g$şass_Çme
 = 
$c
 .'Controller' ;

34 ifĞ!
	$fe_exi¡s
Ğ
$cÚt_fe
 ) )

36 
$cÚt_fe
 = 
CROOT
 . 'cÚŒŞËr' . 
DS
 . 
$c
 . 
$po¡_fix
;

37 ifĞ!
	`fe_exi¡s
Ğ
$cÚt_fe
 ) ) 
	`d›
('Cª\'ˆfšd cÚŒŞË¸f- ' . 
$c
 . 
$po¡_fix
 );

38 
	}
}

41 
»quœe_Úû
Ğ
$cÚt_fe
 );

42 ifĞ!
	$şass_exi¡s
Ğ
$şass_Çme
 ) ) 
	`d›
('Can\'t find class - ' . $class_name );

45 
$o
 = 
Ãw
 
$şass_Çme
;

46 ifĞ!
	$m‘hod_exi¡s
Ğ
$o
 , 
$a
 ) ) 
	`d›
('Can\'t find method - ' . $a . ' ');

49 if(
	`¡½os
(
$_SERVER
['HTTP_ACCEPT_ENCODING'], 'gz'è!=ğ
FALSE
è
	`ob_¡¬t
("ob_gzhandler");

50 
	`ÿÎ_u£r_func
Ğ
	`¬¿y
Ğ
$o
 , 
$a
 ) );

	@F:\Site\stew\1\_lp\simpletest\arguments.php

1 <?
php


14 şas 
	cSim¶eArgum’ts
 {

15 
´iv©e
 
	m$®l
 = 
¬¿y
();

28 
funùiÚ
 
	$__cÚ¡ruù
(
$¬gum’ts
) {

29 
	`¬¿y_shiá
(
$¬gum’ts
);

30 
	`couÁ
(
$¬gum’ts
) > 0) {

31 
	`li¡
(
$key
, 
$v®ue
èğ
$this
->
	`·r£Argum’t
(
$¬gum’ts
);

32 
$this
->
	`assign
(
$key
, 
$v®ue
);

44 
funùiÚ
 
	$assign
(
$key
, 
$v®ue
) {

45 ià(
$this
->
$key
 ==ğ
çl£
) {

46 
$this
->
®l
[
$key
] = 
$v®ue
;

47 } 
	`–£if
 (! 
	`is_¬¿y
(
$this
->
$key
)) {

48 
$this
->
®l
[
$key
] = 
	`¬¿y
($this->$key, 
$v®ue
);

50 
$this
->
®l
[
$key
][] = 
$v®ue
;

52 
	}
}

62 
´iv©e
 
funùiÚ
 
	$·r£Argum’t
(&
$¬gum’ts
) {

63 
$¬gum’t
 = 
	`¬¿y_shiá
(
$¬gum’ts
);

64 ià(
	`´eg_m©ch
('/^-(\w)=(.+)$/', 
$¬gum’t
, 
$m©ches
)) {

65  
	`¬¿y
(
$m©ches
[1], $matches[2]);

66 } 
	`–£if
 (
	`´eg_m©ch
('/^-(\w)$/', 
$¬gum’t
, 
$m©ches
)) {

67  
	`¬¿y
(
$m©ches
[1], 
$this
->
	`ÃxtNÚFÏgEl£True
(
$¬gum’ts
));

68 } 
	`–£if
 (
	`´eg_m©ch
('/^--(\w+)=(.+)$/', 
$¬gum’t
, 
$m©ches
)) {

69  
	`¬¿y
(
$m©ches
[1], $matches[2]);

70 } 
	`–£if
 (
	`´eg_m©ch
('/^--(\w+)$/', 
$¬gum’t
, 
$m©ches
)) {

71  
	`¬¿y
(
$m©ches
[1], 
$this
->
	`ÃxtNÚFÏgEl£True
(
$¬gum’ts
));

73 
	}
}

83 
´iv©e
 
funùiÚ
 
	$ÃxtNÚFÏgEl£True
(&
$¬gum’ts
) {

84  
$this
->
	`v®ueIsNext
(
$¬gum’ts
è? 
	`¬¿y_shiá
($¬gum’tsè: 
Œue
;

85 
	}
}

94 
funùiÚ
 
	$v®ueIsNext
(
$¬gum’ts
) {

95  
	`is£t
(
$¬gum’ts
[0]è&& ! 
$this
->
	`isFÏg
($arguments[0]);

96 
	}
}

103 
funùiÚ
 
	$isFÏg
(
$¬gum’t
) {

104  
	`¡ºcmp
(
$¬gum’t
, '-', 1) == 0;

105 
	}
}

117 
funùiÚ
 
	$__g‘
(
$key
) {

118 ià(
	`is£t
(
$this
->
®l
[
$key
])) {

119  
$this
->
®l
[
$key
];

121  
çl£
;

122 
	}
}

128 
funùiÚ
 
	$®l
() {

129  
$this
->
®l
;

130 
	}
}

138 şas 
	cSim¶eH–p
 {

139 
´iv©e
 
	m$ov”v›w
;

140 
´iv©e
 
	m$æag_£ts
 = 
¬¿y
();

141 
´iv©e
 
	m$ex¶ª©iÚs
 = 
¬¿y
();

147 
funùiÚ
 
__cÚ¡ruù
(
$ov”v›w
 = '') {

148 
$this
->
ov”v›w
 = 
$ov”v›w
;

159 
funùiÚ
 
	$ex¶ašFÏg
(
$æags
, 
$ex¶ª©iÚ
) {

160 
$æags
 = 
	`is_¬¿y
($æagsè? $æag : 
	`¬¿y
($flags);

161 
$this
->
æag_£ts
[] = 
$æags
;

162 
$this
->
ex¶ª©iÚs
[] = 
$ex¶ª©iÚ
;

163 
	}
}

169 
funùiÚ
 
	$»nd”
() {

170 
$b_¡İ
 = 
$this
->
	`lÚge¡FÏg
($this->
æag_£ts
) + 4;

171 
$‹xt
 = 
$this
->
ov”v›w
 . "\n";

172 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
æag_£ts
); $i++) {

173 
$‹xt
 .ğ
$this
->
	`»nd”FÏgS‘
($this->
æag_£ts
[
$i
], $this->
ex¶ª©iÚs
[$i], 
$b_¡İ
);

175  
$this
->
	`noDu¶iÿ‹NewLšes
(
$‹xt
);

176 
	}
}

182 
´iv©e
 
funùiÚ
 
	$lÚge¡FÏg
(
$æag_£ts
) {

183 
$lÚge¡
 = 0;

184 
	`fÜ—ch
 (
$æag_£ts
 
as
 
$æags
) {

185 
	`fÜ—ch
 (
$æags
 
as
 
$æag
) {

186 
$lÚge¡
 = 
	`max
($lÚge¡, 
	`¡¾’
(
$this
->
	`»nd”FÏg
(
$æag
)));

189  
$lÚge¡
;

190 
	}
}

196 
´iv©e
 
funùiÚ
 
	$»nd”FÏgS‘
(
$æags
, 
$ex¶ª©iÚ
, 
$b_¡İ
) {

197 
$æag
 = 
	`¬¿y_shiá
(
$æags
);

198 
$‹xt
 = 
	`¡r_·d
(
$this
->
	`»nd”FÏg
(
$æag
), 
$b_¡İ
, ' 'è. 
$ex¶ª©iÚ
 . "\n";

199 
	`fÜ—ch
 (
$æags
 
as
 
$æag
) {

200 
$‹xt
 .ğ' ' . 
$this
->
	`»nd”FÏg
(
$æag
) . "\n";

202  
$‹xt
;

203 
	}
}

210 
´iv©e
 
funùiÚ
 
	$»nd”FÏg
(
$æag
) {

211  (
	`¡¾’
(
$æag
) == 1 ? '-' : '--') . $flag;

212 
	}
}

220 
´iv©e
 
funùiÚ
 
	$noDu¶iÿ‹NewLšes
(
$‹xt
) {

221  
	`´eg_»¶aû
('/(\n+)/', "\n", 
$‹xt
);

222 
	}
}

	@F:\Site\stew\1\_lp\simpletest\authentication.php

1 <?
php


11 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/http.php');

18 şas 
	cSim¶eR—lm
 {

19 
´iv©e
 
	m$ty³
;

20 
´iv©e
 
	m$roÙ
;

21 
´iv©e
 
	m$u£ºame
;

22 
´iv©e
 
	m$·sswÜd
;

32 
funùiÚ
 
	$Sim¶eR—lm
(
$ty³
, 
$u¾
) {

33 
$this
->
ty³
 = 
$ty³
;

34 
$this
->
roÙ
 = 
$u¾
->
	`g‘Ba£P©h
();

35 
$this
->
u£ºame
 = 
çl£
;

36 
$this
->
·sswÜd
 = 
çl£
;

44 
funùiÚ
 
	$¡»tch
(
$u¾
) {

45 
$this
->
roÙ
 = $this->
	`g‘CommÚP©h
($this->roÙ, 
$u¾
->
	`g‘P©h
());

46 
	}
}

55 
´Ùeùed
 
funùiÚ
 
	$g‘CommÚP©h
(
$fœ¡
, 
$£cÚd
) {

56 
$fœ¡
 = 
	`ex¶ode
('/', $first);

57 
$£cÚd
 = 
	`ex¶ode
('/', $second);

58 
$i
 = 0; $˜< 
	`mš
(
	`couÁ
(
$fœ¡
), couÁ(
$£cÚd
)); $i++) {

59 ià(
$fœ¡
[
$i
] !ğ
$£cÚd
[$i]) {

60  
	`im¶ode
('/', 
	`¬¿y_¦iû
(
$fœ¡
, 0, 
$i
)) . '/';

63  
	`im¶ode
('/', 
$fœ¡
) . '/';

64 
	}
}

72 
funùiÚ
 
	$£tId’t™y
(
$u£ºame
, 
$·sswÜd
) {

73 
$this
->
u£ºame
 = 
$u£ºame
;

74 
$this
->
·sswÜd
 = 
$·sswÜd
;

75 
	}
}

82 
funùiÚ
 
	$g‘U£ºame
() {

83  
$this
->
u£ºame
;

84 
	}
}

91 
funùiÚ
 
	$g‘PasswÜd
() {

92  
$this
->
·sswÜd
;

93 
	}
}

102 
funùiÚ
 
	$isW™hš
(
$u¾
) {

103 ià(
$this
->
	`isIn
($this->
roÙ
, 
$u¾
->
	`g‘Ba£P©h
())) {

104  
Œue
;

106 ià(
$this
->
	`isIn
($this->
roÙ
, 
$u¾
->
	`g‘Ba£P©h
(è. $u¾->
	`g‘Page
() . '/')) {

107  
Œue
;

109  
çl£
;

110 
	}
}

121 
´Ùeùed
 
funùiÚ
 
	$isIn
(
$·¹
, 
$whŞe
) {

122  
	`¡½os
(
$whŞe
, 
$·¹
) === 0;

123 
	}
}

131 şas 
	cSim¶eAuth’tiÿtÜ
 {

132 
´iv©e
 
	m$»®ms
;

138 
funùiÚ
 
	$Sim¶eAuth’tiÿtÜ
() {

139 
$this
->
	`»¡¬tSessiÚ
();

146 
funùiÚ
 
	$»¡¬tSessiÚ
() {

147 
$this
->
»®ms
 = 
	`¬¿y
();

148 
	}
}

166 
funùiÚ
 
	$addR—lm
(
$u¾
, 
$ty³
, 
$»®m
) {

167 
$this
->
»®ms
[
$u¾
->
	`g‘Ho¡
()][
$»®m
] = 
Ãw
 
	`Sim¶eR—lm
(
$ty³
, $url);

168 
	}
}

179 
funùiÚ
 
	$£tId’t™yFÜR—lm
(
$ho¡
, 
$»®m
, 
$u£ºame
, 
$·sswÜd
) {

180 ià(
	`is£t
(
$this
->
»®ms
[
$ho¡
][
$»®m
])) {

181 
$this
->
»®ms
[
$ho¡
][
$»®m
]->
	`£tId’t™y
(
$u£ºame
, 
$·sswÜd
);

183 
	}
}

191 
´Ùeùed
 
funùiÚ
 
	$fšdR—lmFromU¾
(
$u¾
) {

192 ià(! 
	`is£t
(
$this
->
»®ms
[
$u¾
->
	`g‘Ho¡
()])) {

193  
çl£
;

195 
	`fÜ—ch
 (
$this
->
»®ms
[
$u¾
->
	`g‘Ho¡
()] 
as
 
$Çme
 => 
$»®m
) {

196 ià(
$»®m
->
	`isW™hš
(
$u¾
)) {

197  
$»®m
;

200  
çl£
;

201 
	}
}

209 
funùiÚ
 
	$addH—d”s
(&
$»que¡
, 
$u¾
) {

210 ià(
$u¾
->
	`g‘U£ºame
(è&& $u¾->
	`g‘PasswÜd
()) {

211 
$u£ºame
 = 
$u¾
->
	`g‘U£ºame
();

212 
$·sswÜd
 = 
$u¾
->
	`g‘PasswÜd
();

213 } 
	`–£if
 (
$»®m
 = 
$this
->
	`fšdR—lmFromU¾
(
$u¾
)) {

214 
$u£ºame
 = 
$»®m
->
	`g‘U£ºame
();

215 
$·sswÜd
 = 
$»®m
->
	`g‘PasswÜd
();

219 
$this
->
	`addBasicH—d”s
(
$»que¡
, 
$u£ºame
, 
$·sswÜd
);

220 
	}
}

230 
funùiÚ
 
	$addBasicH—d”s
(&
$»que¡
, 
$u£ºame
, 
$·sswÜd
) {

231 ià(
$u£ºame
 && 
$·sswÜd
) {

232 
$»que¡
->
	`addH—d”Lše
(

233 'AuthÜiz©iÚ: Basiø' . 
	`ba£64_’code
("$username:$password"));

235 
	}
}

	@F:\Site\stew\1\_lp\simpletest\autorun.php

1 <?
php


12 
»quœe_Úû
 
dœÇme
(
__FILE__
) . '/unit_tester.php';

13 
»quœe_Úû
 
dœÇme
(
__FILE__
) . '/mock_objects.php';

14 
»quœe_Úû
 
dœÇme
(
__FILE__
) . '/collector.php';

15 
»quœe_Úû
 
dœÇme
(
__FILE__
) . '/default_reporter.php';

18 
	g$GLOBALS
['SIMPLETEST_AUTORUNNER_INITIAL_CLASSES'] = 
g‘_deş¬ed_şas£s
();

19 
	g$GLOBALS
['SIMPLETEST_AUTORUNNER_INITIAL_PATH'] = 
g‘cwd
();

20 
»gi¡”_shutdown_funùiÚ
('simpletest_autorun');

25 
funùiÚ
 
	$sim¶‘e¡_autÜun
() {

26 
	`chdœ
(
$GLOBALS
['SIMPLETEST_AUTORUNNER_INITIAL_PATH']);

27 ià(
	`‹¡s_have_run
()) {

30 
$»suÉ
 = 
	`run_loÿl_‹¡s
();

31 ià(
Sim¶eR•Ü‹r
::
	`šCli
()) {

32 
	`ex™
(
$»suÉ
 ? 0 : 1);

34 
	}
}

44 
funùiÚ
 
	$run_loÿl_‹¡s
() {

45 
Œy
 {

46 ià(
	`‹¡s_have_run
()) {

49 
$ÿndid©es
 = 
	`ÿ±u»_Ãw_şas£s
();

50 
$lßd”
 = 
Ãw
 
	`Sim¶eFeLßd”
();

51 
$su™e
 = 
$lßd”
->
	`ü—‹Su™eFromCÏs£s
(

52 
	`ba£Çme
(
	`š™Ÿl_fe
()),

53 
$lßd”
->
	`£ËùRuÂabËTe¡s
(
$ÿndid©es
));

54  
$su™e
->
	`run
(
Ãw
 
	`DeçuÉR•Ü‹r
());

55 } 
	`ÿtch
 (
Exû±iÚ
 
$¡ack_äame_fix
) {

56 
´št
 
$¡ack_äame_fix
->
	`g‘Mes§ge
();

57  
çl£
;

59 
	}
}

66 
funùiÚ
 
	$‹¡s_have_run
() {

67 ià(
$cÚ‹xt
 = 
Sim¶eTe¡
::
	`g‘CÚ‹xt
()) {

68  (
boŞ—n
)
$cÚ‹xt
->
	`g‘Te¡
();

70  
çl£
;

71 
	}
}

77 
funùiÚ
 
	$š™Ÿl_fe
() {

78 
$fe
 = 
çl£
;

79 ià(! 
$fe
) {

80 ià(
	`is£t
(
$_SERVER
, $_SERVER['SCRIPT_FILENAME'])) {

81 
$fe
 = 
$_SERVER
['SCRIPT_FILENAME'];

83 
$šşuded_fes
 = 
	`g‘_šşuded_fes
();

84 
$fe
 = 
	`»£t
(
$šşuded_fes
);

87  
$fe
;

88 
	}
}

95 
funùiÚ
 
	$ÿ±u»_Ãw_şas£s
() {

96 
glob®
 
$SIMPLETEST_AUTORUNNER_INITIAL_CLASSES
;

97  
	`¬¿y_m­
('¡¹Şow”', 
	`¬¿y_diff
(
	`g‘_deş¬ed_şas£s
(),

98 
$SIMPLETEST_AUTORUNNER_INITIAL_CLASSES
 ?

99 
$SIMPLETEST_AUTORUNNER_INITIAL_CLASSES
 : 
	`¬¿y
()));

100 
	}
}

	@F:\Site\stew\1\_lp\simpletest\browser.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/simpletest.php');

13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/http.php');

14 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/encoding.php');

15 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/page.php');

16 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/php_parser.php');

17 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/tidy_parser.php');

18 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/selector.php');

19 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/frames.php');

20 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/user_agent.php');

21 ià(! 
	gSim¶eTe¡
::
	$g‘P¬£rs
()) {

22 
Sim¶eTe¡
::
	`£tP¬£rs
(
	`¬¿y
(
Ãw
 
	`Sim¶eTidyPageBud”
(),‚ew 
	`Sim¶ePHPPageBud”
()));

24 
	}
}

27 ià(! 
defšed
('DEFAULT_MAX_NESTED_FRAMES')) {

28 
defše
('DEFAULT_MAX_NESTED_FRAMES', 3);

36 şas 
	cSim¶eBrow£rHi¡Üy
 {

37 
´iv©e
 
	m$£qu’û
 = 
¬¿y
();

38 
´iv©e
 
	m$pos™iÚ
 = -1;

45 
´Ùeùed
 
funùiÚ
 
	$isEm±y
() {

46  (
$this
->
pos™iÚ
 == -1);

54 
´Ùeùed
 
funùiÚ
 
	$©Begšnšg
() {

55  (
$this
->
pos™iÚ
 =ğ0è&& ! $this->
	`isEm±y
();

56 
	}
}

63 
´Ùeùed
 
funùiÚ
 
	$©End
() {

64  (
$this
->
pos™iÚ
 + 1 >ğ
	`couÁ
($this->
£qu’û
)è&& ! $this->
	`isEm±y
();

65 
	}
}

73 
funùiÚ
 
	$»cÜdEÁry
(
$u¾
, 
$·¿m‘”s
) {

74 
$this
->
	`drİFutu»
();

75 
	`¬¿y_push
(

76 
$this
->
£qu’û
,

77 
	`¬¿y
('u¾' => 
$u¾
, '·¿m‘”s' => 
$·¿m‘”s
));

78 
$this
->
pos™iÚ
++;

79 
	}
}

87 
funùiÚ
 
	$g‘U¾
() {

88 ià(
$this
->
	`isEm±y
()) {

89  
çl£
;

91  
$this
->
£qu’û
[$this->
pos™iÚ
]['url'];

92 
	}
}

100 
funùiÚ
 
	$g‘P¬am‘”s
() {

101 ià(
$this
->
	`isEm±y
()) {

102  
çl£
;

104  
$this
->
£qu’û
[$this->
pos™iÚ
]['parameters'];

105 
	}
}

113 
funùiÚ
 
	$back
() {

114 ià(
$this
->
	`isEm±y
(è|| $this->
	`©Begšnšg
()) {

115  
çl£
;

117 
$this
->
pos™iÚ
--;

118  
Œue
;

119 
	}
}

127 
funùiÚ
 
	$fÜw¬d
() {

128 ià(
$this
->
	`isEm±y
(è|| $this->
	`©End
()) {

129  
çl£
;

131 
$this
->
pos™iÚ
++;

132  
Œue
;

133 
	}
}

140 
´Ùeùed
 
funùiÚ
 
	$drİFutu»
() {

141 ià(
$this
->
	`isEm±y
()) {

144 ! 
$this
->
	`©End
()) {

145 
	`¬¿y_pİ
(
$this
->
£qu’û
);

147 
	}
}

157 şas 
	cSim¶eBrow£r
 {

158 
´iv©e
 
	m$u£r_ag’t
;

159 
´iv©e
 
	m$·ge
;

160 
´iv©e
 
	m$hi¡Üy
;

161 
´iv©e
 
	m$ignÜe_äames
;

162 
´iv©e
 
	m$maximum_Ã¡ed_äames
;

163 
´iv©e
 
	m$·r£r
;

172 
funùiÚ
 
	$__cÚ¡ruù
() {

173 
$this
->
u£r_ag’t
 = $this->
	`ü—‹U£rAg’t
();

174 
$this
->
u£r_ag’t
->
	`u£Proxy
(

175 
Sim¶eTe¡
::
	`g‘DeçuÉProxy
(),

176 
Sim¶eTe¡
::
	`g‘DeçuÉProxyU£ºame
(),

177 
Sim¶eTe¡
::
	`g‘DeçuÉProxyPasswÜd
());

178 
$this
->
·ge
 = 
Ãw
 
	`Sim¶ePage
();

179 
$this
->
hi¡Üy
 = $this->
	`ü—‹Hi¡Üy
();

180 
$this
->
ignÜe_äames
 = 
çl£
;

181 
$this
->
maximum_Ã¡ed_äames
 = 
DEFAULT_MAX_NESTED_FRAMES
;

189 
´Ùeùed
 
funùiÚ
 
	$ü—‹U£rAg’t
() {

190  
Ãw
 
	`Sim¶eU£rAg’t
();

191 
	}
}

198 
´Ùeùed
 
funùiÚ
 
	$ü—‹Hi¡Üy
() {

199  
Ãw
 
	`Sim¶eBrow£rHi¡Üy
();

200 
	}
}

208 
´Ùeùed
 
funùiÚ
 
	$g‘P¬£r
() {

209 ià(
$this
->
·r£r
) {

210  
$this
->
·r£r
;

212 
	`fÜ—ch
 (
Sim¶eTe¡
::
	`g‘P¬£rs
(è
as
 
$·r£r
) {

213 ià(
$·r£r
->
	`ÿn
()) {

214  
$·r£r
;

217 
	}
}

223 
public
 
funùiÚ
 
	$£tP¬£r
(
$·r£r
) {

224 
$this
->
·r£r
 = 
$·r£r
;

225 
	}
}

232 
funùiÚ
 
	$ignÜeF¿mes
() {

233 
$this
->
ignÜe_äames
 = 
Œue
;

234 
	}
}

241 
funùiÚ
 
	$u£F¿mes
() {

242 
$this
->
ignÜe_äames
 = 
çl£
;

243 
	}
}

249 
funùiÚ
 
	$ignÜeCook›s
() {

250 
$this
->
u£r_ag’t
->
	`ignÜeCook›s
();

251 
	}
}

257 
funùiÚ
 
	$u£Cook›s
() {

258 
$this
->
u£r_ag’t
->
	`u£Cook›s
();

259 
	}
}

269 
´Ùeùed
 
funùiÚ
 
	$·r£
(
$»¥Ú£
, 
$d•th
 = 0) {

270 
$·ge
 = 
$this
->
	`budPage
(
$»¥Ú£
);

271 ià(
$this
->
ignÜe_äames
 || ! 
$·ge
->
	`hasF¿mes
(è|| (
$d•th
 > $this->
maximum_Ã¡ed_äames
)) {

272  
$·ge
;

274 
$äame£t
 = 
Ãw
 
	`Sim¶eF¿me£t
(
$·ge
);

275 
	`fÜ—ch
 (
$·ge
->
	`g‘F¿me£t
(è
as
 
$key
 => 
$u¾
) {

276 
$äame
 = 
$this
->
	`ãtch
(
$u¾
, 
Ãw
 
	`Sim¶eG‘Encodšg
(), 
$d•th
 + 1);

277 
$äame£t
->
	`addF¿me
(
$äame
, 
$key
);

279  
$äame£t
;

280 
	}
}

289 
´Ùeùed
 
funùiÚ
 
	$budPage
(
$»¥Ú£
) {

290  
$this
->
	`g‘P¬£r
()->
	`·r£
(
$»¥Ú£
);

291 
	}
}

302 
´Ùeùed
 
funùiÚ
 
	$ãtch
(
$u¾
, 
$’codšg
, 
$d•th
 = 0) {

303 
$»¥Ú£
 = 
$this
->
u£r_ag’t
->
	`ãtchRe¥Ú£
(
$u¾
, 
$’codšg
);

304 ià(
$»¥Ú£
->
	`isE¼Ü
()) {

305  
Ãw
 
	`Sim¶ePage
(
$»¥Ú£
);

307  
$this
->
	`·r£
(
$»¥Ú£
, 
$d•th
);

308 
	}
}

318 
´Ùeùed
 
funùiÚ
 
	$lßd
(
$u¾
, 
$·¿m‘”s
) {

319 
$äame
 = 
$u¾
->
	`g‘T¬g‘
();

320 ià(! 
$äame
 || ! 
$this
->
·ge
->
	`hasF¿mes
(è|| (
	`¡¹Şow”
($frame) == '_top')) {

321  
$this
->
	`lßdPage
(
$u¾
, 
$·¿m‘”s
);

323  
$this
->
	`lßdF¿me
(
	`¬¿y
(
$äame
), 
$u¾
, 
$·¿m‘”s
);

324 
	}
}

333 
´Ùeùed
 
funùiÚ
 
	$lßdPage
(
$u¾
, 
$·¿m‘”s
) {

334 
$this
->
·ge
 = $this->
	`ãtch
(
$u¾
, 
$·¿m‘”s
);

335 
$this
->
hi¡Üy
->
	`»cÜdEÁry
(

336 
$this
->
·ge
->
	`g‘U¾
(),

337 
$this
->
·ge
->
	`g‘Reque¡D©a
());

338  
$this
->
·ge
->
	`g‘Raw
();

339 
	}
}

350 
´Ùeùed
 
funùiÚ
 
	$lßdF¿me
(
$äames
, 
$u¾
, 
$·¿m‘”s
) {

351 
$·ge
 = 
$this
->
	`ãtch
(
$u¾
, 
$·¿m‘”s
);

352 
$this
->
·ge
->
	`£tF¿me
(
$äames
, 
$·ge
);

353  
$·ge
->
	`g‘Raw
();

354 
	}
}

364 
funùiÚ
 
	$»¡¬t
(
$d©e
 = 
çl£
) {

365 
$this
->
u£r_ag’t
->
	`»¡¬t
(
$d©e
);

366 
	}
}

374 
funùiÚ
 
	$addH—d”
(
$h—d”
) {

375 
$this
->
u£r_ag’t
->
	`addH—d”
(
$h—d”
);

376 
	}
}

383 
funùiÚ
 
	$ageCook›s
(
$š‹rv®
) {

384 
$this
->
u£r_ag’t
->
	`ageCook›s
(
$š‹rv®
);

385 
	}
}

397 
funùiÚ
 
£tCook›
(
$Çme
, 
$v®ue
, 
$ho¡
 = 
çl£
, 
$·th
 = '/', 
$expœy
 = false) {

398 
$this
->
u£r_ag’t
->
£tCook›
(
$Çme
, 
$v®ue
, 
$ho¡
, 
$·th
, 
$expœy
);

411 
funùiÚ
 
	$g‘Cook›V®ue
(
$ho¡
, 
$·th
, 
$Çme
) {

412  
$this
->
u£r_ag’t
->
	`g‘Cook›V®ue
(
$ho¡
, 
$·th
, 
$Çme
);

413 
	}
}

422 
funùiÚ
 
	$g‘Cu¼’tCook›V®ue
(
$Çme
) {

423  
$this
->
u£r_ag’t
->
	`g‘Ba£Cook›V®ue
(
$Çme
, $this->
·ge
->
	`g‘U¾
());

424 
	}
}

432 
funùiÚ
 
	$£tMaximumRedœeùs
(
$max
) {

433 
$this
->
u£r_ag’t
->
	`£tMaximumRedœeùs
(
$max
);

434 
	}
}

442 
funùiÚ
 
	$£tMaximumNe¡edF¿mes
(
$max
) {

443 
$this
->
maximum_Ã¡ed_äames
 = 
$max
;

444 
	}
}

451 
funùiÚ
 
	$£tCÚÃùiÚTimeout
(
$timeout
) {

452 
$this
->
u£r_ag’t
->
	`£tCÚÃùiÚTimeout
(
$timeout
);

453 
	}
}

464 
funùiÚ
 
	$u£Proxy
(
$´oxy
, 
$u£ºame
 = 
çl£
, 
$·sswÜd
 = false) {

465 
$this
->
u£r_ag’t
->
	`u£Proxy
(
$´oxy
, 
$u£ºame
, 
$·sswÜd
);

466 
	}
}

477 
funùiÚ
 
	$h—d
(
$u¾
, 
$·¿m‘”s
 = 
çl£
) {

478 ià(! 
	`is_objeù
(
$u¾
)) {

479 
$u¾
 = 
Ãw
 
	`Sim¶eU¾
($url);

481 ià(
$this
->
	`g‘U¾
()) {

482 
$u¾
 = $u¾->
	`makeAbsŞu‹
(
$this
->
	`g‘U¾
());

484 
$»¥Ú£
 = 
$this
->
u£r_ag’t
->
	`ãtchRe¥Ú£
(
$u¾
, 
Ãw
 
	`Sim¶eH—dEncodšg
(
$·¿m‘”s
));

485 
$this
->
·ge
 = 
Ãw
 
	`Sim¶ePage
(
$»¥Ú£
);

486  ! 
$»¥Ú£
->
	`isE¼Ü
();

487 
	}
}

497 
funùiÚ
 
	$g‘
(
$u¾
, 
$·¿m‘”s
 = 
çl£
) {

498 ià(! 
	`is_objeù
(
$u¾
)) {

499 
$u¾
 = 
Ãw
 
	`Sim¶eU¾
($url);

501 ià(
$this
->
	`g‘U¾
()) {

502 
$u¾
 = $u¾->
	`makeAbsŞu‹
(
$this
->
	`g‘U¾
());

504  
$this
->
	`lßd
(
$u¾
, 
Ãw
 
	`Sim¶eG‘Encodšg
(
$·¿m‘”s
));

505 
	}
}

515 
funùiÚ
 
	$po¡
(
$u¾
, 
$·¿m‘”s
 = 
çl£
, 
$cÚ‹Á_ty³
 = false) {

516 ià(! 
	`is_objeù
(
$u¾
)) {

517 
$u¾
 = 
Ãw
 
	`Sim¶eU¾
($url);

519 ià(
$this
->
	`g‘U¾
()) {

520 
$u¾
 = $u¾->
	`makeAbsŞu‹
(
$this
->
	`g‘U¾
());

522  
$this
->
	`lßd
(
$u¾
, 
Ãw
 
	`Sim¶ePo¡Encodšg
(
$·¿m‘”s
, 
$cÚ‹Á_ty³
));

523 
	}
}

533 
funùiÚ
 
	$put
(
$u¾
, 
$·¿m‘”s
 = 
çl£
, 
$cÚ‹Á_ty³
 = false) {

534 ià(! 
	`is_objeù
(
$u¾
)) {

535 
$u¾
 = 
Ãw
 
	`Sim¶eU¾
($url);

537  
$this
->
	`lßd
(
$u¾
, 
Ãw
 
	`Sim¶ePutEncodšg
(
$·¿m‘”s
, 
$cÚ‹Á_ty³
));

538 
	}
}

548 
funùiÚ
 
	$d–‘e
(
$u¾
, 
$·¿m‘”s
 = 
çl£
) {

549 ià(! 
	`is_objeù
(
$u¾
)) {

550 
$u¾
 = 
Ãw
 
	`Sim¶eU¾
($url);

552  
$this
->
	`lßd
(
$u¾
, 
Ãw
 
	`Sim¶eD–‘eEncodšg
(
$·¿m‘”s
));

553 
	}
}

563 
funùiÚ
 
	$»Œy
() {

564 
$äames
 = 
$this
->
·ge
->
	`g‘F¿meFocus
();

565 ià(
	`couÁ
(
$äames
) > 0) {

566 
$this
->
	`lßdF¿me
(

567 
$äames
,

568 
$this
->
·ge
->
	`g‘U¾
(),

569 
$this
->
·ge
->
	`g‘Reque¡D©a
());

570  
$this
->
·ge
->
	`g‘Raw
();

572 ià(
$u¾
 = 
$this
->
hi¡Üy
->
	`g‘U¾
()) {

573 
$this
->
·ge
 = $this->
	`ãtch
(
$u¾
, $this->
hi¡Üy
->
	`g‘P¬am‘”s
());

574  
$this
->
·ge
->
	`g‘Raw
();

576  
çl£
;

577 
	}
}

588 
funùiÚ
 
	$back
() {

589 ià(! 
$this
->
hi¡Üy
->
	`back
()) {

590  
çl£
;

592 
$cÚ‹Á
 = 
$this
->
	`»Œy
();

593 ià(! 
$cÚ‹Á
) {

594 
$this
->
hi¡Üy
->
	`fÜw¬d
();

596  
$cÚ‹Á
;

597 
	}
}

608 
funùiÚ
 
	$fÜw¬d
() {

609 ià(! 
$this
->
hi¡Üy
->
	`fÜw¬d
()) {

610  
çl£
;

612 
$cÚ‹Á
 = 
$this
->
	`»Œy
();

613 ià(! 
$cÚ‹Á
) {

614 
$this
->
hi¡Üy
->
	`back
();

616  
$cÚ‹Á
;

617 
	}
}

629 
funùiÚ
 
	$auth’tiÿ‹
(
$u£ºame
, 
$·sswÜd
) {

630 ià(! 
$this
->
·ge
->
	`g‘R—lm
()) {

631  
çl£
;

633 
$u¾
 = 
$this
->
·ge
->
	`g‘U¾
();

634 ià(! 
$u¾
) {

635  
çl£
;

637 
$this
->
u£r_ag’t
->
	`£tId’t™y
(

638 
$u¾
->
	`g‘Ho¡
(),

639 
$this
->
·ge
->
	`g‘R—lm
(),

640 
$u£ºame
,

641 
$·sswÜd
);

642  
$this
->
	`»Œy
();

643 
	}
}

651 
funùiÚ
 
	$g‘F¿mes
() {

652  
$this
->
·ge
->
	`g‘F¿mes
();

653 
	}
}

663 
funùiÚ
 
	$g‘F¿meFocus
() {

664  
$this
->
·ge
->
	`g‘F¿meFocus
();

665 
	}
}

673 
funùiÚ
 
	$£tF¿meFocusByIndex
(
$choiû
) {

674  
$this
->
·ge
->
	`£tF¿meFocusByIndex
(
$choiû
);

675 
	}
}

683 
funùiÚ
 
	$£tF¿meFocus
(
$Çme
) {

684  
$this
->
·ge
->
	`£tF¿meFocus
(
$Çme
);

685 
	}
}

692 
funùiÚ
 
	$ş—rF¿meFocus
() {

693  
$this
->
·ge
->
	`ş—rF¿meFocus
();

694 
	}
}

701 
funùiÚ
 
	$g‘T¿n¥ÜtE¼Ü
() {

702  
$this
->
·ge
->
	`g‘T¿n¥ÜtE¼Ü
();

703 
	}
}

710 
funùiÚ
 
	$g‘MimeTy³
() {

711  
$this
->
·ge
->
	`g‘MimeTy³
();

712 
	}
}

719 
funùiÚ
 
	$g‘Re¥Ú£Code
() {

720  
$this
->
·ge
->
	`g‘Re¥Ú£Code
();

721 
	}
}

729 
funùiÚ
 
	$g‘Auth’tiÿtiÚ
() {

730  
$this
->
·ge
->
	`g‘Auth’tiÿtiÚ
();

731 
	}
}

739 
funùiÚ
 
	$g‘R—lm
() {

740  
$this
->
·ge
->
	`g‘R—lm
();

741 
	}
}

749 
funùiÚ
 
	$g‘U¾
() {

750 
$u¾
 = 
$this
->
·ge
->
	`g‘U¾
();

751  
$u¾
 ? $u¾->
	`asSŒšg
(è: 
çl£
;

752 
	}
}

758 
funùiÚ
 
	$g‘Ba£U¾
() {

759 
$u¾
 = 
$this
->
·ge
->
	`g‘Ba£U¾
();

760  
$u¾
 ? $u¾->
	`asSŒšg
(è: 
çl£
;

761 
	}
}

768 
funùiÚ
 
	$g‘Reque¡
() {

769  
$this
->
·ge
->
	`g‘Reque¡
();

770 
	}
}

777 
funùiÚ
 
	$g‘H—d”s
() {

778  
$this
->
·ge
->
	`g‘H—d”s
();

779 
	}
}

786 
funùiÚ
 
	$g‘CÚ‹Á
() {

787  
$this
->
·ge
->
	`g‘Raw
();

788 
	}
}

795 
funùiÚ
 
	$g‘CÚ‹ÁAsText
() {

796  
$this
->
·ge
->
	`g‘Text
();

797 
	}
}

804 
funùiÚ
 
	$g‘T™Ë
() {

805  
$this
->
·ge
->
	`g‘T™Ë
();

806 
	}
}

814 
funùiÚ
 
	$g‘U¾s
() {

815  
$this
->
·ge
->
	`g‘U¾s
();

816 
	}
}

825 
funùiÚ
 
	$£tF›ld
(
$Ïb–
, 
$v®ue
, 
$pos™iÚ
=
çl£
) {

826  
$this
->
·ge
->
	`£tF›ld
(
Ãw
 
	`Sim¶eByLab–OrName
(
$Ïb–
), 
$v®ue
, 
$pos™iÚ
);

827 
	}
}

837 
funùiÚ
 
	$£tF›ldByName
(
$Çme
, 
$v®ue
, 
$pos™iÚ
=
çl£
) {

838  
$this
->
·ge
->
	`£tF›ld
(
Ãw
 
	`Sim¶eByName
(
$Çme
), 
$v®ue
, 
$pos™iÚ
);

839 
	}
}

848 
funùiÚ
 
	$£tF›ldById
(
$id
, 
$v®ue
) {

849  
$this
->
·ge
->
	`£tF›ld
(
Ãw
 
	`Sim¶eById
(
$id
), 
$v®ue
);

850 
	}
}

861 
funùiÚ
 
	$g‘F›ld
(
$Ïb–
) {

862  
$this
->
·ge
->
	`g‘F›ld
(
Ãw
 
	`Sim¶eByLab–OrName
(
$Ïb–
));

863 
	}
}

874 
funùiÚ
 
	$g‘F›ldByName
(
$Çme
) {

875  
$this
->
·ge
->
	`g‘F›ld
(
Ãw
 
	`Sim¶eByName
(
$Çme
));

876 
	}
}

886 
funùiÚ
 
	$g‘F›ldById
(
$id
) {

887  
$this
->
·ge
->
	`g‘F›ld
(
Ãw
 
	`Sim¶eById
(
$id
));

888 
	}
}

899 
funùiÚ
 
şickSubm™
(
$Ïb–
 = 'Subm™', 
$add™iÚ®
 = 
çl£
) {

900 ià(! (
$fÜm
 = 
$this
->
·ge
->
g‘FÜmBySubm™
(
Ãw
 
Sim¶eByLab–
(
$Ïb–
)))) {

901  
çl£
;

903 
	g$sucûss
 = 
$this
->
lßd
(

904 
$fÜm
->
g‘AùiÚ
(),

905 
$fÜm
->
subm™Bu‰Ú
(
Ãw
 
Sim¶eByLab–
(
$Ïb–
), 
$add™iÚ®
));

906  (
	g$sucûss
 ? 
	g$this
->
g‘CÚ‹Á
(è: 
$sucûss
);

917 
funùiÚ
 
	$şickSubm™ByName
(
$Çme
, 
$add™iÚ®
 = 
çl£
) {

918 ià(! (
$fÜm
 = 
$this
->
·ge
->
	`g‘FÜmBySubm™
(
Ãw
 
	`Sim¶eByName
(
$Çme
)))) {

919  
çl£
;

921 
$sucûss
 = 
$this
->
	`lßd
(

922 
$fÜm
->
	`g‘AùiÚ
(),

923 
$fÜm
->
	`subm™Bu‰Ú
(
Ãw
 
	`Sim¶eByName
(
$Çme
), 
$add™iÚ®
));

924  (
$sucûss
 ? 
$this
->
	`g‘CÚ‹Á
() : $success);

925 
	}
}

935 
funùiÚ
 
	$şickSubm™ById
(
$id
, 
$add™iÚ®
 = 
çl£
) {

936 ià(! (
$fÜm
 = 
$this
->
·ge
->
	`g‘FÜmBySubm™
(
Ãw
 
	`Sim¶eById
(
$id
)))) {

937  
çl£
;

939 
$sucûss
 = 
$this
->
	`lßd
(

940 
$fÜm
->
	`g‘AùiÚ
(),

941 
$fÜm
->
	`subm™Bu‰Ú
(
Ãw
 
	`Sim¶eById
(
$id
), 
$add™iÚ®
));

942  (
$sucûss
 ? 
$this
->
	`g‘CÚ‹Á
() : $success);

943 
	}
}

952 
funùiÚ
 
	$isSubm™
(
$Ïb–
) {

953  (
boŞ—n
)
$this
->
·ge
->
	`g‘FÜmBySubm™
(
Ãw
 
	`Sim¶eByLab–
(
$Ïb–
));

954 
	}
}

969 
funùiÚ
 
	$şickImage
(
$Ïb–
, 
$x
 = 1, 
$y
 = 1, 
$add™iÚ®
 = 
çl£
) {

970 ià(! (
$fÜm
 = 
$this
->
·ge
->
	`g‘FÜmByImage
(
Ãw
 
	`Sim¶eByLab–
(
$Ïb–
)))) {

971  
çl£
;

973 
$sucûss
 = 
$this
->
	`lßd
(

974 
$fÜm
->
	`g‘AùiÚ
(),

975 
$fÜm
->
	`subm™Image
(
Ãw
 
	`Sim¶eByLab–
(
$Ïb–
), 
$x
, 
$y
, 
$add™iÚ®
));

976  (
$sucûss
 ? 
$this
->
	`g‘CÚ‹Á
() : $success);

977 
	}
}

992 
funùiÚ
 
	$şickImageByName
(
$Çme
, 
$x
 = 1, 
$y
 = 1, 
$add™iÚ®
 = 
çl£
) {

993 ià(! (
$fÜm
 = 
$this
->
·ge
->
	`g‘FÜmByImage
(
Ãw
 
	`Sim¶eByName
(
$Çme
)))) {

994  
çl£
;

996 
$sucûss
 = 
$this
->
	`lßd
(

997 
$fÜm
->
	`g‘AùiÚ
(),

998 
$fÜm
->
	`subm™Image
(
Ãw
 
	`Sim¶eByName
(
$Çme
), 
$x
, 
$y
, 
$add™iÚ®
));

999  (
$sucûss
 ? 
$this
->
	`g‘CÚ‹Á
() : $success);

1000 
	}
}

1014 
funùiÚ
 
	$şickImageById
(
$id
, 
$x
 = 1, 
$y
 = 1, 
$add™iÚ®
 = 
çl£
) {

1015 ià(! (
$fÜm
 = 
$this
->
·ge
->
	`g‘FÜmByImage
(
Ãw
 
	`Sim¶eById
(
$id
)))) {

1016  
çl£
;

1018 
$sucûss
 = 
$this
->
	`lßd
(

1019 
$fÜm
->
	`g‘AùiÚ
(),

1020 
$fÜm
->
	`subm™Image
(
Ãw
 
	`Sim¶eById
(
$id
), 
$x
, 
$y
, 
$add™iÚ®
));

1021  (
$sucûss
 ? 
$this
->
	`g‘CÚ‹Á
() : $success);

1022 
	}
}

1031 
funùiÚ
 
	$isImage
(
$Ïb–
) {

1032  (
boŞ—n
)
$this
->
·ge
->
	`g‘FÜmByImage
(
Ãw
 
	`Sim¶eByLab–
(
$Ïb–
));

1033 
	}
}

1042 
funùiÚ
 
	$subm™FÜmById
(
$id
, 
$add™iÚ®
 = 
çl£
) {

1043 ià(! (
$fÜm
 = 
$this
->
·ge
->
	`g‘FÜmById
(
$id
))) {

1044  
çl£
;

1046 
$sucûss
 = 
$this
->
	`lßd
(

1047 
$fÜm
->
	`g‘AùiÚ
(),

1048 
$fÜm
->
	`subm™
(
$add™iÚ®
));

1049  (
$sucûss
 ? 
$this
->
	`g‘CÚ‹Á
() : $success);

1050 
	}
}

1062 
funùiÚ
 
	$g‘Lšk
(
$Ïb–
, 
$šdex
 = 0) {

1063 
$u¾s
 = 
$this
->
·ge
->
	`g‘U¾sByLab–
(
$Ïb–
);

1064 ià(
	`couÁ
(
$u¾s
) == 0) {

1065  
çl£
;

1067 ià(
	`couÁ
(
$u¾s
è< 
$šdex
 + 1) {

1068  
çl£
;

1070  
$u¾s
[
$šdex
];

1071 
	}
}

1083 
funùiÚ
 
	$şickLšk
(
$Ïb–
, 
$šdex
 = 0) {

1084 
$u¾
 = 
$this
->
	`g‘Lšk
(
$Ïb–
, 
$šdex
);

1085 ià(
$u¾
 ==ğ
çl£
) {

1086  
çl£
;

1088 
$this
->
	`lßd
(
$u¾
, 
Ãw
 
	`Sim¶eG‘Encodšg
());

1089  
$this
->
	`g‘CÚ‹Á
();

1090 
	}
}

1098 
funùiÚ
 
	$g‘LškById
(
$id
) {

1099  
$this
->
·ge
->
	`g‘U¾ById
(
$id
);

1100 
	}
}

1108 
funùiÚ
 
	$şickLškById
(
$id
) {

1109 ià(! (
$u¾
 = 
$this
->
	`g‘LškById
(
$id
))) {

1110  
çl£
;

1112 
$this
->
	`lßd
(
$u¾
, 
Ãw
 
	`Sim¶eG‘Encodšg
());

1113  
$this
->
	`g‘CÚ‹Á
();

1114 
	}
}

1123 
funùiÚ
 
	$şick
(
$Ïb–
) {

1124 
$¿w
 = 
$this
->
	`şickSubm™
(
$Ïb–
);

1125 ià(! 
$¿w
) {

1126 
$¿w
 = 
$this
->
	`şickLšk
(
$Ïb–
);

1128 ià(! 
$¿w
) {

1129 
$¿w
 = 
$this
->
	`şickImage
(
$Ïb–
);

1131  
$¿w
;

1132 
	}
}

1140 
funùiÚ
 
	$isClickabË
(
$Ïb–
) {

1141  
$this
->
	`isSubm™
(
$Ïb–
è|| ($this->
	`g‘Lšk
($Ïb–è!=ğ
çl£
è|| $this->
	`isImage
($label);

1142 
	}
}

	@F:\Site\stew\1\_lp\simpletest\collector.php

1 <?
php


19 şas 
	cSim¶eCŞËùÜ
 {

26 
´Ùeùed
 
funùiÚ
 
	$»moveT¿šgSÏsh
(
$·th
) {

27 ià(
	`sub¡r
(
$·th
, -1è=ğ
DIRECTORY_SEPARATOR
) {

28  
	`sub¡r
(
$·th
, 0, -1);

29 } 
	`–£if
 (
	`sub¡r
(
$·th
, -1) == '/') {

30  
	`sub¡r
(
$·th
, 0, -1);

32  
$·th
;

42 
funùiÚ
 
	$cŞËù
(&
$‹¡
, 
$·th
) {

43 
$·th
 = 
$this
->
	`»moveT¿šgSÏsh
($path);

44 ià(
$hªdË
 = 
	`İ’dœ
(
$·th
)) {

45 (
$’Œy
 = 
	`»addœ
(
$hªdË
)è!=ğ
çl£
) {

46 ià(
$this
->
	`isHidd’
(
$’Œy
)) {

49 
$this
->
	`hªdË
(
$‹¡
, 
$·th
 . 
DIRECTORY_SEPARATOR
 . 
$’Œy
);

51 
	`şo£dœ
(
$hªdË
);

53 
	}
}

68 
´Ùeùed
 
funùiÚ
 
	$hªdË
(&
$‹¡
, 
$fe
) {

69 ià(
	`is_dœ
(
$fe
)) {

72 
$‹¡
->
	`addFe
(
$fe
);

73 
	}
}

82 
´Ùeùed
 
funùiÚ
 
	$isHidd’
(
$f’ame
) {

83  
	`¡ºcmp
(
$f’ame
, '.', 1) == 0;

84 
	}
}

95 şas 
	cSim¶eP©‹ºCŞËùÜ
 
ex‹nds
 
	mSim¶eCŞËùÜ
 {

96 
´iv©e
 
	m$·‰”n
;

104 
funùiÚ
 
__cÚ¡ruù
(
$·‰”n
 = '/php$/i') {

105 
$this
->
·‰”n
 = 
$·‰”n
;

116 
´Ùeùed
 
funùiÚ
 
	$hªdË
(&
$‹¡
, 
$f’ame
) {

117 ià(
	`´eg_m©ch
(
$this
->
·‰”n
, 
$f’ame
)) {

118 
·»Á
::
	`hªdË
(
$‹¡
, 
$f’ame
);

120 
	}
}

	@F:\Site\stew\1\_lp\simpletest\compatibility.php

1 <?
php


13 şas 
	cSim¶eTe¡Com·tib™y
 {

21 
funùiÚ
 
	$cİy
(
$objeù
) {

22 ià(
	`v”siÚ_com·»
(
	`phpv”siÚ
(), '5') >= 0) {

23 
	`ev®
('$copy = clone $object;');

24  
$cİy
;

26  
$objeù
;

38 
funùiÚ
 
	$isId’tiÿl
(
$fœ¡
, 
$£cÚd
) {

39 ià(
	`v”siÚ_com·»
(
	`phpv”siÚ
(), '5') >= 0) {

40  
Sim¶eTe¡Com·tib™y
::
	`isId’tiÿlTy³
(
$fœ¡
, 
$£cÚd
);

42 ià(
$fœ¡
 !ğ
$£cÚd
) {

43  
çl£
;

45  (
$fœ¡
 ==ğ
$£cÚd
);

46 
	}
}

55 
´Ùeùed
 
funùiÚ
 
	$isId’tiÿlTy³
(
$fœ¡
, 
$£cÚd
) {

56 ià(
	`g‘ty³
(
$fœ¡
è!ğg‘ty³(
$£cÚd
)) {

57  
çl£
;

59 ià(
	`is_objeù
(
$fœ¡
è&& is_objeù(
$£cÚd
)) {

60 ià(
	`g‘_şass
(
$fœ¡
è!ğg‘_şass(
$£cÚd
)) {

61  
çl£
;

63  
Sim¶eTe¡Com·tib™y
::
	`isA¼ayOfId’tiÿlTy³s
(

64 (
¬¿y
è
$fœ¡
,

65 (
¬¿y
è
$£cÚd
);

67 ià(
	`is_¬¿y
(
$fœ¡
è&& is_¬¿y(
$£cÚd
)) {

68  
Sim¶eTe¡Com·tib™y
::
	`isA¼ayOfId’tiÿlTy³s
(
$fœ¡
, 
$£cÚd
);

70 ià(
$fœ¡
 !=ğ
$£cÚd
) {

71  
çl£
;

73  
Œue
;

74 
	}
}

83 
´Ùeùed
 
funùiÚ
 
	$isA¼ayOfId’tiÿlTy³s
(
$fœ¡
, 
$£cÚd
) {

84 ià(
	`¬¿y_keys
(
$fœ¡
è!ğ¬¿y_keys(
$£cÚd
)) {

85  
çl£
;

87 
	`fÜ—ch
 (
	`¬¿y_keys
(
$fœ¡
è
as
 
$key
) {

88 
$is_id’tiÿl
 = 
Sim¶eTe¡Com·tib™y
::
	`isId’tiÿlTy³
(

89 
$fœ¡
[
$key
],

90 
$£cÚd
[
$key
]);

91 ià(! 
$is_id’tiÿl
) {

92  
çl£
;

95  
Œue
;

96 
	}
}

105 
funùiÚ
 
	$isReã»nû
(&
$fœ¡
, &
$£cÚd
) {

106 ià(
	`v”siÚ_com·»
(
	`phpv”siÚ
(), '5', '>='è&& 
	`is_objeù
(
$fœ¡
)) {

107  (
$fœ¡
 ==ğ
$£cÚd
);

109 ià(
	`is_objeù
(
$fœ¡
è&& is_objeù(
$£cÚd
)) {

110 
$id
 = 
	`uniqid
("test");

111 
$fœ¡
->
$id
 = 
Œue
;

112 
$is_»f
 = 
	`is£t
(
$£cÚd
->
$id
);

113 
	`un£t
(
$fœ¡
->
$id
);

114  
$is_»f
;

116 
$‹mp
 = 
$fœ¡
;

117 
$fœ¡
 = 
	`uniqid
("test");

118 
$is_»f
 = (
$fœ¡
 ==ğ
$£cÚd
);

119 
$fœ¡
 = 
$‹mp
;

120  
$is_»f
;

121 
	}
}

131 
funùiÚ
 
	$isA
(
$objeù
, 
$şass
) {

132 ià(
	`v”siÚ_com·»
(
	`phpv”siÚ
(), '5') >= 0) {

133 ià(! 
	`şass_exi¡s
(
$şass
, 
çl£
)) {

134 ià(
	`funùiÚ_exi¡s
('interface_exists')) {

135 ià(! 
	`š‹rçû_exi¡s
(
$şass
, 
çl£
)) {

136  
çl£
;

140 
	`ev®
("\$is_a = \$object instanceof $class;");

141  
$is_a
;

143 ià(
	`funùiÚ_exi¡s
('is_a')) {

144  
	`is_a
(
$objeù
, 
$şass
);

146  ((
	`¡¹Şow”
(
$şass
è=ğ
	`g‘_şass
(
$objeù
))

147 
	`Ü
 (
	`is_subşass_of
(
$objeù
, 
$şass
)));

148 
	}
}

156 
funùiÚ
 
	$£tTimeout
(
$hªdË
, 
$timeout
) {

157 ià(
	`funùiÚ_exi¡s
('stream_set_timeout')) {

158 
	`¡»am_£t_timeout
(
$hªdË
, 
$timeout
, 0);

159 } 
	`–£if
 (
	`funùiÚ_exi¡s
('socket_set_timeout')) {

160 
	`sock‘_£t_timeout
(
$hªdË
, 
$timeout
, 0);

161 } 
	`–£if
 (
	`funùiÚ_exi¡s
('set_socket_timeout')) {

162 
	`£t_sock‘_timeout
(
$hªdË
, 
$timeout
, 0);

164 
	}
}

	@F:\Site\stew\1\_lp\simpletest\cookies.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/url.php');

23 şas 
	cSim¶eCook›
 {

24 
´iv©e
 
	m$ho¡
;

25 
´iv©e
 
	m$Çme
;

26 
´iv©e
 
	m$v®ue
;

27 
´iv©e
 
	m$·th
;

28 
´iv©e
 
	m$expœy
;

29 
´iv©e
 
	m$is_£cu»
;

39 
funùiÚ
 
	$__cÚ¡ruù
(
$Çme
, 
$v®ue
 = 
çl£
, 
$·th
 = f®£, 
$expœy
 = f®£, 
$is_£cu»
 = false) {

40 
$this
->
ho¡
 = 
çl£
;

41 
$this
->
Çme
 = 
$Çme
;

42 
$this
->
v®ue
 = 
$v®ue
;

43 
$this
->
·th
 = (
$·th
 ? $this->
	`fixP©h
($path) : "/");

44 
$this
->
expœy
 = 
çl£
;

45 ià(
	`is_¡ršg
(
$expœy
)) {

46 
$this
->
expœy
 = 
	`¡¹Ùime
(
$expœy
);

47 } 
	`–£if
 (
	`is_š‹g”
(
$expœy
)) {

48 
$this
->
expœy
 = 
$expœy
;

50 
$this
->
is_£cu»
 = 
$is_£cu»
;

63 
funùiÚ
 
	$£tHo¡
(
$ho¡
) {

64 ià(
$ho¡
 = 
$this
->
	`Œunÿ‹Ho¡
($host)) {

65 
$this
->
ho¡
 = 
$ho¡
;

66  
Œue
;

68  
çl£
;

69 
	}
}

77 
funùiÚ
 
	$g‘Ho¡
() {

78  
$this
->
ho¡
;

79 
	}
}

87 
funùiÚ
 
	$isV®idHo¡
(
$ho¡
) {

88  (
$this
->
	`Œunÿ‹Ho¡
(
$ho¡
è==ğ$this->
	`g‘Ho¡
());

89 
	}
}

98 
´Ùeùed
 
funùiÚ
 
	$Œunÿ‹Ho¡
(
$ho¡
) {

99 
$ds
 = 
Sim¶eU¾
::
	`g‘AÎTİLev–Domašs
();

100 ià(
	`´eg_m©ch
('/[a-z\-]+\.(' . 
$ds
 . ')$/i', 
$ho¡
, 
$m©ches
)) {

101  
$m©ches
[0];

102 } 
	`–£if
 (
	`´eg_m©ch
('/[a-z\-]+\.[a-z\-]+\.[a-z\-]+$/i', 
$ho¡
, 
$m©ches
)) {

103  
$m©ches
[0];

105  
çl£
;

106 
	}
}

113 
funùiÚ
 
	$g‘Name
() {

114  
$this
->
Çme
;

115 
	}
}

123 
funùiÚ
 
	$g‘V®ue
() {

124  
$this
->
v®ue
;

125 
	}
}

132 
funùiÚ
 
	$g‘P©h
() {

133  
$this
->
·th
;

134 
	}
}

144 
funùiÚ
 
	$isV®idP©h
(
$·th
) {

145  (
	`¡ºcmp
(

146 
$this
->
	`fixP©h
(
$·th
),

147 
$this
->
	`g‘P©h
(),

148 
	`¡¾’
(
$this
->
	`g‘P©h
())) == 0);

149 
	}
}

156 
funùiÚ
 
	$g‘Expœy
() {

157 ià(! 
$this
->
expœy
) {

158  
çl£
;

160  
	`gmd©e
("D, d M Y H:i:s", 
$this
->
expœy
) . " GMT";

161 
	}
}

174 
funùiÚ
 
	$isExpœed
(
$now
) {

175 ià(! 
$this
->
expœy
) {

176  
Œue
;

178 ià(
	`is_¡ršg
(
$now
)) {

179 
$now
 = 
	`¡¹Ùime
($now);

181  (
$this
->
expœy
 < 
$now
);

182 
	}
}

190 
funùiÚ
 
	$ageP»m©u»ly
(
$š‹rv®
) {

191 ià(
$this
->
expœy
) {

192 
$this
->
expœy
 -ğ
$š‹rv®
;

194 
	}
}

201 
funùiÚ
 
	$isSecu»
() {

202  
$this
->
is_£cu»
;

203 
	}
}

211 
´Ùeùed
 
funùiÚ
 
	$fixP©h
(
$·th
) {

212 ià(
	`sub¡r
(
$·th
, 0, 1) != '/') {

213 
$·th
 = '/' . $path;

215 ià(
	`sub¡r
(
$·th
, -1, 1) != '/') {

216 
$·th
 .= '/';

218  
$·th
;

219 
	}
}

228 şas 
	cSim¶eCook›J¬
 {

229 
´iv©e
 
	m$cook›s
;

235 
funùiÚ
 
	$__cÚ¡ruù
() {

236 
$this
->
cook›s
 = 
	`¬¿y
();

245 
funùiÚ
 
	$»¡¬tSessiÚ
(
$d©e
 = 
çl£
) {

246 
$survivšg_cook›s
 = 
	`¬¿y
();

247 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
cook›s
); $i++) {

248 ià(! 
$this
->
cook›s
[
$i
]->
	`g‘V®ue
()) {

251 ià(! 
$this
->
cook›s
[
$i
]->
	`g‘Expœy
()) {

254 ià(
$d©e
 && 
$this
->
cook›s
[
$i
]->
	`isExpœed
($date)) {

257 
$survivšg_cook›s
[] = 
$this
->
cook›s
[
$i
];

259 
$this
->
cook›s
 = 
$survivšg_cook›s
;

260 
	}
}

270 
funùiÚ
 
	$ageP»m©u»ly
(
$š‹rv®
) {

271 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
cook›s
); $i++) {

272 
$this
->
cook›s
[
$i
]->
	`ageP»m©u»ly
(
$š‹rv®
);

274 
	}
}

286 
funùiÚ
 
£tCook›
(
$Çme
, 
$v®ue
, 
$ho¡
 = 
çl£
, 
$·th
 = '/', 
$expœy
 = false) {

287 
$cook›
 = 
Ãw
 
Sim¶eCook›
(
$Çme
, 
$v®ue
, 
$·th
, 
$expœy
);

288 ià(
	g$ho¡
) {

289 
	g$cook›
->
£tHo¡
(
$ho¡
);

291 
	g$this
->
	gcook›s
[
$this
->
fšdFœ¡M©ch
(
$cook›
)] = $cookie;

301 
´Ùeùed
 
funùiÚ
 
	$fšdFœ¡M©ch
(
$cook›
) {

302 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
cook›s
); $i++) {

303 
$is_m©ch
 = 
$this
->
	`isM©ch
(

304 
$cook›
,

305 
$this
->
cook›s
[
$i
]->
	`g‘Ho¡
(),

306 
$this
->
cook›s
[
$i
]->
	`g‘P©h
(),

307 
$this
->
cook›s
[
$i
]->
	`g‘Name
());

308 ià(
$is_m©ch
) {

309  
$i
;

312  
	`couÁ
(
$this
->
cook›s
);

313 
	}
}

326 
funùiÚ
 
	$g‘Cook›V®ue
(
$ho¡
, 
$·th
, 
$Çme
) {

327 
$lÚge¡_·th
 = '';

328 
	`fÜ—ch
 (
$this
->
cook›s
 
as
 
$cook›
) {

329 ià(
$this
->
	`isM©ch
(
$cook›
, 
$ho¡
, 
$·th
, 
$Çme
)) {

330 ià(
	`¡¾’
(
$cook›
->
	`g‘P©h
()è> sŒËn(
$lÚge¡_·th
)) {

331 
$v®ue
 = 
$cook›
->
	`g‘V®ue
();

332 
$lÚge¡_·th
 = 
$cook›
->
	`g‘P©h
();

336  (
	`is£t
(
$v®ue
è? $v®u: 
çl£
);

337 
	}
}

350 
´Ùeùed
 
funùiÚ
 
	$isM©ch
(
$cook›
, 
$ho¡
, 
$·th
, 
$Çme
) {

351 ià(
$cook›
->
	`g‘Name
(è!ğ
$Çme
) {

352  
çl£
;

354 ià(
$ho¡
 && 
$cook›
->
	`g‘Ho¡
(è&& ! $cook›->
	`isV®idHo¡
($host)) {

355  
çl£
;

357 ià(! 
$cook›
->
	`isV®idP©h
(
$·th
)) {

358  
çl£
;

360  
Œue
;

361 
	}
}

370 
funùiÚ
 
	$£ËùAsPaœs
(
$u¾
) {

371 
$·œs
 = 
	`¬¿y
();

372 
	`fÜ—ch
 (
$this
->
cook›s
 
as
 
$cook›
) {

373 ià(
$this
->
	`isM©ch
(
$cook›
, 
$u¾
->
	`g‘Ho¡
(), $u¾->
	`g‘P©h
(), $cook›->
	`g‘Name
())) {

374 
$·œs
[] = 
$cook›
->
	`g‘Name
(è. '=' . $cook›->
	`g‘V®ue
();

377  
$·œs
;

378 
	}
}

	@F:\Site\stew\1\_lp\simpletest\default_reporter.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/simpletest.php');

13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/scorer.php');

14 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/reporter.php');

15 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/xml.php');

25 şas 
	cSim¶eCommªdLšeP¬£r
 {

26 
´iv©e
 
	m$to_´İ”ty
 = 
¬¿y
(

30 
´iv©e
 
	m$ÿ£
 = '';

31 
´iv©e
 
	m$‹¡
 = '';

32 
´iv©e
 
	m$xml
 = 
çl£
;

33 
´iv©e
 
	m$h–p
 = 
çl£
;

34 
´iv©e
 
	m$no_sks
 = 
çl£
;

40 
funùiÚ
 
	$__cÚ¡ruù
(
$¬gum’ts
) {

41 ià(! 
	`is_¬¿y
(
$¬gum’ts
)) {

44 
	`fÜ—ch
 (
$¬gum’ts
 
as
 
$i
 => 
$¬gum’t
) {

45 ià(
	`´eg_m©ch
('/^--?Ñe¡|ÿ£|t|c)=(.+)$/', 
$¬gum’t
, 
$m©ches
)) {

46 
$´İ”ty
 = 
$this
->
to_´İ”ty
[
$m©ches
[1]];

47 
$this
->
$´İ”ty
 = 
$m©ches
[2];

48 } 
	`–£if
 (
	`´eg_m©ch
('/^--?Ñe¡|ÿ£|t|c)$/', 
$¬gum’t
, 
$m©ches
)) {

49 
$´İ”ty
 = 
$this
->
to_´İ”ty
[
$m©ches
[1]];

50 ià(
	`is£t
(
$¬gum’ts
[
$i
 + 1])) {

51 
$this
->
$´İ”ty
 = 
$¬gum’ts
[
$i
 + 1];

53 } 
	`–£if
 (
	`´eg_m©ch
('/^--?(xml|x)$/', 
$¬gum’t
)) {

54 
$this
->
xml
 = 
Œue
;

55 } 
	`–£if
 (
	`´eg_m©ch
('/^--?Òo-sk|no-sks|s)$/', 
$¬gum’t
)) {

56 
$this
->
no_sks
 = 
Œue
;

57 } 
	`–£if
 (
	`´eg_m©ch
('/^--?(h–p|h)$/', 
$¬gum’t
)) {

58 
$this
->
h–p
 = 
Œue
;

67 
funùiÚ
 
	$g‘Te¡
() {

68  
$this
->
‹¡
;

69 
	}
}

75 
funùiÚ
 
	$g‘Te¡Ca£
() {

76  
$this
->;

77 
	}
}

83 
funùiÚ
 
	$isXml
() {

84  
$this
->
xml
;

85 
	}
}

91 
funùiÚ
 
	$noSks
() {

92  
$this
->
no_sks
;

93 
	}
}

99 
funùiÚ
 
	$h–p
() {

100  
$this
->
h–p
 && ! $this->
xml
;

101 
	}
}

107 
funùiÚ
 
	$g‘H–pText
() {

108  <<<
HELP


109 
Sim¶eTe¡
 
commªd
 
lše
  
	`»pÜ‹r
 (
autÜun
)

110 
U§ge
: 
php
 <
‹¡_fe
> [
¬gs
...]

112 -
c
 <
şass
> 
Run
 
Úly
 
the
 
‹¡
-<class>

113 -
t
 <
m‘hod
> 
Run
 
Úly
 
the
 
‹¡
 method <method>

114 -
s
 
Suµ»ss
 
sk
 
mes§ges


115 -
x
 
R‘uº
 
‹¡
 
»suÉs
 
š
 
XML


116 -
h
 
Di¥Ïy
 
this
 
h–p
 
mes§ge


118 
HELP
;

119 
	}
}

130 şas 
	cDeçuÉR•Ü‹r
 
ex‹nds
 
	mSim¶eR•Ü‹rDecÜ©Ü
 {

135 
funùiÚ
 
	$__cÚ¡ruù
() {

136 ià(
Sim¶eR•Ü‹r
::
	`šCli
()) {

137 
$·r£r
 = 
Ãw
 
	`Sim¶eCommªdLšeP¬£r
(
$_SERVER
['argv']);

138 
$š‹rçûs
 = 
$·r£r
->
	`isXml
(è? 
	`¬¿y
('XmlReporter') :‡rray('TextReporter');

139 ià(
$·r£r
->
	`h–p
()) {

141 
echo
 
$·r£r
->
	`g‘H–pText
();

142 
	`ex™
(1);

144 
$»pÜ‹r
 = 
Ãw
 
	`S–eùiveR•Ü‹r
(

145 
Sim¶eTe¡
::
	`´eã¼ed
(
$š‹rçûs
),

146 
$·r£r
->
	`g‘Te¡Ca£
(),

147 
$·r£r
->
	`g‘Te¡
());

148 ià(
$·r£r
->
	`noSks
()) {

149 
$»pÜ‹r
 = 
Ãw
 
	`NoSksR•Ü‹r
($reporter);

152 
$»pÜ‹r
 = 
Ãw
 
	`S–eùiveR•Ü‹r
(

153 
Sim¶eTe¡
::
	`´eã¼ed
('HtmlReporter'),

154 @
$_GET
['c'],

155 @
$_GET
['t']);

156 ià(@
$_GET
['skips'] == 'no' || @$_GET['show-skips'] == 'no') {

157 
$»pÜ‹r
 = 
Ãw
 
	`NoSksR•Ü‹r
($reporter);

160 
·»Á
::
	`__cÚ¡ruù
(
$»pÜ‹r
);

162 
	}
}

	@F:\Site\stew\1\_lp\simpletest\detached.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/xml.php');

13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/shell_tester.php');

21 şas 
	cD‘achedTe¡Ca£
 {

22 
´iv©e
 
	m$commªd
;

23 
´iv©e
 
	m$dry_commªd
;

24 
´iv©e
 
	m$size
;

32 
funùiÚ
 
	$__cÚ¡ruù
(
$commªd
, 
$dry_commªd
 = 
çl£
) {

33 
$this
->
commªd
 = 
$commªd
;

34 
$this
->
dry_commªd
 = 
$dry_commªd
 ? $dry_commªd : 
$commªd
;

35 
$this
->
size
 = 
çl£
;

43 
funùiÚ
 
	$g‘Lab–
() {

44  
$this
->
commªd
;

45 
	}
}

55 
funùiÚ
 
	$run
(&
$»pÜ‹r
) {

56 
$sh–l
 = &
Ãw
 
	`Sim¶eSh–l
();

57 
$sh–l
->
	`execu‹
(
$this
->
commªd
);

58 
$·r£r
 = &
$this
->
	`ü—‹P¬£r
(
$»pÜ‹r
);

59 ià(! 
$·r£r
->
	`·r£
(
$sh–l
->
	`g‘Ouut
())) {

60 
	`Œigg”_”rÜ
('CªnÙ…¬£ incomšg XML from [' . 
$this
->
commªd
 . ']');

61  
çl£
;

63  
Œue
;

64 
	}
}

71 
funùiÚ
 
	$g‘Size
() {

72 ià(
$this
->
size
 ==ğ
çl£
) {

73 
$sh–l
 = &
Ãw
 
	`Sim¶eSh–l
();

74 
$sh–l
->
	`execu‹
(
$this
->
dry_commªd
);

75 
$»pÜ‹r
 = &
Ãw
 
	`Sim¶eR•Ü‹r
();

76 
$·r£r
 = &
$this
->
	`ü—‹P¬£r
(
$»pÜ‹r
);

77 ià(! 
$·r£r
->
	`·r£
(
$sh–l
->
	`g‘Ouut
())) {

78 
	`Œigg”_”rÜ
('CªnÙ…¬£ incomšg XML from [' . 
$this
->
dry_commªd
 . ']');

79  
çl£
;

81 
$this
->
size
 = 
$»pÜ‹r
->
	`g‘Te¡Ca£CouÁ
();

83  
$this
->
size
;

84 
	}
}

92 
´Ùeùed
 
	gfunùiÚ
 &
	$ü—‹P¬£r
(&
$»pÜ‹r
) {

93  
Ãw
 
	`Sim¶eTe¡XmlP¬£r
(
$»pÜ‹r
);

94 
	}
}

	@F:\Site\stew\1\_lp\simpletest\dumper.php

1 <?
php


11 ià(! 
defšed
('TYPE_MATTERS')) {

12 
defše
('TYPE_MATTERS', 
Œue
);

20 şas 
	cSim¶eDum³r
 {

28 
funùiÚ
 
	$desüibeV®ue
(
$v®ue
) {

29 
$ty³
 = 
$this
->
	`g‘Ty³
(
$v®ue
);

30 
$ty³
) {

34  "BoŞ—n: " . (
$v®ue
 ? "true" : "false");

36  "A¼ay: " . 
	`couÁ
(
$v®ue
) . " items";

38  "Objeù: oà" . 
	`g‘_şass
(
$v®ue
);

40  "SŒšg: " . 
$this
->
	`şSŒšg
(
$v®ue
, 200);

53 
funùiÚ
 
	$g‘Ty³
(
$v®ue
) {

54 ià(! 
	`is£t
(
$v®ue
)) {

56 } 
	`–£if
 (
	`is_boŞ
(
$v®ue
)) {

58 } 
	`–£if
 (
	`is_¡ršg
(
$v®ue
)) {

60 } 
	`–£if
 (
	`is_š‹g”
(
$v®ue
)) {

62 } 
	`–£if
 (
	`is_æßt
(
$v®ue
)) {

64 } 
	`–£if
 (
	`is_¬¿y
(
$v®ue
)) {

66 } 
	`–£if
 (
	`is_»sourû
(
$v®ue
)) {

68 } 
	`–£if
 (
	`is_objeù
(
$v®ue
)) {

72 
	}
}

84 
funùiÚ
 
	$desüibeDifã»nû
(
$fœ¡
, 
$£cÚd
, 
$id’tiÿl
 = 
çl£
) {

85 ià(
$id’tiÿl
) {

86 ià(! 
$this
->
	`isTy³M©ch
(
$fœ¡
, 
$£cÚd
)) {

87  "w™hy³ mism©ch‡ [" . 
$this
->
	`desüibeV®ue
(
$fœ¡
) .

88 "] dÛ nÙ m©ch [" . 
$this
->
	`desüibeV®ue
(
$£cÚd
) . "]";

91 
$ty³
 = 
$this
->
	`g‘Ty³
(
$fœ¡
);

92 ià(
$ty³
 == "Unknown") {

95 
$m‘hod
 = 'desüibe' . 
$ty³
 . 'Difference';

96  
$this
->
	`$m‘hod
(
$fœ¡
, 
$£cÚd
, 
$id’tiÿl
);

97 
	}
}

106 
´Ùeùed
 
funùiÚ
 
	$isTy³M©ch
(
$fœ¡
, 
$£cÚd
) {

107  (
$this
->
	`g‘Ty³
(
$fœ¡
è=ğ$this->g‘Ty³(
$£cÚd
));

108 
	}
}

118 
funùiÚ
 
	$şSŒšg
(
$v®ue
, 
$size
, 
$pos™iÚ
 = 0) {

119 
$Ëngth
 = 
	`¡¾’
(
$v®ue
);

120 ià(
$Ëngth
 <ğ
$size
) {

121  
$v®ue
;

123 
$pos™iÚ
 = 
	`mš
($pos™iÚ, 
$Ëngth
);

124 
$¡¬t
 = (
$size
/2 > 
$pos™iÚ
 ? 0 : $position - $size/2);

125 ià(
$¡¬t
 + 
$size
 > 
$Ëngth
) {

126 
$¡¬t
 = 
$Ëngth
 - 
$size
;

128 
$v®ue
 = 
	`sub¡r
($v®ue, 
$¡¬t
, 
$size
);

129  (
$¡¬t
 > 0 ? "..." : ""è. 
$v®ue
 . ($¡¬ˆ+ 
$size
 < 
$Ëngth
 ? "..." : "");

130 
	}
}

141 
´Ùeùed
 
funùiÚ
 
	$desüibeG’”icDifã»nû
(
$fœ¡
, 
$£cÚd
) {

142  "a [" . 
$this
->
	`desüibeV®ue
(
$fœ¡
) .

144 
$this
->
	`desüibeV®ue
(
$£cÚd
) . "]";

145 
	}
}

156 
´Ùeùed
 
funùiÚ
 
	$desüibeNuÎDifã»nû
(
$fœ¡
, 
$£cÚd
, 
$id’tiÿl
) {

157  
$this
->
	`desüibeG’”icDifã»nû
(
$fœ¡
, 
$£cÚd
);

158 
	}
}

169 
´Ùeùed
 
funùiÚ
 
	$desüibeBoŞ—nDifã»nû
(
$fœ¡
, 
$£cÚd
, 
$id’tiÿl
) {

170  
$this
->
	`desüibeG’”icDifã»nû
(
$fœ¡
, 
$£cÚd
);

171 
	}
}

182 
´Ùeùed
 
funùiÚ
 
	$desüibeSŒšgDifã»nû
(
$fœ¡
, 
$£cÚd
, 
$id’tiÿl
) {

183 ià(
	`is_objeù
(
$£cÚd
è|| 
	`is_¬¿y
($second)) {

184  
$this
->
	`desüibeG’”icDifã»nû
(
$fœ¡
, 
$£cÚd
);

186 
$pos™iÚ
 = 
$this
->
	`¡ršgDifãrsAt
(
$fœ¡
, 
$£cÚd
);

187 
$mes§ge
 = "at character $position";

188 
$mes§ge
 .= " with [" .

189 
$this
->
	`şSŒšg
(
$fœ¡
, 200, 
$pos™iÚ
) . "]‡nd [" .

190 
$this
->
	`şSŒšg
(
$£cÚd
, 200, 
$pos™iÚ
) . "]";

191  
$mes§ge
;

192 
	}
}

203 
´Ùeùed
 
funùiÚ
 
	$desüibeIÁeg”Difã»nû
(
$fœ¡
, 
$£cÚd
, 
$id’tiÿl
) {

204 ià(
	`is_objeù
(
$£cÚd
è|| 
	`is_¬¿y
($second)) {

205  
$this
->
	`desüibeG’”icDifã»nû
(
$fœ¡
, 
$£cÚd
);

207  "beÿu£ [" . 
$this
->
	`desüibeV®ue
(
$fœ¡
) .

209 
$this
->
	`desüibeV®ue
(
$£cÚd
) . "] by " .

210 
	`abs
(
$fœ¡
 - 
$£cÚd
);

211 
	}
}

222 
´Ùeùed
 
funùiÚ
 
	$desüibeFlßtDifã»nû
(
$fœ¡
, 
$£cÚd
, 
$id’tiÿl
) {

223 ià(
	`is_objeù
(
$£cÚd
è|| 
	`is_¬¿y
($second)) {

224  
$this
->
	`desüibeG’”icDifã»nû
(
$fœ¡
, 
$£cÚd
);

226  "beÿu£ [" . 
$this
->
	`desüibeV®ue
(
$fœ¡
) .

228 
$this
->
	`desüibeV®ue
(
$£cÚd
) . "] by " .

229 
	`abs
(
$fœ¡
 - 
$£cÚd
);

230 
	}
}

241 
´Ùeùed
 
funùiÚ
 
	$desüibeA¼ayDifã»nû
(
$fœ¡
, 
$£cÚd
, 
$id’tiÿl
) {

242 ià(! 
	`is_¬¿y
(
$£cÚd
)) {

243  
$this
->
	`desüibeG’”icDifã»nû
(
$fœ¡
, 
$£cÚd
);

245 ià(! 
$this
->
	`isM©chšgKeys
(
$fœ¡
, 
$£cÚd
, 
$id’tiÿl
)) {

247 
	`im¶ode
(", ", 
	`¬¿y_keys
(
$fœ¡
)) . "] does‚ot match key†ist [" .

248 
	`im¶ode
(", ", 
	`¬¿y_keys
(
$£cÚd
)) . "]";

250 
	`fÜ—ch
 (
	`¬¿y_keys
(
$fœ¡
è
as
 
$key
) {

251 ià(
$id’tiÿl
 && (
$fœ¡
[
$key
] ==ğ
$£cÚd
[$key])) {

254 ià(! 
$id’tiÿl
 && (
$fœ¡
[
$key
] =ğ
$£cÚd
[$key])) {

257  "w™h memb” [$key] " . 
$this
->
	`desüibeDifã»nû
(

258 
$fœ¡
[
$key
],

259 
$£cÚd
[
$key
],

260 
$id’tiÿl
);

263 
	}
}

275 
´Ùeùed
 
funùiÚ
 
	$isM©chšgKeys
(
$fœ¡
, 
$£cÚd
, 
$id’tiÿl
) {

276 
$fœ¡_keys
 = 
	`¬¿y_keys
(
$fœ¡
);

277 
$£cÚd_keys
 = 
	`¬¿y_keys
(
$£cÚd
);

278 ià(
$id’tiÿl
) {

279  (
$fœ¡_keys
 ==ğ
$£cÚd_keys
);

281 
	`sÜt
(
$fœ¡_keys
);

282 
	`sÜt
(
$£cÚd_keys
);

283  (
$fœ¡_keys
 =ğ
$£cÚd_keys
);

284 
	}
}

295 
´Ùeùed
 
funùiÚ
 
	$desüibeResourûDifã»nû
(
$fœ¡
, 
$£cÚd
, 
$id’tiÿl
) {

296  
$this
->
	`desüibeG’”icDifã»nû
(
$fœ¡
, 
$£cÚd
);

297 
	}
}

307 
´Ùeùed
 
funùiÚ
 
	$desüibeObjeùDifã»nû
(
$fœ¡
, 
$£cÚd
, 
$id’tiÿl
) {

308 ià(! 
	`is_objeù
(
$£cÚd
)) {

309  
$this
->
	`desüibeG’”icDifã»nû
(
$fœ¡
, 
$£cÚd
);

311  
$this
->
	`desüibeA¼ayDifã»nû
(

312 
$this
->
	`g‘Memb”s
(
$fœ¡
),

313 
$this
->
	`g‘Memb”s
(
$£cÚd
),

314 
$id’tiÿl
);

315 
	}
}

324 
´Ùeùed
 
funùiÚ
 
	$g‘Memb”s
(
$objeù
) {

325 
$»æeùiÚ
 = 
Ãw
 
	`ReæeùiÚObjeù
(
$objeù
);

326 
$memb”s
 = 
	`¬¿y
();

327 
	`fÜ—ch
 (
$»æeùiÚ
->
	`g‘Prİ”t›s
(è
as
 
$´İ”ty
) {

328 ià(
	`m‘hod_exi¡s
(
$´İ”ty
, 'setAccessible')) {

329 
$´İ”ty
->
	`£tAcûssibË
(
Œue
);

331 
Œy
 {

332 
$memb”s
[
$´İ”ty
->
	`g‘Name
()] = $´İ”ty->
	`g‘V®ue
(
$objeù
);

333 } 
	`ÿtch
 (
ReæeùiÚExû±iÚ
 
$e
) {

334 
$memb”s
[
$´İ”ty
->
	`g‘Name
()] =

335 
$this
->
	`g‘Priv©ePrİ”tyNoM©‹rWh©
(
$´İ”ty
->
	`g‘Name
(), 
$objeù
);

338  
$memb”s
;

339 
	}
}

347 
´iv©e
 
funùiÚ
 
	$g‘Priv©ePrİ”tyNoM©‹rWh©
(
$Çme
, 
$objeù
) {

348 
	`fÜ—ch
 ((
¬¿y
)
$objeù
 
as
 
$mªgËd_Çme
 => 
$v®ue
) {

349 ià(
$this
->
	`unmªgË
(
$mªgËd_Çme
è=ğ
$Çme
) {

350  
$v®ue
;

353 
	}
}

361 
funùiÚ
 
	$unmªgË
(
$mªgËd
) {

362 
$·¹s
 = 
	`´eg_¥l™
('/[^a-zA-Z0-9_\x7f-\xff]+/', 
$mªgËd
);

363  
	`¬¿y_pİ
(
$·¹s
);

364 
	}
}

375 
´Ùeùed
 
funùiÚ
 
	$¡ršgDifãrsAt
(
$fœ¡
, 
$£cÚd
) {

376 ià(! 
$fœ¡
 || ! 
$£cÚd
) {

379 ià(
	`¡¾’
(
$fœ¡
è< sŒËn(
$£cÚd
)) {

380 
	`li¡
(
$fœ¡
, 
$£cÚd
èğ
	`¬¿y
($second, $first);

382 
$pos™iÚ
 = 0;

383 
$¡•
 = 
	`¡¾’
(
$fœ¡
);

384 
$¡•
 > 1) {

385 
$¡•
 = (
š‹g”
)(($step + 1) / 2);

386 ià(
	`¡ºcmp
(
$fœ¡
, 
$£cÚd
, 
$pos™iÚ
 + 
$¡•
) == 0) {

387 
$pos™iÚ
 +ğ
$¡•
;

390  
$pos™iÚ
;

391 
	}
}

399 
funùiÚ
 
	$dump
(
$v¬ŸbË
) {

400 
	`ob_¡¬t
();

401 
	`´št_r
(
$v¬ŸbË
);

402 
$fÜm©‹d
 = 
	`ob_g‘_cÚ‹Ás
();

403 
	`ob_’d_ş—n
();

404  
$fÜm©‹d
;

405 
	}
}

	@F:\Site\stew\1\_lp\simpletest\eclipse.php

1 <?
php


11 
	gšşude_Úû
 'unit_tester.php';

12 
	gšşude_Úû
 'test_case.php';

13 
	gšşude_Úû
 'invoker.php';

14 
	gšşude_Úû
 'socket.php';

15 
	gšşude_Úû
 'mock_objects.php';

23 şas 
	cEş£R•Ü‹r
 
ex‹nds
 
	mSim¶eScÜ”
 {

30 
funùiÚ
 
	$__cÚ¡ruù
(&
$li¡’”
, 
$cc
=
çl£
){

31 
$this
->
li¡’”
 = &
$li¡’”
;

32 
$this
->
	`Sim¶eScÜ”
();

33 
$this
->= "";

34 
$this
->
group
 = "";

35 
$this
->
m‘hod
 = "";

36 
$this
->
cc
 = 
$cc
;

37 
$this
->
”rÜ
 = 
çl£
;

38 
$this
->
ç
 = 
çl£
;

45 
funùiÚ
 
	$g‘Dum³r
() {

46  
Ãw
 
	`Sim¶eDum³r
();

47 
	}
}

55 
	gfunùiÚ
 &
ü—‹Li¡’”
(
$pÜt
, 
$ho¡
="127.0.0.1"){

56 
$tm¶i¡’”
 = &
Ãw
 
Sim¶eSock‘
(
$ho¡
, 
$pÜt
, 5);

57  
	g$tm¶i¡’”
;

66 
	gfunùiÚ
 &
	$ü—‹Invok”
(&
$švok”
){

67 
$eşšvok”
 = &
Ãw
 
	`Eş£Invok”
(
$švok”
, 
$this
->
li¡’”
);

68  
$eşšvok”
;

69 
	}
}

76 
funùiÚ
 
	$esÿ³V®
(
$¿w
){

77 
$ÃedË
 = 
	`¬¿y
("\\","\"","/","\b","\f","\n","\r","\t");

78 
$»¶aû
 = 
	`¬¿y
('\\\\','\"','\/','\b','\f','\n','\r','\t');

79  
	`¡r_»¶aû
(
$ÃedË
, 
$»¶aû
, 
$¿w
);

80 
	}
}

88 
funùiÚ
 
	$·štPass
(
$mes§ge
){

89 ià(! 
$this
->
·ss
){

90 
$this
->
mes§ge
 = $this->
	`esÿ³V®
(
$mes§ge
);

92 
$this
->
·ss
 = 
Œue
;

93 
	}
}

101 
funùiÚ
 
	$·štFa
(
$mes§ge
){

103 ià(! 
$this
->
ç
 && ! $this->
”rÜ
){

104 
$this
->
ç
 = 
Œue
;

105 
$this
->
mes§ge
 = $this->
	`esÿ³V®
(
$mes§ge
);

106 
$this
->
li¡’”
->
	`wr™e
('{¡©us:"ç",mes§ge:"'.$this->
mes§ge
.'",group:"'.$this->
group
.'",ÿ£:"'.$this->.'",m‘hod:"'.$this->
m‘hod
.'"}');

108 
	}
}

116 
funùiÚ
 
	$·štE¼Ü
(
$mes§ge
){

117 ià(! 
$this
->
ç
 && ! $this->
”rÜ
){

118 
$this
->
”rÜ
 = 
Œue
;

119 
$this
->
mes§ge
 = $this->
	`esÿ³V®
(
$mes§ge
);

120 
$this
->
li¡’”
->
	`wr™e
('{¡©us:"”rÜ",mes§ge:"'.$this->
mes§ge
.'",group:"'.$this->
group
.'",ÿ£:"'.$this->.'",m‘hod:"'.$this->
m‘hod
.'"}');

122 
	}
}

131 
funùiÚ
 
	$·štExû±iÚ
(
$exû±iÚ
){

132 ià(! 
$this
->
ç
 && ! $this->
”rÜ
){

133 
$this
->
”rÜ
 = 
Œue
;

134 
$mes§ge
 = 'UÃx³ùedƒxû±iÚ oàty³[' . 
	`g‘_şass
(
$exû±iÚ
) .

135 '] w™h mes§g[' . 
$exû±iÚ
->
	`g‘Mes§ge
() . '] in [' .

136 
$exû±iÚ
->
	`g‘Fe
(è.'†š'. $exû±iÚ->
	`g‘Lše
() . ']';

137 
$this
->
mes§ge
 = $this->
	`esÿ³V®
(
$mes§ge
);

138 
$this
->
li¡’”
->
	`wr™e
(

139 '{¡©us:"”rÜ",mes§ge:"' . 
$this
->
mes§ge
 . '",group:"' .

140 
$this
->
group
 . '",ÿ£:"' . $this->. '",m‘hod:"' . $this->
m‘hod


143 
	}
}

152 
funùiÚ
 
	$·štH—d”
(
$‹¡_Çme
) {

153 
	}
}

160 
funùiÚ
 
	$·štFoÙ”
(
$‹¡_Çme
) {

161 
	}
}

169 
funùiÚ
 
	$·štM‘hodS¹
(
$m‘hod
) {

170 
$this
->
·ss
 = 
çl£
;

171 
$this
->
ç
 = 
çl£
;

172 
$this
->
”rÜ
 = 
çl£
;

173 
$this
->
m‘hod
 = $this->
	`esÿ³V®
(
$m‘hod
);

174 
	}
}

182 
funùiÚ
 
	$·štM‘hodEnd
(
$m‘hod
){

183 ià(
$this
->
ç
 || $this->
”rÜ
 || ! $this->
·ss
){

185 
$this
->
li¡’”
->
	`wr™e
(

186 '{¡©us:"·ss",mes§ge:"' . 
$this
->
mes§ge
 . '",group:"' .

187 
$this
->
group
 . '",case:"' . $this->. '",method:"' .

188 
$this
->
m‘hod
 . '"}');

190 
	}
}

197 
funùiÚ
 
	$·štCa£S¹
(
$ÿ£
){

198 
$this
->ğ$this->
	`esÿ³V®
(
$ÿ£
);

199 
	}
}

206 
funùiÚ
 
	$·štCa£End
(
$ÿ£
){

207 
$this
->= "";

208 
	}
}

217 
funùiÚ
 
	$·štGroupS¹
(
$group
, 
$size
){

218 
$this
->
group
 = $this->
	`esÿ³V®
(
$group
);

219 ià(
$this
->
cc
){

220 ià(
	`ex‹nsiÚ_lßded
('xdebug')){

221 
	`xdebug_¡¬t_code_cov”age
(
XDEBUG_CC_UNUSED
 | 
XDEBUG_CC_DEAD_CODE
);

224 
	}
}

231 
funùiÚ
 
	$·štGroupEnd
(
$group
){

232 
$this
->
group
 = "";

233 
$cc
 = "";

234 ià(
$this
->
cc
){

235 ià(
	`ex‹nsiÚ_lßded
('xdebug')){

236 
$¬rfes
 = 
	`xdebug_g‘_code_cov”age
();

237 
	`xdebug_¡İ_code_cov”age
();

238 
$thisdœ
 = 
	`dœÇme
(
__FILE__
);

239 
$thisdœËn
 = 
	`¡¾’
(
$thisdœ
);

240 
	`fÜ—ch
 (
$¬rfes
 
as
 
$šdex
=>
$fe
){

241 ià(
	`sub¡r
(
$šdex
, 0, 
$thisdœËn
)===
$thisdœ
){

244 
$lút
 = 0;

245 
$cút
 = 0;

246 
	`fÜ—ch
 (
$fe
 
as
 
$lše
){

247 ià(
$lše
 == -2){

250 
$lút
++;

251 ià(
$lše
==1){

252 
$cút
++;

255 ià(
$lút
 > 0){

256 
$cc
 .ğ
	`round
((
$cút
/
$lút
) * 100, 2) . '%';

258 
$cc
 .= "0.00%";

260 
$cc
.ğ"\t". 
$šdex
 . "\n";

264 
$this
->
li¡’”
->
	`wr™e
('{status:"coverage",message:"' .

265 
Eş£R•Ü‹r
::
	`esÿ³V®
(
$cc
) . '"}');

266 
	}
}

275 şas 
	cEş£Invok”
 
ex‹nds
 
	mSim¶eInvok”DecÜ©Ü
{

276 
funùiÚ
 
	$__cÚ¡ruù
(&
$švok”
, &
$li¡’”
) {

277 
$this
->
li¡’”
 = &
$li¡’”
;

278 
$this
->
	`Sim¶eInvok”DecÜ©Ü
(
$švok”
);

286 
funùiÚ
 
	$befÜe
(
$m‘hod
){

287 
	`ob_¡¬t
();

288 
$this
->
švok”
->
	`befÜe
(
$m‘hod
);

289 
	}
}

297 
funùiÚ
 
	$aá”
(
$m‘hod
) {

298 
$this
->
švok”
->
	`aá”
(
$m‘hod
);

299 
$ouut
 = 
	`ob_g‘_cÚ‹Ás
();

300 
	`ob_’d_ş—n
();

301 ià(
$ouut
 !== ""){

302 
$»suÉ
 = 
$this
->
li¡’”
->
	`wr™e
('{status:"info",message:"' .

303 
Eş£R•Ü‹r
::
	`esÿ³V®
(
$ouut
) . '"}');

305 
	}
}

	@F:\Site\stew\1\_lp\simpletest\encoding.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/socket.php');

20 şas 
	cSim¶eEncodedPaœ
 {

21 
´iv©e
 
	m$key
;

22 
´iv©e
 
	m$v®ue
;

29 
funùiÚ
 
	$__cÚ¡ruù
(
$key
, 
$v®ue
) {

30 
$this
->
key
 = 
$key
;

31 
$this
->
v®ue
 = 
$v®ue
;

39 
funùiÚ
 
	$asReque¡
() {

40  
	`u¾’code
(
$this
->
key
è. '=' . u¾’code($this->
v®ue
);

41 
	}
}

48 
funùiÚ
 
	$asMime
() {

49 
$·¹
 = 'Content-Disposition: form-data; ';

50 
$·¹
 .ğ"Çme=\"" . 
$this
->
key
 . "\"\r\n";

51 
$·¹
 .ğ"\r\n" . 
$this
->
v®ue
;

52  
$·¹
;

53 
	}
}

61 
funùiÚ
 
	$isKey
(
$key
) {

62  
$key
 =ğ
$this
->
key
;

63 
	}
}

70 
funùiÚ
 
	$g‘Key
() {

71  
$this
->
key
;

72 
	}
}

79 
funùiÚ
 
	$g‘V®ue
() {

80  
$this
->
v®ue
;

81 
	}
}

89 şas 
	cSim¶eA‰achm’t
 {

90 
´iv©e
 
	m$key
;

91 
´iv©e
 
	m$cÚ‹Á
;

92 
´iv©e
 
	m$f’ame
;

100 
funùiÚ
 
	$__cÚ¡ruù
(
$key
, 
$cÚ‹Á
, 
$f’ame
) {

101 
$this
->
key
 = 
$key
;

102 
$this
->
cÚ‹Á
 = 
$cÚ‹Á
;

103 
$this
->
f’ame
 = 
$f’ame
;

111 
funùiÚ
 
	$asReque¡
() {

113 
	}
}

120 
funùiÚ
 
	$asMime
() {

121 
$·¹
 = 'Content-Disposition: form-data; ';

122 
$·¹
 .ğ'Çme="' . 
$this
->
key
 . '"; ';

123 
$·¹
 .ğ'f’ame="' . 
$this
->
f’ame
 . '"';

124 
$·¹
 .ğ"\r\nCÚ‹Á-Ty³: " . 
$this
->
	`deduûMimeTy³
();

125 
$·¹
 .ğ"\r\n\r\n" . 
$this
->
cÚ‹Á
;

126  
$·¹
;

127 
	}
}

135 
´Ùeùed
 
funùiÚ
 
	$deduûMimeTy³
() {

136 ià(
$this
->
	`isOÆyAscii
($this->
cÚ‹Á
)) {

140 
	}
}

147 
´Ùeùed
 
funùiÚ
 
	$isOÆyAscii
(
$ascii
) {

148 
$i
 = 0, 
$Ëngth
 = 
	`¡¾’
(
$ascii
); $i < $length; $i++) {

149 ià(
	`Üd
(
$ascii
[
$i
]) > 127) {

150  
çl£
;

153  
Œue
;

154 
	}
}

162 
funùiÚ
 
	$isKey
(
$key
) {

163  
$key
 =ğ
$this
->
key
;

164 
	}
}

171 
funùiÚ
 
	$g‘Key
() {

172  
$this
->
key
;

173 
	}
}

180 
funùiÚ
 
	$g‘V®ue
() {

181  
$this
->
f’ame
;

182 
	}
}

191 şas 
	cSim¶eEncodšg
 {

192 
´iv©e
 
	m$»que¡
;

201 
funùiÚ
 
	$__cÚ¡ruù
(
$qu”y
 = 
çl£
) {

202 ià(! 
$qu”y
) {

203 
$qu”y
 = 
	`¬¿y
();

205 
$this
->
	`ş—r
();

206 
$this
->
	`m”ge
(
$qu”y
);

213 
funùiÚ
 
	$ş—r
() {

214 
$this
->
»que¡
 = 
	`¬¿y
();

215 
	}
}

223 
funùiÚ
 
	$add
(
$key
, 
$v®ue
) {

224 ià(
$v®ue
 ==ğ
çl£
) {

227 ià(
	`is_¬¿y
(
$v®ue
)) {

228 
	`fÜ—ch
 (
$v®ue
 
as
 
$™em
) {

229 
$this
->
	`addPaœ
(
$key
, 
$™em
);

232 
$this
->
	`addPaœ
(
$key
, 
$v®ue
);

234 
	}
}

242 
´Ùeùed
 
funùiÚ
 
	$addPaœ
(
$key
, 
$v®ue
) {

243 
$this
->
»que¡
[] = 
Ãw
 
	`Sim¶eEncodedPaœ
(
$key
, 
$v®ue
);

244 
	}
}

254 
funùiÚ
 
	$©ch
(
$key
, 
$cÚ‹Á
, 
$f’ame
) {

255 
$this
->
»que¡
[] = 
Ãw
 
	`Sim¶eA‰achm’t
(
$key
, 
$cÚ‹Á
, 
$f’ame
);

256 
	}
}

264 
funùiÚ
 
	$m”ge
(
$qu”y
) {

265 ià(
	`is_objeù
(
$qu”y
)) {

266 
$this
->
»que¡
 = 
	`¬¿y_m”ge
($this->»que¡, 
$qu”y
->
	`g‘AÎ
());

267 } 
	`–£if
 (
	`is_¬¿y
(
$qu”y
)) {

268 
	`fÜ—ch
 (
$qu”y
 
as
 
$key
 => 
$v®ue
) {

269 
$this
->
	`add
(
$key
, 
$v®ue
);

272 
	}
}

281 
funùiÚ
 
	$g‘V®ue
(
$key
) {

282 
$v®ues
 = 
	`¬¿y
();

283 
	`fÜ—ch
 (
$this
->
»que¡
 
as
 
$·œ
) {

284 ià(
$·œ
->
	`isKey
(
$key
)) {

285 
$v®ues
[] = 
$·œ
->
	`g‘V®ue
();

288 ià(
	`couÁ
(
$v®ues
) == 0) {

289  
çl£
;

290 } 
	`–£if
 (
	`couÁ
(
$v®ues
) == 1) {

291  
$v®ues
[0];

293  
$v®ues
;

295 
	}
}

302 
funùiÚ
 
	$g‘AÎ
() {

303  
$this
->
»que¡
;

304 
	}
}

312 
´Ùeùed
 
funùiÚ
 
	$’code
() {

313 
$¡©em’ts
 = 
	`¬¿y
();

314 
	`fÜ—ch
 (
$this
->
»que¡
 
as
 
$·œ
) {

315 ià(
$¡©em’t
 = 
$·œ
->
	`asReque¡
()) {

316 
$¡©em’ts
[] = 
$¡©em’t
;

319  
	`im¶ode
('&', 
$¡©em’ts
);

320 
	}
}

329 şas 
	cSim¶eG‘Encodšg
 
ex‹nds
 
	mSim¶eEncodšg
 {

338 
funùiÚ
 
	$__cÚ¡ruù
(
$qu”y
 = 
çl£
) {

339 
·»Á
::
	`__cÚ¡ruù
(
$qu”y
);

347 
funùiÚ
 
	$g‘M‘hod
() {

349 
	}
}

356 
funùiÚ
 
	$wr™eH—d”sTo
(&
$sock‘
) {

357 
	}
}

365 
funùiÚ
 
	$wr™eTo
(&
$sock‘
) {

366 
	}
}

374 
funùiÚ
 
	$asU¾Reque¡
() {

375  
$this
->
	`’code
();

376 
	}
}

384 şas 
	cSim¶eH—dEncodšg
 
ex‹nds
 
	mSim¶eG‘Encodšg
 {

393 
funùiÚ
 
	$__cÚ¡ruù
(
$qu”y
 = 
çl£
) {

394 
·»Á
::
	`__cÚ¡ruù
(
$qu”y
);

402 
funùiÚ
 
	$g‘M‘hod
() {

404 
	}
}

412 şas 
	cSim¶eD–‘eEncodšg
 
ex‹nds
 
	mSim¶eG‘Encodšg
 {

421 
funùiÚ
 
	$__cÚ¡ruù
(
$qu”y
 = 
çl£
) {

422 
·»Á
::
	`__cÚ¡ruù
(
$qu”y
);

430 
funùiÚ
 
	$g‘M‘hod
() {

432 
	}
}

441 şas 
	cSim¶eEÁ™yEncodšg
 
ex‹nds
 
	mSim¶eEncodšg
 {

442 
´iv©e
 
	m$cÚ‹Á_ty³
;

443 
´iv©e
 
	m$body
;

445 
funùiÚ
 
	$__cÚ¡ruù
(
$qu”y
 = 
çl£
, 
$cÚ‹Á_ty³
 = false) {

446 
$this
->
cÚ‹Á_ty³
 = 
$cÚ‹Á_ty³
;

447 ià(
	`is_¡ršg
(
$qu”y
)) {

448 
$this
->
body
 = 
$qu”y
;

449 
·»Á
::
	`__cÚ¡ruù
();

451 
·»Á
::
	`__cÚ¡ruù
(
$qu”y
);

460 
funùiÚ
 
	$g‘CÚ‹ÁTy³
() {

461 ià(!
$this
->
cÚ‹Á_ty³
) {

462  (
$this
->
body
) ? 'text/plain' : 'application/x-www-form-urlencoded';

464  
$this
->
cÚ‹Á_ty³
;

465 
	}
}

472 
funùiÚ
 
	$wr™eH—d”sTo
(&
$sock‘
) {

473 
$sock‘
->
	`wr™e
("CÚ‹Á-L’gth: " . (
š‹g”
)
	`¡¾’
(
$this
->
	`’code
()) . "\r\n");

474 
$sock‘
->
	`wr™e
("CÚ‹Á-Ty³: " . 
$this
->
	`g‘CÚ‹ÁTy³
() . "\r\n");

475 
	}
}

482 
funùiÚ
 
	$wr™eTo
(&
$sock‘
) {

483 
$sock‘
->
	`wr™e
(
$this
->
	`’code
());

484 
	}
}

491 
´Ùeùed
 
funùiÚ
 
	$’code
() {

492  (
$this
->
body
è? $this->body : 
·»Á
::
	`’code
();

493 
	}
}

502 şas 
	cSim¶ePo¡Encodšg
 
ex‹nds
 
	mSim¶eEÁ™yEncodšg
 {

511 
funùiÚ
 
	$__cÚ¡ruù
(
$qu”y
 = 
çl£
, 
$cÚ‹Á_ty³
 = false) {

512 ià(
	`is_¬¿y
(
$qu”y
è
ªd
 
$this
->
	`hasMÜeThªOÃLev–
($query)) {

513 
$qu”y
 = 
$this
->
	`»wr™eA¼ayW™hMuÉËLev–s
($query);

515 
·»Á
::
	`__cÚ¡ruù
(
$qu”y
, 
$cÚ‹Á_ty³
);

518 
funùiÚ
 
	$hasMÜeThªOÃLev–
(
$qu”y
) {

519 
	`fÜ—ch
 (
$qu”y
 
as
 
$key
 => 
$v®ue
) {

520 ià(
	`is_¬¿y
(
$v®ue
)) {

521  
Œue
;

524  
çl£
;

525 
	}
}

527 
funùiÚ
 
	$»wr™eA¼ayW™hMuÉËLev–s
(
$qu”y
) {

528 
$qu”y_
 = 
	`¬¿y
();

529 
	`fÜ—ch
 (
$qu”y
 
as
 
$key
 => 
$v®ue
) {

530 ià(
	`is_¬¿y
(
$v®ue
)) {

531 
	`fÜ—ch
 (
$v®ue
 
as
 
$sub_key
 => 
$sub_v®ue
) {

532 
$qu”y_
[
$key
."[".
$sub_key
."]"] = 
$sub_v®ue
;

535 
$qu”y_
[
$key
] = 
$v®ue
;

538 ià(
$this
->
	`hasMÜeThªOÃLev–
(
$qu”y_
)) {

539 
$qu”y_
 = 
$this
->
	`»wr™eA¼ayW™hMuÉËLev–s
($query_);

542  
$qu”y_
;

543 
	}
}

550 
funùiÚ
 
	$g‘M‘hod
() {

552 
	}
}

560 
funùiÚ
 
	$asU¾Reque¡
() {

562 
	}
}

570 şas 
	cSim¶ePutEncodšg
 
ex‹nds
 
	mSim¶eEÁ™yEncodšg
 {

579 
funùiÚ
 
	$__cÚ¡ruù
(
$qu”y
 = 
çl£
, 
$cÚ‹Á_ty³
 = false) {

580 
·»Á
::
	`__cÚ¡ruù
(
$qu”y
, 
$cÚ‹Á_ty³
);

588 
funùiÚ
 
	$g‘M‘hod
() {

590 
	}
}

599 şas 
	cSim¶eMuÉ¬tEncodšg
 
ex‹nds
 
	mSim¶ePo¡Encodšg
 {

600 
´iv©e
 
	m$bound¬y
;

609 
funùiÚ
 
	$__cÚ¡ruù
(
$qu”y
 = 
çl£
, 
$bound¬y
 = false) {

610 
·»Á
::
	`__cÚ¡ruù
(
$qu”y
);

611 
$this
->
bound¬y
 = (
$bound¬y
 ==ğ
çl£
 ? 
	`uniqid
('st') : $boundary);

619 
funùiÚ
 
	$wr™eH—d”sTo
(&
$sock‘
) {

620 
$sock‘
->
	`wr™e
("CÚ‹Á-L’gth: " . (
š‹g”
)
	`¡¾’
(
$this
->
	`’code
()) . "\r\n");

621 
$sock‘
->
	`wr™e
("CÚ‹Á-Ty³: muÉ¬t/fÜm-d©a; bound¬y=" . 
$this
->
bound¬y
 . "\r\n");

622 
	}
}

629 
funùiÚ
 
	$wr™eTo
(&
$sock‘
) {

630 
$sock‘
->
	`wr™e
(
$this
->
	`’code
());

631 
	}
}

639 
funùiÚ
 
	$’code
() {

640 
$¡»am
 = '';

641 
	`fÜ—ch
 (
$this
->
	`g‘AÎ
(è
as
 
$·œ
) {

642 
$¡»am
 .ğ"--" . 
$this
->
bound¬y
 . "\r\n";

643 
$¡»am
 .ğ
$·œ
->
	`asMime
() . "\r\n";

645 
$¡»am
 .ğ"--" . 
$this
->
bound¬y
 . "--\r\n";

646  
$¡»am
;

647 
	}
}

	@F:\Site\stew\1\_lp\simpletest\errors.php

1 <?
php


12 
»quœe_Úû
 
dœÇme
(
__FILE__
) . '/invoker.php';

13 
»quœe_Úû
 
dœÇme
(
__FILE__
) . '/test_case.php';

14 
»quœe_Úû
 
dœÇme
(
__FILE__
) . '/expectation.php';

22 şas 
	cSim¶eE¼ÜT¿µšgInvok”
 
ex‹nds
 
	mSim¶eInvok”DecÜ©Ü
 {

28 
funùiÚ
 
	$__cÚ¡ruù
(
$švok”
) {

29 
·»Á
::
	`__cÚ¡ruù
(
$švok”
);

39 
funùiÚ
 
	$švoke
(
$m‘hod
) {

40 
$queue
 = 
$this
->
	`ü—‹E¼ÜQueue
();

41 
	`£t_”rÜ_hªdËr
('SimpleTestErrorHandler');

42 
·»Á
::
	`švoke
(
$m‘hod
);

43 
	`»¡Üe_”rÜ_hªdËr
();

44 
$queue
->
	`Îy
();

45 
	}
}

52 
´Ùeùed
 
funùiÚ
 
	$ü—‹E¼ÜQueue
() {

53 
$cÚ‹xt
 = 
Sim¶eTe¡
::
	`g‘CÚ‹xt
();

54 
$‹¡
 = 
$this
->
	`g‘Te¡Ca£
();

55 
$queue
 = 
$cÚ‹xt
->
	`g‘
('SimpleErrorQueue');

56 
$queue
->
	`£tTe¡Ca£
(
$‹¡
);

57  
$queue
;

58 
	}
}

67 şas 
	cSim¶eE¼ÜQueue
 {

68 
´iv©e
 
	m$queue
;

69 
´iv©e
 
	m$ex³ù©iÚ_queue
;

70 
´iv©e
 
	m$‹¡
;

71 
´iv©e
 
	m$usšg_ex³ù_¡yË
 = 
çl£
;

76 
funùiÚ
 
	$__cÚ¡ruù
() {

77 
$this
->
	`ş—r
();

84 
funùiÚ
 
	$ş—r
() {

85 
$this
->
queue
 = 
	`¬¿y
();

86 
$this
->
ex³ù©iÚ_queue
 = 
	`¬¿y
();

87 
	}
}

94 
funùiÚ
 
	$£tTe¡Ca£
(
$‹¡
) {

95 
$this
->
‹¡
 = 
$‹¡
;

96 
	}
}

107 
funùiÚ
 
	$ex³ùE¼Ü
(
$ex³ùed
, 
$mes§ge
) {

108 
	`¬¿y_push
(
$this
->
ex³ù©iÚ_queue
, 
	`¬¿y
(
$ex³ùed
, 
$mes§ge
));

109 
	}
}

119 
funùiÚ
 
	$add
(
$£v”™y
, 
$cÚ‹Á
, 
$f’ame
, 
$lše
) {

120 
$cÚ‹Á
 = 
	`¡r_»¶aû
('%', '%%', $content);

121 
$this
->
	`‹¡L©e¡E¼Ü
(
$£v”™y
, 
$cÚ‹Á
, 
$f’ame
, 
$lše
);

122 
	}
}

129 
funùiÚ
 
	$Îy
() {

130 
	`li¡
(
$£v”™y
, 
$mes§ge
, 
$fe
, 
$lše
èğ
$this
->
	`exŒaù
()) {

131 
$£v”™y
 = 
$this
->
	`g‘Sev”™yAsSŒšg
($severity);

132 
$this
->
‹¡
->
	`”rÜ
(
$£v”™y
, 
$mes§ge
, 
$fe
, 
$lše
);

134 
	`li¡
(
$ex³ùed
, 
$mes§ge
èğ
$this
->
	`exŒaùEx³ù©iÚ
()) {

135 
$this
->
‹¡
->
	`as£¹
(
$ex³ùed
, 
çl£
, "%s -> Expectedƒrror‚ot caught");

137 
	}
}

148 
´Ùeùed
 
funùiÚ
 
	$‹¡L©e¡E¼Ü
(
$£v”™y
, 
$cÚ‹Á
, 
$f’ame
, 
$lše
) {

149 ià(
$ex³ù©iÚ
 = 
$this
->
	`exŒaùEx³ù©iÚ
()) {

150 
	`li¡
(
$ex³ùed
, 
$mes§ge
èğ
$ex³ù©iÚ
;

151 
$this
->
‹¡
->
	`as£¹
(
$ex³ùed
, 
$cÚ‹Á
, 
	`¥rštf
(

152 
$mes§ge
,

154 
$this
->
	`g‘Sev”™yAsSŒšg
(
$£v”™y
) .

157 
$this
->
‹¡
->
	`”rÜ
(
$£v”™y
, 
$cÚ‹Á
, 
$f’ame
, 
$lše
);

159 
	}
}

170 
funùiÚ
 
	$exŒaù
() {

171 ià(
	`couÁ
(
$this
->
queue
)) {

172  
	`¬¿y_shiá
(
$this
->
queue
);

174  
çl£
;

175 
	}
}

182 
´Ùeùed
 
funùiÚ
 
	$exŒaùEx³ù©iÚ
() {

183 ià(
	`couÁ
(
$this
->
ex³ù©iÚ_queue
)) {

184  
	`¬¿y_shiá
(
$this
->
ex³ù©iÚ_queue
);

186  
çl£
;

187 
	}
}

196 
funùiÚ
 
	$g‘Sev”™yAsSŒšg
(
$£v”™y
) {

197 
$m­
 = 
	`¬¿y
(

198 
E_STRICT
 => 'E_STRICT',

199 
E_ERROR
 => 'E_ERROR',

200 
E_WARNING
 => 'E_WARNING',

201 
E_PARSE
 => 'E_PARSE',

202 
E_NOTICE
 => 'E_NOTICE',

203 
E_CORE_ERROR
 => 'E_CORE_ERROR',

204 
E_CORE_WARNING
 => 'E_CORE_WARNING',

205 
E_COMPILE_ERROR
 => 'E_COMPILE_ERROR',

206 
E_COMPILE_WARNING
 => 'E_COMPILE_WARNING',

207 
E_USER_ERROR
 => 'E_USER_ERROR',

208 
E_USER_WARNING
 => 'E_USER_WARNING',

209 
E_USER_NOTICE
 => 'E_USER_NOTICE');

210 ià(
	`defšed
('E_RECOVERABLE_ERROR')) {

211 
$m­
[
E_RECOVERABLE_ERROR
] = 'E_RECOVERABLE_ERROR';

213 ià(
	`defšed
('E_DEPRECATED')) {

214 
$m­
[
E_DEPRECATED
] = 'E_DEPRECATED';

216  
$m­
[
$£v”™y
];

217 
	}
}

231 
funùiÚ
 
	$Sim¶eTe¡E¼ÜHªdËr
(
$£v”™y
, 
$mes§ge
, 
$f’ame
 = 
nuÎ
, 
$lše
 =‚uÎ, 
$su³r_glob®s
 =‚uÎ, 
$mask
 =‚ull) {

232 
$£v”™y
 = $£v”™y & 
	`”rÜ_»pÜtšg
();

233 ià(
$£v”™y
) {

234 
	`»¡Üe_”rÜ_hªdËr
();

235 ià(
	`IsNÙCau£dBySim¶eTe¡
(
$mes§ge
è&& 
	`IsNÙTimeZÚeNag
($message)) {

236 ià(
	`ši_g‘
('log_errors')) {

237 
$Ïb–
 = 
Sim¶eE¼ÜQueue
::
	`g‘Sev”™yAsSŒšg
(
$£v”™y
);

238 
	`”rÜ_log
("$label: $message in $filename on†ine $line");

240 
$queue
 = 
Sim¶eTe¡
::
	`g‘CÚ‹xt
()->
	`g‘
('SimpleErrorQueue');

241 
$queue
->
	`add
(
$£v”™y
, 
$mes§ge
, 
$f’ame
, 
$lše
);

243 
	`£t_”rÜ_hªdËr
('SimpleTestErrorHandler');

245  
Œue
;

246 
	}
}

254 
funùiÚ
 
	$IsNÙCau£dBySim¶eTe¡
(
$mes§ge
) {

255  ! 
	`´eg_m©ch
('/»tuºed by„eã»nû/', 
$mes§ge
);

256 
	}
}

264 
funùiÚ
 
	$IsNÙTimeZÚeNag
(
$mes§ge
) {

265  ! 
	`´eg_m©ch
('/nÙ saãØ»ly .*imezÚ£‰šgs/', 
$mes§ge
);

266 
	}
}

	@F:\Site\stew\1\_lp\simpletest\exceptions.php

1 <?
php


12 
»quœe_Úû
 
dœÇme
(
__FILE__
) . '/invoker.php';

13 
»quœe_Úû
 
dœÇme
(
__FILE__
) . '/expectation.php';

22 şas 
	cSim¶eExû±iÚT¿µšgInvok”
 
ex‹nds
 
	mSim¶eInvok”DecÜ©Ü
 {

28 
funùiÚ
 
	$__cÚ¡ruù
(
$švok”
) {

29 
·»Á
::
	`__cÚ¡ruù
(
$švok”
);

38 
funùiÚ
 
	$švoke
(
$m‘hod
) {

39 
$Œ­
 = 
Sim¶eTe¡
::
	`g‘CÚ‹xt
()->
	`g‘
('SimpleExceptionTrap');

40 
$Œ­
->
	`ş—r
();

41 
Œy
 {

42 
$has_thrown
 = 
çl£
;

43 
·»Á
::
	`švoke
(
$m‘hod
);

44 } 
	`ÿtch
 (
Exû±iÚ
 
$exû±iÚ
) {

45 
$has_thrown
 = 
Œue
;

46 ià(! 
$Œ­
->
	`isEx³ùed
(
$this
->
	`g‘Te¡Ca£
(), 
$exû±iÚ
)) {

47 
$this
->
	`g‘Te¡Ca£
()->
	`exû±iÚ
(
$exû±iÚ
);

49 
$Œ­
->
	`ş—r
();

51 ià(
$mes§ge
 = 
$Œ­
->
	`g‘Out¡ªdšg
()) {

52 
$this
->
	`g‘Te¡Ca£
()->
	`ç
(
$mes§ge
);

54 ià(
$has_thrown
) {

55 
Œy
 {

56 
·»Á
::
	`g‘Te¡Ca£
()->
	`‹¬Down
();

57 } 
	`ÿtch
 (
Exû±iÚ
 
$e
) { }

59 
	}
}

70 şas 
	cExû±iÚEx³ù©iÚ
 
ex‹nds
 
	mSim¶eEx³ù©iÚ
 {

71 
´iv©e
 
	m$ex³ùed
;

85 
funùiÚ
 
__cÚ¡ruù
(
$ex³ùed
, 
$mes§ge
 = '%s') {

86 
$this
->
ex³ùed
 = 
$ex³ùed
;

87 
	m·»Á
::
__cÚ¡ruù
(
$mes§ge
);

95 
funùiÚ
 
	$‹¡
(
$com·»
) {

96 ià(
	`is_¡ršg
(
$this
->
ex³ùed
)) {

97  (
$com·»
 
š¡ªûof
 
$this
->
ex³ùed
);

99 ià(
	`g‘_şass
(
$com·»
è!ğg‘_şass(
$this
->
ex³ùed
)) {

100  
çl£
;

102  
$com·»
->
	`g‘Mes§ge
(è=ğ
$this
->
ex³ùed
->getMessage();

103 
	}
}

110 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

111 ià(
	`is_¡ršg
(
$this
->
ex³ùed
)) {

112  "Exû±iÚ [" . 
$this
->
	`desüibeExû±iÚ
(
$com·»
) .

113 "] should bty³ [" . 
$this
->
ex³ùed
 . "]";

115  "Exû±iÚ [" . 
$this
->
	`desüibeExû±iÚ
(
$com·»
) .

117 
$this
->
	`desüibeExû±iÚ
($this->
ex³ùed
) . "]";

118 
	}
}

125 
´Ùeùed
 
funùiÚ
 
	$desüibeExû±iÚ
(
$exû±iÚ
) {

126  
	`g‘_şass
(
$exû±iÚ
è. ": " . $exû±iÚ->
	`g‘Mes§ge
();

127 
	}
}

137 şas 
	cSim¶eExû±iÚT¿p
 {

138 
´iv©e
 
	m$ex³ùed
;

139 
´iv©e
 
	m$ignÜed
;

140 
´iv©e
 
	m$mes§ge
;

145 
funùiÚ
 
	$__cÚ¡ruù
() {

146 
$this
->
	`ş—r
();

157 
funùiÚ
 
	`ex³ùExû±iÚ
(
$ex³ùed
 = 
çl£
, 
$mes§ge
 = '%s') {

158 
$this
->
ex³ùed
 = $this->
	`cÛrûToEx³ù©iÚ
(
$ex³ùed
);

159 
$this
->
mes§ge
 = 
$mes§ge
;

160 
	}
}

168 
funùiÚ
 
	$ignÜeExû±iÚ
(
$ignÜed
) {

169 
$this
->
ignÜed
[] = $this->
	`cÛrûToEx³ù©iÚ
(
$ignÜed
);

170 
	}
}

180 
funùiÚ
 
	$isEx³ùed
(
$‹¡
, 
$exû±iÚ
) {

181 ià(
$this
->
ex³ùed
) {

182  
$‹¡
->
	`as£¹
(
$this
->
ex³ùed
, 
$exû±iÚ
, $this->
mes§ge
);

184 
	`fÜ—ch
 (
$this
->
ignÜed
 
as
 
$ignÜed
) {

185 ià(
$ignÜed
->
	`‹¡
(
$exû±iÚ
)) {

186  
Œue
;

189  
çl£
;

190 
	}
}

199 
´iv©e
 
funùiÚ
 
	$cÛrûToEx³ù©iÚ
(
$exû±iÚ
) {

200 ià(
$exû±iÚ
 ==ğ
çl£
) {

201  
Ãw
 
	`AnythšgEx³ù©iÚ
();

203 ià(! 
Sim¶eEx³ù©iÚ
::
	`isEx³ù©iÚ
(
$exû±iÚ
)) {

204  
Ãw
 
	`Exû±iÚEx³ù©iÚ
(
$exû±iÚ
);

206  
$exû±iÚ
;

207 
	}
}

213 
funùiÚ
 
	$g‘Out¡ªdšg
() {

214  
	`¥rštf
(
$this
->
mes§ge
, 'Failedorapƒxception');

215 
	}
}

220 
funùiÚ
 
	$ş—r
() {

221 
$this
->
ex³ùed
 = 
çl£
;

222 
$this
->
mes§ge
 = 
çl£
;

223 
$this
->
ignÜed
 = 
	`¬¿y
();

224 
	}
}

	@F:\Site\stew\1\_lp\simpletest\expectation.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/dumper.php');

13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/compatibility.php');

23 şas 
	cSim¶eEx³ù©iÚ
 {

24 
´Ùeùed
 
	m$dum³r
 = 
çl£
;

25 
´iv©e
 
	m$mes§ge
;

32 
funùiÚ
 
__cÚ¡ruù
(
$mes§ge
 = '%s') {

33 
$this
->
mes§ge
 = 
$mes§ge
;

43 
funùiÚ
 
	$‹¡
(
$com·»
) {

44 
	}
}

54 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

55 
	}
}

66 
funùiÚ
 
	$ov”ÏyMes§ge
(
$com·»
, 
$dum³r
) {

67 
$this
->
dum³r
 = 
$dum³r
;

68  
	`¥rštf
(
$this
->
mes§ge
, $this->
	`‹¡Mes§ge
(
$com·»
));

69 
	}
}

76 
´Ùeùed
 
funùiÚ
 
	$g‘Dum³r
() {

77 ià(! 
$this
->
dum³r
) {

78 
$dum³r
 = 
Ãw
 
	`Sim¶eDum³r
();

79  
$dum³r
;

81  
$this
->
dum³r
;

82 
	}
}

93 
funùiÚ
 
	$isEx³ù©iÚ
(
$ex³ù©iÚ
) {

94  
	`is_objeù
(
$ex³ù©iÚ
) &&

95 
Sim¶eTe¡Com·tib™y
::
	`isA
(
$ex³ù©iÚ
, 'SimpleExpectation');

96 
	}
}

104 şas 
	cAnythšgEx³ù©iÚ
 
ex‹nds
 
	mSim¶eEx³ù©iÚ
 {

112 
funùiÚ
 
	$‹¡
(
$com·»
) {

113  
Œue
;

123 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

124 
$dum³r
 = 
$this
->
	`g‘Dum³r
();

125  'Anythšg‡lway m©che [' . 
$dum³r
->
	`desüibeV®ue
(
$com·»
) . ']';

126 
	}
}

134 şas 
	cFaedEx³ù©iÚ
 
ex‹nds
 
	mSim¶eEx³ù©iÚ
 {

142 
funùiÚ
 
	$‹¡
(
$com·»
) {

143  
çl£
;

152 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

153 
$dum³r
 = 
$this
->
	`g‘Dum³r
();

154  'Faedƒx³ù©iÚ‚ev” m©che [' . 
$dum³r
->
	`desüibeV®ue
(
$com·»
) . ']';

155 
	}
}

163 şas 
	cTrueEx³ù©iÚ
 
ex‹nds
 
	mSim¶eEx³ù©iÚ
 {

171 
funùiÚ
 
	$‹¡
(
$com·»
) {

172  (
boŞ—n
)
$com·»
;

182 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

183 
$dum³r
 = 
$this
->
	`g‘Dum³r
();

184  'Ex³ùedrue, gÙ [' . 
$dum³r
->
	`desüibeV®ue
(
$com·»
) . ']';

185 
	}
}

193 şas 
	cF®£Ex³ù©iÚ
 
ex‹nds
 
	mSim¶eEx³ù©iÚ
 {

201 
funùiÚ
 
	$‹¡
(
$com·»
) {

202  ! (
boŞ—n
)
$com·»
;

212 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

213 
$dum³r
 = 
$this
->
	`g‘Dum³r
();

214  'Ex³ùed f®£, gÙ [' . 
$dum³r
->
	`desüibeV®ue
(
$com·»
) . ']';

215 
	}
}

223 şas 
	cEqu®Ex³ù©iÚ
 
ex‹nds
 
	mSim¶eEx³ù©iÚ
 {

224 
´iv©e
 
	m$v®ue
;

232 
funùiÚ
 
__cÚ¡ruù
(
$v®ue
, 
$mes§ge
 = '%s') {

233 
·»Á
::
__cÚ¡ruù
(
$mes§ge
);

234 
	m$this
->
	mv®ue
 = 
$v®ue
;

244 
funùiÚ
 
	$‹¡
(
$com·»
) {

245  ((
$this
->
v®ue
 =ğ
$com·»
) && ($compare == $this->value));

246 
	}
}

255 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

256 ià(
$this
->
	`‹¡
(
$com·»
)) {

257  "Equ®ƒx³ù©iÚ [" . 
$this
->
dum³r
->
	`desüibeV®ue
($this->
v®ue
) . "]";

260 
$this
->
dum³r
->
	`desüibeDifã»nû
($this->
v®ue
, 
$com·»
);

262 
	}
}

269 
´Ùeùed
 
funùiÚ
 
	$g‘V®ue
() {

270  
$this
->
v®ue
;

271 
	}
}

279 şas 
	cNÙEqu®Ex³ù©iÚ
 
ex‹nds
 
	mEqu®Ex³ù©iÚ
 {

287 
funùiÚ
 
__cÚ¡ruù
(
$v®ue
, 
$mes§ge
 = '%s') {

288 
·»Á
::
__cÚ¡ruù
(
$v®ue
, 
$mes§ge
);

298 
funùiÚ
 
	$‹¡
(
$com·»
) {

299  ! 
·»Á
::
	`‹¡
(
$com·»
);

300 
	}
}

309 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

310 
$dum³r
 = 
$this
->
	`g‘Dum³r
();

311 ià(
$this
->
	`‹¡
(
$com·»
)) {

313 
$dum³r
->
	`desüibeDifã»nû
(
$this
->
	`g‘V®ue
(), 
$com·»
);

316 
$dum³r
->
	`desüibeV®ue
(
$this
->
	`g‘V®ue
()) .

319 
	}
}

327 şas 
	cW™hšM¬gšEx³ù©iÚ
 
ex‹nds
 
	mSim¶eEx³ù©iÚ
 {

328 
´iv©e
 
	m$uµ”
;

329 
´iv©e
 
	m$low”
;

339 
funùiÚ
 
__cÚ¡ruù
(
$v®ue
, 
$m¬gš
, 
$mes§ge
 = '%s') {

340 
·»Á
::
__cÚ¡ruù
(
$mes§ge
);

341 
	m$this
->
	muµ”
 = 
$v®ue
 + 
$m¬gš
;

342 
	m$this
->
	mlow”
 = 
$v®ue
 - 
$m¬gš
;

352 
funùiÚ
 
	$‹¡
(
$com·»
) {

353  ((
$com·»
 <ğ
$this
->
uµ”
è&& ($com·» >ğ$this->
low”
));

354 
	}
}

363 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

364 ià(
$this
->
	`‹¡
(
$com·»
)) {

365  
$this
->
	`w™hšMes§ge
(
$com·»
);

367  
$this
->
	`outsideMes§ge
(
$com·»
);

369 
	}
}

376 
´Ùeùed
 
funùiÚ
 
	$w™hšMes§ge
(
$com·»
) {

377  "W™hšƒx³ù©iÚ [" . 
$this
->
dum³r
->
	`desüibeV®ue
($this->
low”
) . "]‡nd [" .

378 
$this
->
dum³r
->
	`desüibeV®ue
($this->
uµ”
) . "]";

379 
	}
}

386 
´Ùeùed
 
funùiÚ
 
	$outsideMes§ge
(
$com·»
) {

387 ià(
$com·»
 > 
$this
->
uµ”
) {

389 
$this
->
dum³r
->
	`desüibeDifã»nû
(
$com·»
, $this->
uµ”
);

392 
$this
->
dum³r
->
	`desüibeDifã»nû
(
$com·»
, $this->
low”
);

394 
	}
}

402 şas 
	cOutsideM¬gšEx³ù©iÚ
 
ex‹nds
 
	mW™hšM¬gšEx³ù©iÚ
 {

412 
funùiÚ
 
__cÚ¡ruù
(
$v®ue
, 
$m¬gš
, 
$mes§ge
 = '%s') {

413 
·»Á
::
__cÚ¡ruù
(
$v®ue
, 
$m¬gš
, 
$mes§ge
);

423 
funùiÚ
 
	$‹¡
(
$com·»
) {

424  ! 
·»Á
::
	`‹¡
(
$com·»
);

425 
	}
}

434 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

435 ià(! 
$this
->
	`‹¡
(
$com·»
)) {

436  
$this
->
	`w™hšMes§ge
(
$com·»
);

438  
$this
->
	`outsideMes§ge
(
$com·»
);

440 
	}
}

448 şas 
	cReã»nûEx³ù©iÚ
 {

449 
´iv©e
 
	m$v®ue
;

457 
funùiÚ
 
__cÚ¡ruù
(&
$v®ue
, 
$mes§ge
 = '%s') {

458 
$this
->
mes§ge
 = 
$mes§ge
;

459 
	m$this
->
	mv®ue
 = &
$v®ue
;

469 
funùiÚ
 
	$‹¡
(&
$com·»
) {

470  
Sim¶eTe¡Com·tib™y
::
	`isReã»nû
(
$this
->
v®ue
, 
$com·»
);

471 
	}
}

480 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

481 ià(
$this
->
	`‹¡
(
$com·»
)) {

482  "Reã»nûƒx³ù©iÚ [" . 
$this
->
dum³r
->
	`desüibeV®ue
($this->
v®ue
) . "]";

485 
$this
->
dum³r
->
	`desüibeDifã»nû
($this->
v®ue
, 
$com·»
);

487 
	}
}

498 
funùiÚ
 
	$ov”ÏyMes§ge
(
$com·»
, 
$dum³r
) {

499 
$this
->
dum³r
 = 
$dum³r
;

500  
	`¥rštf
(
$this
->
mes§ge
, $this->
	`‹¡Mes§ge
(
$com·»
));

501 
	}
}

508 
´Ùeùed
 
funùiÚ
 
	$g‘Dum³r
() {

509 ià(! 
$this
->
dum³r
) {

510 
$dum³r
 = 
Ãw
 
	`Sim¶eDum³r
();

511  
$dum³r
;

513  
$this
->
dum³r
;

514 
	}
}

522 şas 
	cId’tiÿlEx³ù©iÚ
 
ex‹nds
 
	mEqu®Ex³ù©iÚ
 {

530 
funùiÚ
 
__cÚ¡ruù
(
$v®ue
, 
$mes§ge
 = '%s') {

531 
·»Á
::
__cÚ¡ruù
(
$v®ue
, 
$mes§ge
);

541 
funùiÚ
 
	$‹¡
(
$com·»
) {

542  
Sim¶eTe¡Com·tib™y
::
	`isId’tiÿl
(
$this
->
	`g‘V®ue
(), 
$com·»
);

543 
	}
}

552 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

553 
$dum³r
 = 
$this
->
	`g‘Dum³r
();

554 ià(
$this
->
	`‹¡
(
$com·»
)) {

555  "Id’tiÿÈex³ù©iÚ [" . 
$dum³r
->
	`desüibeV®ue
(
$this
->
	`g‘V®ue
()) . "]";

557  "Id’tiÿÈex³ù©iÚ [" . 
$dum³r
->
	`desüibeV®ue
(
$this
->
	`g‘V®ue
()) .

559 
$dum³r
->
	`desüibeV®ue
(
$com·»
) . "] " .

560 
$dum³r
->
	`desüibeDifã»nû
(
$this
->
	`g‘V®ue
(), 
$com·»
, 
TYPE_MATTERS
);

562 
	}
}

570 şas 
	cNÙId’tiÿlEx³ù©iÚ
 
ex‹nds
 
	mId’tiÿlEx³ù©iÚ
 {

578 
funùiÚ
 
__cÚ¡ruù
(
$v®ue
, 
$mes§ge
 = '%s') {

579 
·»Á
::
__cÚ¡ruù
(
$v®ue
, 
$mes§ge
);

589 
funùiÚ
 
	$‹¡
(
$com·»
) {

590  ! 
·»Á
::
	`‹¡
(
$com·»
);

591 
	}
}

600 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

601 
$dum³r
 = 
$this
->
	`g‘Dum³r
();

602 ià(
$this
->
	`‹¡
(
$com·»
)) {

604 
$dum³r
->
	`desüibeDifã»nû
(
$this
->
	`g‘V®ue
(), 
$com·»
, 
TYPE_MATTERS
);

606  "NÙ id’tiÿÈex³ù©iÚ [" . 
$dum³r
->
	`desüibeV®ue
(
$this
->
	`g‘V®ue
()) . "] matches";

608 
	}
}

616 şas 
	cP©‹ºEx³ù©iÚ
 
ex‹nds
 
	mSim¶eEx³ù©iÚ
 {

617 
´iv©e
 
	m$·‰”n
;

625 
funùiÚ
 
__cÚ¡ruù
(
$·‰”n
, 
$mes§ge
 = '%s') {

626 
·»Á
::
__cÚ¡ruù
(
$mes§ge
);

627 
	m$this
->
	m·‰”n
 = 
$·‰”n
;

635 
´Ùeùed
 
funùiÚ
 
	$g‘P©‹º
() {

636  
$this
->
·‰”n
;

637 
	}
}

646 
funùiÚ
 
	$‹¡
(
$com·»
) {

647  (
boŞ—n
)
	`´eg_m©ch
(
$this
->
	`g‘P©‹º
(), 
$com·»
);

648 
	}
}

657 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

658 ià(
$this
->
	`‹¡
(
$com·»
)) {

659  
$this
->
	`desüibeP©‹ºM©ch
($this->
	`g‘P©‹º
(), 
$com·»
);

661 
$dum³r
 = 
$this
->
	`g‘Dum³r
();

662  "P©‹º [" . 
$this
->
	`g‘P©‹º
() .

664 
$dum³r
->
	`desüibeV®ue
(
$com·»
) . "]";

666 
	}
}

675 
´Ùeùed
 
funùiÚ
 
	$desüibeP©‹ºM©ch
(
$·‰”n
, 
$subjeù
) {

676 
	`´eg_m©ch
(
$·‰”n
, 
$subjeù
, 
$m©ches
);

677 
$pos™iÚ
 = 
	`¡½os
(
$subjeù
, 
$m©ches
[0]);

678 
$dum³r
 = 
$this
->
	`g‘Dum³r
();

680 
$dum³r
->
	`desüibeV®ue
(
$subjeù
) . "]‡s [" .

681 
$m©ches
[0] . "] in„egion [" .

682 
$dum³r
->
	`şSŒšg
(
$subjeù
, 100, 
$pos™iÚ
) . "]";

683 
	}
}

692 şas 
	cNoP©‹ºEx³ù©iÚ
 
ex‹nds
 
	mP©‹ºEx³ù©iÚ
 {

700 
funùiÚ
 
__cÚ¡ruù
(
$·‰”n
, 
$mes§ge
 = '%s') {

701 
·»Á
::
__cÚ¡ruù
(
$·‰”n
, 
$mes§ge
);

711 
funùiÚ
 
	$‹¡
(
$com·»
) {

712  ! 
·»Á
::
	`‹¡
(
$com·»
);

713 
	}
}

722 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

723 ià(
$this
->
	`‹¡
(
$com·»
)) {

724 
$dum³r
 = 
$this
->
	`g‘Dum³r
();

725  "P©‹º [" . 
$this
->
	`g‘P©‹º
() .

727 
$dum³r
->
	`desüibeV®ue
(
$com·»
) . "]";

729  
$this
->
	`desüibeP©‹ºM©ch
($this->
	`g‘P©‹º
(), 
$com·»
);

731 
	}
}

739 şas 
	cIsAEx³ù©iÚ
 
ex‹nds
 
	mSim¶eEx³ù©iÚ
 {

740 
´iv©e
 
	m$ty³
;

748 
funùiÚ
 
__cÚ¡ruù
(
$ty³
, 
$mes§ge
 = '%s') {

749 
·»Á
::
__cÚ¡ruù
(
$mes§ge
);

750 
	m$this
->
	mty³
 = 
$ty³
;

758 
´Ùeùed
 
funùiÚ
 
	$g‘Ty³
() {

759  
$this
->
ty³
;

760 
	}
}

769 
funùiÚ
 
	$‹¡
(
$com·»
) {

770 ià(
	`is_objeù
(
$com·»
)) {

771  
Sim¶eTe¡Com·tib™y
::
	`isA
(
$com·»
, 
$this
->
ty³
);

773 
$funùiÚ
 = 'is_'.
$this
->
	`ÿnÚiÿlTy³
($this->
ty³
);

774 ià(
	`is_ÿÎabË
(
$funùiÚ
)) {

775  
	`$funùiÚ
(
$com·»
);

777  
çl£
;

779 
	}
}

787 
´Ùeùed
 
funùiÚ
 
	$ÿnÚiÿlTy³
(
$ty³
) {

788 
$ty³
 = 
	`¡¹Şow”
($type);

789 
$m­
 = 
	`¬¿y
('boolean' => 'bool');

790 ià(
	`is£t
(
$m­
[
$ty³
])) {

791 
$ty³
 = 
$m­
[$type];

793  
$ty³
;

794 
	}
}

803 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

804 
$dum³r
 = 
$this
->
	`g‘Dum³r
();

805  "V®u[" . 
$dum³r
->
	`desüibeV®ue
(
$com·»
) .

806 "] should bty³ [" . 
$this
->
ty³
 . "]";

807 
	}
}

816 şas 
	cNÙAEx³ù©iÚ
 
ex‹nds
 
	mIsAEx³ù©iÚ
 {

817 
´iv©e
 
	m$ty³
;

825 
funùiÚ
 
__cÚ¡ruù
(
$ty³
, 
$mes§ge
 = '%s') {

826 
·»Á
::
__cÚ¡ruù
(
$ty³
, 
$mes§ge
);

836 
funùiÚ
 
	$‹¡
(
$com·»
) {

837  ! 
·»Á
::
	`‹¡
(
$com·»
);

838 
	}
}

847 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

848 
$dum³r
 = 
$this
->
	`g‘Dum³r
();

849  "V®u[" . 
$dum³r
->
	`desüibeV®ue
(
$com·»
) .

850 "] should‚Ù bty³ [" . 
$this
->
	`g‘Ty³
() . "]";

851 
	}
}

859 şas 
	cM‘hodExi¡sEx³ù©iÚ
 
ex‹nds
 
	mSim¶eEx³ù©iÚ
 {

860 
´iv©e
 
	m$m‘hod
;

868 
funùiÚ
 
__cÚ¡ruù
(
$m‘hod
, 
$mes§ge
 = '%s') {

869 
·»Á
::
__cÚ¡ruù
(
$mes§ge
);

870 
	m$this
->
	mm‘hod
 = &
$m‘hod
;

878 
funùiÚ
 
	$‹¡
(
$com·»
) {

879  (
boŞ—n
)(
	`is_objeù
(
$com·»
è&& 
	`m‘hod_exi¡s
($com·», 
$this
->
m‘hod
));

880 
	}
}

888 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

889 
$dum³r
 = 
$this
->
	`g‘Dum³r
();

890 ià(! 
	`is_objeù
(
$com·»
)) {

891  'NØm‘hod oÀnÚ-objeù [' . 
$dum³r
->
	`desüibeV®ue
(
$com·»
) . ']';

893 
$m‘hod
 = 
$this
->
m‘hod
;

894  "Objeù [" . 
$dum³r
->
	`desüibeV®ue
(
$com·»
) .

896 
	}
}

904 şas 
	cMemb”Ex³ù©iÚ
 
ex‹nds
 
	mId’tiÿlEx³ù©iÚ
 {

905 
´iv©e
 
	m$Çme
;

913 
funùiÚ
 
	$__cÚ¡ruù
(
$Çme
, 
$ex³ùed
) {

914 
$this
->
Çme
 = 
$Çme
;

915 
·»Á
::
	`__cÚ¡ruù
(
$ex³ùed
);

923 
funùiÚ
 
	$‹¡
(
$aùu®
) {

924 ià(! 
	`is_objeù
(
$aùu®
)) {

925  
çl£
;

927  
·»Á
::
	`‹¡
(
$this
->
	`g‘Prİ”ty
($this->
Çme
, 
$aùu®
));

928 
	}
}

936 
funùiÚ
 
	$‹¡Mes§ge
(
$aùu®
) {

937  
·»Á
::
	`‹¡Mes§ge
(
$this
->
	`g‘Prİ”ty
($this->
Çme
, 
$aùu®
));

938 
	}
}

946 
´iv©e
 
funùiÚ
 
	$g‘Prİ”ty
(
$Çme
, 
$objeù
) {

947 
$»æeùiÚ
 = 
Ãw
 
	`ReæeùiÚObjeù
(
$objeù
);

948 
$´İ”ty
 = 
$»æeùiÚ
->
	`g‘Prİ”ty
(
$Çme
);

949 ià(
	`m‘hod_exi¡s
(
$´İ”ty
, 'setAccessible')) {

950 
$´İ”ty
->
	`£tAcûssibË
(
Œue
);

952 
Œy
 {

953  
$´İ”ty
->
	`g‘V®ue
(
$objeù
);

954 } 
	`ÿtch
 (
ReæeùiÚExû±iÚ
 
$e
) {

955  
$this
->
	`g‘Priv©ePrİ”tyNoM©‹rWh©
(
$Çme
, 
$objeù
);

957 
	}
}

965 
´iv©e
 
funùiÚ
 
	$g‘Priv©ePrİ”tyNoM©‹rWh©
(
$Çme
, 
$objeù
) {

966 
	`fÜ—ch
 ((
¬¿y
)
$objeù
 
as
 
$mªgËd_Çme
 => 
$v®ue
) {

967 ià(
$this
->
	`unmªgË
(
$mªgËd_Çme
è=ğ
$Çme
) {

968  
$v®ue
;

971 
	}
}

979 
funùiÚ
 
	$unmªgË
(
$mªgËd
) {

980 
$·¹s
 = 
	`´eg_¥l™
('/[^a-zA-Z0-9_\x7f-\xff]+/', 
$mªgËd
);

981  
	`¬¿y_pİ
(
$·¹s
);

982 
	}
}

	@F:\Site\stew\1\_lp\simpletest\extensions\pear_test_case.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/../dumper.php');

13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/../compatibility.php');

14 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/../test_case.php');

15 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/../expectation.php');

24 şas 
	cPHPUn™_Te¡Ca£
 
ex‹nds
 
	mSim¶eTe¡Ca£
 {

25 
´iv©e
 
	m$_loo£ly_ty³d
;

32 
funùiÚ
 
	$__cÚ¡ruù
(
$Ïb–
 = 
çl£
) {

33 
·»Á
::
	`__cÚ¡ruù
(
$Ïb–
);

34 
$this
->
_loo£ly_ty³d
 = 
çl£
;

45 
funùiÚ
 
	`as£¹Equ®s
(
$fœ¡
, 
$£cÚd
, 
$mes§ge
 = "%s", 
$d–
 = 0) {

46 ià(
$this
->
_loo£ly_ty³d
) {

47 
$ex³ù©iÚ
 = 
Ãw
 
	`Equ®Ex³ù©iÚ
(
$fœ¡
);

49 
$ex³ù©iÚ
 = 
Ãw
 
	`Id’tiÿlEx³ù©iÚ
(
$fœ¡
);

51 
$this
->
	`as£¹
(
$ex³ù©iÚ
, 
$£cÚd
, 
$mes§ge
);

52 
	}
}

60 
funùiÚ
 
as£¹NÙNuÎ
(
$v®ue
, 
$mes§ge
 = "%s") {

61 
·»Á
::
as£¹
(
Ãw
 
TrueEx³ù©iÚ
(), 
is£t
(
$v®ue
), 
$mes§ge
);

70 
funùiÚ
 
as£¹NuÎ
(
$v®ue
, 
$mes§ge
 = "%s") {

71 
·»Á
::
as£¹
(
Ãw
 
TrueEx³ù©iÚ
(), !
is£t
(
$v®ue
), 
$mes§ge
);

81 
funùiÚ
 
as£¹Same
(
$fœ¡
, 
$£cÚd
, 
$mes§ge
 = "%s") {

82 
$dum³r
 = 
Ãw
 
Sim¶eDum³r
();

83 
	g$mes§ge
 = 
¥rštf
(

84 
$mes§ge
,

85 "[" . 
$dum³r
->
desüibeV®ue
(
$fœ¡
) .

86 "]‡nd [" . 
$dum³r
->
desüibeV®ue
(
$£cÚd
) .

88  
	g$this
->
as£¹
(

89 
Ãw
 
TrueEx³ù©iÚ
(),

90 
Sim¶eTe¡Com·tib™y
::
isReã»nû
(
$fœ¡
, 
$£cÚd
),

91 
$mes§ge
);

101 
funùiÚ
 
as£¹NÙSame
(
$fœ¡
, 
$£cÚd
, 
$mes§ge
 = "%s") {

102 
$dum³r
 = 
Ãw
 
Sim¶eDum³r
();

103 
	g$mes§ge
 = 
¥rštf
(

104 
$mes§ge
,

105 "[" . 
$dum³r
->
desüibeV®ue
(
$fœ¡
) .

106 "]‡nd [" . 
$dum³r
->
desüibeV®ue
(
$£cÚd
) .

108  
	g$this
->
as£¹
(

109 
Ãw
 
çl£Ex³ù©iÚ
(),

110 
Sim¶eTe¡Com·tib™y
::
isReã»nû
(
$fœ¡
, 
$£cÚd
),

111 
$mes§ge
);

121 
funùiÚ
 
as£¹True
(
$cÚd™iÚ
, 
$mes§ge
 = "%s") {

122 
·»Á
::
as£¹
(
Ãw
 
TrueEx³ù©iÚ
(), 
$cÚd™iÚ
, 
$mes§ge
);

132 
funùiÚ
 
as£¹F®£
(
$cÚd™iÚ
, 
$mes§ge
 = "%s") {

133 
·»Á
::
as£¹
(
Ãw
 
F®£Ex³ù©iÚ
(), 
$cÚd™iÚ
, 
$mes§ge
);

143 
funùiÚ
 
as£¹RegExp
(
$·‰”n
, 
$subjeù
, 
$mes§ge
 = "%s") {

144 
$this
->
as£¹
(
Ãw
 
P©‹ºEx³ù©iÚ
(
$·‰”n
), 
$subjeù
, 
$mes§ge
);

154 
funùiÚ
 
as£¹Ty³
(
$v®ue
, 
$ty³
, 
$mes§ge
 = "%s") {

155 
·»Á
::
as£¹
(
Ãw
 
TrueEx³ù©iÚ
(), 
g‘ty³
(
$v®ue
è=ğ
¡¹Şow”
(
$ty³
), 
$mes§ge
);

165 
funùiÚ
 
	$£tLoo£lyTy³d
(
$loo£ly_ty³d
) {

166 
$this
->
_loo£ly_ty³d
 = 
$loo£ly_ty³d
;

167 
	}
}

175 
funùiÚ
 
	$couÁTe¡Ca£s
() {

176  
$this
->
	`g‘Size
();

177 
	}
}

184 
funùiÚ
 
	$g‘Name
() {

185  
$this
->
	`g‘Lab–
();

186 
	}
}

193 
funùiÚ
 
	$£tName
(
$Çme
) {

194 
	}
}

	@F:\Site\stew\1\_lp\simpletest\extensions\testdox.php

1 <?
php


14 şas 
	cTe¡DoxR•Ü‹r
 
ex‹nds
 
	mSim¶eR•Ü‹r


16 
v¬
 
	m$_‹¡_ÿ£_·‰”n
 = '/^TestOf(.*)$/';

18 
funùiÚ
 
__cÚ¡ruù
(
$‹¡_ÿ£_·‰”n
 = '/^TestOf(.*)$/') {

19 
·»Á
::
__cÚ¡ruù
();

20 
	m$this
->
	m_‹¡_ÿ£_·‰”n
 = 
em±y
(
$‹¡_ÿ£_·‰”n
) ? '/^(.*)$/' : $test_case_pattern;

23 
funùiÚ
 
	$·štCa£S¹
(
$‹¡_Çme
) {

24 
	`´eg_m©ch
(
$this
->
_‹¡_ÿ£_·‰”n
, 
$‹¡_Çme
, 
$m©ches
);

25 ià(!
	`em±y
(
$m©ches
[1])) {

26 
echo
 
$m©ches
[1] . "\n";

28 
echo
 
$‹¡_Çme
 . "\n";

30 
	}
}

32 
funùiÚ
 
	$·štCa£End
(
$‹¡_Çme
) {

33 
echo
 "\n";

34 
	}
}

36 
funùiÚ
 
	$·štM‘hodS¹
(
$‹¡_Çme
) {

37 ià(!
	`´eg_m©ch
('/^‹¡(.*)$/i', 
$‹¡_Çme
, 
$m©ches
)) {

40 
$‹¡_Çme
 = 
$m©ches
[1];

41 
$‹¡_Çme
 = 
	`´eg_»¶aû
('/([A-Z])([A-Z])/', '$1 $2', $test_name);

42 
echo
 '- ' . 
	`¡¹Şow”
(
	`´eg_»¶aû
('/([a-zA-Z])([A-Z0-9])/', '$1 $2', 
$‹¡_Çme
));

43 
	}
}

45 
funùiÚ
 
	$·štM‘hodEnd
(
$‹¡_Çme
) {

46 
echo
 "\n";

47 
	}
}

49 
funùiÚ
 
	$·štFa
(
$mes§ge
) {

50 
echo
 " [FAILED]";

51 
	}
}

	@F:\Site\stew\1\_lp\simpletest\extensions\testdox\test.php

1 <?
php


3 
»quœe_Úû
 
dœÇme
(
__FILE__
) . '/../../autorun.php';

4 
»quœe_Úû
 
dœÇme
(
__FILE__
) . '/../testdox.php';

9 şas 
	cTe¡OfTe¡DoxR•Ü‹r
 
ex‹nds
 
	mUn™Te¡Ca£


11 
funùiÚ
 
	$‹¡IsAnIn¡ªûOfSim¶eScÜ”AndR•Ü‹r
() {

12 
$dox
 = 
Ãw
 
	`Te¡DoxR•Ü‹r
();

13 
$this
->
	`as£¹IsA
(
$dox
, 'SimpleScorer');

14 
$this
->
	`as£¹IsA
(
$dox
, 'SimpleReporter');

17 
funùiÚ
 
	$‹¡OuutsNameOfTe¡Ca£
() {

18 
$dox
 = 
Ãw
 
	`Te¡DoxR•Ü‹r
();

19 
	`ob_¡¬t
();

20 
$dox
->
	`·štCa£S¹
('TestOfTestDoxReporter');

21 
$bufãr
 = 
	`ob_g‘_ş—n
();

22 
$this
->
	`as£¹P©‹º
('/^Te¡DoxR•Ü‹r/', 
$bufãr
);

23 
	}
}

25 
funùiÚ
 
	$‹¡OuutOfTe¡Ca£NameF‹»dByCÚ¡ruùP¬am‘”
() {

26 
$dox
 = 
Ãw
 
	`Te¡DoxR•Ü‹r
('/^(.*)Test$/');

27 
	`ob_¡¬t
();

28 
$dox
->
	`·štCa£S¹
('SomeGreatWidgetTest');

29 
$bufãr
 = 
	`ob_g‘_ş—n
();

30 
$this
->
	`as£¹P©‹º
('/^SomeG»©Widg‘/', 
$bufãr
);

31 
	}
}

33 
funùiÚ
 
	$‹¡IfTe¡_ÿ£_·‰”nIsEm±yAssumeEv”ythšgM©ches
() {

34 
$dox
 = 
Ãw
 
	`Te¡DoxR•Ü‹r
('');

35 
	`ob_¡¬t
();

36 
$dox
->
	`·štCa£S¹
('TestOfTestDoxReporter');

37 
$bufãr
 = 
	`ob_g‘_ş—n
();

38 
$this
->
	`as£¹P©‹º
('/^Te¡OfTe¡DoxR•Ü‹r/', 
$bufãr
);

39 
	}
}

41 
funùiÚ
 
	$‹¡Em±yLšeIn£¹edWh’Ca£Ends
() {

42 
$dox
 = 
Ãw
 
	`Te¡DoxR•Ü‹r
();

43 
	`ob_¡¬t
();

44 
$dox
->
	`·štCa£End
('TestOfTestDoxReporter');

45 
$bufãr
 = 
	`ob_g‘_ş—n
();

46 
$this
->
	`as£¹Equ®
("\n", 
$bufãr
);

47 
	}
}

49 
funùiÚ
 
	$‹¡PaštsTe¡M‘hodInTe¡DoxFÜm©
() {

50 
$dox
 = 
Ãw
 
	`Te¡DoxR•Ü‹r
();

51 
	`ob_¡¬t
();

52 
$dox
->
	`·štM‘hodS¹
('testSomeGreatTestCase');

53 
$bufãr
 = 
	`ob_g‘_ş—n
();

54 
$this
->
	`as£¹Equ®
("- somg»©e¡ ca£", 
$bufãr
);

55 
	`un£t
(
$bufãr
);

57 
$¿ndom
 = 
	`¿nd
(100, 200);

58 
	`ob_¡¬t
();

59 
$dox
->
	`·štM‘hodS¹
("testRandomNumberIs{$random}");

60 
$bufãr
 = 
	`ob_g‘_ş—n
();

61 
$this
->
	`as£¹Equ®
("-„ªdom‚umb” i {$¿ndom}", 
$bufãr
);

62 
	}
}

64 
funùiÚ
 
	$‹¡DÛsNÙOuutAnythšgOnNÚeTe¡M‘hods
() {

65 
$dox
 = 
Ãw
 
	`Te¡DoxR•Ü‹r
();

66 
	`ob_¡¬t
();

67 
$dox
->
	`·štM‘hodS¹
('nonMatchingMethod');

68 
$bufãr
 = 
	`ob_g‘_ş—n
();

69 
$this
->
	`as£¹Equ®
('', 
$bufãr
);

70 
	}
}

72 
funùiÚ
 
	$‹¡PaštM‘hodAddLšeB»ak
() {

73 
$dox
 = 
Ãw
 
	`Te¡DoxR•Ü‹r
();

74 
	`ob_¡¬t
();

75 
$dox
->
	`·štM‘hodEnd
('someMethod');

76 
$bufãr
 = 
	`ob_g‘_ş—n
();

77 
$this
->
	`as£¹Equ®
("\n", 
$bufãr
);

78 
	}
}

80 
funùiÚ
 
	$‹¡Prİ”lyS·ûsSšgËL‘‹rsInM‘hodName
() {

81 
$dox
 = 
Ãw
 
	`Te¡DoxR•Ü‹r
();

82 
	`ob_¡¬t
();

83 
$dox
->
	`·štM‘hodS¹
('testAVerySimpleAgainAVerySimpleMethod');

84 
$bufãr
 = 
	`ob_g‘_ş—n
();

85 
$this
->
	`as£¹Equ®
('-‡ v”y sim¶agaš‡ v”y sim¶m‘hod', 
$bufãr
);

86 
	}
}

88 
funùiÚ
 
	$‹¡OnFau»ThisPrštsFau»NÙiû
() {

89 
$dox
 = 
Ãw
 
	`Te¡DoxR•Ü‹r
();

90 
	`ob_¡¬t
();

91 
$dox
->
	`·štFa
('');

92 
$bufãr
 = 
	`ob_g‘_ş—n
();

93 
$this
->
	`as£¹Equ®
(' [FAILED]', 
$bufãr
);

94 
	}
}

96 
funùiÚ
 
	$‹¡Wh’M©chšgM‘hodNamesTe¡P»fixIsCa£In£ns™ive
() {

97 
$dox
 = 
Ãw
 
	`Te¡DoxR•Ü‹r
();

98 
	`ob_¡¬t
();

99 
$dox
->
	`·štM‘hodS¹
('TESTSupportsAllUppercaseTestPrefixEvenThoughIDoNotKnowWhyYouWouldDoThat');

100 
$bufãr
 = 
	`ob_g‘_ş—n
();

101 
$this
->
	`as£¹Equ®
(

103 
$bufãr


105 
	}
}

	@F:\Site\stew\1\_lp\simpletest\form.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/tag.php');

13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/encoding.php');

14 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/selector.php');

22 şas 
	cSim¶eFÜm
 {

23 
´iv©e
 
	m$m‘hod
;

24 
´iv©e
 
	m$aùiÚ
;

25 
´iv©e
 
	m$’codšg
;

26 
´iv©e
 
	m$deçuÉ_rg‘
;

27 
´iv©e
 
	m$id
;

28 
´iv©e
 
	m$bu‰Ús
;

29 
´iv©e
 
	m$images
;

30 
´iv©e
 
	m$widg‘s
;

31 
´iv©e
 
	m$¿dios
;

32 
´iv©e
 
	m$checkboxes
;

39 
funùiÚ
 
	$__cÚ¡ruù
(
$g
, 
$·ge
) {

40 
$this
->
m‘hod
 = 
$g
->
	`g‘A‰ribu‹
('method');

41 
$this
->
aùiÚ
 = $this->
	`ü—‹AùiÚ
(
$g
->
	`g‘A‰ribu‹
('aùiÚ'), 
$·ge
);

42 
$this
->
’codšg
 = $this->
	`£tEncodšgCÏss
(
$g
);

43 
$this
->
deçuÉ_rg‘
 = 
çl£
;

44 
$this
->
id
 = 
$g
->
	`g‘A‰ribu‹
('id');

45 
$this
->
bu‰Ús
 = 
	`¬¿y
();

46 
$this
->
images
 = 
	`¬¿y
();

47 
$this
->
widg‘s
 = 
	`¬¿y
();

48 
$this
->
¿dios
 = 
	`¬¿y
();

49 
$this
->
checkboxes
 = 
	`¬¿y
();

58 
´Ùeùed
 
funùiÚ
 
	$£tEncodšgCÏss
(
$g
) {

59 ià(
	`¡¹Şow”
(
$g
->
	`g‘A‰ribu‹
('method')) == 'post') {

60 ià(
	`¡¹Şow”
(
$g
->
	`g‘A‰ribu‹
('enctype')) == 'multipart/form-data') {

66 
	}
}

73 
funùiÚ
 
	$£tDeçuÉT¬g‘
(
$äame
) {

74 
$this
->
deçuÉ_rg‘
 = 
$äame
;

75 
	}
}

82 
funùiÚ
 
	$g‘M‘hod
() {

83  (
$this
->
m‘hod
 ? 
	`¡¹Şow”
($this->method) : 'get');

84 
	}
}

93 
´Ùeùed
 
funùiÚ
 
	$ü—‹AùiÚ
(
$aùiÚ
, 
$·ge
) {

94 ià((
$aùiÚ
 ==ğ''è|| ($aùiÚ ==ğ
çl£
)) {

95  
$·ge
->
	`ex·ndU¾
($·ge->
	`g‘U¾
());

97  
$·ge
->
	`ex·ndU¾
(
Ãw
 
	`Sim¶eU¾
(
$aùiÚ
));;

98 
	}
}

105 
funùiÚ
 
	$g‘AùiÚ
() {

106 
$u¾
 = 
$this
->
aùiÚ
;

107 ià(
$this
->
deçuÉ_rg‘
 && ! 
$u¾
->
	`g‘T¬g‘
()) {

108 
$u¾
->
	`£tT¬g‘
(
$this
->
deçuÉ_rg‘
);

110 ià(
$this
->
	`g‘M‘hod
() == 'get') {

111 
$u¾
->
	`ş—rReque¡
();

113  
$u¾
;

114 
	}
}

122 
´Ùeùed
 
funùiÚ
 
	$’code
() {

123 
$şass
 = 
$this
->
’codšg
;

124 
$’codšg
 = 
Ãw
 
	`$şass
();

125 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$this
->
widg‘s
); $i < $count; $i++) {

126 
$this
->
widg‘s
[
$i
]->
	`wr™e
(
$’codšg
);

128  
$’codšg
;

129 
	}
}

136 
funùiÚ
 
	$g‘Id
() {

137  
$this
->
id
;

138 
	}
}

144 
funùiÚ
 
	$addWidg‘
(
$g
) {

145 ià(
	`¡¹Şow”
(
$g
->
	`g‘A‰ribu‹
('type')) == 'submit') {

146 
$this
->
bu‰Ús
[] = 
$g
;

147 } 
	`–£if
 (
	`¡¹Şow”
(
$g
->
	`g‘A‰ribu‹
('type')) == 'image') {

148 
$this
->
images
[] = 
$g
;

149 } 
	`–£if
 (
$g
->
	`g‘Name
()) {

150 
$this
->
	`£tWidg‘
(
$g
);

152 
	}
}

160 
´Ùeùed
 
funùiÚ
 
	$£tWidg‘
(
$g
) {

161 ià(
	`¡¹Şow”
(
$g
->
	`g‘A‰ribu‹
('type')) == 'radio') {

162 
$this
->
	`addRadioBu‰Ú
(
$g
);

163 } 
	`–£if
 (
	`¡¹Şow”
(
$g
->
	`g‘A‰ribu‹
('type')) == 'checkbox') {

164 
$this
->
	`addCheckbox
(
$g
);

166 
$this
->
widg‘s
[] = &
$g
;

168 
	}
}

175 
´Ùeùed
 
funùiÚ
 
	$addRadioBu‰Ú
(
$g
) {

176 ià(! 
	`is£t
(
$this
->
¿dios
[
$g
->
	`g‘Name
()])) {

177 
$this
->
widg‘s
[] = 
Ãw
 
	`Sim¶eRadioGroup
();

178 
$this
->
¿dios
[
$g
->
	`g‘Name
()] = 
	`couÁ
($this->
widg‘s
) - 1;

180 
$this
->
widg‘s
[$this->
¿dios
[
$g
->
	`g‘Name
()]]->
	`addWidg‘
($tag);

181 
	}
}

188 
´Ùeùed
 
funùiÚ
 
	$addCheckbox
(
$g
) {

189 ià(! 
	`is£t
(
$this
->
checkboxes
[
$g
->
	`g‘Name
()])) {

190 
$this
->
widg‘s
[] = 
$g
;

191 
$this
->
checkboxes
[
$g
->
	`g‘Name
()] = 
	`couÁ
($this->
widg‘s
) - 1;

193 
$šdex
 = 
$this
->
checkboxes
[
$g
->
	`g‘Name
()];

194 ià(! 
Sim¶eTe¡Com·tib™y
::
	`isA
(
$this
->
widg‘s
[
$šdex
], 'SimpleCheckboxGroup')) {

195 
$´evious
 = 
$this
->
widg‘s
[
$šdex
];

196 
$this
->
widg‘s
[
$šdex
] = 
Ãw
 
	`Sim¶eCheckboxGroup
();

197 
$this
->
widg‘s
[
$šdex
]->
	`addWidg‘
(
$´evious
);

199 
$this
->
widg‘s
[
$šdex
]->
	`addWidg‘
(
$g
);

201 
	}
}

210 
funùiÚ
 
	$g‘V®ue
(
$£ËùÜ
) {

211 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$this
->
widg‘s
); $i < $count; $i++) {

212 ià(
$£ËùÜ
->
	`isM©ch
(
$this
->
widg‘s
[
$i
])) {

213  
$this
->
widg‘s
[
$i
]->
	`g‘V®ue
();

216 
	`fÜ—ch
 (
$this
->
bu‰Ús
 
as
 
$bu‰Ú
) {

217 ià(
$£ËùÜ
->
	`isM©ch
(
$bu‰Ú
)) {

218  
$bu‰Ú
->
	`g‘V®ue
();

221  
nuÎ
;

222 
	}
}

233 
funùiÚ
 
	$£tF›ld
(
$£ËùÜ
, 
$v®ue
, 
$pos™iÚ
=
çl£
) {

234 
$sucûss
 = 
çl£
;

235 
$_pos™iÚ
 = 0;

236 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$this
->
widg‘s
); $i < $count; $i++) {

237 ià(
$£ËùÜ
->
	`isM©ch
(
$this
->
widg‘s
[
$i
])) {

238 
$_pos™iÚ
++;

239 ià(
$pos™iÚ
 ==ğ
çl£
 
Ü
 
$_pos™iÚ
 === ()$position) {

240 ià(
$this
->
widg‘s
[
$i
]->
	`£tV®ue
(
$v®ue
)) {

241 
$sucûss
 = 
Œue
;

246  
$sucûss
;

247 
	}
}

255 
funùiÚ
 
	$©chLab–ByS–eùÜ
(
$£ËùÜ
, 
$Ïb–
) {

256 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$this
->
widg‘s
); $i < $count; $i++) {

257 ià(
$£ËùÜ
->
	`isM©ch
(
$this
->
widg‘s
[
$i
])) {

258 ià(
	`m‘hod_exi¡s
(
$this
->
widg‘s
[
$i
], 'setLabel')) {

259 
$this
->
widg‘s
[
$i
]->
	`£tLab–
(
$Ïb–
);

264 
	}
}

272 
funùiÚ
 
	$hasSubm™
(
$£ËùÜ
) {

273 
	`fÜ—ch
 (
$this
->
bu‰Ús
 
as
 
$bu‰Ú
) {

274 ià(
$£ËùÜ
->
	`isM©ch
(
$bu‰Ú
)) {

275  
Œue
;

278  
çl£
;

279 
	}
}

287 
funùiÚ
 
	$hasImage
(
$£ËùÜ
) {

288 
	`fÜ—ch
 (
$this
->
images
 
as
 
$image
) {

289 ià(
$£ËùÜ
->
	`isM©ch
(
$image
)) {

290  
Œue
;

293  
çl£
;

294 
	}
}

305 
funùiÚ
 
	$subm™Bu‰Ú
(
$£ËùÜ
, 
$add™iÚ®
 = 
çl£
) {

306 
$add™iÚ®
 = $add™iÚ® ? $add™iÚ® : 
	`¬¿y
();

307 
	`fÜ—ch
 (
$this
->
bu‰Ús
 
as
 
$bu‰Ú
) {

308 ià(
$£ËùÜ
->
	`isM©ch
(
$bu‰Ú
)) {

309 
$’codšg
 = 
$this
->
	`’code
();

310 
$bu‰Ú
->
	`wr™e
(
$’codšg
);

311 ià(
$add™iÚ®
) {

312 
$’codšg
->
	`m”ge
(
$add™iÚ®
);

314  
$’codšg
;

317  
çl£
;

318 
	}
}

331 
funùiÚ
 
	$subm™Image
(
$£ËùÜ
, 
$x
, 
$y
, 
$add™iÚ®
 = 
çl£
) {

332 
$add™iÚ®
 = $add™iÚ® ? $add™iÚ® : 
	`¬¿y
();

333 
	`fÜ—ch
 (
$this
->
images
 
as
 
$image
) {

334 ià(
$£ËùÜ
->
	`isM©ch
(
$image
)) {

335 
$’codšg
 = 
$this
->
	`’code
();

336 
$image
->
	`wr™e
(
$’codšg
, 
$x
, 
$y
);

337 ià(
$add™iÚ®
) {

338 
$’codšg
->
	`m”ge
(
$add™iÚ®
);

340  
$’codšg
;

343  
çl£
;

344 
	}
}

353 
funùiÚ
 
	$subm™
(
$add™iÚ®
 = 
çl£
) {

354 
$’codšg
 = 
$this
->
	`’code
();

355 ià(
$add™iÚ®
) {

356 
$’codšg
->
	`m”ge
(
$add™iÚ®
);

358  
$’codšg
;

359 
	}
}

	@F:\Site\stew\1\_lp\simpletest\frames.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/page.php');

13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/user_agent.php');

24 şas 
	cSim¶eF¿me£t
 {

25 
´iv©e
 
	m$äame£t
;

26 
´iv©e
 
	m$äames
;

27 
´iv©e
 
	m$focus
;

28 
´iv©e
 
	m$Çmes
;

35 
funùiÚ
 
	$__cÚ¡ruù
(
$·ge
) {

36 
$this
->
äame£t
 = 
$·ge
;

37 
$this
->
äames
 = 
	`¬¿y
();

38 
$this
->
focus
 = 
çl£
;

39 
$this
->
Çmes
 = 
	`¬¿y
();

48 
funùiÚ
 
	$addF¿me
(
$·ge
, 
$Çme
 = 
çl£
) {

49 
$this
->
äames
[] = 
$·ge
;

50 ià(
$Çme
) {

51 
$this
->
Çmes
[
$Çme
] = 
	`couÁ
($this->
äames
) - 1;

53 
	}
}

63 
funùiÚ
 
	$£tF¿me
(
$·th
, 
$·ge
) {

64 
$Çme
 = 
	`¬¿y_shiá
(
$·th
);

65 ià(
	`is£t
(
$this
->
Çmes
[
$Çme
])) {

66 
$šdex
 = 
$this
->
Çmes
[
$Çme
];

68 
$šdex
 = 
$Çme
 - 1;

70 ià(
	`couÁ
(
$·th
) == 0) {

71 
$this
->
äames
[
$šdex
] = &
$·ge
;

74 
$this
->
äames
[
$šdex
]->
	`£tF¿me
(
$·th
, 
$·ge
);

75 
	}
}

84 
funùiÚ
 
	$g‘F¿meFocus
() {

85 ià(
$this
->
focus
 ==ğ
çl£
) {

86  
	`¬¿y
();

88  
	`¬¿y_m”ge
(

89 
	`¬¿y
(
$this
->
	`g‘PublicNameFromIndex
($this->
focus
)),

90 
$this
->
äames
[$this->
focus
]->
	`g‘F¿meFocus
());

91 
	}
}

101 
´Ùeùed
 
funùiÚ
 
	$g‘PublicNameFromIndex
(
$subjeù
) {

102 
	`fÜ—ch
 (
$this
->
Çmes
 
as
 
$Çme
 => 
$šdex
) {

103 ià(
$subjeù
 =ğ
$šdex
) {

104  
$Çme
;

107  
$subjeù
 + 1;

108 
	}
}

118 
funùiÚ
 
	$£tF¿meFocusByIndex
(
$choiû
) {

119 ià(
	`is_š‹g”
(
$this
->
focus
)) {

120 ià(
$this
->
äames
[$this->
focus
]->
	`hasF¿mes
()) {

121  
$this
->
äames
[$this->
focus
]->
	`£tF¿meFocusByIndex
(
$choiû
);

124 ià((
$choiû
 < 1è|| ($choiû > 
	`couÁ
(
$this
->
äames
))) {

125  
çl£
;

127 
$this
->
focus
 = 
$choiû
 - 1;

128  
Œue
;

129 
	}
}

139 
funùiÚ
 
	$£tF¿meFocus
(
$Çme
) {

140 ià(
	`is_š‹g”
(
$this
->
focus
)) {

141 ià(
$this
->
äames
[$this->
focus
]->
	`hasF¿mes
()) {

142  
$this
->
äames
[$this->
focus
]->
	`£tF¿meFocus
(
$Çme
);

145 ià(
	`š_¬¿y
(
$Çme
, 
	`¬¿y_keys
(
$this
->
Çmes
))) {

146 
$this
->
focus
 = $this->
Çmes
[
$Çme
];

147  
Œue
;

149  
çl£
;

150 
	}
}

156 
funùiÚ
 
	$ş—rF¿meFocus
() {

157 
$this
->
focus
 = 
çl£
;

158 
$this
->
	`ş—rNe¡edF¿mesFocus
();

159 
	}
}

165 
´Ùeùed
 
funùiÚ
 
	$ş—rNe¡edF¿mesFocus
() {

166 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
äames
); $i++) {

167 
$this
->
äames
[
$i
]->
	`ş—rF¿meFocus
();

169 
	}
}

176 
funùiÚ
 
	$hasF¿mes
() {

177  
Œue
;

178 
	}
}

187 
funùiÚ
 
	$g‘F¿mes
() {

188 
$»pÜt
 = 
	`¬¿y
();

189 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
äames
); $i++) {

190 
$»pÜt
[
$this
->
	`g‘PublicNameFromIndex
(
$i
)] =

191 
$this
->
äames
[
$i
]->
	`g‘F¿mes
();

193  
$»pÜt
;

194 
	}
}

202 
funùiÚ
 
	$g‘Raw
() {

203 ià(
	`is_š‹g”
(
$this
->
focus
)) {

204  
$this
->
äames
[$this->
focus
]->
	`g‘Raw
();

206 
$¿w
 = '';

207 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
äames
); $i++) {

208 
$¿w
 .ğ
$this
->
äames
[
$i
]->
	`g‘Raw
();

210  
$¿w
;

211 
	}
}

219 
funùiÚ
 
	$g‘Text
() {

220 ià(
	`is_š‹g”
(
$this
->
focus
)) {

221  
$this
->
äames
[$this->
focus
]->
	`g‘Text
();

223 
$¿w
 = '';

224 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
äames
); $i++) {

225 
$¿w
 .ğ' ' . 
$this
->
äames
[
$i
]->
	`g‘Text
();

227  
	`Œim
(
$¿w
);

228 
	}
}

235 
funùiÚ
 
	$g‘T¿n¥ÜtE¼Ü
() {

236 ià(
	`is_š‹g”
(
$this
->
focus
)) {

237  
$this
->
äames
[$this->
focus
]->
	`g‘T¿n¥ÜtE¼Ü
();

239  
$this
->
äame£t
->
	`g‘T¿n¥ÜtE¼Ü
();

240 
	}
}

247 
funùiÚ
 
	$g‘M‘hod
() {

248 ià(
	`is_š‹g”
(
$this
->
focus
)) {

249  
$this
->
äames
[$this->
focus
]->
	`g‘M‘hod
();

251  
$this
->
äame£t
->
	`g‘M‘hod
();

252 
	}
}

259 
funùiÚ
 
	$g‘U¾
() {

260 ià(
	`is_š‹g”
(
$this
->
focus
)) {

261 
$u¾
 = 
$this
->
äames
[$this->
focus
]->
	`g‘U¾
();

262 
$u¾
->
	`£tT¬g‘
(
$this
->
	`g‘PublicNameFromIndex
($this->
focus
));

264 
$u¾
 = 
$this
->
äame£t
->
	`g‘U¾
();

266  
$u¾
;

267 
	}
}

274 
funùiÚ
 
	$g‘Ba£U¾
() {

275 ià(
	`is_š‹g”
(
$this
->
focus
)) {

276 
$u¾
 = 
$this
->
äames
[$this->
focus
]->
	`g‘Ba£U¾
();

278 
$u¾
 = 
$this
->
äame£t
->
	`g‘Ba£U¾
();

280  
$u¾
;

281 
	}
}

290 
funùiÚ
 
	$ex·ndU¾
(
$u¾
) {

291  
$this
->
äame£t
->
	`ex·ndU¾
(
$u¾
);

292 
	}
}

299 
funùiÚ
 
	$g‘Reque¡D©a
() {

300 ià(
	`is_š‹g”
(
$this
->
focus
)) {

301  
$this
->
äames
[$this->
focus
]->
	`g‘Reque¡D©a
();

303  
$this
->
äame£t
->
	`g‘Reque¡D©a
();

304 
	}
}

311 
funùiÚ
 
	$g‘MimeTy³
() {

312 ià(
	`is_š‹g”
(
$this
->
focus
)) {

313  
$this
->
äames
[$this->
focus
]->
	`g‘MimeTy³
();

315  
$this
->
äame£t
->
	`g‘MimeTy³
();

316 
	}
}

323 
funùiÚ
 
	$g‘Re¥Ú£Code
() {

324 ià(
	`is_š‹g”
(
$this
->
focus
)) {

325  
$this
->
äames
[$this->
focus
]->
	`g‘Re¥Ú£Code
();

327  
$this
->
äame£t
->
	`g‘Re¥Ú£Code
();

328 
	}
}

336 
funùiÚ
 
	$g‘Auth’tiÿtiÚ
() {

337 ià(
	`is_š‹g”
(
$this
->
focus
)) {

338  
$this
->
äames
[$this->
focus
]->
	`g‘Auth’tiÿtiÚ
();

340  
$this
->
äame£t
->
	`g‘Auth’tiÿtiÚ
();

341 
	}
}

349 
funùiÚ
 
	$g‘R—lm
() {

350 ià(
	`is_š‹g”
(
$this
->
focus
)) {

351  
$this
->
äames
[$this->
focus
]->
	`g‘R—lm
();

353  
$this
->
äame£t
->
	`g‘R—lm
();

354 
	}
}

361 
funùiÚ
 
	$g‘Reque¡
() {

362 ià(
	`is_š‹g”
(
$this
->
focus
)) {

363  
$this
->
äames
[$this->
focus
]->
	`g‘Reque¡
();

365  
$this
->
äame£t
->
	`g‘Reque¡
();

366 
	}
}

373 
funùiÚ
 
	$g‘H—d”s
() {

374 ià(
	`is_š‹g”
(
$this
->
focus
)) {

375  
$this
->
äames
[$this->
focus
]->
	`g‘H—d”s
();

377  
$this
->
äame£t
->
	`g‘H—d”s
();

378 
	}
}

385 
funùiÚ
 
	$g‘T™Ë
() {

386  
$this
->
äame£t
->
	`g‘T™Ë
();

387 
	}
}

394 
funùiÚ
 
	$g‘U¾s
() {

395 ià(
	`is_š‹g”
(
$this
->
focus
)) {

396  
$this
->
äames
[$this->
focus
]->
	`g‘U¾s
();

398 
$u¾s
 = 
	`¬¿y
();

399 
	`fÜ—ch
 (
$this
->
äames
 
as
 
$äame
) {

400 
$u¾s
 = 
	`¬¿y_m”ge
($u¾s, 
$äame
->
	`g‘U¾s
());

402  
	`¬¿y_v®ues
(
	`¬¿y_unique
(
$u¾s
));

403 
	}
}

412 
funùiÚ
 
	$g‘U¾sByLab–
(
$Ïb–
) {

413 ià(
	`is_š‹g”
(
$this
->
focus
)) {

414  
$this
->
	`gU¾sW™hF¿me
(

415 
$this
->
äames
[$this->
focus
]->
	`g‘U¾sByLab–
(
$Ïb–
),

416 
$this
->
focus
);

418 
$u¾s
 = 
	`¬¿y
();

419 
	`fÜ—ch
 (
$this
->
äames
 
as
 
$šdex
 => 
$äame
) {

420 
$u¾s
 = 
	`¬¿y_m”ge
(

421 
$u¾s
,

422 
$this
->
	`gU¾sW™hF¿me
(

423 
$äame
->
	`g‘U¾sByLab–
(
$Ïb–
),

424 
$šdex
));

426  
$u¾s
;

427 
	}
}

438 
funùiÚ
 
	$g‘U¾ById
(
$id
) {

439 
	`fÜ—ch
 (
$this
->
äames
 
as
 
$šdex
 => 
$äame
) {

440 ià(
$u¾
 = 
$äame
->
	`g‘U¾ById
(
$id
)) {

441 ià(! 
$u¾
->
	`g‘rg‘
()) {

442 
$u¾
->
	`£tT¬g‘
(
$this
->
	`g‘PublicNameFromIndex
(
$šdex
));

444  
$u¾
;

447  
çl£
;

448 
	}
}

457 
´Ùeùed
 
funùiÚ
 
	$gU¾sW™hF¿me
(
$u¾s
, 
$äame
) {

458 
$gged
 = 
	`¬¿y
();

459 
	`fÜ—ch
 (
$u¾s
 
as
 
$u¾
) {

460 ià(! 
$u¾
->
	`g‘T¬g‘
()) {

461 
$u¾
->
	`£tT¬g‘
(
$this
->
	`g‘PublicNameFromIndex
(
$äame
));

463 
$gged
[] = 
$u¾
;

465  
$gged
;

466 
	}
}

476 
funùiÚ
 
	$g‘FÜmBySubm™
(
$£ËùÜ
) {

477  
$this
->
	`fšdFÜm
('g‘FÜmBySubm™', 
$£ËùÜ
);

478 
	}
}

490 
funùiÚ
 
	$g‘FÜmByImage
(
$£ËùÜ
) {

491  
$this
->
	`fšdFÜm
('g‘FÜmByImage', 
$£ËùÜ
);

492 
	}
}

504 
funùiÚ
 
	$g‘FÜmById
(
$id
) {

505  
$this
->
	`fšdFÜm
('g‘FÜmById', 
$id
);

506 
	}
}

516 
´Ùeùed
 
funùiÚ
 
	$fšdFÜm
(
$m‘hod
, 
$©Œibu‹
) {

517 ià(
	`is_š‹g”
(
$this
->
focus
)) {

518  
$this
->
	`fšdFÜmInF¿me
(

519 
$this
->
äames
[$this->
focus
],

520 
$this
->
focus
,

521 
$m‘hod
,

522 
$©Œibu‹
);

524 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
äames
); $i++) {

525 
$fÜm
 = 
$this
->
	`fšdFÜmInF¿me
(

526 
$this
->
äames
[
$i
],

527 
$i
,

528 
$m‘hod
,

529 
$©Œibu‹
);

530 ià(
$fÜm
) {

531  
$fÜm
;

534 
$nuÎ
 = 
nuÎ
;

535  
$nuÎ
;

536 
	}
}

548 
´Ùeùed
 
funùiÚ
 
	$fšdFÜmInF¿me
(
$·ge
, 
$šdex
, 
$m‘hod
, 
$©Œibu‹
) {

549 
$fÜm
 = 
$this
->
äames
[
$šdex
]->
	`$m‘hod
(
$©Œibu‹
);

550 ià(
	`is£t
(
$fÜm
)) {

551 
$fÜm
->
	`£tDeçuÉT¬g‘
(
$this
->
	`g‘PublicNameFromIndex
(
$šdex
));

553  
$fÜm
;

554 
	}
}

564 
funùiÚ
 
	$£tF›ld
(
$£ËùÜ
, 
$v®ue
) {

565 ià(
	`is_š‹g”
(
$this
->
focus
)) {

566 
$this
->
äames
[$this->
focus
]->
	`£tF›ld
(
$£ËùÜ
, 
$v®ue
);

568 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
äames
); $i++) {

569 
$this
->
äames
[
$i
]->
	`£tF›ld
(
$£ËùÜ
, 
$v®ue
);

572 
	}
}

582 
funùiÚ
 
	$g‘F›ld
(
$£ËùÜ
) {

583 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
äames
); $i++) {

584 
$v®ue
 = 
$this
->
äames
[
$i
]->
	`g‘F›ld
(
$£ËùÜ
);

585 ià(
	`is£t
(
$v®ue
)) {

586  
$v®ue
;

589  
nuÎ
;

590 
	}
}

	@F:\Site\stew\1\_lp\simpletest\http.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/socket.php');

13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/cookies.php');

14 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/url.php');

23 şas 
	cSim¶eRou‹
 {

24 
´iv©e
 
	m$u¾
;

31 
funùiÚ
 
	$__cÚ¡ruù
(
$u¾
) {

32 
$this
->
u¾
 = 
$u¾
;

40 
funùiÚ
 
	$g‘U¾
() {

41  
$this
->
u¾
;

42 
	}
}

50 
´Ùeùed
 
funùiÚ
 
	$g‘Reque¡Lše
(
$m‘hod
) {

51  
$m‘hod
 . ' ' . 
$this
->
u¾
->
	`g‘P©h
() .

52 
$this
->
u¾
->
	`g‘EncodedReque¡
() . ' HTTP/1.0';

53 
	}
}

60 
´Ùeùed
 
funùiÚ
 
	$g‘Ho¡Lše
() {

61 
$lše
 = 'Ho¡: ' . 
$this
->
u¾
->
	`g‘Ho¡
();

62 ià(
$this
->
u¾
->
	`g‘PÜt
()) {

63 
$lše
 .ğ':' . 
$this
->
u¾
->
	`g‘PÜt
();

65  
$lše
;

66 
	}
}

75 
funùiÚ
 
	$ü—‹CÚÃùiÚ
(
$m‘hod
, 
$timeout
) {

76 
$deçuÉ_pÜt
 = ('h‰ps' =ğ
$this
->
u¾
->
	`g‘Scheme
()) ? 443 : 80;

77 
$sock‘
 = 
$this
->
	`ü—‹Sock‘
(

78 
$this
->
u¾
->
	`g‘Scheme
() ? $this->url->getScheme() : 'http',

79 
$this
->
u¾
->
	`g‘Ho¡
(),

80 
$this
->
u¾
->
	`g‘PÜt
(è? $this->u¾->g‘PÜt(è: 
$deçuÉ_pÜt
,

81 
$timeout
);

82 ià(! 
$sock‘
->
	`isE¼Ü
()) {

83 
$sock‘
->
	`wr™e
(
$this
->
	`g‘Reque¡Lše
(
$m‘hod
) . "\r\n");

84 
$sock‘
->
	`wr™e
(
$this
->
	`g‘Ho¡Lše
() . "\r\n");

85 
$sock‘
->
	`wr™e
("Connection: close\r\n");

87  
$sock‘
;

88 
	}
}

99 
´Ùeùed
 
funùiÚ
 
	$ü—‹Sock‘
(
$scheme
, 
$ho¡
, 
$pÜt
, 
$timeout
) {

100 ià(
	`š_¬¿y
(
$scheme
, 
	`¬¿y
('file'))) {

101  
Ãw
 
	`Sim¶eFeSock‘
(
$this
->
u¾
);

102 } 
	`–£if
 (
	`š_¬¿y
(
$scheme
, 
	`¬¿y
('https'))) {

103  
Ãw
 
	`Sim¶eSecu»Sock‘
(
$ho¡
, 
$pÜt
, 
$timeout
);

105  
Ãw
 
	`Sim¶eSock‘
(
$ho¡
, 
$pÜt
, 
$timeout
);

107 
	}
}

116 şas 
	cSim¶eProxyRou‹
 
ex‹nds
 
	mSim¶eRou‹
 {

117 
´iv©e
 
	m$´oxy
;

118 
´iv©e
 
	m$u£ºame
;

119 
´iv©e
 
	m$·sswÜd
;

129 
funùiÚ
 
	$__cÚ¡ruù
(
$u¾
, 
$´oxy
, 
$u£ºame
 = 
çl£
, 
$·sswÜd
 = false) {

130 
·»Á
::
	`__cÚ¡ruù
(
$u¾
);

131 
$this
->
´oxy
 = 
$´oxy
;

132 
$this
->
u£ºame
 = 
$u£ºame
;

133 
$this
->
·sswÜd
 = 
$·sswÜd
;

143 
funùiÚ
 
	$g‘Reque¡Lše
(
$m‘hod
) {

144 
$u¾
 = 
$this
->
	`g‘U¾
();

145 
$scheme
 = 
$u¾
->
	`g‘Scheme
() ? $url->getScheme() : 'http';

146 
$pÜt
 = 
$u¾
->
	`g‘PÜt
() ? ':' . $url->getPort() : '';

147  
$m‘hod
 . ' ' . 
$scheme
 . '://' . 
$u¾
->
	`g‘Ho¡
(è. 
$pÜt
 .

148 
$u¾
->
	`g‘P©h
(è. $u¾->
	`g‘EncodedReque¡
() . ' HTTP/1.0';

149 
	}
}

157 
funùiÚ
 
	$g‘Ho¡Lše
() {

158 
$ho¡
 = 'Ho¡: ' . 
$this
->
´oxy
->
	`g‘Ho¡
();

159 
$pÜt
 = 
$this
->
´oxy
->
	`g‘PÜt
() ? $this->proxy->getPort() : 8080;

161 
	}
}

170 
funùiÚ
 
	$ü—‹CÚÃùiÚ
(
$m‘hod
, 
$timeout
) {

171 
$sock‘
 = 
$this
->
	`ü—‹Sock‘
(

172 
$this
->
´oxy
->
	`g‘Scheme
() ? $this->proxy->getScheme() : 'http',

173 
$this
->
´oxy
->
	`g‘Ho¡
(),

174 
$this
->
´oxy
->
	`g‘PÜt
() ? $this->proxy->getPort() : 8080,

175 
$timeout
);

176 ià(
$sock‘
->
	`isE¼Ü
()) {

177  
$sock‘
;

179 
$sock‘
->
	`wr™e
(
$this
->
	`g‘Reque¡Lše
(
$m‘hod
) . "\r\n");

180 
$sock‘
->
	`wr™e
(
$this
->
	`g‘Ho¡Lše
() . "\r\n");

181 ià(
$this
->
u£ºame
 && $this->
·sswÜd
) {

182 
$sock‘
->
	`wr™e
('Proxy-Authorization: Basic ' .

183 
	`ba£64_’code
(
$this
->
u£ºame
 . ':' . $this->
·sswÜd
) .

186 
$sock‘
->
	`wr™e
("Connection: close\r\n");

187  
$sock‘
;

188 
	}
}

197 şas 
	cSim¶eH‰pReque¡
 {

198 
´iv©e
 
	m$rou‹
;

199 
´iv©e
 
	m$’codšg
;

200 
´iv©e
 
	m$h—d”s
;

201 
´iv©e
 
	m$cook›s
;

212 
funùiÚ
 
	$__cÚ¡ruù
(
$rou‹
, 
$’codšg
) {

213 
$this
->
rou‹
 = 
$rou‹
;

214 
$this
->
’codšg
 = 
$’codšg
;

215 
$this
->
h—d”s
 = 
	`¬¿y
();

216 
$this
->
cook›s
 = 
	`¬¿y
();

227 
funùiÚ
 
	$ãtch
(
$timeout
) {

228 
$sock‘
 = 
$this
->
rou‹
->
	`ü—‹CÚÃùiÚ
($this->
’codšg
->
	`g‘M‘hod
(), 
$timeout
);

229 ià(! 
$sock‘
->
	`isE¼Ü
()) {

230 
$this
->
	`di¥©chReque¡
(
$sock‘
, $this->
’codšg
);

232  
$this
->
	`ü—‹Re¥Ú£
(
$sock‘
);

233 
	}
}

243 
´Ùeùed
 
funùiÚ
 
	$di¥©chReque¡
(
$sock‘
, 
$’codšg
) {

244 
	`fÜ—ch
 (
$this
->
h—d”s
 
as
 
$h—d”_lše
) {

245 
$sock‘
->
	`wr™e
(
$h—d”_lše
 . "\r\n");

247 ià(
	`couÁ
(
$this
->
cook›s
) > 0) {

248 
$sock‘
->
	`wr™e
("Cook›: " . 
	`im¶ode
(";", 
$this
->
cook›s
) . "\r\n");

250 
$’codšg
->
	`wr™eH—d”sTo
(
$sock‘
);

251 
$sock‘
->
	`wr™e
("\r\n");

252 
$’codšg
->
	`wr™eTo
(
$sock‘
);

253 
	}
}

260 
funùiÚ
 
	$addH—d”Lše
(
$h—d”_lše
) {

261 
$this
->
h—d”s
[] = 
$h—d”_lše
;

262 
	}
}

271 
funùiÚ
 
	$»adCook›sFromJ¬
(
$j¬
, 
$u¾
) {

272 
$this
->
cook›s
 = 
$j¬
->
	`£ËùAsPaœs
(
$u¾
);

273 
	}
}

281 
´Ùeùed
 
funùiÚ
 
	$ü—‹Re¥Ú£
(
$sock‘
) {

282 
$»¥Ú£
 = 
Ãw
 
	`Sim¶eH‰pRe¥Ú£
(

283 
$sock‘
,

284 
$this
->
rou‹
->
	`g‘U¾
(),

285 
$this
->
’codšg
);

286 
$sock‘
->
	`şo£
();

287  
$»¥Ú£
;

288 
	}
}

296 şas 
	cSim¶eH‰pH—d”s
 {

297 
´iv©e
 
	m$¿w_h—d”s
;

298 
´iv©e
 
	m$»¥Ú£_code
;

299 
´iv©e
 
	m$h‰p_v”siÚ
;

300 
´iv©e
 
	m$mime_ty³
;

301 
´iv©e
 
	m$loÿtiÚ
;

302 
´iv©e
 
	m$cook›s
;

303 
´iv©e
 
	m$auth’tiÿtiÚ
;

304 
´iv©e
 
	m$»®m
;

311 
funùiÚ
 
	$__cÚ¡ruù
(
$h—d”s
) {

312 
$this
->
¿w_h—d”s
 = 
$h—d”s
;

313 
$this
->
»¥Ú£_code
 = 
çl£
;

314 
$this
->
h‰p_v”siÚ
 = 
çl£
;

315 
$this
->
mime_ty³
 = '';

316 
$this
->
loÿtiÚ
 = 
çl£
;

317 
$this
->
cook›s
 = 
	`¬¿y
();

318 
$this
->
auth’tiÿtiÚ
 = 
çl£
;

319 
$this
->
»®m
 = 
çl£
;

320 
	`fÜ—ch
 (
	`ex¶ode
("\r\n", 
$h—d”s
è
as
 
$h—d”_lše
) {

321 
$this
->
	`·r£H—d”Lše
(
$h—d”_lše
);

330 
funùiÚ
 
	$g‘H‰pV”siÚ
() {

331  
$this
->
h‰p_v”siÚ
;

332 
	}
}

339 
funùiÚ
 
	$g‘Raw
() {

340  
$this
->
¿w_h—d”s
;

341 
	}
}

348 
funùiÚ
 
	$g‘Re¥Ú£Code
() {

349  (
š‹g”
)
$this
->
»¥Ú£_code
;

350 
	}
}

358 
funùiÚ
 
	$g‘LoÿtiÚ
() {

359  
$this
->
loÿtiÚ
;

360 
	}
}

367 
funùiÚ
 
	$isRedœeù
() {

368  
	`š_¬¿y
(
$this
->
»¥Ú£_code
, 
	`¬¿y
(301, 302, 303, 307)) &&

369 (
boŞ—n
)
$this
->
	`g‘LoÿtiÚ
();

370 
	}
}

378 
funùiÚ
 
	$isCh®Ënge
() {

379  (
$this
->
»¥Ú£_code
 == 401) &&

380 (
boŞ—n
)
$this
->
auth’tiÿtiÚ
 &&

381 (
boŞ—n
)
$this
->
»®m
;

382 
	}
}

389 
funùiÚ
 
	$g‘MimeTy³
() {

390  
$this
->
mime_ty³
;

391 
	}
}

398 
funùiÚ
 
	$g‘Auth’tiÿtiÚ
() {

399  
$this
->
auth’tiÿtiÚ
;

400 
	}
}

407 
funùiÚ
 
	$g‘R—lm
() {

408  
$this
->
»®m
;

409 
	}
}

417 
funùiÚ
 
	$wr™eCook›sToJ¬
(
$j¬
, 
$u¾
) {

418 
	`fÜ—ch
 (
$this
->
cook›s
 
as
 
$cook›
) {

419 
$j¬
->
	`£tCook›
(

420 
$cook›
->
	`g‘Name
(),

421 
$cook›
->
	`g‘V®ue
(),

422 
$u¾
->
	`g‘Ho¡
(),

423 
$cook›
->
	`g‘P©h
(),

424 
$cook›
->
	`g‘Expœy
());

426 
	}
}

434 
´Ùeùed
 
funùiÚ
 
	$·r£H—d”Lše
(
$h—d”_lše
) {

435 ià(
	`´eg_m©ch
('/HTTP\/(\d+\.\d+)\s+(\d+)/i', 
$h—d”_lše
, 
$m©ches
)) {

436 
$this
->
h‰p_v”siÚ
 = 
$m©ches
[1];

437 
$this
->
»¥Ú£_code
 = 
$m©ches
[2];

439 ià(
	`´eg_m©ch
('/CÚ‹Á-ty³:\s*(.*)/i', 
$h—d”_lše
, 
$m©ches
)) {

440 
$this
->
mime_ty³
 = 
	`Œim
(
$m©ches
[1]);

442 ià(
	`´eg_m©ch
('/LoÿtiÚ:\s*(.*)/i', 
$h—d”_lše
, 
$m©ches
)) {

443 
$this
->
loÿtiÚ
 = 
	`Œim
(
$m©ches
[1]);

445 ià(
	`´eg_m©ch
('/S‘-cook›:(.*)/i', 
$h—d”_lše
, 
$m©ches
)) {

446 
$this
->
cook›s
[] = $this->
	`·r£Cook›
(
$m©ches
[1]);

448 ià(
	`´eg_m©ch
('/WWW-Auth’tiÿ‹:\s+(\S+)\s+»®m=\"(.*?)\"/i', 
$h—d”_lše
, 
$m©ches
)) {

449 
$this
->
auth’tiÿtiÚ
 = 
$m©ches
[1];

450 
$this
->
»®m
 = 
	`Œim
(
$m©ches
[2]);

452 
	}
}

460 
´Ùeùed
 
funùiÚ
 
	$·r£Cook›
(
$cook›_lše
) {

461 
$·¹s
 = 
	`ex¶ode
(";", 
$cook›_lše
);

462 
$cook›
 = 
	`¬¿y
();

463 
	`´eg_m©ch
('/\s*(.*?)\s*=(.*)/', 
	`¬¿y_shiá
(
$·¹s
), 
$cook›
);

464 
	`fÜ—ch
 (
$·¹s
 
as
 
$·¹
) {

465 ià(
	`´eg_m©ch
('/\s*(.*?)\s*=(.*)/', 
$·¹
, 
$m©ches
)) {

466 
$cook›
[
$m©ches
[1]] = 
	`Œim
($matches[2]);

469  
Ãw
 
	`Sim¶eCook›
(

470 
$cook›
[1],

471 
	`Œim
(
$cook›
[2]),

472 
	`is£t
(
$cook›
["path"]) ? $cookie["path"] : "",

473 
	`is£t
(
$cook›
["expœes"]è? $cook›["expœes"] : 
çl£
);

474 
	}
}

482 şas 
	cSim¶eH‰pRe¥Ú£
 
ex‹nds
 
	mSim¶eStickyE¼Ü
 {

483 
´iv©e
 
	m$u¾
;

484 
´iv©e
 
	m$’codšg
;

485 
´iv©e
 
	m$£Á
;

486 
´iv©e
 
	m$cÚ‹Á
;

487 
´iv©e
 
	m$h—d”s
;

498 
funùiÚ
 
	$__cÚ¡ruù
(
$sock‘
, 
$u¾
, 
$’codšg
) {

499 
·»Á
::
	`__cÚ¡ruù
();

500 
$this
->
u¾
 = 
$u¾
;

501 
$this
->
’codšg
 = 
$’codšg
;

502 
$this
->
£Á
 = 
$sock‘
->
	`g‘S’t
();

503 
$this
->
cÚ‹Á
 = 
çl£
;

504 
$¿w
 = 
$this
->
	`»adAÎ
(
$sock‘
);

505 ià(
$sock‘
->
	`isE¼Ü
()) {

506 
$this
->
	`£tE¼Ü
('E¼Ü„—dšg sock‘ [' . 
$sock‘
->
	`g‘E¼Ü
() . ']');

509 
$this
->
	`·r£
(
$¿w
);

517 
´Ùeùed
 
funùiÚ
 
	$·r£
(
$¿w
) {

518 ià(! 
$¿w
) {

519 
$this
->
	`£tE¼Ü
('Nothing fetched');

520 
$this
->
h—d”s
 = 
Ãw
 
	`Sim¶eH‰pH—d”s
('');

521 } 
	`–£if
 ('fe' =ğ
$this
->
u¾
->
	`g‘Scheme
()) {

522 
$this
->
h—d”s
 = 
Ãw
 
	`Sim¶eH‰pH—d”s
('');

523 
$this
->
cÚ‹Á
 = 
$¿w
;

524 } 
	`–£if
 (! 
	`¡r¡r
(
$¿w
, "\r\n\r\n")) {

525 
$this
->
	`£tE¼Ü
('Could‚ot split headers from content');

526 
$this
->
h—d”s
 = 
Ãw
 
	`Sim¶eH‰pH—d”s
(
$¿w
);

528 
	`li¡
(
$h—d”s
, 
$this
->
cÚ‹Á
èğ
	`ex¶ode
("\r\n\r\n", 
$¿w
, 2);

529 
$this
->
h—d”s
 = 
Ãw
 
	`Sim¶eH‰pH—d”s
(
$h—d”s
);

531 
	}
}

538 
funùiÚ
 
	$g‘M‘hod
() {

539  
$this
->
’codšg
->
	`g‘M‘hod
();

540 
	}
}

547 
funùiÚ
 
	$g‘U¾
() {

548  
$this
->
u¾
;

549 
	}
}

556 
funùiÚ
 
	$g‘Reque¡D©a
() {

557  
$this
->
’codšg
;

558 
	}
}

565 
funùiÚ
 
	$g‘S’t
() {

566  
$this
->
£Á
;

567 
	}
}

575 
funùiÚ
 
	$g‘CÚ‹Á
() {

576  
$this
->
cÚ‹Á
;

577 
	}
}

585 
funùiÚ
 
	$g‘H—d”s
() {

586  
$this
->
h—d”s
;

587 
	}
}

594 
funùiÚ
 
	$g‘NewCook›s
() {

595  
$this
->
h—d”s
->
	`g‘NewCook›s
();

596 
	}
}

606 
´Ùeùed
 
funùiÚ
 
	$»adAÎ
(
$sock‘
) {

607 
$®l
 = '';

608 ! 
$this
->
	`isLa¡Pack‘
(
$Ãxt
 = 
$sock‘
->
	`»ad
())) {

609 
$®l
 .ğ
$Ãxt
;

611  
$®l
;

612 
	}
}

621 
´Ùeùed
 
funùiÚ
 
	$isLa¡Pack‘
(
$·ck‘
) {

622 ià(
	`is_¡ršg
(
$·ck‘
)) {

623  
$·ck‘
 === '';

625  ! 
$·ck‘
;

626 
	}
}

	@F:\Site\stew\1\_lp\simpletest\invoker.php

1 <?
php


13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/errors.php');

14 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/compatibility.php');

15 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/scorer.php');

16 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/expectation.php');

17 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/dumper.php');

18 ià(! 
defšed
('SIMPLE_TEST')) {

19 
defše
('SIMPLE_TEST', 
dœÇme
(
__FILE__
) . '/');

30 şas 
	cSim¶eInvok”
 {

31 
´iv©e
 
	m$‹¡_ÿ£
;

37 
funùiÚ
 
	$__cÚ¡ruù
(
$‹¡_ÿ£
) {

38 
$this
->
‹¡_ÿ£
 = 
$‹¡_ÿ£
;

46 
funùiÚ
 
	$g‘Te¡Ca£
() {

47  
$this
->
‹¡_ÿ£
;

48 
	}
}

56 
funùiÚ
 
	$befÜe
(
$m‘hod
) {

57 
$this
->
‹¡_ÿ£
->
	`befÜe
(
$m‘hod
);

58 
	}
}

66 
funùiÚ
 
	$švoke
(
$m‘hod
) {

67 
$this
->
‹¡_ÿ£
->
	`£tUp
();

68 
$this
->
‹¡_ÿ£
->
	`$m‘hod
();

69 
$this
->
‹¡_ÿ£
->
	`‹¬Down
();

70 
	}
}

78 
funùiÚ
 
	$aá”
(
$m‘hod
) {

79 
$this
->
‹¡_ÿ£
->
	`aá”
(
$m‘hod
);

80 
	}
}

89 şas 
	cSim¶eInvok”DecÜ©Ü
 {

90 
´iv©e
 
	m$švok”
;

96 
funùiÚ
 
	$__cÚ¡ruù
(
$švok”
) {

97 
$this
->
švok”
 = 
$švok”
;

105 
funùiÚ
 
	$g‘Te¡Ca£
() {

106  
$this
->
švok”
->
	`g‘Te¡Ca£
();

107 
	}
}

115 
funùiÚ
 
	$befÜe
(
$m‘hod
) {

116 
$this
->
švok”
->
	`befÜe
(
$m‘hod
);

117 
	}
}

125 
funùiÚ
 
	$švoke
(
$m‘hod
) {

126 
$this
->
švok”
->
	`švoke
(
$m‘hod
);

127 
	}
}

135 
funùiÚ
 
	$aá”
(
$m‘hod
) {

136 
$this
->
švok”
->
	`aá”
(
$m‘hod
);

137 
	}
}

	@F:\Site\stew\1\_lp\simpletest\mock_objects.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/expectation.php');

13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/simpletest.php');

14 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/dumper.php');

15 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/reflection_php5.php');

21 ià(! 
defšed
('MOCK_ANYTHING')) {

22 
defše
('MOCK_ANYTHING', '*');

30 şas 
	cP¬am‘”sEx³ù©iÚ
 
ex‹nds
 
	mSim¶eEx³ù©iÚ
 {

31 
´iv©e
 
	m$ex³ùed
;

41 
funùiÚ
 
__cÚ¡ruù
(
$ex³ùed
 = 
çl£
, 
$mes§ge
 = '%s') {

42 
·»Á
::
__cÚ¡ruù
(
$mes§ge
);

43 
	m$this
->
	mex³ùed
 = 
$ex³ùed
;

51 
funùiÚ
 
	$‹¡
(
$·¿m‘”s
) {

52 ià(! 
	`is_¬¿y
(
$this
->
ex³ùed
)) {

53  
Œue
;

55 ià(
	`couÁ
(
$this
->
ex³ùed
è!ğcouÁ(
$·¿m‘”s
)) {

56  
çl£
;

58 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
ex³ùed
); $i++) {

59 ià(! 
$this
->
	`‹¡P¬am‘”
(
$·¿m‘”s
[
$i
], $this->
ex³ùed
[$i])) {

60  
çl£
;

63  
Œue
;

64 
	}
}

73 
´Ùeùed
 
funùiÚ
 
	$‹¡P¬am‘”
(
$·¿m‘”
, 
$ex³ùed
) {

74 
$com·risÚ
 = 
$this
->
	`cÛrûToEx³ù©iÚ
(
$ex³ùed
);

75  
$com·risÚ
->
	`‹¡
(
$·¿m‘”
);

76 
	}
}

84 
funùiÚ
 
	$‹¡Mes§ge
(
$·¿m‘”s
) {

85 ià(
$this
->
	`‹¡
(
$·¿m‘”s
)) {

86  "Ex³ù©iÚ oà" . 
	`couÁ
(
$this
->
ex³ùed
) .

87 "‡rgum’t oà[" . 
$this
->
	`»nd”Argum’ts
($this->
ex³ùed
) .

90  
$this
->
	`desüibeDifã»nû
($this->
ex³ùed
, 
$·¿m‘”s
);

92 
	}
}

101 
´Ùeùed
 
funùiÚ
 
	$desüibeDifã»nû
(
$ex³ùed
, 
$·¿m‘”s
) {

102 ià(
	`couÁ
(
$ex³ùed
è!ğcouÁ(
$·¿m‘”s
)) {

103  "Ex³ùed " . 
	`couÁ
(
$ex³ùed
) .

104 "‡rgum’t oà[" . 
$this
->
	`»nd”Argum’ts
(
$ex³ùed
) .

105 "] buˆgÙ " . 
	`couÁ
(
$·¿m‘”s
) .

106 "‡rgum’t oà[" . 
$this
->
	`»nd”Argum’ts
(
$·¿m‘”s
) . "]";

108 
$mes§ges
 = 
	`¬¿y
();

109 
$i
 = 0; $˜< 
	`couÁ
(
$ex³ùed
); $i++) {

110 
$com·risÚ
 = 
$this
->
	`cÛrûToEx³ù©iÚ
(
$ex³ùed
[
$i
]);

111 ià(! 
$com·risÚ
->
	`‹¡
(
$·¿m‘”s
[
$i
])) {

112 
$mes§ges
[] = "·¿m‘” " . (
$i
 + 1) . " with [" .

113 
$com·risÚ
->
	`ov”ÏyMes§ge
(
$·¿m‘”s
[
$i
], 
$this
->
	`g‘Dum³r
()) . "]";

116  "P¬am‘”ƒx³ù©iÚ difãr © " . 
	`im¶ode
("‡nd ", 
$mes§ges
);

117 
	}
}

126 
´Ùeùed
 
funùiÚ
 
	$cÛrûToEx³ù©iÚ
(
$ex³ùed
) {

127 ià(
Sim¶eEx³ù©iÚ
::
	`isEx³ù©iÚ
(
$ex³ùed
)) {

128  
$ex³ùed
;

130  
Ãw
 
	`Id’tiÿlEx³ù©iÚ
(
$ex³ùed
);

131 
	}
}

139 
´Ùeùed
 
funùiÚ
 
	$»nd”Argum’ts
(
$¬gs
) {

140 
$desütiÚs
 = 
	`¬¿y
();

141 ià(
	`is_¬¿y
(
$¬gs
)) {

142 
	`fÜ—ch
 (
$¬gs
 
as
 
$¬g
) {

143 
$dum³r
 = 
Ãw
 
	`Sim¶eDum³r
();

144 
$desütiÚs
[] = 
$dum³r
->
	`desüibeV®ue
(
$¬g
);

147  
	`im¶ode
(', ', 
$desütiÚs
);

148 
	}
}

156 şas 
	cC®lCouÁEx³ù©iÚ
 
ex‹nds
 
	mSim¶eEx³ù©iÚ
 {

157 
´iv©e
 
	m$m‘hod
;

158 
´iv©e
 
	m$couÁ
;

167 
funùiÚ
 
__cÚ¡ruù
(
$m‘hod
, 
$couÁ
, 
$mes§ge
 = '%s') {

168 
$this
->
m‘hod
 = 
$m‘hod
;

169 
	m$this
->
	mcouÁ
 = 
$couÁ
;

170 
	m·»Á
::
__cÚ¡ruù
(
$mes§ge
);

178 
funùiÚ
 
	$‹¡
(
$com·»
) {

179  (
$this
->
couÁ
 =ğ
$com·»
);

180 
	}
}

187 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

188  'Ex³ùed c®ÈcouÁ fÜ [' . 
$this
->
m‘hod
 .

189 '] wa [' . 
$this
->
couÁ
 .

190 '] gÙ [' . 
$com·»
 . ']';

191 
	}
}

199 şas 
	cMšimumC®lCouÁEx³ù©iÚ
 
ex‹nds
 
	mSim¶eEx³ù©iÚ
 {

200 
´iv©e
 
	m$m‘hod
;

201 
´iv©e
 
	m$couÁ
;

210 
funùiÚ
 
__cÚ¡ruù
(
$m‘hod
, 
$couÁ
, 
$mes§ge
 = '%s') {

211 
$this
->
m‘hod
 = 
$m‘hod
;

212 
	m$this
->
	mcouÁ
 = 
$couÁ
;

213 
	m·»Á
::
__cÚ¡ruù
(
$mes§ge
);

221 
funùiÚ
 
	$‹¡
(
$com·»
) {

222  (
$this
->
couÁ
 <ğ
$com·»
);

223 
	}
}

230 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

231  'Mšimum c®ÈcouÁ fÜ [' . 
$this
->
m‘hod
 .

232 '] wa [' . 
$this
->
couÁ
 .

233 '] gÙ [' . 
$com·»
 . ']';

234 
	}
}

242 şas 
	cMaximumC®lCouÁEx³ù©iÚ
 
ex‹nds
 
	mSim¶eEx³ù©iÚ
 {

243 
´iv©e
 
	m$m‘hod
;

244 
´iv©e
 
	m$couÁ
;

253 
funùiÚ
 
__cÚ¡ruù
(
$m‘hod
, 
$couÁ
, 
$mes§ge
 = '%s') {

254 
$this
->
m‘hod
 = 
$m‘hod
;

255 
	m$this
->
	mcouÁ
 = 
$couÁ
;

256 
	m·»Á
::
__cÚ¡ruù
(
$mes§ge
);

264 
funùiÚ
 
	$‹¡
(
$com·»
) {

265  (
$this
->
couÁ
 >ğ
$com·»
);

266 
	}
}

273 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

274  'Maximum c®ÈcouÁ fÜ [' . 
$this
->
m‘hod
 .

275 '] wa [' . 
$this
->
couÁ
 .

276 '] gÙ [' . 
$com·»
 . ']';

277 
	}
}

286 şas 
	cSim¶eSigÇtu»M­
 {

287 
´iv©e
 
	m$m­
;

292 
funùiÚ
 
	$__cÚ¡ruù
() {

293 
$this
->
m­
 = 
	`¬¿y
();

301 
funùiÚ
 
	$add
(
$·¿m‘”s
, 
$aùiÚ
) {

302 
$¶aû
 = 
	`couÁ
(
$this
->
m­
);

303 
$this
->
m­
[
$¶aû
] = 
	`¬¿y
();

304 
$this
->
m­
[
$¶aû
]['·¿ms'] = 
Ãw
 
	`P¬am‘”sEx³ù©iÚ
(
$·¿m‘”s
);

305 
$this
->
m­
[
$¶aû
]['cÚ‹Á'] = 
$aùiÚ
;

306 
	}
}

316 
	gfunùiÚ
 &
	$fšdFœ¡AùiÚ
(
$·¿m‘”s
) {

317 
$¦Ù
 = 
$this
->
	`fšdFœ¡SlÙ
(
$·¿m‘”s
);

318 ià(
	`is£t
(
$¦Ù
) && isset($slot['content'])) {

319  
$¦Ù
['content'];

321 
$nuÎ
 = 
nuÎ
;

322  
$nuÎ
;

323 
	}
}

332 
funùiÚ
 
	$isM©ch
(
$·¿m‘”s
) {

333  (
$this
->
	`fšdFœ¡SlÙ
(
$·¿m‘”s
è!ğ
nuÎ
);

334 
	}
}

344 
funùiÚ
 
	$‹¡
(
$‹¡
, 
$·¿m‘”s
, 
$mes§ge
) {

345 
	}
}

353 
	gfunùiÚ
 &
	$fšdFœ¡SlÙ
(
$·¿m‘”s
) {

354 
$couÁ
 = 
	`couÁ
(
$this
->
m­
);

355 
$i
 = 0; $˜< 
$couÁ
; $i++) {

356 ià(
$this
->
m­
[
$i
]["·¿ms"]->
	`‹¡
(
$·¿m‘”s
)) {

357  
$this
->
m­
[
$i
];

360 
$nuÎ
 = 
nuÎ
;

361  
$nuÎ
;

362 
	}
}

373 şas 
	cSim¶eC®lScheduË
 {

374 
´iv©e
 
	m$wdÿrd
 = 
MOCK_ANYTHING
;

375 
´iv©e
 
	m$®ways
;

376 
´iv©e
 
	m$©
;

382 
funùiÚ
 
	$__cÚ¡ruù
() {

383 
$this
->
®ways
 = 
	`¬¿y
();

384 
$this
->
©
 = 
	`¬¿y
();

395 
funùiÚ
 (
$m‘hod
, 
$¬gs
, 
$aùiÚ
) {

396 
$¬gs
 = 
$this
->
	`»¶aûWdÿrds
($args);

397 
$m‘hod
 = 
	`¡¹Şow”
($method);

398 ià(! 
	`is£t
(
$this
->
®ways
[
$m‘hod
])) {

399 
$this
->
®ways
[
$m‘hod
] = 
Ãw
 
	`Sim¶eSigÇtu»M­
();

401 
$this
->
®ways
[
$m‘hod
]->
	`add
(
$¬gs
, 
$aùiÚ
);

402 
	}
}

413 
funùiÚ
 
	$»gi¡”At
(
$¡•
, 
$m‘hod
, 
$¬gs
, 
$aùiÚ
) {

414 
$¬gs
 = 
$this
->
	`»¶aûWdÿrds
($args);

415 
$m‘hod
 = 
	`¡¹Şow”
($method);

416 ià(! 
	`is£t
(
$this
->
©
[
$m‘hod
])) {

417 
$this
->
©
[
$m‘hod
] = 
	`¬¿y
();

419 ià(! 
	`is£t
(
$this
->
©
[
$m‘hod
][
$¡•
])) {

420 
$this
->
©
[
$m‘hod
][
$¡•
] = 
Ãw
 
	`Sim¶eSigÇtu»M­
();

422 
$this
->
©
[
$m‘hod
][
$¡•
]->
	`add
(
$¬gs
, 
$aùiÚ
);

423 
	}
}

432 
funùiÚ
 
	$ex³ùArgum’ts
(
$m‘hod
, 
$¬gs
, 
$mes§ge
) {

433 
$¬gs
 = 
$this
->
	`»¶aûWdÿrds
($args);

434 
$mes§ge
 .ğ
Mock
::
	`g‘Ex³ù©iÚLše
();

435 
$this
->
ex³ùed_¬gs
[
	`¡¹Şow”
(
$m‘hod
)] =

436 
Ãw
 
	`P¬am‘”sEx³ù©iÚ
(
$¬gs
, 
$mes§ge
);

438 
	}
}

449 
	gfunùiÚ
 &
	$»¥Úd
(
$¡•
, 
$m‘hod
, 
$¬gs
) {

450 
$m‘hod
 = 
	`¡¹Şow”
($method);

451 ià(
	`is£t
(
$this
->
©
[
$m‘hod
][
$¡•
])) {

452 ià(
$this
->
©
[
$m‘hod
][
$¡•
]->
	`isM©ch
(
$¬gs
)) {

453 
$aùiÚ
 = 
$this
->
©
[
$m‘hod
][
$¡•
]->
	`fšdFœ¡AùiÚ
(
$¬gs
);

454 ià(
	`is£t
(
$aùiÚ
)) {

455  
$aùiÚ
->
	`aù
();

459 ià(
	`is£t
(
$this
->
®ways
[
$m‘hod
])) {

460 
$aùiÚ
 = 
$this
->
®ways
[
$m‘hod
]->
	`fšdFœ¡AùiÚ
(
$¬gs
);

461 ià(
	`is£t
(
$aùiÚ
)) {

462  
$aùiÚ
->
	`aù
();

465 
$nuÎ
 = 
nuÎ
;

466  
$nuÎ
;

467 
	}
}

476 
´Ùeùed
 
funùiÚ
 
	$»¶aûWdÿrds
(
$¬gs
) {

477 ià(
$¬gs
 ==ğ
çl£
) {

478  
çl£
;

480 
$i
 = 0; $˜< 
	`couÁ
(
$¬gs
); $i++) {

481 ià(
$¬gs
[
$i
] ==ğ
$this
->
wdÿrd
) {

482 
$¬gs
[
$i
] = 
Ãw
 
	`AnythšgEx³ù©iÚ
();

485  
$¬gs
;

486 
	}
}

496 şas 
	cSim¶eR‘uº
 {

497 
´iv©e
 
	m$v®ue
;

505 
funùiÚ
 
	$__cÚ¡ruù
(
$v®ue
) {

506 
$this
->
v®ue
 = 
$v®ue
;

513 
funùiÚ
 
	$aù
() {

514  
$this
->
v®ue
;

515 
	}
}

524 şas 
	cSim¶eByReã»nû
 {

525 
´iv©e
 
	m$»ã»nû
;

531 
funùiÚ
 
	$__cÚ¡ruù
(&
$»ã»nû
) {

532 
$this
->
»ã»nû
 = &
$»ã»nû
;

539 
funùiÚ
 &
	$aù
() {

540  
$this
->
»ã»nû
;

541 
	}
}

550 şas 
	cSim¶eByV®ue
 {

551 
´iv©e
 
	m$v®ue
;

559 
funùiÚ
 
	$__cÚ¡ruù
(
$v®ue
) {

560 
$this
->
v®ue
 = 
$v®ue
;

567 
funùiÚ
 &
	$aù
() {

568 
$dummy
 = 
$this
->
v®ue
;

569  
$dummy
;

570 
	}
}

579 şas 
	cSim¶eThrow”
 {

580 
´iv©e
 
	m$exû±iÚ
;

586 
funùiÚ
 
	$__cÚ¡ruù
(
$exû±iÚ
) {

587 
$this
->
exû±iÚ
 = 
$exû±iÚ
;

593 
funùiÚ
 
	$aù
() {

594 
throw
 
$this
->
exû±iÚ
;

595 
	}
}

604 şas 
	cSim¶eE¼ÜThrow”
 {

605 
´iv©e
 
	m$”rÜ
;

606 
´iv©e
 
	m$£v”™y
;

613 
funùiÚ
 
	$__cÚ¡ruù
(
$”rÜ
, 
$£v”™y
) {

614 
$this
->
”rÜ
 = 
$”rÜ
;

615 
$this
->
£v”™y
 = 
$£v”™y
;

621 
funùiÚ
 &
	$aù
() {

622 
	`Œigg”_”rÜ
(
$this
->
”rÜ
, $this->
£v”™y
);

623 
$nuÎ
 = 
nuÎ
;

624  
$nuÎ
;

625 
	}
}

639 şas 
	cSim¶eMock
 {

640 
´iv©e
 
	m$aùiÚs
;

641 
´iv©e
 
	m$ex³ù©iÚs
;

642 
´iv©e
 
	m$wdÿrd
 = 
MOCK_ANYTHING
;

643 
´iv©e
 
	m$is_¡riù
 = 
Œue
;

644 
´iv©e
 
	m$ÿÎ_couÁs
;

645 
´iv©e
 
	m$ex³ùed_couÁs
;

646 
´iv©e
 
	m$max_couÁs
;

647 
´iv©e
 
	m$ex³ùed_¬gs
;

648 
´iv©e
 
	m$ex³ùed_¬gs_©
;

654 
funùiÚ
 
	$Sim¶eMock
() {

655 
$this
->
aùiÚs
 = 
Ãw
 
	`Sim¶eC®lScheduË
();

656 
$this
->
ex³ù©iÚs
 = 
Ãw
 
	`Sim¶eC®lScheduË
();

657 
$this
->
ÿÎ_couÁs
 = 
	`¬¿y
();

658 
$this
->
ex³ùed_couÁs
 = 
	`¬¿y
();

659 
$this
->
max_couÁs
 = 
	`¬¿y
();

660 
$this
->
ex³ùed_¬gs
 = 
	`¬¿y
();

661 
$this
->
ex³ùed_¬gs_©
 = 
	`¬¿y
();

662 
$this
->
	`g‘Cu¼’tTe¡Ca£
()->
	`‹Î
($this);

669 
funùiÚ
 
	$di§bËEx³ù©iÚNameChecks
() {

670 
$this
->
is_¡riù
 = 
çl£
;

671 
	}
}

677 
´Ùeùed
 
funùiÚ
 
	$g‘Cu¼’tTe¡Ca£
() {

678  
Sim¶eTe¡
::
	`g‘CÚ‹xt
()->
	`g‘Te¡
();

679 
	}
}

687 
´Ùeùed
 
funùiÚ
 
	$checkArgum’tsIsA¼ay
(
$¬gs
, 
$sk
) {

688 ià(! 
	`is_¬¿y
(
$¬gs
)) {

689 
	`Œigg”_”rÜ
(

691 
E_USER_ERROR
);

693 
	}
}

701 
´Ùeùed
 
funùiÚ
 
	$d›OnNoM‘hod
(
$m‘hod
, 
$sk
) {

702 ià(
$this
->
is_¡riù
 && ! 
	`m‘hod_exi¡s
($this, 
$m‘hod
)) {

703 
	`Œigg”_”rÜ
(

704 "CªnÙ $sk‡ nØ${m‘hod}(èš cÏs " . 
	`g‘_şass
(
$this
),

705 
E_USER_ERROR
);

707 
	}
}

716 
funùiÚ
 
	$»¶aûWdÿrds
(
$¬gs
) {

717 ià(
$¬gs
 ==ğ
çl£
) {

718  
çl£
;

720 
$i
 = 0; $˜< 
	`couÁ
(
$¬gs
); $i++) {

721 ià(
$¬gs
[
$i
] ==ğ
$this
->
wdÿrd
) {

722 
$¬gs
[
$i
] = 
Ãw
 
	`AnythšgEx³ù©iÚ
();

725  
$¬gs
;

726 
	}
}

733 
´Ùeùed
 
funùiÚ
 
	$addC®l
(
$m‘hod
, 
$¬gs
) {

734 ià(! 
	`is£t
(
$this
->
ÿÎ_couÁs
[
$m‘hod
])) {

735 
$this
->
ÿÎ_couÁs
[
$m‘hod
] = 0;

737 
$this
->
ÿÎ_couÁs
[
$m‘hod
]++;

738 
	}
}

745 
funùiÚ
 
	$g‘C®lCouÁ
(
$m‘hod
) {

746 
$this
->
	`d›OnNoM‘hod
(
$m‘hod
, "get call count");

747 
$m‘hod
 = 
	`¡¹Şow”
($method);

748 ià(! 
	`is£t
(
$this
->
ÿÎ_couÁs
[
$m‘hod
])) {

751  
$this
->
ÿÎ_couÁs
[
$m‘hod
];

752 
	}
}

762 
funùiÚ
 
	$»tuºs
(
$m‘hod
, 
$v®ue
, 
$¬gs
 = 
çl£
) {

763 
$this
->
	`d›OnNoM‘hod
(
$m‘hod
, "set„eturn");

764 
$this
->
aùiÚs
->(
$m‘hod
, 
$¬gs
, 
Ãw
 
	`Sim¶eR‘uº
(
$v®ue
));

765 
	}
}

780 
funùiÚ
 
	$»tuºsAt
(
$timšg
, 
$m‘hod
, 
$v®ue
, 
$¬gs
 = 
çl£
) {

781 
$this
->
	`d›OnNoM‘hod
(
$m‘hod
, "set„eturn value sequence");

782 
$this
->
aùiÚs
->
	`»gi¡”At
(
$timšg
, 
$m‘hod
, 
$¬gs
, 
Ãw
 
	`Sim¶eR‘uº
(
$v®ue
));

783 
	}
}

793 
funùiÚ
 
	$»tuºsByV®ue
(
$m‘hod
, 
$v®ue
, 
$¬gs
 = 
çl£
) {

794 
$this
->
	`d›OnNoM‘hod
(
$m‘hod
, "set„eturn value");

795 
$this
->
aùiÚs
->(
$m‘hod
, 
$¬gs
, 
Ãw
 
	`Sim¶eByV®ue
(
$v®ue
));

796 
	}
}

799 
funùiÚ
 
	$£tR‘uºV®ue
(
$m‘hod
, 
$v®ue
, 
$¬gs
 = 
çl£
) {

800 
$this
->
	`»tuºsByV®ue
(
$m‘hod
, 
$v®ue
, 
$¬gs
);

801 
	}
}

816 
funùiÚ
 
	$»tuºsByV®ueAt
(
$timšg
, 
$m‘hod
, 
$v®ue
, 
$¬gs
 = 
çl£
) {

817 
$this
->
	`d›OnNoM‘hod
(
$m‘hod
, "set„eturn value sequence");

818 
$this
->
aùiÚs
->
	`»gi¡”At
(
$timšg
, 
$m‘hod
, 
$¬gs
, 
Ãw
 
	`Sim¶eByV®ue
(
$v®ue
));

819 
	}
}

822 
funùiÚ
 
	$£tR‘uºV®ueAt
(
$timšg
, 
$m‘hod
, 
$v®ue
, 
$¬gs
 = 
çl£
) {

823 
$this
->
	`»tuºsByV®ueAt
(
$timšg
, 
$m‘hod
, 
$v®ue
, 
$¬gs
);

824 
	}
}

834 
funùiÚ
 
	$»tuºsByReã»nû
(
$m‘hod
, &
$»ã»nû
, 
$¬gs
 = 
çl£
) {

835 
$this
->
	`d›OnNoM‘hod
(
$m‘hod
, "set„eturn„eference");

836 
$this
->
aùiÚs
->(
$m‘hod
, 
$¬gs
, 
Ãw
 
	`Sim¶eByReã»nû
(
$»ã»nû
));

837 
	}
}

840 
funùiÚ
 
	$£tR‘uºReã»nû
(
$m‘hod
, &
$»ã»nû
, 
$¬gs
 = 
çl£
) {

841 
$this
->
	`»tuºsByReã»nû
(
$m‘hod
, 
$»ã»nû
, 
$¬gs
);

842 
	}
}

857 
funùiÚ
 
	$»tuºsByReã»nûAt
(
$timšg
, 
$m‘hod
, &
$»ã»nû
, 
$¬gs
 = 
çl£
) {

858 
$this
->
	`d›OnNoM‘hod
(
$m‘hod
, "set„eturn„eference sequence");

859 
$this
->
aùiÚs
->
	`»gi¡”At
(
$timšg
, 
$m‘hod
, 
$¬gs
, 
Ãw
 
	`Sim¶eByReã»nû
(
$»ã»nû
));

860 
	}
}

863 
funùiÚ
 
	$£tR‘uºReã»nûAt
(
$timšg
, 
$m‘hod
, &
$»ã»nû
, 
$¬gs
 = 
çl£
) {

864 
$this
->
	`»tuºsByReã»nûAt
(
$timšg
, 
$m‘hod
, 
$»ã»nû
, 
$¬gs
);

865 
	}
}

877 
funùiÚ
 
ex³ù
(
$m‘hod
, 
$¬gs
, 
$mes§ge
 = '%s') {

878 
$this
->
d›OnNoM‘hod
(
$m‘hod
, 'setƒxpected‡rguments');

879 
	g$this
->
checkArgum’tsIsA¼ay
(
$¬gs
, 'setƒxpected‡rguments');

880 
	g$this
->
	gex³ù©iÚs
->
ex³ùArgum’ts
(
$m‘hod
, 
$¬gs
, 
$mes§ge
);

881 
	g$¬gs
 = 
$this
->
»¶aûWdÿrds
(
$¬gs
);

882 
	g$mes§ge
 .ğ
Mock
::
g‘Ex³ù©iÚLše
();

883 
	g$this
->
	gex³ùed_¬gs
[
¡¹Şow”
(
$m‘hod
)] =

884 
Ãw
 
P¬am‘”sEx³ù©iÚ
(
$¬gs
, 
$mes§ge
);

899 
funùiÚ
 
ex³ùAt
(
$timšg
, 
$m‘hod
, 
$¬gs
, 
$mes§ge
 = '%s') {

900 
$this
->
d›OnNoM‘hod
(
$m‘hod
, 'setƒxpected‡rguments‡time');

901 
	g$this
->
checkArgum’tsIsA¼ay
(
$¬gs
, 'setƒxpected‡rguments‡time');

902 
	g$¬gs
 = 
$this
->
»¶aûWdÿrds
(
$¬gs
);

903 ià(! 
is£t
(
$this
->
ex³ùed_¬gs_©
[
$timšg
])) {

904 
	g$this
->
	gex³ùed_¬gs_©
[
$timšg
] = 
¬¿y
();

906 
	g$m‘hod
 = 
¡¹Şow”
(
$m‘hod
);

907 
	g$mes§ge
 .ğ
Mock
::
g‘Ex³ù©iÚLše
();

908 
	g$this
->
	gex³ùed_¬gs_©
[
$timšg
][
$m‘hod
] =

909 
Ãw
 
P¬am‘”sEx³ù©iÚ
(
$¬gs
, 
$mes§ge
);

921 
funùiÚ
 
ex³ùC®lCouÁ
(
$m‘hod
, 
$couÁ
, 
$mes§ge
 = '%s') {

922 
$this
->
d›OnNoM‘hod
(
$m‘hod
, 'setƒxpected call count');

923 
	g$mes§ge
 .ğ
Mock
::
g‘Ex³ù©iÚLše
();

924 
	g$this
->
	gex³ùed_couÁs
[
¡¹Şow”
(
$m‘hod
)] =

925 
Ãw
 
C®lCouÁEx³ù©iÚ
(
$m‘hod
, 
$couÁ
, 
$mes§ge
);

936 
funùiÚ
 
ex³ùMaximumC®lCouÁ
(
$m‘hod
, 
$couÁ
, 
$mes§ge
 = '%s') {

937 
$this
->
d›OnNoM‘hod
(
$m‘hod
, 'set maximum call count');

938 
	g$mes§ge
 .ğ
Mock
::
g‘Ex³ù©iÚLše
();

939 
	g$this
->
	gmax_couÁs
[
¡¹Şow”
(
$m‘hod
)] =

940 
Ãw
 
MaximumC®lCouÁEx³ù©iÚ
(
$m‘hod
, 
$couÁ
, 
$mes§ge
);

951 
funùiÚ
 
ex³ùMšimumC®lCouÁ
(
$m‘hod
, 
$couÁ
, 
$mes§ge
 = '%s') {

952 
$this
->
d›OnNoM‘hod
(
$m‘hod
, 'set minimum call count');

953 
	g$mes§ge
 .ğ
Mock
::
g‘Ex³ù©iÚLše
();

954 
	g$this
->
	gex³ùed_couÁs
[
¡¹Şow”
(
$m‘hod
)] =

955 
Ãw
 
MšimumC®lCouÁEx³ù©iÚ
(
$m‘hod
, 
$couÁ
, 
$mes§ge
);

964 
funùiÚ
 
ex³ùNev”
(
$m‘hod
, 
$mes§ge
 = '%s') {

965 
$this
->
ex³ùMaximumC®lCouÁ
(
$m‘hod
, 0, 
$mes§ge
);

976 
funùiÚ
 
ex³ùOnû
(
$m‘hod
, 
$¬gs
 = 
çl£
, 
$mes§ge
 = '%s') {

977 
$this
->
ex³ùC®lCouÁ
(
$m‘hod
, 1, 
$mes§ge
);

978 ià(
	g$¬gs
 !=ğ
çl£
) {

979 
$this
->
ex³ù
(
$m‘hod
, 
$¬gs
, 
$mes§ge
);

991 
funùiÚ
 
ex³ùAtL—¡Onû
(
$m‘hod
, 
$¬gs
 = 
çl£
, 
$mes§ge
 = '%s') {

992 
$this
->
ex³ùMšimumC®lCouÁ
(
$m‘hod
, 1, 
$mes§ge
);

993 ià(
	g$¬gs
 !=ğ
çl£
) {

994 
$this
->
ex³ù
(
$m‘hod
, 
$¬gs
, 
$mes§ge
);

1010 
funùiÚ
 
	$throwOn
(
$m‘hod
, 
$exû±iÚ
 = 
çl£
, 
$¬gs
 = false) {

1011 
$this
->
	`d›OnNoM‘hod
(
$m‘hod
, "throw on");

1012 
$this
->
aùiÚs
->(
$m‘hod
, 
$¬gs
,

1013 
Ãw
 
	`Sim¶eThrow”
(
$exû±iÚ
 ? $exû±iÚ :‚ew 
	`Exû±iÚ
()));

1014 
	}
}

1034 
funùiÚ
 
	$throwAt
(
$timšg
, 
$m‘hod
, 
$exû±iÚ
 = 
çl£
, 
$¬gs
 = false) {

1035 
$this
->
	`d›OnNoM‘hod
(
$m‘hod
, "throw‡t");

1036 
$this
->
aùiÚs
->
	`»gi¡”At
(
$timšg
, 
$m‘hod
, 
$¬gs
,

1037 
Ãw
 
	`Sim¶eThrow”
(
$exû±iÚ
 ? $exû±iÚ :‚ew 
	`Exû±iÚ
()));

1038 
	}
}

1052 
funùiÚ
 
”rÜOn
(
$m‘hod
, 
$”rÜ
 = 'A mockƒ¼Ü', 
$¬gs
 = 
çl£
, 
$£v”™y
 = 
E_USER_ERROR
) {

1053 
$this
->
d›OnNoM‘hod
(
$m‘hod
, "error on");

1054 
	g$this
->
	gaùiÚs
->(
	g$m‘hod
, 
	g$¬gs
, 
Ãw
 
Sim¶eE¼ÜThrow”
(
$”rÜ
, 
$£v”™y
));

1075 
funùiÚ
 
”rÜAt
(
$timšg
, 
$m‘hod
, 
$”rÜ
 = 'A mockƒ¼Ü', 
$¬gs
 = 
çl£
, 
$£v”™y
 = 
E_USER_ERROR
) {

1076 
$this
->
d›OnNoM‘hod
(
$m‘hod
, "error‡t");

1077 
	g$this
->
	gaùiÚs
->
»gi¡”At
(
$timšg
, 
$m‘hod
, 
$¬gs
, 
Ãw
 
Sim¶eE¼ÜThrow”
(
$”rÜ
, 
$£v”™y
));

1088 
funùiÚ
 
	$©Te¡End
(
$‹¡_m‘hod
, &
$‹¡
) {

1089 
	`fÜ—ch
 (
$this
->
ex³ùed_couÁs
 
as
 
$m‘hod
 => 
$ex³ù©iÚ
) {

1090 
$‹¡
->
	`as£¹
(
$ex³ù©iÚ
, 
$this
->
	`g‘C®lCouÁ
(
$m‘hod
));

1092 
	`fÜ—ch
 (
$this
->
max_couÁs
 
as
 
$m‘hod
 => 
$ex³ù©iÚ
) {

1093 ià(
$ex³ù©iÚ
->
	`‹¡
(
$this
->
	`g‘C®lCouÁ
(
$m‘hod
))) {

1094 
$‹¡
->
	`as£¹
(
$ex³ù©iÚ
, 
$this
->
	`g‘C®lCouÁ
(
$m‘hod
));

1097 
	}
}

1108 
	gfunùiÚ
 &
	$švoke
(
$m‘hod
, 
$¬gs
) {

1109 
$m‘hod
 = 
	`¡¹Şow”
($method);

1110 
$¡•
 = 
$this
->
	`g‘C®lCouÁ
(
$m‘hod
);

1111 
$this
->
	`addC®l
(
$m‘hod
, 
$¬gs
);

1112 
$this
->
	`checkEx³ù©iÚs
(
$m‘hod
, 
$¬gs
, 
$¡•
);

1113 
$was
 = 
$this
->
	`di§bËESŒiù
();

1114 
Œy
 {

1115 
$»suÉ
 = &
$this
->
	`emuÏ‹C®l
(
$m‘hod
, 
$¬gs
, 
$¡•
);

1116 } 
	`ÿtch
 (
Exû±iÚ
 
$e
) {

1117 
$this
->
	`»¡ÜeESŒiù
(
$was
);

1118 
throw
 
$e
;

1120 
$this
->
	`»¡ÜeESŒiù
(
$was
);

1121  
$»suÉ
;

1122 
	}
}

1134 
´Ùeùed
 
	gfunùiÚ
 &
	$emuÏ‹C®l
(
$m‘hod
, 
$¬gs
, 
$¡•
) {

1135  
$this
->
aùiÚs
->
	`»¥Úd
(
$¡•
, 
$m‘hod
, 
$¬gs
);

1136 
	}
}

1145 
´Ùeùed
 
funùiÚ
 
	$checkEx³ù©iÚs
(
$m‘hod
, 
$¬gs
, 
$timšg
) {

1146 
$‹¡
 = 
$this
->
	`g‘Cu¼’tTe¡Ca£
();

1147 ià(
	`is£t
(
$this
->
max_couÁs
[
$m‘hod
])) {

1148 ià(! 
$this
->
max_couÁs
[
$m‘hod
]->
	`‹¡
(
$timšg
 + 1)) {

1149 
$‹¡
->
	`as£¹
(
$this
->
max_couÁs
[
$m‘hod
], 
$timšg
 + 1);

1152 ià(
	`is£t
(
$this
->
ex³ùed_¬gs_©
[
$timšg
][
$m‘hod
])) {

1153 
$‹¡
->
	`as£¹
(

1154 
$this
->
ex³ùed_¬gs_©
[
$timšg
][
$m‘hod
],

1155 
$¬gs
,

1157 } 
	`–£if
 (
	`is£t
(
$this
->
ex³ùed_¬gs
[
$m‘hod
])) {

1158 
$‹¡
->
	`as£¹
(

1159 
$this
->
ex³ùed_¬gs
[
$m‘hod
],

1160 
$¬gs
,

1163 
	}
}

1171 
´iv©e
 
funùiÚ
 
	$di§bËESŒiù
() {

1172 
$was
 = 
	`”rÜ_»pÜtšg
();

1173 
	`”rÜ_»pÜtšg
(
$was
 & ~
E_STRICT
);

1174  
$was
;

1175 
	}
}

1181 
´iv©e
 
funùiÚ
 
	$»¡ÜeESŒiù
(
$was
) {

1182 
	`”rÜ_»pÜtšg
(
$was
);

1183 
	}
}

1192 şas 
	cMock
 {

1197 
funùiÚ
 
	$__cÚ¡ruù
() {

1198 
	`Œigg”_”rÜ
('Mock factory methods‡re static.');

1214 
funùiÚ
 
	$g’”©e
(
$şass
, 
$mock_şass
 = 
çl£
, 
$m‘hods
 = false) {

1215 
$g’”©Ü
 = 
Ãw
 
	`MockG’”©Ü
(
$şass
, 
$mock_şass
);

1216  @
$g’”©Ü
->
	`g’”©eSubşass
(
$m‘hods
);

1217 
	}
}

1229 
funùiÚ
 
	$g’”©eP¬tŸl
(
$şass
, 
$mock_şass
, 
$m‘hods
) {

1230 
$g’”©Ü
 = 
Ãw
 
	`MockG’”©Ü
(
$şass
, 
$mock_şass
);

1231  @
$g’”©Ü
->
	`g’”©eP¬tŸl
(
$m‘hods
);

1232 
	}
}

1237 
funùiÚ
 
	$g‘Ex³ù©iÚLše
() {

1238 
$Œaû
 = 
Ãw
 
	`Sim¶eSckT¿û
(
	`¬¿y
('expect'));

1239  
$Œaû
->
	`ŒaûM‘hod
();

1240 
	}
}

1248 şas 
	cMockG’”©Ü
 {

1249 
´iv©e
 
	m$şass
;

1250 
´iv©e
 
	m$mock_şass
;

1251 
´iv©e
 
	m$mock_ba£
;

1252 
´iv©e
 
	m$»æeùiÚ
;

1260 
funùiÚ
 
	$__cÚ¡ruù
(
$şass
, 
$mock_şass
) {

1261 
$this
->
şass
 = 
$şass
;

1262 
$this
->
mock_şass
 = 
$mock_şass
;

1263 ià(! 
$this
->
mock_şass
) {

1264 
$this
->
mock_şass
 = 'Mock' . $this->
şass
;

1266 
$this
->
mock_ba£
 = 
Sim¶eTe¡
::
	`g‘MockBa£CÏss
();

1267 
$this
->
»æeùiÚ
 = 
Ãw
 
	`Sim¶eReæeùiÚ
($this->
şass
);

1279 
funùiÚ
 
	$g’”©e
(
$m‘hods
) {

1280 ià(! 
$this
->
»æeùiÚ
->
	`şassOrIÁ”çûExi¡s
()) {

1281  
çl£
;

1283 
$mock_»æeùiÚ
 = 
Ãw
 
	`Sim¶eReæeùiÚ
(
$this
->
mock_şass
);

1284 ià(
$mock_»æeùiÚ
->
	`şassExi¡sSªsAutŞßd
()) {

1285  
çl£
;

1287 
$code
 = 
$this
->
	`ü—‹CÏssCode
(
$m‘hods
 ? $m‘hod : 
	`¬¿y
());

1288  
	`ev®
("$code„eturn \$code;");

1289 
	}
}

1301 
funùiÚ
 
	$g’”©eSubşass
(
$m‘hods
) {

1302 ià(! 
$this
->
»æeùiÚ
->
	`şassOrIÁ”çûExi¡s
()) {

1303  
çl£
;

1305 
$mock_»æeùiÚ
 = 
Ãw
 
	`Sim¶eReæeùiÚ
(
$this
->
mock_şass
);

1306 ià(
$mock_»æeùiÚ
->
	`şassExi¡sSªsAutŞßd
()) {

1307  
çl£
;

1309 ià(
$this
->
»æeùiÚ
->
	`isIÁ”çû
(è|| $this->»æeùiÚ->
	`hasFš®
()) {

1310 
$code
 = 
$this
->
	`ü—‹CÏssCode
(
$m‘hods
 ? $m‘hod : 
	`¬¿y
());

1311  
	`ev®
("$code„eturn \$code;");

1313 
$code
 = 
$this
->
	`ü—‹SubşassCode
(
$m‘hods
 ? $m‘hod : 
	`¬¿y
());

1314  
	`ev®
("$code„eturn \$code;");

1316 
	}
}

1326 
funùiÚ
 
	$g’”©eP¬tŸl
(
$m‘hods
) {

1327 ià(! 
$this
->
»æeùiÚ
->
	`şassExi¡s
($this->
şass
)) {

1328  
çl£
;

1330 
$mock_»æeùiÚ
 = 
Ãw
 
	`Sim¶eReæeùiÚ
(
$this
->
mock_şass
);

1331 ià(
$mock_»æeùiÚ
->
	`şassExi¡sSªsAutŞßd
()) {

1332 
	`Œigg”_”rÜ
('P¬tŸÈmock cÏs [' . 
$this
->
mock_şass
 . ']‡lreadyƒxists');

1333  
çl£
;

1335 
$code
 = 
$this
->
	`ex‹ndCÏssCode
(
$m‘hods
);

1336  
	`ev®
("$code„eturn \$code;");

1337 
	}
}

1344 
´Ùeùed
 
funùiÚ
 
	$ü—‹CÏssCode
(
$m‘hods
) {

1345 
$im¶em’ts
 = '';

1346 
$š‹rçûs
 = 
$this
->
»æeùiÚ
->
	`g‘IÁ”çûs
();

1347 ià(
	`funùiÚ_exi¡s
('spl_classes')) {

1348 
$š‹rçûs
 = 
	`¬¿y_diff
($š‹rçûs, 
	`¬¿y
('Traversable'));

1350 ià(
	`couÁ
(
$š‹rçûs
) > 0) {

1351 
$im¶em’ts
 = 'im¶em’t ' . 
	`im¶ode
(', ', 
$š‹rçûs
);

1353 
$code
 = "şas " . 
$this
->
mock_şass
 . "ƒx‹nd " . $this->
mock_ba£
 . " $implements {\n";

1354 
$code
 .ğ" funùiÚ " . 
$this
->
mock_şass
 . "() {\n";

1355 
$code
 .ğ" \$this->" . 
$this
->
mock_ba£
 . "();\n";

1356 
$code
 .= " }\n";

1357 ià(
	`š_¬¿y
('__cÚ¡ruù', 
$this
->
»æeùiÚ
->
	`g‘M‘hods
())) {

1358 
$code
 .= " function __construct() {\n";

1359 
$code
 .ğ" \$this->" . 
$this
->
mock_ba£
 . "();\n";

1360 
$code
 .= " }\n";

1362 
$code
 .ğ
$this
->
	`ü—‹HªdËrCode
(
$m‘hods
);

1363 
$code
 .= "}\n";

1364  
$code
;

1365 
	}
}

1373 
´Ùeùed
 
funùiÚ
 
	$ü—‹SubşassCode
(
$m‘hods
) {

1374 
$code
 = "şas " . 
$this
->
mock_şass
 . "ƒx‹nd " . $this->
şass
 . " {\n";

1375 
$code
 .= "…ublic \$mock;\n";

1376 
$code
 .ğ
$this
->
	`addM‘hodLi¡
(
	`¬¿y_m”ge
(
$m‘hods
, $this->
»æeùiÚ
->
	`g‘M‘hods
()));

1377 
$code
 .= "\n";

1378 
$code
 .ğ" funùiÚ " . 
$this
->
mock_şass
 . "() {\n";

1379 
$code
 .ğ" \$this->mock =‚ew " . 
$this
->
mock_ba£
 . "();\n";

1380 
$code
 .= " \$this->mock->disableExpectationNameChecks();\n";

1381 
$code
 .= " }\n";

1382 
$code
 .ğ
$this
->
	`chašMockR‘uºs
();

1383 
$code
 .ğ
$this
->
	`chašMockEx³ù©iÚs
();

1384 
$code
 .ğ
$this
->
	`chašThrowM‘hods
();

1385 
$code
 .ğ
$this
->
	`ov”rideM‘hods
($this->
»æeùiÚ
->
	`g‘M‘hods
());

1386 
$code
 .ğ
$this
->
	`ü—‹NewM‘hodCode
(
$m‘hods
);

1387 
$code
 .= "}\n";

1388  
$code
;

1389 
	}
}

1398 
´Ùeùed
 
funùiÚ
 
	$ex‹ndCÏssCode
(
$m‘hods
) {

1399 
$code
 = "şas " . 
$this
->
mock_şass
 . "ƒx‹nd " . $this->
şass
 . " {\n";

1400 
$code
 .= "…rotected \$mock;\n";

1401 
$code
 .ğ
$this
->
	`addM‘hodLi¡
(
$m‘hods
);

1402 
$code
 .= "\n";

1403 
$code
 .ğ" funùiÚ " . 
$this
->
mock_şass
 . "() {\n";

1404 
$code
 .ğ" \$this->mock =‚ew " . 
$this
->
mock_ba£
 . "();\n";

1405 
$code
 .= " \$this->mock->disableExpectationNameChecks();\n";

1406 
$code
 .= " }\n";

1407 
$code
 .ğ
$this
->
	`chašMockR‘uºs
();

1408 
$code
 .ğ
$this
->
	`chašMockEx³ù©iÚs
();

1409 
$code
 .ğ
$this
->
	`chašThrowM‘hods
();

1410 
$code
 .ğ
$this
->
	`ov”rideM‘hods
(
$m‘hods
);

1411 
$code
 .= "}\n";

1412  
$code
;

1413 
	}
}

1422 
´Ùeùed
 
funùiÚ
 
	$ü—‹HªdËrCode
(
$m‘hods
) {

1423 
$code
 = '';

1424 
$m‘hods
 = 
	`¬¿y_m”ge
($m‘hods, 
$this
->
»æeùiÚ
->
	`g‘M‘hods
());

1425 
	`fÜ—ch
 (
$m‘hods
 
as
 
$m‘hod
) {

1426 ià(
$this
->
	`isCÚ¡ruùÜ
(
$m‘hod
)) {

1429 
$mock_»æeùiÚ
 = 
Ãw
 
	`Sim¶eReæeùiÚ
(
$this
->
mock_ba£
);

1430 ià(
	`š_¬¿y
(
$m‘hod
, 
$mock_»æeùiÚ
->
	`g‘M‘hods
())) {

1433 
$code
 .ğ" " . 
$this
->
»æeùiÚ
->
	`g‘SigÇtu»
(
$m‘hod
) . " {\n";

1434 
$code
 .= " \$args = func_get_args();\n";

1435 
$code
 .= " \$result = &\$this->invoke(\"$method\", \$args);\n";

1436 
$code
 .= "„eturn \$result;\n";

1437 
$code
 .= " }\n";

1439  
$code
;

1440 
	}
}

1449 
´Ùeùed
 
funùiÚ
 
	$ü—‹NewM‘hodCode
(
$m‘hods
) {

1450 
$code
 = '';

1451 
	`fÜ—ch
 (
$m‘hods
 
as
 
$m‘hod
) {

1452 ià(
$this
->
	`isCÚ¡ruùÜ
(
$m‘hod
)) {

1455 
$mock_»æeùiÚ
 = 
Ãw
 
	`Sim¶eReæeùiÚ
(
$this
->
mock_ba£
);

1456 ià(
	`š_¬¿y
(
$m‘hod
, 
$mock_»æeùiÚ
->
	`g‘M‘hods
())) {

1459 
$code
 .ğ" " . 
$this
->
»æeùiÚ
->
	`g‘SigÇtu»
(
$m‘hod
) . " {\n";

1460 
$code
 .= " \$args = func_get_args();\n";

1461 
$code
 .= " \$result = &\$this->mock->invoke(\"$method\", \$args);\n";

1462 
$code
 .= "„eturn \$result;\n";

1463 
$code
 .= " }\n";

1465  
$code
;

1466 
	}
}

1474 
´Ùeùed
 
funùiÚ
 
	$isCÚ¡ruùÜ
(
$m‘hod
) {

1475  
	`š_¬¿y
(

1476 
	`¡¹Şow”
(
$m‘hod
),

1477 
	`¬¿y
('__construct', '__destruct'));

1478 
	}
}

1485 
´Ùeùed
 
funùiÚ
 
	$addM‘hodLi¡
(
$m‘hods
) {

1487 
	`im¶ode
("', '", 
	`¬¿y_m­
('¡¹Şow”', 
$m‘hods
)) .

1489 
	}
}

1496 
´Ùeùed
 
funùiÚ
 
	$baOutIfNÙMocked
(
$®Ÿs
) {

1497 
$code
 = " if (! in_array(strtolower($alias), \$this->mocked_methods)) {\n";

1498 
$code
 .= "rigger_error(\"Method [$alias] is‚ot mocked\");\n";

1499 
$code
 .= " \$null =‚ull;\n";

1500 
$code
 .= "„eturn \$null;\n";

1501 
$code
 .= " }\n";

1502  
$code
;

1503 
	}
}

1510 
´Ùeùed
 
funùiÚ
 
	$chašMockR‘uºs
() {

1511 
$code
 = " function„eturns(\$method, \$value, \$args = false) {\n";

1512 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1513 
$code
 .= " \$this->mock->returns(\$method, \$value, \$args);\n";

1514 
$code
 .= " }\n";

1515 
$code
 .= " function„eturnsAt(\$timing, \$method, \$value, \$args = false) {\n";

1516 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1517 
$code
 .= " \$this->mock->returnsAt(\$timing, \$method, \$value, \$args);\n";

1518 
$code
 .= " }\n";

1519 
$code
 .= " function„eturnsByValue(\$method, \$value, \$args = false) {\n";

1520 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1521 
$code
 .= " \$this->mock->setReturnValue(\$method, \$value, \$args);\n";

1522 
$code
 .= " }\n";

1523 
$code
 .= " function„eturnsByValueAt(\$timing, \$method, \$value, \$args = false) {\n";

1524 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1525 
$code
 .= " \$this->mock->setReturnValueAt(\$timing, \$method, \$value, \$args);\n";

1526 
$code
 .= " }\n";

1527 
$code
 .= " function„eturnsByReference(\$method, &\$ref, \$args = false) {\n";

1528 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1529 
$code
 .= " \$this->mock->setReturnReference(\$method, \$ref, \$args);\n";

1530 
$code
 .= " }\n";

1531 
$code
 .= " function„eturnsByReferenceAt(\$timing, \$method, &\$ref, \$args = false) {\n";

1532 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1533 
$code
 .= " \$this->mock->setReturnReferenceAt(\$timing, \$method, \$ref, \$args);\n";

1534 
$code
 .= " }\n";

1535 
$code
 .= " function setReturnValue(\$method, \$value, \$args = false) {\n";

1536 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1537 
$code
 .= " \$this->mock->setReturnValue(\$method, \$value, \$args);\n";

1538 
$code
 .= " }\n";

1539 
$code
 .= " function setReturnValueAt(\$timing, \$method, \$value, \$args = false) {\n";

1540 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1541 
$code
 .= " \$this->mock->setReturnValueAt(\$timing, \$method, \$value, \$args);\n";

1542 
$code
 .= " }\n";

1543 
$code
 .= " function setReturnReference(\$method, &\$ref, \$args = false) {\n";

1544 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1545 
$code
 .= " \$this->mock->setReturnReference(\$method, \$ref, \$args);\n";

1546 
$code
 .= " }\n";

1547 
$code
 .= " function setReturnReferenceAt(\$timing, \$method, &\$ref, \$args = false) {\n";

1548 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1549 
$code
 .= " \$this->mock->setReturnReferenceAt(\$timing, \$method, \$ref, \$args);\n";

1550 
$code
 .= " }\n";

1551  
$code
;

1552 
	}
}

1559 
´Ùeùed
 
funùiÚ
 
	$chašMockEx³ù©iÚs
() {

1560 
$code
 = " functionƒxpect(\$method, \$args = false, \$msg = '%s') {\n";

1561 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1562 
$code
 .= " \$this->mock->expect(\$method, \$args, \$msg);\n";

1563 
$code
 .= " }\n";

1564 
$code
 .= " functionƒxpectAt(\$timing, \$method, \$args = false, \$msg = '%s') {\n";

1565 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1566 
$code
 .= " \$this->mock->expectAt(\$timing, \$method, \$args, \$msg);\n";

1567 
$code
 .= " }\n";

1568 
$code
 .= " functionƒxpectCallCount(\$method, \$count) {\n";

1569 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1570 
$code
 .= " \$this->mock->expectCallCount(\$method, \$count, \$msg = '%s');\n";

1571 
$code
 .= " }\n";

1572 
$code
 .= " functionƒxpectMaximumCallCount(\$method, \$count, \$msg = '%s') {\n";

1573 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1574 
$code
 .= " \$this->mock->expectMaximumCallCount(\$method, \$count, \$msg = '%s');\n";

1575 
$code
 .= " }\n";

1576 
$code
 .= " functionƒxpectMinimumCallCount(\$method, \$count, \$msg = '%s') {\n";

1577 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1578 
$code
 .= " \$this->mock->expectMinimumCallCount(\$method, \$count, \$msg = '%s');\n";

1579 
$code
 .= " }\n";

1580 
$code
 .= " functionƒxpectNever(\$method) {\n";

1581 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1582 
$code
 .= " \$this->mock->expectNever(\$method);\n";

1583 
$code
 .= " }\n";

1584 
$code
 .= " functionƒxpectOnce(\$method, \$args = false, \$msg = '%s') {\n";

1585 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1586 
$code
 .= " \$this->mock->expectOnce(\$method, \$args, \$msg);\n";

1587 
$code
 .= " }\n";

1588 
$code
 .= " functionƒxpectAtLeastOnce(\$method, \$args = false, \$msg = '%s') {\n";

1589 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1590 
$code
 .= " \$this->mock->expectAtLeastOnce(\$method, \$args, \$msg);\n";

1591 
$code
 .= " }\n";

1592  
$code
;

1593 
	}
}

1599 
´Ùeùed
 
funùiÚ
 
	$chašThrowM‘hods
() {

1600 
$code
 = " functionhrowOn(\$method, \$exception = false, \$args = false) {\n";

1601 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1602 
$code
 .= " \$this->mock->throwOn(\$method, \$exception, \$args);\n";

1603 
$code
 .= " }\n";

1604 
$code
 .= " functionhrowAt(\$timing, \$method, \$exception = false, \$args = false) {\n";

1605 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1606 
$code
 .= " \$this->mock->throwAt(\$timing, \$method, \$exception, \$args);\n";

1607 
$code
 .= " }\n";

1608 
$code
 .= " functionƒrrorOn(\$method, \$error = 'A mockƒrror', \$args = false, \$severity = E_USER_ERROR) {\n";

1609 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1610 
$code
 .= " \$this->mock->errorOn(\$method, \$error, \$args, \$severity);\n";

1611 
$code
 .= " }\n";

1612 
$code
 .= " functionƒrrorAt(\$timing, \$method, \$error = 'A mockƒrror', \$args = false, \$severity = E_USER_ERROR) {\n";

1613 
$code
 .ğ
$this
->
	`baOutIfNÙMocked
("\$method");

1614 
$code
 .= " \$this->mock->errorAt(\$timing, \$method, \$error, \$args, \$severity);\n";

1615 
$code
 .= " }\n";

1616  
$code
;

1617 
	}
}

1626 
´Ùeùed
 
funùiÚ
 
	$ov”rideM‘hods
(
$m‘hods
) {

1627 
$code
 = "";

1628 
	`fÜ—ch
 (
$m‘hods
 
as
 
$m‘hod
) {

1629 ià(
$this
->
	`isCÚ¡ruùÜ
(
$m‘hod
)) {

1632 
$code
 .ğ" " . 
$this
->
»æeùiÚ
->
	`g‘SigÇtu»
(
$m‘hod
) . " {\n";

1633 
$code
 .= " \$args = func_get_args();\n";

1634 
$code
 .= " \$result = &\$this->mock->invoke(\"$method\", \$args);\n";

1635 
$code
 .= "„eturn \$result;\n";

1636 
$code
 .= " }\n";

1638  
$code
;

1639 
	}
}

	@F:\Site\stew\1\_lp\simpletest\page.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/http.php');

13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/php_parser.php');

14 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/tag.php');

15 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/form.php');

16 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/selector.php');

24 şas 
	cSim¶ePage
 {

25 
´iv©e
 
	m$lšks
 = 
¬¿y
();

26 
´iv©e
 
	m$t™Ë
 = 
çl£
;

27 
´iv©e
 
	m$Ï¡_widg‘
;

28 
´iv©e
 
	m$Ïb–
;

29 
´iv©e
 
	m$fÜms
 = 
¬¿y
();

30 
´iv©e
 
	m$äames
 = 
¬¿y
();

31 
´iv©e
 
	m$Œª¥Üt_”rÜ
;

32 
´iv©e
 
	m$¿w
;

33 
´iv©e
 
	m$‹xt
 = 
çl£
;

34 
´iv©e
 
	m$£Á
;

35 
´iv©e
 
	m$h—d”s
;

36 
´iv©e
 
	m$m‘hod
;

37 
´iv©e
 
	m$u¾
;

38 
´iv©e
 
	m$ba£
 = 
çl£
;

39 
´iv©e
 
	m$»que¡_d©a
;

46 
funùiÚ
 
	$__cÚ¡ruù
(
$»¥Ú£
 = 
çl£
) {

47 ià(
$»¥Ú£
) {

48 
$this
->
	`exŒaùRe¥Ú£
(
$»¥Ú£
);

50 
$this
->
	`noRe¥Ú£
();

59 
´Ùeùed
 
funùiÚ
 
	$exŒaùRe¥Ú£
(
$»¥Ú£
) {

60 
$this
->
Œª¥Üt_”rÜ
 = 
$»¥Ú£
->
	`g‘E¼Ü
();

61 
$this
->
¿w
 = 
$»¥Ú£
->
	`g‘CÚ‹Á
();

62 
$this
->
£Á
 = 
$»¥Ú£
->
	`g‘S’t
();

63 
$this
->
h—d”s
 = 
$»¥Ú£
->
	`g‘H—d”s
();

64 
$this
->
m‘hod
 = 
$»¥Ú£
->
	`g‘M‘hod
();

65 
$this
->
u¾
 = 
$»¥Ú£
->
	`g‘U¾
();

66 
$this
->
»que¡_d©a
 = 
$»¥Ú£
->
	`g‘Reque¡D©a
();

67 
	}
}

73 
´Ùeùed
 
funùiÚ
 
	$noRe¥Ú£
() {

74 
$this
->
Œª¥Üt_”rÜ
 = 'No…age fetched yet';

75 
$this
->
¿w
 = 
çl£
;

76 
$this
->
£Á
 = 
çl£
;

77 
$this
->
h—d”s
 = 
çl£
;

78 
$this
->
m‘hod
 = 'GET';

79 
$this
->
u¾
 = 
çl£
;

80 
$this
->
»que¡_d©a
 = 
çl£
;

81 
	}
}

88 
funùiÚ
 
	$g‘Reque¡
() {

89  
$this
->
£Á
;

90 
	}
}

97 
funùiÚ
 
	$g‘Raw
() {

98  
$this
->
¿w
;

99 
	}
}

107 
funùiÚ
 
	$g‘Text
() {

108 ià(! 
$this
->
‹xt
) {

109 
$this
->
‹xt
 = 
Sim¶ePage
::
	`nÜm®i£
($this->
¿w
);

111  
$this
->
‹xt
;

112 
	}
}

119 
funùiÚ
 
	$g‘H—d”s
() {

120 ià(
$this
->
h—d”s
) {

121  
$this
->
h—d”s
->
	`g‘Raw
();

123  
çl£
;

124 
	}
}

131 
funùiÚ
 
	$g‘M‘hod
() {

132  
$this
->
m‘hod
;

133 
	}
}

140 
funùiÚ
 
	$g‘U¾
() {

141  
$this
->
u¾
;

142 
	}
}

149 
funùiÚ
 
	$g‘Ba£U¾
() {

150  
$this
->
ba£
;

151 
	}
}

158 
funùiÚ
 
	$g‘Reque¡D©a
() {

159  
$this
->
»que¡_d©a
;

160 
	}
}

167 
funùiÚ
 
	$g‘T¿n¥ÜtE¼Ü
() {

168  
$this
->
Œª¥Üt_”rÜ
;

169 
	}
}

176 
funùiÚ
 
	$g‘MimeTy³
() {

177 ià(
$this
->
h—d”s
) {

178  
$this
->
h—d”s
->
	`g‘MimeTy³
();

180  
çl£
;

181 
	}
}

188 
funùiÚ
 
	$g‘Re¥Ú£Code
() {

189 ià(
$this
->
h—d”s
) {

190  
$this
->
h—d”s
->
	`g‘Re¥Ú£Code
();

192  
çl£
;

193 
	}
}

201 
funùiÚ
 
	$g‘Auth’tiÿtiÚ
() {

202 ià(
$this
->
h—d”s
) {

203  
$this
->
h—d”s
->
	`g‘Auth’tiÿtiÚ
();

205  
çl£
;

206 
	}
}

214 
funùiÚ
 
	$g‘R—lm
() {

215 ià(
$this
->
h—d”s
) {

216  
$this
->
h—d”s
->
	`g‘R—lm
();

218  
çl£
;

219 
	}
}

227 
funùiÚ
 
	$g‘F¿meFocus
() {

228  
	`¬¿y
();

229 
	}
}

237 
funùiÚ
 
	$£tF¿meFocusByIndex
(
$choiû
) {

238  
çl£
;

239 
	}
}

247 
funùiÚ
 
	$£tF¿meFocus
(
$Çme
) {

248  
çl£
;

249 
	}
}

255 
funùiÚ
 
	$ş—rF¿meFocus
() {

256 
	}
}

261 
funùiÚ
 
	$£tF¿mes
(
$äames
) {

262 
$this
->
äames
 = 
$äames
;

263 
	}
}

271 
´Ùeùed
 
funùiÚ
 
	$lškIsAbsŞu‹
(
$u¾
) {

272 
$·r£d
 = 
Ãw
 
	`Sim¶eU¾
(
$u¾
);

273  (
boŞ—n
)(
$·r£d
->
	`g‘Scheme
(è&& $·r£d->
	`g‘Ho¡
());

274 
	}
}

280 
funùiÚ
 
	$addLšk
(
$g
) {

281 
$this
->
lšks
[] = 
$g
;

282 
	}
}

288 
funùiÚ
 
	$£tFÜms
(
$fÜms
) {

289 
$this
->
fÜms
 = 
$fÜms
;

290 
	}
}

297 
funùiÚ
 
	$hasF¿mes
() {

298  
	`couÁ
(
$this
->
äames
) > 0;

299 
	}
}

310 
funùiÚ
 
	$g‘F¿me£t
() {

311 ià(! 
$this
->
	`hasF¿mes
()) {

312  
çl£
;

314 
$u¾s
 = 
	`¬¿y
();

315 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
äames
); $i++) {

316 
$Çme
 = 
$this
->
äames
[
$i
]->
	`g‘A‰ribu‹
('name');

317 
$u¾
 = 
Ãw
 
	`Sim¶eU¾
(
$this
->
äames
[
$i
]->
	`g‘A‰ribu‹
('src'));

318 
$u¾s
[
$Çme
 ? $Çm: 
$i
 + 1] = 
$this
->
	`ex·ndU¾
(
$u¾
);

320  
$u¾s
;

321 
	}
}

328 
funùiÚ
 
	$g‘F¿mes
() {

329 
$u¾
 = 
$this
->
	`ex·ndU¾
($this->
	`g‘U¾
());

330  
$u¾
->
	`asSŒšg
();

331 
	}
}

339 
funùiÚ
 
	$g‘U¾s
() {

340 
$®l
 = 
	`¬¿y
();

341 
	`fÜ—ch
 (
$this
->
lšks
 
as
 
$lšk
) {

342 
$u¾
 = 
$this
->
	`g‘U¾FromLšk
(
$lšk
);

343 
$®l
[] = 
$u¾
->
	`asSŒšg
();

345  
$®l
;

346 
	}
}

355 
funùiÚ
 
	$g‘U¾sByLab–
(
$Ïb–
) {

356 
$m©ches
 = 
	`¬¿y
();

357 
	`fÜ—ch
 (
$this
->
lšks
 
as
 
$lšk
) {

358 ià(
$lšk
->
	`g‘Text
(è=ğ
$Ïb–
) {

359 
$m©ches
[] = 
$this
->
	`g‘U¾FromLšk
(
$lšk
);

362  
$m©ches
;

363 
	}
}

371 
funùiÚ
 
	$g‘U¾ById
(
$id
) {

372 
	`fÜ—ch
 (
$this
->
lšks
 
as
 
$lšk
) {

373 ià(
$lšk
->
	`g‘A‰ribu‹
('id'è==ğ(
¡ršg
)
$id
) {

374  
$this
->
	`g‘U¾FromLšk
(
$lšk
);

377  
çl£
;

378 
	}
}

386 
´Ùeùed
 
funùiÚ
 
	$g‘U¾FromLšk
(
$lšk
) {

387 
$u¾
 = 
$this
->
	`ex·ndU¾
(
$lšk
->
	`g‘H»f
());

388 ià(
$lšk
->
	`g‘A‰ribu‹
('target')) {

389 
$u¾
->
	`£tT¬g‘
(
$lšk
->
	`g‘A‰ribu‹
('target'));

391  
$u¾
;

392 
	}
}

401 
funùiÚ
 
	$ex·ndU¾
(
$u¾
) {

402 ià(! 
	`is_objeù
(
$u¾
)) {

403 
$u¾
 = 
Ãw
 
	`Sim¶eU¾
($url);

405 
$loÿtiÚ
 = 
$this
->
	`g‘Ba£U¾
(è? $this->g‘Ba£U¾(è: 
Ãw
 
	`Sim¶eU¾
();

406  
$u¾
->
	`makeAbsŞu‹
(
$loÿtiÚ
->makeAbsŞu‹(
$this
->
	`g‘U¾
()));

407 
	}
}

413 
funùiÚ
 
	$£tBa£
(
$u¾
) {

414 
$this
->
ba£
 = 
Ãw
 
	`Sim¶eU¾
(
$u¾
);

415 
	}
}

421 
funùiÚ
 
	$£tT™Ë
(
$g
) {

422 
$this
->
t™Ë
 = 
$g
;

423 
	}
}

430 
funùiÚ
 
	$g‘T™Ë
() {

431 ià(
$this
->
t™Ë
) {

432  
$this
->
t™Ë
->
	`g‘Text
();

434  
çl£
;

435 
	}
}

445 
funùiÚ
 
	$g‘FÜmBySubm™
(
$£ËùÜ
) {

446 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
fÜms
); $i++) {

447 ià(
$this
->
fÜms
[
$i
]->
	`hasSubm™
(
$£ËùÜ
)) {

448  
$this
->
fÜms
[
$i
];

451  
nuÎ
;

452 
	}
}

462 
funùiÚ
 
	$g‘FÜmByImage
(
$£ËùÜ
) {

463 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
fÜms
); $i++) {

464 ià(
$this
->
fÜms
[
$i
]->
	`hasImage
(
$£ËùÜ
)) {

465  
$this
->
fÜms
[
$i
];

468  
nuÎ
;

469 
	}
}

479 
funùiÚ
 
	$g‘FÜmById
(
$id
) {

480 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
fÜms
); $i++) {

481 ià(
$this
->
fÜms
[
$i
]->
	`g‘Id
(è=ğ
$id
) {

482  
$this
->
fÜms
[
$i
];

485  
nuÎ
;

486 
	}
}

496 
funùiÚ
 
	$£tF›ld
(
$£ËùÜ
, 
$v®ue
, 
$pos™iÚ
=
çl£
) {

497 
$is_£t
 = 
çl£
;

498 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
fÜms
); $i++) {

499 ià(
$this
->
fÜms
[
$i
]->
	`£tF›ld
(
$£ËùÜ
, 
$v®ue
, 
$pos™iÚ
)) {

500 
$is_£t
 = 
Œue
;

503  
$is_£t
;

504 
	}
}

514 
funùiÚ
 
	$g‘F›ld
(
$£ËùÜ
) {

515 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
fÜms
); $i++) {

516 
$v®ue
 = 
$this
->
fÜms
[
$i
]->
	`g‘V®ue
(
$£ËùÜ
);

517 ià(
	`is£t
(
$v®ue
)) {

518  
$v®ue
;

521  
nuÎ
;

522 
	}
}

532 
funùiÚ
 
	$nÜm®i£
(
$html
) {

533 
$‹xt
 = 
	`´eg_»¶aû
('#<!--.*?-->#si', '', 
$html
);

534 
$‹xt
 = 
	`´eg_»¶aû
('#<(script|option|textarea)[^>]*>.*?</\1>#si', '', $text);

535 
$‹xt
 = 
	`´eg_»¶aû
('#<img[^>]*alt\s*=\s*("([^"]*)"|\'([^\']*)\'|([a-zA-Z_]+))[^>]*>#', ' \2\3\4 ', $text);

536 
$‹xt
 = 
	`´eg_»¶aû
('#<[^>]*>#', '', $text);

537 
$‹xt
 = 
	`html_’t™y_decode
($‹xt, 
ENT_QUOTES
);

538 
$‹xt
 = 
	`´eg_»¶aû
('#\s+#', ' ', $text);

539  
	`Œim
Ñrim(
$‹xt
), "\xA0");

540 
	}
}

	@F:\Site\stew\1\_lp\simpletest\php_parser.php

1 <?
php


12 
fÜ—ch
 (
¬¿y
('LEXER_ENTER', 'LEXER_MATCHED',

14 'LEXER_SPECIAL'è
as
 
$i
 => 
$cÚ¡ªt
) {

15 ià(! 
defšed
(
$cÚ¡ªt
)) {

16 
defše
(
$cÚ¡ªt
, 
$i
 + 1);

28 şas 
	cP¬®ËlRegex
 {

29 
´iv©e
 
	m$·‰”ns
;

30 
´iv©e
 
	m$Ïb–s
;

31 
´iv©e
 
	m$»gex
;

32 
´iv©e
 
	m$ÿ£
;

40 
funùiÚ
 
	$__cÚ¡ruù
(
$ÿ£
) {

41 
$this
->ğ
$ÿ£
;

42 
$this
->
·‰”ns
 = 
	`¬¿y
();

43 
$this
->
Ïb–s
 = 
	`¬¿y
();

44 
$this
->
»gex
 = 
nuÎ
;

55 
funùiÚ
 
	$addP©‹º
(
$·‰”n
, 
$Ïb–
 = 
Œue
) {

56 
$couÁ
 = 
	`couÁ
(
$this
->
·‰”ns
);

57 
$this
->
·‰”ns
[
$couÁ
] = 
$·‰”n
;

58 
$this
->
Ïb–s
[
$couÁ
] = 
$Ïb–
;

59 
$this
->
»gex
 = 
nuÎ
;

60 
	}
}

71 
funùiÚ
 
	$m©ch
(
$subjeù
, &
$m©ch
) {

72 ià(
	`couÁ
(
$this
->
·‰”ns
) == 0) {

73  
çl£
;

75 ià(! 
	`´eg_m©ch
(
$this
->
	`g‘CompoundedRegex
(), 
$subjeù
, 
$m©ches
)) {

76 
$m©ch
 = '';

77  
çl£
;

79 
$m©ch
 = 
$m©ches
[0];

80 
$i
 = 1; $˜< 
	`couÁ
(
$m©ches
); $i++) {

81 ià(
$m©ches
[
$i
]) {

82  
$this
->
Ïb–s
[
$i
 - 1];

85  
Œue
;

86 
	}
}

96 
´Ùeùed
 
funùiÚ
 
	$g‘CompoundedRegex
() {

97 ià(
$this
->
»gex
 =ğ
nuÎ
) {

98 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$this
->
·‰”ns
); $i < $count; $i++) {

99 
$this
->
·‰”ns
[
$i
] = '(' . 
	`¡r_»¶aû
(

100 
	`¬¿y
('/', '(', ')'),

101 
	`¬¿y
('\/', '\(', '\)'),

102 
$this
->
·‰”ns
[
$i
]) . ')';

104 
$this
->
»gex
 = "/" . 
	`im¶ode
("|", $this->
·‰”ns
è. "/" . $this->
	`g‘P”lM©chšgFÏgs
();

106  
$this
->
»gex
;

107 
	}
}

114 
´Ùeùed
 
funùiÚ
 
	$g‘P”lM©chšgFÏgs
() {

115  (
$this
->? "msS" : "msSi");

116 
	}
}

124 şas 
	cSim¶eS‹Sck
 {

125 
´iv©e
 
	m$¡ack
;

132 
funùiÚ
 
	$__cÚ¡ruù
(
$¡¬t
) {

133 
$this
->
¡ack
 = 
	`¬¿y
(
$¡¬t
);

141 
funùiÚ
 
	$g‘Cu¼’t
() {

142  
$this
->
¡ack
[
	`couÁ
($this->stack) - 1];

143 
	}
}

151 
funùiÚ
 
	$’‹r
(
$¡©e
) {

152 
	`¬¿y_push
(
$this
->
¡ack
, 
$¡©e
);

153 
	}
}

162 
funùiÚ
 
	$Ëave
() {

163 ià(
	`couÁ
(
$this
->
¡ack
) == 1) {

164  
çl£
;

166 
	`¬¿y_pİ
(
$this
->
¡ack
);

167  
Œue
;

168 
	}
}

180 şas 
	cSim¶eLex”
 {

181 
´iv©e
 
	m$»gexes
;

182 
´iv©e
 
	m$·r£r
;

183 
´iv©e
 
	m$mode
;

184 
´iv©e
 
	m$mode_hªdËrs
;

185 
´iv©e
 
	m$ÿ£
;

196 
funùiÚ
 
__cÚ¡ruù
(
$·r£r
, 
$¡¬t
 = "acû±", 
$ÿ£
 = 
çl£
) {

197 
$this
->ğ
$ÿ£
;

198 
	m$this
->
	m»gexes
 = 
¬¿y
();

199 
	m$this
->
	m·r£r
 = 
$·r£r
;

200 
	m$this
->
	mmode
 = 
Ãw
 
Sim¶eS‹Sck
(
$¡¬t
);

201 
	m$this
->
	mmode_hªdËrs
 = 
¬¿y
(
$¡¬t
 => $start);

215 
funùiÚ
 
addP©‹º
(
$·‰”n
, 
$mode
 = "accept") {

216 ià(! 
is£t
(
$this
->
»gexes
[
$mode
])) {

217 
$this
->
»gexes
[
$mode
] = 
Ãw
 
P¬®ËlRegex
($this->);

219 
	g$this
->
	g»gexes
[
$mode
]->
addP©‹º
(
$·‰”n
);

220 ià(! 
is£t
(
$this
->
mode_hªdËrs
[
$mode
])) {

221 
	g$this
->
	gmode_hªdËrs
[
$mode
] = $mode;

238 
funùiÚ
 
	$addEÁryP©‹º
(
$·‰”n
, 
$mode
, 
$Ãw_mode
) {

239 ià(! 
	`is£t
(
$this
->
»gexes
[
$mode
])) {

240 
$this
->
»gexes
[
$mode
] = 
Ãw
 
	`P¬®ËlRegex
($this->);

242 
$this
->
»gexes
[
$mode
]->
	`addP©‹º
(
$·‰”n
, 
$Ãw_mode
);

243 ià(! 
	`is£t
(
$this
->
mode_hªdËrs
[
$Ãw_mode
])) {

244 
$this
->
mode_hªdËrs
[
$Ãw_mode
] = $new_mode;

246 
	}
}

256 
funùiÚ
 
	$addEx™P©‹º
(
$·‰”n
, 
$mode
) {

257 ià(! 
	`is£t
(
$this
->
»gexes
[
$mode
])) {

258 
$this
->
»gexes
[
$mode
] = 
Ãw
 
	`P¬®ËlRegex
($this->);

260 
$this
->
»gexes
[
$mode
]->
	`addP©‹º
(
$·‰”n
, "__exit");

261 ià(! 
	`is£t
(
$this
->
mode_hªdËrs
[
$mode
])) {

262 
$this
->
mode_hªdËrs
[
$mode
] = $mode;

264 
	}
}

278 
funùiÚ
 
	$addS³cŸlP©‹º
(
$·‰”n
, 
$mode
, 
$¥ecŸl
) {

279 ià(! 
	`is£t
(
$this
->
»gexes
[
$mode
])) {

280 
$this
->
»gexes
[
$mode
] = 
Ãw
 
	`P¬®ËlRegex
($this->);

282 
$this
->
»gexes
[
$mode
]->
	`addP©‹º
(
$·‰”n
, "_$special");

283 ià(! 
	`is£t
(
$this
->
mode_hªdËrs
[
$¥ecŸl
])) {

284 
$this
->
mode_hªdËrs
[
$¥ecŸl
] = $special;

286 
	}
}

294 
funùiÚ
 
	$m­HªdËr
(
$mode
, 
$hªdËr
) {

295 
$this
->
mode_hªdËrs
[
$mode
] = 
$hªdËr
;

296 
	}
}

308 
funùiÚ
 
	$·r£
(
$¿w
) {

309 ià(! 
	`is£t
(
$this
->
·r£r
)) {

310  
çl£
;

312 
$Ëngth
 = 
	`¡¾’
(
$¿w
);

313 
	`is_¬¿y
(
$·r£d
 = 
$this
->
	`»duû
(
$¿w
))) {

314 
	`li¡
(
$¿w
, 
$unm©ched
, 
$m©ched
, 
$mode
èğ
$·r£d
;

315 ià(! 
$this
->
	`di¥©chTok’s
(
$unm©ched
, 
$m©ched
, 
$mode
)) {

316  
çl£
;

318 ià(
$¿w
 === '') {

319  
Œue
;

321 ià(
	`¡¾’
(
$¿w
è=ğ
$Ëngth
) {

322  
çl£
;

324 
$Ëngth
 = 
	`¡¾’
(
$¿w
);

326 ià(! 
$·r£d
) {

327  
çl£
;

329  
$this
->
	`švokeP¬£r
(
$¿w
, 
LEXER_UNMATCHED
);

330 
	}
}

344 
´Ùeùed
 
funùiÚ
 
	$di¥©chTok’s
(
$unm©ched
, 
$m©ched
, 
$mode
 = 
çl£
) {

345 ià(! 
$this
->
	`švokeP¬£r
(
$unm©ched
, 
LEXER_UNMATCHED
)) {

346  
çl£
;

348 ià(
	`is_boŞ
(
$mode
)) {

349  
$this
->
	`švokeP¬£r
(
$m©ched
, 
LEXER_MATCHED
);

351 ià(
$this
->
	`isModeEnd
(
$mode
)) {

352 ià(! 
$this
->
	`švokeP¬£r
(
$m©ched
, 
LEXER_EXIT
)) {

353  
çl£
;

355  
$this
->
mode
->
	`Ëave
();

357 ià(
$this
->
	`isS³cŸlMode
(
$mode
)) {

358 
$this
->
mode
->
	`’‹r
($this->
	`decodeS³cŸl
(
$mode
));

359 ià(! 
$this
->
	`švokeP¬£r
(
$m©ched
, 
LEXER_SPECIAL
)) {

360  
çl£
;

362  
$this
->
mode
->
	`Ëave
();

364 
$this
->
mode
->
	`’‹r
(
$mode
);

365  
$this
->
	`švokeP¬£r
(
$m©ched
, 
LEXER_ENTER
);

366 
	}
}

376 
´Ùeùed
 
funùiÚ
 
	$isModeEnd
(
$mode
) {

377  (
$mode
 === "__exit");

378 
	}
}

388 
´Ùeùed
 
funùiÚ
 
	$isS³cŸlMode
(
$mode
) {

389  (
	`¡ºcmp
(
$mode
, "_", 1) == 0);

390 
	}
}

399 
´Ùeùed
 
funùiÚ
 
	$decodeS³cŸl
(
$mode
) {

400  
	`sub¡r
(
$mode
, 1);

401 
	}
}

412 
´Ùeùed
 
funùiÚ
 
	$švokeP¬£r
(
$cÚ‹Á
, 
$is_m©ch
) {

413 ià((
$cÚ‹Á
 ==ğ''è|| ($cÚ‹Á ==ğ
çl£
)) {

414  
Œue
;

416 
$hªdËr
 = 
$this
->
mode_hªdËrs
[$this->
mode
->
	`g‘Cu¼’t
()];

417  
$this
->
·r£r
->
	`$hªdËr
(
$cÚ‹Á
, 
$is_m©ch
);

418 
	}
}

434 
´Ùeùed
 
funùiÚ
 
	$»duû
(
$¿w
) {

435 ià(
$aùiÚ
 = 
$this
->
»gexes
[$this->
mode
->
	`g‘Cu¼’t
()]->
	`m©ch
(
$¿w
, 
$m©ch
)) {

436 
$uÅ¬£d_ch¬aù”_couÁ
 = 
	`¡½os
(
$¿w
, 
$m©ch
);

437 
$uÅ¬£d
 = 
	`sub¡r
(
$¿w
, 0, 
$uÅ¬£d_ch¬aù”_couÁ
);

438 
$¿w
 = 
	`sub¡r
($¿w, 
$uÅ¬£d_ch¬aù”_couÁ
 + 
	`¡¾’
(
$m©ch
));

439  
	`¬¿y
(
$¿w
, 
$uÅ¬£d
, 
$m©ch
, 
$aùiÚ
);

441  
Œue
;

442 
	}
}

450 şas 
	cSim¶eHtmlLex”
 
ex‹nds
 
	mSim¶eLex”
 {

459 
funùiÚ
 
	$__cÚ¡ruù
(
$·r£r
) {

460 
·»Á
::
	`__cÚ¡ruù
(
$·r£r
, 'text');

461 
$this
->
	`m­HªdËr
('text', 'acceptTextToken');

462 
$this
->
	`addSkpšg
();

463 
	`fÜ—ch
 (
$this
->
	`g‘P¬£dTags
(è
as
 
$g
) {

464 
$this
->
	`addTag
(
$g
);

466 
$this
->
	`addInTagTok’s
();

474 
´Ùeùed
 
funùiÚ
 
	$g‘P¬£dTags
() {

475  
	`¬¿y
('a', 'base', 'title', 'form', 'input', 'button', 'textarea', 'select',

477 
	}
}

484 
´Ùeùed
 
funùiÚ
 
	$addSkpšg
() {

485 
$this
->
	`m­HªdËr
('css', 'ignore');

486 
$this
->
	`addEÁryP©‹º
('<style', 'text', 'css');

487 
$this
->
	`addEx™P©‹º
('</style>', 'css');

488 
$this
->
	`m­HªdËr
('js', 'ignore');

489 
$this
->
	`addEÁryP©‹º
('<script', 'text', 'js');

490 
$this
->
	`addEx™P©‹º
('</script>', 'js');

491 
$this
->
	`m­HªdËr
('comment', 'ignore');

492 
$this
->
	`addEÁryP©‹º
('<!--', 'text', 'comment');

493 
$this
->
	`addEx™P©‹º
('-->', 'comment');

494 
	}
}

501 
´Ùeùed
 
funùiÚ
 
	$addTag
(
$g
) {

502 
$this
->
	`addS³cŸlP©‹º
("</$tag>", 'text', 'acceptEndToken');

503 
$this
->
	`addEÁryP©‹º
("<$tag", 'text', 'tag');

504 
	}
}

511 
´Ùeùed
 
funùiÚ
 
	$addInTagTok’s
() {

512 
$this
->
	`m­HªdËr
('tag', 'acceptStartToken');

513 
$this
->
	`addS³cŸlP©‹º
('\s+', 'tag', 'ignore');

514 
$this
->
	`addA‰ribu‹Tok’s
();

515 
$this
->
	`addEx™P©‹º
('/>', 'tag');

516 
$this
->
	`addEx™P©‹º
('>', 'tag');

517 
	}
}

524 
´Ùeùed
 
funùiÚ
 
	$addA‰ribu‹Tok’s
() {

525 
$this
->
	`m­HªdËr
('dq_attribute', 'acceptAttributeToken');

526 
$this
->
	`addEÁryP©‹º
('=\s*"', 'tag', 'dq_attribute');

527 
$this
->
	`addP©‹º
("\\\\\"", 'dq_attribute');

528 
$this
->
	`addEx™P©‹º
('"', 'dq_attribute');

529 
$this
->
	`m­HªdËr
('sq_attribute', 'acceptAttributeToken');

530 
$this
->
	`addEÁryP©‹º
("=\s*'", 'tag', 'sq_attribute');

531 
$this
->
	`addP©‹º
("\\\\'", 'sq_attribute');

532 
$this
->
	`addEx™P©‹º
("'", 'sq_attribute');

533 
$this
->
	`m­HªdËr
('uq_attribute', 'acceptAttributeToken');

534 
$this
->
	`addS³cŸlP©‹º
('=\s*[^>\s]*', 'tag', 'uq_attribute');

535 
	}
}

543 şas 
	cSim¶eHtmlSaxP¬£r
 {

544 
´iv©e
 
	m$Ëx”
;

545 
´iv©e
 
	m$li¡’”
;

546 
´iv©e
 
	m$g
;

547 
´iv©e
 
	m$©Œibu‹s
;

548 
´iv©e
 
	m$cu¼’t_©Œibu‹
;

555 
funùiÚ
 
	$__cÚ¡ruù
(
$li¡’”
) {

556 
$this
->
li¡’”
 = 
$li¡’”
;

557 
$this
->
Ëx”
 = $this->
	`ü—‹Lex”
($this);

558 
$this
->
g
 = '';

559 
$this
->
©Œibu‹s
 = 
	`¬¿y
();

560 
$this
->
cu¼’t_©Œibu‹
 = '';

570 
funùiÚ
 
	$·r£
(
$¿w
) {

571  
$this
->
Ëx”
->
	`·r£
(
$¿w
);

572 
	}
}

580 
funùiÚ
 
	$ü—‹Lex”
(&
$·r£r
) {

581  
Ãw
 
	`Sim¶eHtmlLex”
(
$·r£r
);

582 
	}
}

595 
funùiÚ
 
	$acû±S¹Tok’
(
$tok’
, 
$ev’t
) {

596 ià(
$ev’t
 =ğ
LEXER_ENTER
) {

597 
$this
->
g
 = 
	`¡¹Şow”
(
	`sub¡r
(
$tok’
, 1));

598  
Œue
;

600 ià(
$ev’t
 =ğ
LEXER_EXIT
) {

601 
$sucûss
 = 
$this
->
li¡’”
->
	`¡¬tEËm’t
(

602 
$this
->
g
,

603 
$this
->
©Œibu‹s
);

604 
$this
->
g
 = '';

605 
$this
->
©Œibu‹s
 = 
	`¬¿y
();

606  
$sucûss
;

608 ià(
$tok’
 != '=') {

609 
$this
->
cu¼’t_©Œibu‹
 = 
	`¡¹Şow”
(
	`html_’t™y_decode
(
$tok’
, 
ENT_QUOTES
));

610 
$this
->
©Œibu‹s
[$this->
cu¼’t_©Œibu‹
] = '';

612  
Œue
;

613 
	}
}

623 
funùiÚ
 
	$acû±EndTok’
(
$tok’
, 
$ev’t
) {

624 ià(! 
	`´eg_m©ch
('/<\/(.*)>/', 
$tok’
, 
$m©ches
)) {

625  
çl£
;

627  
$this
->
li¡’”
->
	`’dEËm’t
(
	`¡¹Şow”
(
$m©ches
[1]));

628 
	}
}

637 
funùiÚ
 
	$acû±A‰ribu‹Tok’
(
$tok’
, 
$ev’t
) {

638 ià(
$this
->
cu¼’t_©Œibu‹
) {

639 ià(
$ev’t
 =ğ
LEXER_UNMATCHED
) {

640 
$this
->
©Œibu‹s
[$this->
cu¼’t_©Œibu‹
] .=

641 
	`html_’t™y_decode
(
$tok’
, 
ENT_QUOTES
);

643 ià(
$ev’t
 =ğ
LEXER_SPECIAL
) {

644 
$this
->
©Œibu‹s
[$this->
cu¼’t_©Œibu‹
] .=

645 
	`´eg_»¶aû
('/^=\s*/' , '', 
	`html_’t™y_decode
(
$tok’
, 
ENT_QUOTES
));

648  
Œue
;

649 
	}
}

658 
funùiÚ
 
	$acû±EÁ™yTok’
(
$tok’
, 
$ev’t
) {

659 
	}
}

669 
funùiÚ
 
	$acû±TextTok’
(
$tok’
, 
$ev’t
) {

670  
$this
->
li¡’”
->
	`addCÚ‹Á
(
$tok’
);

671 
	}
}

680 
funùiÚ
 
	$ignÜe
(
$tok’
, 
$ev’t
) {

681  
Œue
;

682 
	}
}

691 şas 
	cSim¶ePhpPageBud”
 {

692 
´iv©e
 
	m$gs
;

693 
´iv©e
 
	m$·ge
;

694 
´iv©e
 
	m$´iv©e_cÚ‹Á_g
;

695 
´iv©e
 
	m$İ’_fÜms
 = 
¬¿y
();

696 
´iv©e
 
	m$com¶‘e_fÜms
 = 
¬¿y
();

697 
´iv©e
 
	m$äame£t
 = 
çl£
;

698 
´iv©e
 
	m$lßdšg_äames
 = 
¬¿y
();

699 
´iv©e
 
	m$äame£t_Ã¡šg_Ëv–
 = 0;

700 
´iv©e
 
	m$Ëá_ov”_Ïb–s
 = 
¬¿y
();

707 
funùiÚ
 
	$ä“
() {

708 
	`un£t
(
$this
->
gs
);

709 
	`un£t
(
$this
->
·ge
);

710 
	`un£t
(
$this
->
´iv©e_cÚ‹Á_gs
);

711 
$this
->
İ’_fÜms
 = 
	`¬¿y
();

712 
$this
->
com¶‘e_fÜms
 = 
	`¬¿y
();

713 
$this
->
äame£t
 = 
çl£
;

714 
$this
->
lßdšg_äames
 = 
	`¬¿y
();

715 
$this
->
äame£t_Ã¡šg_Ëv–
 = 0;

716 
$this
->
Ëá_ov”_Ïb–s
 = 
	`¬¿y
();

723 
funùiÚ
 
	$ÿn
() {

724  
Œue
;

725 
	}
}

734 
funùiÚ
 
	$·r£
(
$»¥Ú£
) {

735 
$this
->
gs
 = 
	`¬¿y
();

736 
$this
->
·ge
 = $this->
	`ü—‹Page
(
$»¥Ú£
);

737 
$·r£r
 = 
$this
->
	`ü—‹P¬£r
($this);

738 
$·r£r
->
	`·r£
(
$»¥Ú£
->
	`g‘CÚ‹Á
());

739 
$this
->
	`acû±PageEnd
();

740 
$·ge
 = 
$this
->
·ge
;

741 
$this
->
	`ä“
();

742  
$·ge
;

743 
	}
}

750 
´Ùeùed
 
funùiÚ
 
	$ü—‹Page
(
$»¥Ú£
) {

751  
Ãw
 
	`Sim¶ePage
(
$»¥Ú£
);

752 
	}
}

761 
´Ùeùed
 
funùiÚ
 
	$ü—‹P¬£r
(&
$li¡’”
) {

762  
Ãw
 
	`Sim¶eHtmlSaxP¬£r
(
$li¡’”
);

763 
	}
}

773 
funùiÚ
 
	$¡¬tEËm’t
(
$Çme
, 
$©Œibu‹s
) {

774 
$çùÜy
 = 
Ãw
 
	`Sim¶eTagBud”
();

775 
$g
 = 
$çùÜy
->
	`ü—‹Tag
(
$Çme
, 
$©Œibu‹s
);

776 ià(! 
$g
) {

777  
Œue
;

779 ià(
$g
->
	`g‘TagName
() == 'label') {

780 
$this
->
	`acû±Lab–S¹
(
$g
);

781 
$this
->
	`İ’Tag
(
$g
);

782  
Œue
;

784 ià(
$g
->
	`g‘TagName
() == 'form') {

785 
$this
->
	`acû±FÜmS¹
(
$g
);

786  
Œue
;

788 ià(
$g
->
	`g‘TagName
() == 'frameset') {

789 
$this
->
	`acû±F¿me£tS¹
(
$g
);

790  
Œue
;

792 ià(
$g
->
	`g‘TagName
() == 'frame') {

793 
$this
->
	`acû±F¿me
(
$g
);

794  
Œue
;

796 ià(
$g
->
	`isPriv©eCÚ‹Á
(è&& ! 
	`is£t
(
$this
->
´iv©e_cÚ‹Á_g
)) {

797 
$this
->
´iv©e_cÚ‹Á_g
 = &
$g
;

799 ià(
$g
->
	`ex³ùEndTag
()) {

800 
$this
->
	`İ’Tag
(
$g
);

801  
Œue
;

803 
$this
->
	`acû±Tag
(
$g
);

804  
Œue
;

805 
	}
}

813 
funùiÚ
 
	$’dEËm’t
(
$Çme
) {

814 ià(
$Çme
 == 'label') {

815 
$this
->
	`acû±Lab–End
();

816  
Œue
;

818 ià(
$Çme
 == 'form') {

819 
$this
->
	`acû±FÜmEnd
();

820  
Œue
;

822 ià(
$Çme
 == 'frameset') {

823 
$this
->
	`acû±F¿me£tEnd
();

824  
Œue
;

826 ià(
$this
->
	`hasNamedTagOnO³nTagSck
(
$Çme
)) {

827 
$g
 = 
	`¬¿y_pİ
(
$this
->
gs
[
$Çme
]);

828 ià(
$g
->
	`isPriv©eCÚ‹Á
(è&& 
$this
->
´iv©e_cÚ‹Á_g
->
	`g‘TagName
(è=ğ
$Çme
) {

829 
	`un£t
(
$this
->
´iv©e_cÚ‹Á_g
);

831 
$this
->
	`addCÚ‹ÁTagToO³nTags
(
$g
);

832 
$this
->
	`acû±Tag
(
$g
);

833  
Œue
;

835  
Œue
;

836 
	}
}

845 
´Ùeùed
 
funùiÚ
 
	$hasNamedTagOnO³nTagSck
(
$Çme
) {

846  
	`is£t
(
$this
->
gs
[
$Çme
]è&& (
	`couÁ
($this->tags[$name]) > 0);

847 
	}
}

856 
funùiÚ
 
	$addCÚ‹Á
(
$‹xt
) {

857 ià(
	`is£t
(
$this
->
´iv©e_cÚ‹Á_g
)) {

858 
$this
->
´iv©e_cÚ‹Á_g
->
	`addCÚ‹Á
(
$‹xt
);

860 
$this
->
	`addCÚ‹ÁToAÎO³nTags
(
$‹xt
);

862  
Œue
;

863 
	}
}

871 
´Ùeùed
 
funùiÚ
 
	$addCÚ‹ÁToAÎO³nTags
(
$‹xt
) {

872 
	`fÜ—ch
 (
	`¬¿y_keys
(
$this
->
gs
è
as
 
$Çme
) {

873 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$this
->
gs
[
$Çme
]); $i < $count; $i++) {

874 
$this
->
gs
[
$Çme
][
$i
]->
	`addCÚ‹Á
(
$‹xt
);

877 
	}
}

886 
´Ùeùed
 
funùiÚ
 
	$addCÚ‹ÁTagToO³nTags
(&
$g
) {

887 ià(
$g
->
	`g‘TagName
() != 'option') {

890 
	`fÜ—ch
 (
	`¬¿y_keys
(
$this
->
gs
è
as
 
$Çme
) {

891 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$this
->
gs
[
$Çme
]); $i < $count; $i++) {

892 
$this
->
gs
[
$Çme
][
$i
]->
	`addTag
(
$g
);

895 
	}
}

903 
´Ùeùed
 
funùiÚ
 
	$İ’Tag
(
$g
) {

904 
$Çme
 = 
$g
->
	`g‘TagName
();

905 ià(! 
	`š_¬¿y
(
$Çme
, 
	`¬¿y_keys
(
$this
->
gs
))) {

906 
$this
->
gs
[
$Çme
] = 
	`¬¿y
();

908 
$this
->
gs
[
$Çme
][] = 
$g
;

909 
	}
}

916 
´Ùeùed
 
funùiÚ
 
	$acû±Tag
(
$g
) {

917 ià(
$g
->
	`g‘TagName
() == "a") {

918 
$this
->
·ge
->
	`addLšk
(
$g
);

919 } 
	`–£if
 (
$g
->
	`g‘TagName
() == "base") {

920 
$this
->
·ge
->
	`£tBa£
(
$g
->
	`g‘A‰ribu‹
('href'));

921 } 
	`–£if
 (
$g
->
	`g‘TagName
() == "title") {

922 
$this
->
·ge
->
	`£tT™Ë
(
$g
);

923 } 
	`–£if
 (
$this
->
	`isFÜmEËm’t
(
$g
->
	`g‘TagName
())) {

924 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
İ’_fÜms
); $i++) {

925 
$this
->
İ’_fÜms
[
$i
]->
	`addWidg‘
(
$g
);

927 
$this
->
Ï¡_widg‘
 = 
$g
;

929 
	}
}

936 
´Ùeùed
 
funùiÚ
 
	$acû±Lab–S¹
(
$g
) {

937 
$this
->
Ïb–
 = 
$g
;

938 
	`un£t
(
$this
->
Ï¡_widg‘
);

939 
	}
}

945 
´Ùeùed
 
funùiÚ
 
	$acû±Lab–End
() {

946 ià(
	`is£t
(
$this
->
Ïb–
)) {

947 ià(
	`is£t
(
$this
->
Ï¡_widg‘
)) {

948 
$this
->
Ï¡_widg‘
->
	`£tLab–
($this->
Ïb–
->
	`g‘Text
());

949 
	`un£t
(
$this
->
Ï¡_widg‘
);

951 
$this
->
Ëá_ov”_Ïb–s
[] = 
Sim¶eTe¡Com·tib™y
::
	`cİy
($this->
Ïb–
);

953 
	`un£t
(
$this
->
Ïb–
);

955 
	}
}

964 
´Ùeùed
 
funùiÚ
 
	$isFÜmEËm’t
(
$Çme
) {

965  
	`š_¬¿y
(
$Çme
, 
	`¬¿y
('input', 'button', 'textarea', 'select'));

966 
	}
}

973 
´Ùeùed
 
funùiÚ
 
	$acû±FÜmS¹
(
$g
) {

974 
$this
->
İ’_fÜms
[] = 
Ãw
 
	`Sim¶eFÜm
(
$g
, $this->
·ge
);

975 
	}
}

981 
´Ùeùed
 
funùiÚ
 
	$acû±FÜmEnd
() {

982 ià(
	`couÁ
(
$this
->
İ’_fÜms
)) {

983 
$this
->
com¶‘e_fÜms
[] = 
	`¬¿y_pİ
($this->
İ’_fÜms
);

985 
	}
}

993 
´Ùeùed
 
funùiÚ
 
	$acû±F¿me£tS¹
(
$g
) {

994 ià(! 
$this
->
	`isLßdšgF¿mes
()) {

995 
$this
->
äame£t
 = 
$g
;

997 
$this
->
äame£t_Ã¡šg_Ëv–
++;

998 
	}
}

1004 
´Ùeùed
 
funùiÚ
 
	$acû±F¿me£tEnd
() {

1005 ià(
$this
->
	`isLßdšgF¿mes
()) {

1006 
$this
->
äame£t_Ã¡šg_Ëv–
--;

1008 
	}
}

1016 
´Ùeùed
 
funùiÚ
 
	$acû±F¿me
(
$g
) {

1017 ià(
$this
->
	`isLßdšgF¿mes
()) {

1018 ià(
$g
->
	`g‘A‰ribu‹
('src')) {

1019 
$this
->
lßdšg_äames
[] = 
$g
;

1022 
	}
}

1030 
´Ùeùed
 
funùiÚ
 
	$isLßdšgF¿mes
() {

1031  
$this
->
äame£t
 
ªd
 $this->
äame£t_Ã¡šg_Ëv–
 > 0;

1032 
	}
}

1039 
´Ùeùed
 
funùiÚ
 
	$acû±PageEnd
() {

1040 
	`couÁ
(
$this
->
İ’_fÜms
)) {

1041 
$this
->
com¶‘e_fÜms
[] = 
	`¬¿y_pİ
($this->
İ’_fÜms
);

1043 
	`fÜ—ch
 (
$this
->
Ëá_ov”_Ïb–s
 
as
 
$Ïb–
) {

1044 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$this
->
com¶‘e_fÜms
); $i < $count; $i++) {

1045 
$this
->
com¶‘e_fÜms
[
$i
]->
	`©chLab–ByS–eùÜ
(

1046 
Ãw
 
	`Sim¶eById
(
$Ïb–
->
	`g‘FÜ
()),

1047 
$Ïb–
->
	`g‘Text
());

1050 
$this
->
·ge
->
	`£tFÜms
($this->
com¶‘e_fÜms
);

1051 
$this
->
·ge
->
	`£tF¿mes
($this->
lßdšg_äames
);

1052 
	}
}

	@F:\Site\stew\1\_lp\simpletest\recorder.php

1 <?
php


15 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/scorer.php');

22 
ab¡¿ù
 cÏs 
	cSim¶eResuÉ
 {

23 
public
 
	m$time
;

24 
public
 
	m$b»adüumb
;

25 
public
 
	m$mes§ge
;

32 
funùiÚ
 
	$__cÚ¡ruù
(
$b»adüumb
, 
$mes§ge
) {

33 
	`li¡
(
$this
->
time
, $this->
b»adüumb
, $this->
mes§ge
) =

34 
	`¬¿y
(
	`time
(), 
$b»adüumb
, 
$mes§ge
);

36 
	}
}

43 şas 
	cSim¶eResuÉOfPass
 
ex‹nds
 
	mSim¶eResuÉ
 { }

50 şas 
	cSim¶eResuÉOfFa
 
ex‹nds
 
	mSim¶eResuÉ
 { }

57 şas 
	cSim¶eResuÉOfExû±iÚ
 
ex‹nds
 
	mSim¶eResuÉ
 { }

65 şas 
	cRecÜd”
 
ex‹nds
 
	mSim¶eR•Ü‹rDecÜ©Ü
 {

66 
public
 
	m$»suÉs
 = 
¬¿y
();

74 
funùiÚ
 
	$·štPass
(
$mes§ge
) {

75 
·»Á
::
	`·štPass
(
$mes§ge
);

76 
$this
->
»suÉs
[] = 
Ãw
 
	`Sim¶eResuÉOfPass
(
·»Á
::
	`g‘Te¡Li¡
(), 
$mes§ge
);

85 
funùiÚ
 
	$·štFa
(
$mes§ge
) {

86 
·»Á
::
	`·štFa
(
$mes§ge
);

87 
$this
->
»suÉs
[] = 
Ãw
 
	`Sim¶eResuÉOfFa
(
·»Á
::
	`g‘Te¡Li¡
(), 
$mes§ge
);

88 
	}
}

96 
funùiÚ
 
	$·štExû±iÚ
(
$mes§ge
) {

97 
·»Á
::
	`·štExû±iÚ
(
$mes§ge
);

98 
$this
->
»suÉs
[] = 
Ãw
 
	`Sim¶eResuÉOfExû±iÚ
(
·»Á
::
	`g‘Te¡Li¡
(), 
$mes§ge
);

99 
	}
}

	@F:\Site\stew\1\_lp\simpletest\reflection_php4.php

1 <?
php


15 şas 
	cSim¶eReæeùiÚ
 {

16 
v¬
 
	m$_š‹rçû
;

23 
funùiÚ
 
	$Sim¶eReæeùiÚ
(
$š‹rçû
) {

24 
$this
->
_š‹rçû
 = 
$š‹rçû
;

32 
funùiÚ
 
	$şassExi¡s
() {

33  
	`şass_exi¡s
(
$this
->
_š‹rçû
);

34 
	}
}

42 
funùiÚ
 
	$şassExi¡sSªsAutŞßd
() {

43  
	`şass_exi¡s
(
$this
->
_š‹rçû
);

44 
	}
}

52 
funùiÚ
 
	$şassOrIÁ”çûExi¡s
() {

53  
	`şass_exi¡s
(
$this
->
_š‹rçû
);

54 
	}
}

62 
funùiÚ
 
	$şassOrIÁ”çûExi¡sSªsAutŞßd
() {

63  
	`şass_exi¡s
(
$this
->
_š‹rçû
);

64 
	}
}

72 
funùiÚ
 
	$g‘M‘hods
() {

73  
	`g‘_şass_m‘hods
(
$this
->
_š‹rçû
);

74 
	}
}

83 
funùiÚ
 
	$g‘IÁ”çûs
() {

84  
	`¬¿y
();

85 
	}
}

92 
funùiÚ
 
	$g‘P¬’t
() {

93  
	`¡¹Şow”
(
	`g‘_·»Á_şass
(
$this
->
_š‹rçû
));

94 
	}
}

102 
funùiÚ
 
	$isAb¡¿ù
() {

103  
çl£
;

104 
	}
}

112 
funùiÚ
 
	$isIÁ”çû
() {

113  
çl£
;

114 
	}
}

122 
funùiÚ
 
	$hasFš®
() {

123  
çl£
;

124 
	}
}

132 
funùiÚ
 
	$g‘SigÇtu»
(
$m‘hod
) {

134 
	}
}

	@F:\Site\stew\1\_lp\simpletest\reflection_php5.php

1 <?
php


14 şas 
	cSim¶eReæeùiÚ
 {

15 
´iv©e
 
	m$š‹rçû
;

22 
funùiÚ
 
	$__cÚ¡ruù
(
$š‹rçû
) {

23 
$this
->
š‹rçû
 = 
$š‹rçû
;

33 
funùiÚ
 
	$şassExi¡s
() {

34 ià(! 
	`şass_exi¡s
(
$this
->
š‹rçû
)) {

35  
çl£
;

37 
$»æeùiÚ
 = 
Ãw
 
	`ReæeùiÚCÏss
(
$this
->
š‹rçû
);

38  ! 
$»æeùiÚ
->
	`isIÁ”çû
();

39 
	}
}

47 
funùiÚ
 
	$şassExi¡sSªsAutŞßd
() {

48  
	`şass_exi¡s
(
$this
->
š‹rçû
, 
çl£
);

49 
	}
}

57 
funùiÚ
 
	$şassOrIÁ”çûExi¡s
() {

58  
$this
->
	`şassOrIÁ”çûExi¡sW™hAutŞßd
($this->
š‹rçû
, 
Œue
);

59 
	}
}

67 
funùiÚ
 
	$şassOrIÁ”çûExi¡sSªsAutŞßd
() {

68  
$this
->
	`şassOrIÁ”çûExi¡sW™hAutŞßd
($this->
š‹rçû
, 
çl£
);

69 
	}
}

79 
´Ùeùed
 
funùiÚ
 
	$şassOrIÁ”çûExi¡sW™hAutŞßd
(
$š‹rçû
, 
$autŞßd
) {

80 ià(
	`funùiÚ_exi¡s
('interface_exists')) {

81 ià(
	`š‹rçû_exi¡s
(
$this
->
š‹rçû
, 
$autŞßd
)) {

82  
Œue
;

85  
	`şass_exi¡s
(
$this
->
š‹rçû
, 
$autŞßd
);

86 
	}
}

94 
funùiÚ
 
	$g‘M‘hods
() {

95  
	`¬¿y_unique
(
	`g‘_şass_m‘hods
(
$this
->
š‹rçû
));

96 
	}
}

105 
funùiÚ
 
	$g‘IÁ”çûs
() {

106 
$»æeùiÚ
 = 
Ãw
 
	`ReæeùiÚCÏss
(
$this
->
š‹rçû
);

107 ià(
$»æeùiÚ
->
	`isIÁ”çû
()) {

108  
	`¬¿y
(
$this
->
š‹rçû
);

110  
$this
->
	`ÚlyP¬’ts
(
$»æeùiÚ
->
	`g‘IÁ”çûs
());

111 
	}
}

119 
funùiÚ
 
	$g‘IÁ”çûM‘hods
() {

120 
$m‘hods
 = 
	`¬¿y
();

121 
	`fÜ—ch
 (
$this
->
	`g‘IÁ”çûs
(è
as
 
$š‹rçû
) {

122 
$m‘hods
 = 
	`¬¿y_m”ge
($m‘hods, 
	`g‘_şass_m‘hods
(
$š‹rçû
));

124  
	`¬¿y_unique
(
$m‘hods
);

125 
	}
}

134 
´Ùeùed
 
funùiÚ
 
	$isIÁ”çûM‘hod
(
$m‘hod
) {

135  
	`š_¬¿y
(
$m‘hod
, 
$this
->
	`g‘IÁ”çûM‘hods
());

136 
	}
}

143 
funùiÚ
 
	$g‘P¬’t
() {

144 
$»æeùiÚ
 = 
Ãw
 
	`ReæeùiÚCÏss
(
$this
->
š‹rçû
);

145 
$·»Á
 = 
$»æeùiÚ
->
	`g‘P¬’tCÏss
();

146 ià(
$·»Á
) {

147  
$·»Á
->
	`g‘Name
();

149  
çl£
;

150 
	}
}

157 
funùiÚ
 
	$isAb¡¿ù
() {

158 
$»æeùiÚ
 = 
Ãw
 
	`ReæeùiÚCÏss
(
$this
->
š‹rçû
);

159  
$»æeùiÚ
->
	`isAb¡¿ù
();

160 
	}
}

167 
funùiÚ
 
	$isIÁ”çû
() {

168 
$»æeùiÚ
 = 
Ãw
 
	`ReæeùiÚCÏss
(
$this
->
š‹rçû
);

169  
$»æeùiÚ
->
	`isIÁ”çû
();

170 
	}
}

178 
funùiÚ
 
	$hasFš®
() {

179 
$»æeùiÚ
 = 
Ãw
 
	`ReæeùiÚCÏss
(
$this
->
š‹rçû
);

180 
	`fÜ—ch
 (
$»æeùiÚ
->
	`g‘M‘hods
(è
as
 
$m‘hod
) {

181 ià(
$m‘hod
->
	`isFš®
()) {

182  
Œue
;

185  
çl£
;

186 
	}
}

196 
´Ùeùed
 
funùiÚ
 
	$ÚlyP¬’ts
(
$š‹rçûs
) {

197 
$·»Ás
 = 
	`¬¿y
();

198 
$bÏckli¡
 = 
	`¬¿y
();

199 
	`fÜ—ch
 (
$š‹rçûs
 
as
 
$š‹rçû
) {

200 
	`fÜ—ch
(
$š‹rçûs
 
as
 
$possibË_·»Á
) {

201 ià(
$š‹rçû
->
	`g‘Name
(è=ğ
$possibË_·»Á
->getName()) {

204 ià(
$š‹rçû
->
	`isSubCÏssOf
(
$possibË_·»Á
)) {

205 
$bÏckli¡
[
$possibË_·»Á
->
	`g‘Name
()] = 
Œue
;

208 ià(!
	`is£t
(
$bÏckli¡
[
$š‹rçû
->
	`g‘Name
()])) {

209 
$·»Ás
[] = 
$š‹rçû
->
	`g‘Name
();

212  
$·»Ás
;

213 
	}
}

221 
´Ùeùed
 
funùiÚ
 
	$isAb¡¿ùM‘hod
(
$Çme
) {

222 
$š‹rçû
 = 
Ãw
 
	`ReæeùiÚCÏss
(
$this
->
š‹rçû
);

223 ià(! 
$š‹rçû
->
	`hasM‘hod
(
$Çme
)) {

224  
çl£
;

226  
$š‹rçû
->
	`g‘M‘hod
(
$Çme
)->
	`isAb¡¿ù
();

227 
	}
}

235 
´Ùeùed
 
funùiÚ
 
	$isCÚ¡ruùÜ
(
$Çme
) {

236  (
$Çme
 =ğ'__cÚ¡ruù'è|| ($Çm=ğ
$this
->
š‹rçû
);

237 
	}
}

245 
´Ùeùed
 
funùiÚ
 
	$isAb¡¿ùM‘hodInP¬’ts
(
$Çme
) {

246 
$š‹rçû
 = 
Ãw
 
	`ReæeùiÚCÏss
(
$this
->
š‹rçû
);

247 
$·»Á
 = 
$š‹rçû
->
	`g‘P¬’tCÏss
();

248 
$·»Á
) {

249 ià(! 
$·»Á
->
	`hasM‘hod
(
$Çme
)) {

250  
çl£
;

252 ià(
$·»Á
->
	`g‘M‘hod
(
$Çme
)->
	`isAb¡¿ù
()) {

253  
Œue
;

255 
$·»Á
 = $·»Á->
	`g‘P¬’tCÏss
();

257  
çl£
;

258 
	}
}

266 
´Ùeùed
 
funùiÚ
 
	$isSticM‘hod
(
$Çme
) {

267 
$š‹rçû
 = 
Ãw
 
	`ReæeùiÚCÏss
(
$this
->
š‹rçû
);

268 ià(! 
$š‹rçû
->
	`hasM‘hod
(
$Çme
)) {

269  
çl£
;

271  
$š‹rçû
->
	`g‘M‘hod
(
$Çme
)->
	`isStic
();

272 
	}
}

282 
funùiÚ
 
	$g‘SigÇtu»
(
$Çme
) {

283 ià(
$Çme
 == '__set') {

286 ià(
$Çme
 == '__call') {

289 ià(
	`v”siÚ_com·»
(
	`phpv”siÚ
(), '5.1.0', '>=')) {

290 ià(
	`š_¬¿y
(
$Çme
, 
	`¬¿y
('__get', '__isset', $name == '__unset'))) {

294 ià(
$Çme
 == '__toString') {

303 
Œy
 {

304 
$š‹rçû
 = 
Ãw
 
	`ReæeùiÚCÏss
(
$this
->
š‹rçû
);

305 
$š‹rçû
->
	`g‘M‘hod
(
$Çme
);

306 } 
	`ÿtch
 (
ReæeùiÚExû±iÚ
 
$e
) {

309  
$this
->
	`g‘FuÎSigÇtu»
(
$Çme
);

310 
	}
}

320 
´Ùeùed
 
funùiÚ
 
	$g‘FuÎSigÇtu»
(
$Çme
) {

321 
$š‹rçû
 = 
Ãw
 
	`ReæeùiÚCÏss
(
$this
->
š‹rçû
);

322 
$m‘hod
 = 
$š‹rçû
->
	`g‘M‘hod
(
$Çme
);

323 
$»ã»nû
 = 
$m‘hod
->
	`»tuºsReã»nû
() ? '&' : '';

324 
$¡©ic
 = 
$m‘hod
->
	`isStic
() ? 'static ' : '';

326 
	`im¶ode
(', ', 
$this
->
	`g‘P¬am‘”SigÇtu»s
(
$m‘hod
)) .

328 
	}
}

338 
´Ùeùed
 
funùiÚ
 
	$g‘P¬am‘”SigÇtu»s
(
$m‘hod
) {

339 
$sigÇtu»s
 = 
	`¬¿y
();

340 
	`fÜ—ch
 (
$m‘hod
->
	`g‘P¬am‘”s
(è
as
 
$·¿m‘”
) {

341 
$sigÇtu»
 = '';

342 
$ty³
 = 
$·¿m‘”
->
	`g‘CÏss
();

343 ià(
	`is_nuÎ
(
$ty³
è&& 
	`v”siÚ_com·»
(
	`phpv”siÚ
(), '5.1.0', '>='è&& 
$·¿m‘”
->
	`isA¼ay
()) {

344 
$sigÇtu»
 .= 'array ';

345 } 
	`–£if
 (!
	`is_nuÎ
(
$ty³
)) {

346 
$sigÇtu»
 .ğ
$ty³
->
	`g‘Name
() . ' ';

348 ià(
$·¿m‘”
->
	`isPas£dByReã»nû
()) {

349 
$sigÇtu»
 .= '&';

351 
$sigÇtu»
 .ğ'$' . 
$this
->
	`suµ»ssSpurious
(
$·¿m‘”
->
	`g‘Name
());

352 ià(
$this
->
	`isO±iÚ®
(
$·¿m‘”
)) {

353 
$sigÇtu»
 .= ' =‚ull';

355 
$sigÇtu»s
[] = 
$sigÇtu»
;

357  
$sigÇtu»s
;

358 
	}
}

368 
´Ùeùed
 
funùiÚ
 
	$suµ»ssSpurious
(
$Çme
) {

369  
	`¡r_»¶aû
(
	`¬¿y
('[', ']', ' '), '', 
$Çme
);

370 
	}
}

379 
´Ùeùed
 
funùiÚ
 
	$isO±iÚ®
(
$·¿m‘”
) {

380 ià(
	`m‘hod_exi¡s
(
$·¿m‘”
, 'isOptional')) {

381  
$·¿m‘”
->
	`isO±iÚ®
();

383  
çl£
;

384 
	}
}

	@F:\Site\stew\1\_lp\simpletest\remote.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/browser.php');

13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/xml.php');

14 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/test_case.php');

22 şas 
	cRemÙeTe¡Ca£
 {

23 
´iv©e
 
	m$u¾
;

24 
´iv©e
 
	m$dry_u¾
;

25 
´iv©e
 
	m$size
;

33 
funùiÚ
 
	$__cÚ¡ruù
(
$u¾
, 
$dry_u¾
 = 
çl£
) {

34 
$this
->
u¾
 = 
$u¾
;

35 
$this
->
dry_u¾
 = 
$dry_u¾
 ? $dry_u¾ : 
$u¾
;

36 
$this
->
size
 = 
çl£
;

44 
funùiÚ
 
	$g‘Lab–
() {

45  
$this
->
u¾
;

46 
	}
}

56 
funùiÚ
 
	$run
(
$»pÜ‹r
) {

57 
$brow£r
 = 
$this
->
	`ü—‹Brow£r
();

58 
$xml
 = 
$brow£r
->
	`g‘
(
$this
->
u¾
);

59 ià(! 
$xml
) {

60 
	`Œigg”_”rÜ
('CªnÙ„—d„emÙ‹¡ URL [' . 
$this
->
u¾
 . ']');

61  
çl£
;

63 
$·r£r
 = 
$this
->
	`ü—‹P¬£r
(
$»pÜ‹r
);

64 ià(! 
$·r£r
->
	`·r£
(
$xml
)) {

65 
	`Œigg”_”rÜ
('CªnÙ…¬£ incomšg XML from [' . 
$this
->
u¾
 . ']');

66  
çl£
;

68  
Œue
;

69 
	}
}

77 
´Ùeùed
 
funùiÚ
 
	$ü—‹Brow£r
() {

78  
Ãw
 
	`Sim¶eBrow£r
();

79 
	}
}

87 
´Ùeùed
 
funùiÚ
 
	$ü—‹P¬£r
(
$»pÜ‹r
) {

88  
Ãw
 
	`Sim¶eTe¡XmlP¬£r
(
$»pÜ‹r
);

89 
	}
}

96 
funùiÚ
 
	$g‘Size
() {

97 ià(
$this
->
size
 ==ğ
çl£
) {

98 
$brow£r
 = 
$this
->
	`ü—‹Brow£r
();

99 
$xml
 = 
$brow£r
->
	`g‘
(
$this
->
dry_u¾
);

100 ià(! 
$xml
) {

101 
	`Œigg”_”rÜ
('CªnÙ„—d„emÙ‹¡ URL [' . 
$this
->
dry_u¾
 . ']');

102  
çl£
;

104 
$»pÜ‹r
 = 
Ãw
 
	`Sim¶eR•Ü‹r
();

105 
$·r£r
 = 
$this
->
	`ü—‹P¬£r
(
$»pÜ‹r
);

106 ià(! 
$·r£r
->
	`·r£
(
$xml
)) {

107 
	`Œigg”_”rÜ
('CªnÙ…¬£ incomšg XML from [' . 
$this
->
dry_u¾
 . ']');

108  
çl£
;

110 
$this
->
size
 = 
$»pÜ‹r
->
	`g‘Te¡Ca£CouÁ
();

112  
$this
->
size
;

113 
	}
}

	@F:\Site\stew\1\_lp\simpletest\reporter.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/scorer.php');

22 şas 
	cHtmlR•Ü‹r
 
ex‹nds
 
	mSim¶eR•Ü‹r
 {

23 
´iv©e
 
	m$ch¬aù”_£t
;

31 
funùiÚ
 
__cÚ¡ruù
(
$ch¬aù”_£t
 = 'ISO-8859-1') {

32 
·»Á
::
__cÚ¡ruù
();

33 
	m$this
->
	mch¬aù”_£t
 = 
$ch¬aù”_£t
;

42 
funùiÚ
 
	$·štH—d”
(
$‹¡_Çme
) {

43 
$this
->
	`£ndNoCacheH—d”s
();

44 
´št
 "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">";

45 
´št
 "<html>\n<head>\n<title>$test_name</title>\n";

46 
´št
 "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=" .

47 
$this
->
ch¬aù”_£t
 . "\">\n";

48 
´št
 "<styleype=\"text/css\">\n";

49 
´št
 
$this
->
	`g‘Css
() . "\n";

50 
´št
 "</style>\n";

51 
´št
 "</head>\n<body>\n";

52 
´št
 "<h1>$test_name</h1>\n";

53 
	`æush
();

54 
	}
}

62 
funùiÚ
 
	$£ndNoCacheH—d”s
() {

63 ià(! 
	`h—d”s_£Á
()) {

64 
	`h—d”
("Expires: Mon, 26 Jul 1997 05:00:00 GMT");

65 
	`h—d”
("La¡-Modif›d: " . 
	`gmd©e
("D, d M Y H:i:s") . " GMT");

66 
	`h—d”
("Cache-Control:‚o-store,‚o-cache, must-revalidate");

67 
	`h—d”
("Cache-CÚŒŞ:…o¡-check=0,…»-check=0", 
çl£
);

68 
	`h—d”
("Pragma:‚o-cache");

70 
	}
}

77 
´Ùeùed
 
funùiÚ
 
	$g‘Css
() {

79 .
ç
 { 
background
-
cŞÜ
: 
šh”™
; cŞÜ: 
»d
; }" .

82 
	}
}

90 
funùiÚ
 
	$·štFoÙ”
(
$‹¡_Çme
) {

91 
$cŞour
 = (
$this
->
	`g‘FaCouÁ
(è+ $this->
	`g‘Exû±iÚCouÁ
() > 0 ? "red" : "green");

92 
´št
 "<div style=\"";

93 
´št
 "padding: 10px; margin-top: 1em; background-color: $colour; color: white; -moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;box-shadow: 3px 3px 1px #888;opacity:0.8;";

94 
´št
 "\">";

95 
´št
 
$this
->
	`g‘Te¡Ca£Prog»ss
(è. "/" . $this->
	`g‘Te¡Ca£CouÁ
();

96 
´št
 "est cases complete:\n";

97 
´št
 "<¡rÚg>" . 
$this
->
	`g‘PassCouÁ
() . "</strong>…asses, ";

98 
´št
 "<¡rÚg>" . 
$this
->
	`g‘FaCouÁ
() . "</strong> fails‡nd ";

99 
´št
 "<¡rÚg>" . 
$this
->
	`g‘Exû±iÚCouÁ
() . "</strong>ƒxceptions.";

100 
´št
 "</div>\n";

101 
´št
 "</body>\n</html>\n";

102 
	}
}

111 
funùiÚ
 
	$·štFa
(
$mes§ge
) {

112 
·»Á
::
	`·štFa
(
$mes§ge
);

113 
´št
 "<span class=\"fail\">Fail</span>: ";

114 
$b»adüumb
 = 
$this
->
	`g‘Te¡Li¡
();

115 
	`¬¿y_shiá
(
$b»adüumb
);

116 
´št
 
	`im¶ode
(" -&gt; ", 
$b»adüumb
);

117 
´št
 " -&gt; " . 
$this
->
	`htmlEÁ™›s
(
$mes§ge
è. '<div ><´¡yË="·ddšg:10px">' . 
	`´št_r
(
	`g
('st-content'),1) . '</pre></div>' . "<br />\n";

118 
	}
}

125 
funùiÚ
 
	$·štE¼Ü
(
$mes§ge
) {

126 
·»Á
::
	`·štE¼Ü
(
$mes§ge
);

127 
´št
 "<span class=\"fail\">Exception</span>: ";

128 
$b»adüumb
 = 
$this
->
	`g‘Te¡Li¡
();

129 
	`¬¿y_shiá
(
$b»adüumb
);

130 
´št
 
	`im¶ode
(" -&gt; ", 
$b»adüumb
);

131 
´št
 " -&gt; <¡rÚg>" . 
$this
->
	`htmlEÁ™›s
(
$mes§ge
) . "</strong><br />\n";

132 
	}
}

139 
funùiÚ
 
	$·štExû±iÚ
(
$exû±iÚ
) {

140 
·»Á
::
	`·štExû±iÚ
(
$exû±iÚ
);

141 
´št
 "<span class=\"fail\">Exception</span>: ";

142 
$b»adüumb
 = 
$this
->
	`g‘Te¡Li¡
();

143 
	`¬¿y_shiá
(
$b»adüumb
);

144 
´št
 
	`im¶ode
(" -&gt; ", 
$b»adüumb
);

145 
$mes§ge
 = 'UÃx³ùedƒxû±iÚ oàty³ [' . 
	`g‘_şass
(
$exû±iÚ
) .

146 '] w™h mes§g['. 
$exû±iÚ
->
	`g‘Mes§ge
() .

147 '] iÀ['. 
$exû±iÚ
->
	`g‘Fe
() .

148 '†š' . 
$exû±iÚ
->
	`g‘Lše
() . ']';

149 
´št
 " -&gt; <¡rÚg>" . 
$this
->
	`htmlEÁ™›s
(
$mes§ge
) . "</strong><br />\n";

150 
	}
}

157 
funùiÚ
 
	$·štSk
(
$mes§ge
) {

158 
·»Á
::
	`·štSk
(
$mes§ge
);

159 
´št
 "<span class=\"pass\">Skipped</span>: ";

160 
$b»adüumb
 = 
$this
->
	`g‘Te¡Li¡
();

161 
	`¬¿y_shiá
(
$b»adüumb
);

162 
´št
 
	`im¶ode
(" -&gt; ", 
$b»adüumb
);

163 
´št
 " -&gt; " . 
$this
->
	`htmlEÁ™›s
(
$mes§ge
) . "<br />\n";

164 
	}
}

171 
funùiÚ
 
	$·štFÜm©‹dMes§ge
(
$mes§ge
) {

172 
´št
 '<´e>' . 
$this
->
	`htmlEÁ™›s
(
$mes§ge
) . '</pre>';

173 
	}
}

181 
´Ùeùed
 
funùiÚ
 
	$htmlEÁ™›s
(
$mes§ge
) {

182  
	`htmËÁ™›s
(
$mes§ge
, 
ENT_COMPAT
, 
$this
->
ch¬aù”_£t
);

183 
	}
}

195 şas 
	cTextR•Ü‹r
 
ex‹nds
 
	mSim¶eR•Ü‹r
 {

201 
funùiÚ
 
	$__cÚ¡ruù
() {

202 
·»Á
::
	`__cÚ¡ruù
();

210 
funùiÚ
 
	$·štH—d”
(
$‹¡_Çme
) {

211 ià(! 
Sim¶eR•Ü‹r
::
	`šCli
()) {

212 
	`h—d”
('Content-type:ext/plain');

214 
´št
 "$test_name\n";

215 
	`æush
();

216 
	}
}

224 
funùiÚ
 
	$·štFoÙ”
(
$‹¡_Çme
) {

225 ià(
$this
->
	`g‘FaCouÁ
(è+ $this->
	`g‘Exû±iÚCouÁ
() == 0) {

226 
´št
 "OK\n";

228 
´št
 "FAILURES!!!\n";

230 
´št
 "Te¡ ca£ run: " . 
$this
->
	`g‘Te¡Ca£Prog»ss
() .

231 "/" . 
$this
->
	`g‘Te¡Ca£CouÁ
() .

232 ", Pas£s: " . 
$this
->
	`g‘PassCouÁ
() .

233 ", Fau»s: " . 
$this
->
	`g‘FaCouÁ
() .

234 ", Exû±iÚs: " . 
$this
->
	`g‘Exû±iÚCouÁ
() . "\n";

235 
	}
}

243 
funùiÚ
 
	$·štFa
(
$mes§ge
) {

244 
·»Á
::
	`·štFa
(
$mes§ge
);

245 
´št
 
$this
->
	`g‘FaCouÁ
() . ") $message\n";

246 
$b»adüumb
 = 
$this
->
	`g‘Te¡Li¡
();

247 
	`¬¿y_shiá
(
$b»adüumb
);

248 
´št
 "\tš " . 
	`im¶ode
("\n\tš ", 
	`¬¿y_»v”£
(
$b»adüumb
));

249 
´št
 "\n";

250 
	}
}

258 
funùiÚ
 
	$·štE¼Ü
(
$mes§ge
) {

259 
·»Á
::
	`·štE¼Ü
(
$mes§ge
);

260 
´št
 "Exû±iÚ " . 
$this
->
	`g‘Exû±iÚCouÁ
() . "!\n$message\n";

261 
$b»adüumb
 = 
$this
->
	`g‘Te¡Li¡
();

262 
	`¬¿y_shiá
(
$b»adüumb
);

263 
´št
 "\tš " . 
	`im¶ode
("\n\tš ", 
	`¬¿y_»v”£
(
$b»adüumb
));

264 
´št
 "\n";

265 
	}
}

273 
funùiÚ
 
	$·štExû±iÚ
(
$exû±iÚ
) {

274 
·»Á
::
	`·štExû±iÚ
(
$exû±iÚ
);

275 
$mes§ge
 = 'UÃx³ùedƒxû±iÚ oàty³ [' . 
	`g‘_şass
(
$exû±iÚ
) .

276 '] w™h mes§g['. 
$exû±iÚ
->
	`g‘Mes§ge
() .

277 '] iÀ['. 
$exû±iÚ
->
	`g‘Fe
() .

278 '†š' . 
$exû±iÚ
->
	`g‘Lše
() . ']';

279 
´št
 "Exû±iÚ " . 
$this
->
	`g‘Exû±iÚCouÁ
() . "!\n$message\n";

280 
$b»adüumb
 = 
$this
->
	`g‘Te¡Li¡
();

281 
	`¬¿y_shiá
(
$b»adüumb
);

282 
´št
 "\tš " . 
	`im¶ode
("\n\tš ", 
	`¬¿y_»v”£
(
$b»adüumb
));

283 
´št
 "\n";

284 
	}
}

291 
funùiÚ
 
	$·štSk
(
$mes§ge
) {

292 
·»Á
::
	`·štSk
(
$mes§ge
);

293 
´št
 "Skip: $message\n";

294 
	}
}

301 
funùiÚ
 
	$·štFÜm©‹dMes§ge
(
$mes§ge
) {

302 
´št
 "$message\n";

303 
	`æush
();

304 
	}
}

313 şas 
	cS–eùiveR•Ü‹r
 
ex‹nds
 
	mSim¶eR•Ü‹rDecÜ©Ü
 {

314 
´iv©e
 
	m$ju¡_this_ÿ£
 = 
çl£
;

315 
´iv©e
 
	m$ju¡_this_‹¡
 = 
çl£
;

316 
´iv©e
 
	m$Ú
;

325 
funùiÚ
 
	$__cÚ¡ruù
(
$»pÜ‹r
, 
$ju¡_this_ÿ£
 = 
çl£
, 
$ju¡_this_‹¡
 = false) {

326 ià(
	`is£t
(
$ju¡_this_ÿ£
) && $just_this_case) {

327 
$this
->
ju¡_this_ÿ£
 = 
	`¡¹Şow”
(
$ju¡_this_ÿ£
);

328 
$this
->
	`off
();

330 
$this
->
	`Ú
();

332 ià(
	`is£t
(
$ju¡_this_‹¡
) && $just_this_test) {

333 
$this
->
ju¡_this_‹¡
 = 
	`¡¹Şow”
(
$ju¡_this_‹¡
);

335 
·»Á
::
	`__cÚ¡ruù
(
$»pÜ‹r
);

344 
´Ùeùed
 
funùiÚ
 
	$m©chesTe¡Ca£
(
$‹¡_ÿ£
) {

345  
$this
->
ju¡_this_ÿ£
 =ğ
	`¡¹Şow”
(
$‹¡_ÿ£
);

346 
	}
}

356 
´Ùeùed
 
funùiÚ
 
	$shouldRunTe¡
(
$‹¡_ÿ£
, 
$m‘hod
) {

357 ià(
$this
->
	`isOn
(è|| $this->
	`m©chesTe¡Ca£
(
$‹¡_ÿ£
)) {

358 ià(
$this
->
ju¡_this_‹¡
) {

359  
$this
->
ju¡_this_‹¡
 =ğ
	`¡¹Şow”
(
$m‘hod
);

361  
Œue
;

364  
çl£
;

365 
	}
}

371 
´Ùeùed
 
funùiÚ
 
	$Ú
() {

372 
$this
->
Ú
 = 
Œue
;

373 
	}
}

379 
´Ùeùed
 
funùiÚ
 
	$off
() {

380 
$this
->
Ú
 = 
çl£
;

381 
	}
}

388 
´Ùeùed
 
funùiÚ
 
	$isOn
() {

389  
$this
->
Ú
;

390 
	}
}

399 
funùiÚ
 
	$shouldInvoke
(
$‹¡_ÿ£
, 
$m‘hod
) {

400 ià(
$this
->
	`shouldRunTe¡
(
$‹¡_ÿ£
, 
$m‘hod
)) {

401  
$this
->
»pÜ‹r
->
	`shouldInvoke
(
$‹¡_ÿ£
, 
$m‘hod
);

403  
çl£
;

404 
	}
}

412 
funùiÚ
 
	$·štGroupS¹
(
$‹¡_ÿ£
, 
$size
) {

413 ià(
$this
->
ju¡_this_ÿ£
 && $this->
	`m©chesTe¡Ca£
(
$‹¡_ÿ£
)) {

414 
$this
->
	`Ú
();

416 
$this
->
»pÜ‹r
->
	`·štGroupS¹
(
$‹¡_ÿ£
, 
$size
);

417 
	}
}

424 
funùiÚ
 
	$·štGroupEnd
(
$‹¡_ÿ£
) {

425 
$this
->
»pÜ‹r
->
	`·štGroupEnd
(
$‹¡_ÿ£
);

426 ià(
$this
->
ju¡_this_ÿ£
 && $this->
	`m©chesTe¡Ca£
(
$‹¡_ÿ£
)) {

427 
$this
->
	`off
();

429 
	}
}

437 şas 
	cNoSksR•Ü‹r
 
ex‹nds
 
	mSim¶eR•Ü‹rDecÜ©Ü
 {

444 
funùiÚ
 
	$·štSk
(
$mes§ge
) { }

445 
	}
}

	@F:\Site\stew\1\_lp\simpletest\scorer.php

1 <?
php


10 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/invoker.php');

21 şas 
	cSim¶eScÜ”
 {

22 
´iv©e
 
	m$·s£s
;

23 
´iv©e
 
	m$çs
;

24 
´iv©e
 
	m$exû±iÚs
;

25 
´iv©e
 
	m$is_dry_run
;

31 
funùiÚ
 
	$__cÚ¡ruù
() {

32 
$this
->
·s£s
 = 0;

33 
$this
->
çs
 = 0;

34 
$this
->
exû±iÚs
 = 0;

35 
$this
->
is_dry_run
 = 
çl£
;

45 
funùiÚ
 
	$makeDry
(
$is_dry
 = 
Œue
) {

46 
$this
->
is_dry_run
 = 
$is_dry
;

47 
	}
}

55 
funùiÚ
 
	$shouldInvoke
(
$‹¡_ÿ£_Çme
, 
$m‘hod
) {

56  ! 
$this
->
is_dry_run
;

57 
	}
}

66 
funùiÚ
 
	$ü—‹Invok”
(
$švok”
) {

67  
$švok”
;

68 
	}
}

77 
funùiÚ
 
	$g‘Stus
() {

78 ià(
$this
->
exû±iÚs
 + $this->
çs
 > 0) {

79  
çl£
;

81  
Œue
;

82 
	}
}

90 
funùiÚ
 
	$·štGroupS¹
(
$‹¡_Çme
, 
$size
) {

91 
	}
}

98 
funùiÚ
 
	$·štGroupEnd
(
$‹¡_Çme
) {

99 
	}
}

106 
funùiÚ
 
	$·štCa£S¹
(
$‹¡_Çme
) {

107 
	}
}

114 
funùiÚ
 
	$·štCa£End
(
$‹¡_Çme
) {

115 
	}
}

122 
funùiÚ
 
	$·štM‘hodS¹
(
$‹¡_Çme
) {

123 
	}
}

130 
funùiÚ
 
	$·štM‘hodEnd
(
$‹¡_Çme
) {

131 
	}
}

138 
funùiÚ
 
	$·štPass
(
$mes§ge
) {

139 
$this
->
·s£s
++;

140 
	}
}

147 
funùiÚ
 
	$·štFa
(
$mes§ge
) {

148 
$this
->
çs
++;

149 
	}
}

157 
funùiÚ
 
	$·štE¼Ü
(
$mes§ge
) {

158 
$this
->
exû±iÚs
++;

159 
	}
}

166 
funùiÚ
 
	$·štExû±iÚ
(
$exû±iÚ
) {

167 
$this
->
exû±iÚs
++;

168 
	}
}

175 
funùiÚ
 
	$·štSk
(
$mes§ge
) {

176 
	}
}

183 
funùiÚ
 
	$g‘PassCouÁ
() {

184  
$this
->
·s£s
;

185 
	}
}

192 
funùiÚ
 
	$g‘FaCouÁ
() {

193  
$this
->
çs
;

194 
	}
}

202 
funùiÚ
 
	$g‘Exû±iÚCouÁ
() {

203  
$this
->
exû±iÚs
;

204 
	}
}

211 
funùiÚ
 
	$·štMes§ge
(
$mes§ge
) {

212 
	}
}

220 
funùiÚ
 
	$·štFÜm©‹dMes§ge
(
$mes§ge
) {

221 
	}
}

229 
funùiÚ
 
	$·štSigÇl
(
$ty³
, 
$·ylßd
) {

230 
	}
}

241 şas 
	cSim¶eR•Ü‹r
 
ex‹nds
 
	mSim¶eScÜ”
 {

242 
´iv©e
 
	m$‹¡_¡ack
;

243 
´iv©e
 
	m$size
;

244 
´iv©e
 
	m$´og»ss
;

250 
funùiÚ
 
	$__cÚ¡ruù
() {

251 
·»Á
::
	`__cÚ¡ruù
();

252 
$this
->
‹¡_¡ack
 = 
	`¬¿y
();

253 
$this
->
size
 = 
nuÎ
;

254 
$this
->
´og»ss
 = 0;

262 
funùiÚ
 
	$g‘Dum³r
() {

263  
Ãw
 
	`Sim¶eDum³r
();

264 
	}
}

275 
funùiÚ
 
	$·štGroupS¹
(
$‹¡_Çme
, 
$size
) {

276 ià(! 
	`is£t
(
$this
->
size
)) {

277 
$this
->
size
 = 
$size
;

279 ià(
	`couÁ
(
$this
->
‹¡_¡ack
) == 0) {

280 
$this
->
	`·štH—d”
(
$‹¡_Çme
);

282 
$this
->
‹¡_¡ack
[] = 
$‹¡_Çme
;

283 
	}
}

292 
funùiÚ
 
	$·štGroupEnd
(
$‹¡_Çme
) {

293 
	`¬¿y_pİ
(
$this
->
‹¡_¡ack
);

294 ià(
	`couÁ
(
$this
->
‹¡_¡ack
) == 0) {

295 
$this
->
	`·štFoÙ”
(
$‹¡_Çme
);

297 
	}
}

307 
funùiÚ
 
	$·štCa£S¹
(
$‹¡_Çme
) {

308 ià(! 
	`is£t
(
$this
->
size
)) {

309 
$this
->
size
 = 1;

311 ià(
	`couÁ
(
$this
->
‹¡_¡ack
) == 0) {

312 
$this
->
	`·štH—d”
(
$‹¡_Çme
);

314 
$this
->
‹¡_¡ack
[] = 
$‹¡_Çme
;

315 
	}
}

323 
funùiÚ
 
	$·štCa£End
(
$‹¡_Çme
) {

324 
$this
->
´og»ss
++;

325 
	`¬¿y_pİ
(
$this
->
‹¡_¡ack
);

326 ià(
	`couÁ
(
$this
->
‹¡_¡ack
) == 0) {

327 
$this
->
	`·štFoÙ”
(
$‹¡_Çme
);

329 
	}
}

336 
funùiÚ
 
	$·štM‘hodS¹
(
$‹¡_Çme
) {

337 
$this
->
‹¡_¡ack
[] = 
$‹¡_Çme
;

338 
	}
}

346 
funùiÚ
 
	$·štM‘hodEnd
(
$‹¡_Çme
) {

347 
	`¬¿y_pİ
(
$this
->
‹¡_¡ack
);

348 
	}
}

357 
funùiÚ
 
	$·štH—d”
(
$‹¡_Çme
) {

358 
	}
}

366 
funùiÚ
 
	$·štFoÙ”
(
$‹¡_Çme
) {

367 
	}
}

376 
funùiÚ
 
	$g‘Te¡Li¡
() {

377  
$this
->
‹¡_¡ack
;

378 
	}
}

387 
funùiÚ
 
	$g‘Te¡Ca£CouÁ
() {

388  
$this
->
size
;

389 
	}
}

397 
funùiÚ
 
	$g‘Te¡Ca£Prog»ss
() {

398  
$this
->
´og»ss
;

399 
	}
}

406 
funùiÚ
 
	$šCli
() {

407  
	`php_§pi_Çme
() == 'cli';

408 
	}
}

416 şas 
	cSim¶eR•Ü‹rDecÜ©Ü
 {

417 
´Ùeùed
 
	m$»pÜ‹r
;

423 
funùiÚ
 
	$__cÚ¡ruù
(
$»pÜ‹r
) {

424 
$this
->
»pÜ‹r
 = 
$»pÜ‹r
;

434 
funùiÚ
 
	$makeDry
(
$is_dry
 = 
Œue
) {

435 
$this
->
»pÜ‹r
->
	`makeDry
(
$is_dry
);

436 
	}
}

445 
funùiÚ
 
	$g‘Stus
() {

446  
$this
->
»pÜ‹r
->
	`g‘Stus
();

447 
	}
}

455 
funùiÚ
 
	$g‘Te¡Li¡
() {

456 ià(
	`m‘hod_exi¡s
(
$this
->
»pÜ‹r
, 'getTestList')) {

457  
$this
->
»pÜ‹r
->
	`g‘Te¡Li¡
();

459  
	`¬¿y
();

461 
	}
}

470 
funùiÚ
 
	$shouldInvoke
(
$‹¡_ÿ£_Çme
, 
$m‘hod
) {

471  
$this
->
»pÜ‹r
->
	`shouldInvoke
(
$‹¡_ÿ£_Çme
, 
$m‘hod
);

472 
	}
}

481 
funùiÚ
 
	$ü—‹Invok”
(
$švok”
) {

482  
$this
->
»pÜ‹r
->
	`ü—‹Invok”
(
$švok”
);

483 
	}
}

491 
funùiÚ
 
	$g‘Dum³r
() {

492  
$this
->
»pÜ‹r
->
	`g‘Dum³r
();

493 
	}
}

501 
funùiÚ
 
	$·štGroupS¹
(
$‹¡_Çme
, 
$size
) {

502 
$this
->
»pÜ‹r
->
	`·štGroupS¹
(
$‹¡_Çme
, 
$size
);

503 
	}
}

510 
funùiÚ
 
	$·štGroupEnd
(
$‹¡_Çme
) {

511 
$this
->
»pÜ‹r
->
	`·štGroupEnd
(
$‹¡_Çme
);

512 
	}
}

519 
funùiÚ
 
	$·štCa£S¹
(
$‹¡_Çme
) {

520 
$this
->
»pÜ‹r
->
	`·štCa£S¹
(
$‹¡_Çme
);

521 
	}
}

528 
funùiÚ
 
	$·štCa£End
(
$‹¡_Çme
) {

529 
$this
->
»pÜ‹r
->
	`·štCa£End
(
$‹¡_Çme
);

530 
	}
}

537 
funùiÚ
 
	$·štM‘hodS¹
(
$‹¡_Çme
) {

538 
$this
->
»pÜ‹r
->
	`·štM‘hodS¹
(
$‹¡_Çme
);

539 
	}
}

546 
funùiÚ
 
	$·štM‘hodEnd
(
$‹¡_Çme
) {

547 
$this
->
»pÜ‹r
->
	`·štM‘hodEnd
(
$‹¡_Çme
);

548 
	}
}

555 
funùiÚ
 
	$·štPass
(
$mes§ge
) {

556 
$this
->
»pÜ‹r
->
	`·štPass
(
$mes§ge
);

557 
	}
}

564 
funùiÚ
 
	$·štFa
(
$mes§ge
) {

565 
$this
->
»pÜ‹r
->
	`·štFa
(
$mes§ge
);

566 
	}
}

574 
funùiÚ
 
	$·štE¼Ü
(
$mes§ge
) {

575 
$this
->
»pÜ‹r
->
	`·štE¼Ü
(
$mes§ge
);

576 
	}
}

583 
funùiÚ
 
	$·štExû±iÚ
(
$exû±iÚ
) {

584 
$this
->
»pÜ‹r
->
	`·štExû±iÚ
(
$exû±iÚ
);

585 
	}
}

592 
funùiÚ
 
	$·štSk
(
$mes§ge
) {

593 
$this
->
»pÜ‹r
->
	`·štSk
(
$mes§ge
);

594 
	}
}

601 
funùiÚ
 
	$·štMes§ge
(
$mes§ge
) {

602 
$this
->
»pÜ‹r
->
	`·štMes§ge
(
$mes§ge
);

603 
	}
}

610 
funùiÚ
 
	$·štFÜm©‹dMes§ge
(
$mes§ge
) {

611 
$this
->
»pÜ‹r
->
	`·štFÜm©‹dMes§ge
(
$mes§ge
);

612 
	}
}

623 
funùiÚ
 
	$·štSigÇl
(
$ty³
, 
$·ylßd
) {

624 
$this
->
»pÜ‹r
->
	`·štSigÇl
(
$ty³
, 
$·ylßd
);

625 
	}
}

634 şas 
	cMuÉËR•Ü‹r
 {

635 
´iv©e
 
	m$»pÜ‹rs
 = 
¬¿y
();

642 
funùiÚ
 
	$©chR•Ü‹r
(
$»pÜ‹r
) {

643 
$this
->
»pÜ‹rs
[] = 
$»pÜ‹r
;

653 
funùiÚ
 
	$makeDry
(
$is_dry
 = 
Œue
) {

654 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
»pÜ‹rs
); $i++) {

655 
$this
->
»pÜ‹rs
[
$i
]->
	`makeDry
(
$is_dry
);

657 
	}
}

667 
funùiÚ
 
	$g‘Stus
() {

668 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
»pÜ‹rs
); $i++) {

669 ià(! 
$this
->
»pÜ‹rs
[
$i
]->
	`g‘Stus
()) {

670  
çl£
;

673  
Œue
;

674 
	}
}

683 
funùiÚ
 
	$shouldInvoke
(
$‹¡_ÿ£_Çme
, 
$m‘hod
) {

684 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
»pÜ‹rs
); $i++) {

685 ià(! 
$this
->
»pÜ‹rs
[
$i
]->
	`shouldInvoke
(
$‹¡_ÿ£_Çme
, 
$m‘hod
)) {

686  
çl£
;

689  
Œue
;

690 
	}
}

698 
funùiÚ
 
	$ü—‹Invok”
(
$švok”
) {

699 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
»pÜ‹rs
); $i++) {

700 
$švok”
 = 
$this
->
»pÜ‹rs
[
$i
]->
	`ü—‹Invok”
($invoker);

702  
$švok”
;

703 
	}
}

711 
funùiÚ
 
	$g‘Dum³r
() {

712  
Ãw
 
	`Sim¶eDum³r
();

713 
	}
}

721 
funùiÚ
 
	$·štGroupS¹
(
$‹¡_Çme
, 
$size
) {

722 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
»pÜ‹rs
); $i++) {

723 
$this
->
»pÜ‹rs
[
$i
]->
	`·štGroupS¹
(
$‹¡_Çme
, 
$size
);

725 
	}
}

732 
funùiÚ
 
	$·štGroupEnd
(
$‹¡_Çme
) {

733 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
»pÜ‹rs
); $i++) {

734 
$this
->
»pÜ‹rs
[
$i
]->
	`·štGroupEnd
(
$‹¡_Çme
);

736 
	}
}

743 
funùiÚ
 
	$·štCa£S¹
(
$‹¡_Çme
) {

744 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
»pÜ‹rs
); $i++) {

745 
$this
->
»pÜ‹rs
[
$i
]->
	`·štCa£S¹
(
$‹¡_Çme
);

747 
	}
}

754 
funùiÚ
 
	$·štCa£End
(
$‹¡_Çme
) {

755 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
»pÜ‹rs
); $i++) {

756 
$this
->
»pÜ‹rs
[
$i
]->
	`·štCa£End
(
$‹¡_Çme
);

758 
	}
}

765 
funùiÚ
 
	$·štM‘hodS¹
(
$‹¡_Çme
) {

766 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
»pÜ‹rs
); $i++) {

767 
$this
->
»pÜ‹rs
[
$i
]->
	`·štM‘hodS¹
(
$‹¡_Çme
);

769 
	}
}

776 
funùiÚ
 
	$·štM‘hodEnd
(
$‹¡_Çme
) {

777 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
»pÜ‹rs
); $i++) {

778 
$this
->
»pÜ‹rs
[
$i
]->
	`·štM‘hodEnd
(
$‹¡_Çme
);

780 
	}
}

787 
funùiÚ
 
	$·štPass
(
$mes§ge
) {

788 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
»pÜ‹rs
); $i++) {

789 
$this
->
»pÜ‹rs
[
$i
]->
	`·štPass
(
$mes§ge
);

791 
	}
}

798 
funùiÚ
 
	$·štFa
(
$mes§ge
) {

799 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
»pÜ‹rs
); $i++) {

800 
$this
->
»pÜ‹rs
[
$i
]->
	`·štFa
(
$mes§ge
);

802 
	}
}

810 
funùiÚ
 
	$·štE¼Ü
(
$mes§ge
) {

811 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
»pÜ‹rs
); $i++) {

812 
$this
->
»pÜ‹rs
[
$i
]->
	`·štE¼Ü
(
$mes§ge
);

814 
	}
}

821 
funùiÚ
 
	$·štExû±iÚ
(
$exû±iÚ
) {

822 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
»pÜ‹rs
); $i++) {

823 
$this
->
»pÜ‹rs
[
$i
]->
	`·štExû±iÚ
(
$exû±iÚ
);

825 
	}
}

832 
funùiÚ
 
	$·štSk
(
$mes§ge
) {

833 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
»pÜ‹rs
); $i++) {

834 
$this
->
»pÜ‹rs
[
$i
]->
	`·štSk
(
$mes§ge
);

836 
	}
}

843 
funùiÚ
 
	$·štMes§ge
(
$mes§ge
) {

844 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
»pÜ‹rs
); $i++) {

845 
$this
->
»pÜ‹rs
[
$i
]->
	`·štMes§ge
(
$mes§ge
);

847 
	}
}

854 
funùiÚ
 
	$·štFÜm©‹dMes§ge
(
$mes§ge
) {

855 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
»pÜ‹rs
); $i++) {

856 
$this
->
»pÜ‹rs
[
$i
]->
	`·štFÜm©‹dMes§ge
(
$mes§ge
);

858 
	}
}

869 
funùiÚ
 
	$·štSigÇl
(
$ty³
, 
$·ylßd
) {

870 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
»pÜ‹rs
); $i++) {

871 
$this
->
»pÜ‹rs
[
$i
]->
	`·štSigÇl
(
$ty³
, 
$·ylßd
);

873 
	}
}

	@F:\Site\stew\1\_lp\simpletest\selector.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/tag.php');

13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/encoding.php');

22 şas 
	cSim¶eByName
 {

23 
´iv©e
 
	m$Çme
;

29 
funùiÚ
 
	$__cÚ¡ruù
(
$Çme
) {

30 
$this
->
Çme
 = 
$Çme
;

37 
funùiÚ
 
	$g‘Name
() {

38  
$this
->
Çme
;

39 
	}
}

46 
funùiÚ
 
	$isM©ch
(
$widg‘
) {

47  (
$widg‘
->
	`g‘Name
(è=ğ
$this
->
Çme
);

48 
	}
}

57 şas 
	cSim¶eByLab–
 {

58 
´iv©e
 
	m$Ïb–
;

64 
funùiÚ
 
	$__cÚ¡ruù
(
$Ïb–
) {

65 
$this
->
Ïb–
 = 
$Ïb–
;

74 
funùiÚ
 
	$isM©ch
(
$widg‘
) {

75 ià(! 
	`m‘hod_exi¡s
(
$widg‘
, 'isLabel')) {

76  
çl£
;

78  
$widg‘
->
	`isLab–
(
$this
->
Ïb–
);

79 
	}
}

88 şas 
	cSim¶eById
 {

89 
´iv©e
 
	m$id
;

95 
funùiÚ
 
	$__cÚ¡ruù
(
$id
) {

96 
$this
->
id
 = 
$id
;

104 
funùiÚ
 
	$isM©ch
(
$widg‘
) {

105  
$widg‘
->
	`isId
(
$this
->
id
);

106 
	}
}

115 şas 
	cSim¶eByLab–OrName
 {

116 
´iv©e
 
	m$Ïb–
;

122 
funùiÚ
 
	$__cÚ¡ruù
(
$Ïb–
) {

123 
$this
->
Ïb–
 = 
$Ïb–
;

132 
funùiÚ
 
	$isM©ch
(
$widg‘
) {

133 ià(
	`m‘hod_exi¡s
(
$widg‘
, 'isLabel')) {

134 ià(
$widg‘
->
	`isLab–
(
$this
->
Ïb–
)) {

135  
Œue
;

138  (
$widg‘
->
	`g‘Name
(è=ğ
$this
->
Ïb–
);

139 
	}
}

	@F:\Site\stew\1\_lp\simpletest\shell_tester.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/test_case.php');

20 şas 
	cSim¶eSh–l
 {

21 
´iv©e
 
	m$ouut
;

27 
funùiÚ
 
	$__cÚ¡ruù
() {

28 
$this
->
ouut
 = 
çl£
;

39 
funùiÚ
 
	$execu‹
(
$commªd
) {

40 
$this
->
ouut
 = 
çl£
;

41 
	`exec
(
$commªd
, 
$this
->
ouut
, 
$»t
);

42  
$»t
;

43 
	}
}

50 
funùiÚ
 
	$g‘Ouut
() {

51  
	`im¶ode
("\n", 
$this
->
ouut
);

52 
	}
}

59 
funùiÚ
 
	$g‘OuutAsLi¡
() {

60  
$this
->
ouut
;

61 
	}
}

71 şas 
	cSh–lTe¡Ca£
 
ex‹nds
 
	mSim¶eTe¡Ca£
 {

72 
´iv©e
 
	m$cu¼’t_sh–l
;

73 
´iv©e
 
	m$Ï¡_¡©us
;

74 
´iv©e
 
	m$Ï¡_commªd
;

83 
funùiÚ
 
	$__cÚ¡ruù
(
$Ïb–
 = 
çl£
) {

84 
·»Á
::
	`__cÚ¡ruù
(
$Ïb–
);

85 
$this
->
cu¼’t_sh–l
 = $this->
	`ü—‹Sh–l
();

86 
$this
->
Ï¡_¡©us
 = 
çl£
;

87 
$this
->
Ï¡_commªd
 = '';

96 
funùiÚ
 
	$execu‹
(
$commªd
) {

97 
$sh–l
 = 
$this
->
	`g‘Sh–l
();

98 
$this
->
Ï¡_¡©us
 = 
$sh–l
->
	`execu‹
(
$commªd
);

99 
$this
->
Ï¡_commªd
 = 
$commªd
;

100  (
$this
->
Ï¡_¡©us
 === 0);

101 
	}
}

107 
funùiÚ
 
	$dumpOuut
() {

108 
$this
->
	`dump
($this->
	`g‘Ouut
());

109 
	}
}

116 
funùiÚ
 
	$g‘Ouut
() {

117 
$sh–l
 = 
$this
->
	`g‘Sh–l
();

118  
$sh–l
->
	`g‘Ouut
();

119 
	}
}

126 
funùiÚ
 
	$g‘OuutAsLi¡
() {

127 
$sh–l
 = 
$this
->
	`g‘Sh–l
();

128  
$sh–l
->
	`g‘OuutAsLi¡
();

129 
	}
}

140 
funùiÚ
 
	$as£¹True
(
$»suÉ
, 
$mes§ge
 = 
çl£
) {

141  
$this
->
	`as£¹
(
Ãw
 
	`TrueEx³ù©iÚ
(), 
$»suÉ
, 
$mes§ge
);

142 
	}
}

154 
funùiÚ
 
as£¹F®£
(
$»suÉ
, 
$mes§ge
 = '%s') {

155  
$this
->
as£¹
(
Ãw
 
F®£Ex³ù©iÚ
(), 
$»suÉ
, 
$mes§ge
);

168 
funùiÚ
 
as£¹Equ®
(
$fœ¡
, 
$£cÚd
, 
$mes§ge
 = "%s") {

169  
$this
->
as£¹
(

170 
Ãw
 
Equ®Ex³ù©iÚ
(
$fœ¡
),

171 
$£cÚd
,

172 
$mes§ge
);

185 
funùiÚ
 
as£¹NÙEqu®
(
$fœ¡
, 
$£cÚd
, 
$mes§ge
 = "%s") {

186  
$this
->
as£¹
(

187 
Ãw
 
NÙEqu®Ex³ù©iÚ
(
$fœ¡
),

188 
$£cÚd
,

189 
$mes§ge
);

200 
funùiÚ
 
as£¹Ex™Code
(
$¡©us
, 
$mes§ge
 = "%s") {

201 
$mes§ge
 = 
¥rštf
($message, "Expected status code of [$status] from [" .

202 
$this
->
Ï¡_commªd
 . "], but got [" .

203 
$this
->
Ï¡_¡©us
 . "]");

204  
	g$this
->
as£¹True
(
$¡©us
 ==ğ
$this
->
Ï¡_¡©us
, 
$mes§ge
);

215 
funùiÚ
 
as£¹Ouut
(
$ex³ùed
, 
$mes§ge
 = "%s") {

216 
$sh–l
 = 
$this
->
g‘Sh–l
();

217  
	g$this
->
as£¹
(

218 
Ãw
 
Equ®Ex³ù©iÚ
(
$ex³ùed
),

219 
$sh–l
->
g‘Ouut
(),

220 
$mes§ge
);

231 
funùiÚ
 
as£¹OuutP©‹º
(
$·‰”n
, 
$mes§ge
 = "%s") {

232 
$sh–l
 = 
$this
->
g‘Sh–l
();

233  
	g$this
->
as£¹
(

234 
Ãw
 
P©‹ºEx³ù©iÚ
(
$·‰”n
),

235 
$sh–l
->
g‘Ouut
(),

236 
$mes§ge
);

247 
funùiÚ
 
as£¹NoOuutP©‹º
(
$·‰”n
, 
$mes§ge
 = "%s") {

248 
$sh–l
 = 
$this
->
g‘Sh–l
();

249  
	g$this
->
as£¹
(

250 
Ãw
 
NoP©‹ºEx³ù©iÚ
(
$·‰”n
),

251 
$sh–l
->
g‘Ouut
(),

252 
$mes§ge
);

262 
funùiÚ
 
as£¹FeExi¡s
(
$·th
, 
$mes§ge
 = "%s") {

263 
$mes§ge
 = 
¥rštf
($message, "File [$path] shouldƒxist");

264  
	g$this
->
as£¹True
(
fe_exi¡s
(
$·th
), 
$mes§ge
);

274 
funùiÚ
 
as£¹FeNÙExi¡s
(
$·th
, 
$mes§ge
 = "%s") {

275 
$mes§ge
 = 
¥rštf
($message, "File [$path] should‚otƒxist");

276  
	g$this
->
as£¹F®£
(
fe_exi¡s
(
$·th
), 
$mes§ge
);

288 
funùiÚ
 
as£¹FeP©‹º
(
$·‰”n
, 
$·th
, 
$mes§ge
 = "%s") {

289  
$this
->
as£¹
(

290 
Ãw
 
P©‹ºEx³ù©iÚ
(
$·‰”n
),

291 
im¶ode
('', 
fe
(
$·th
)),

292 
$mes§ge
);

304 
funùiÚ
 
as£¹NoFeP©‹º
(
$·‰”n
, 
$·th
, 
$mes§ge
 = "%s") {

305  
$this
->
as£¹
(

306 
Ãw
 
NoP©‹ºEx³ù©iÚ
(
$·‰”n
),

307 
im¶ode
('', 
fe
(
$·th
)),

308 
$mes§ge
);

317 
´Ùeùed
 
funùiÚ
 
	$g‘Sh–l
() {

318  
$this
->
cu¼’t_sh–l
;

319 
	}
}

326 
´Ùeùed
 
funùiÚ
 
	$ü—‹Sh–l
() {

327  
Ãw
 
	`Sim¶eSh–l
();

328 
	}
}

	@F:\Site\stew\1\_lp\simpletest\simpletest.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/reflection_php5.php');

13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/default_reporter.php');

14 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/compatibility.php');

23 şas 
	cSim¶eTe¡
 {

29 
funùiÚ
 
	$g‘V”siÚ
() {

30 
$cÚ‹Á
 = 
	`fe
(
	`dœÇme
(
__FILE__
) . '/VERSION');

31  
	`Œim
(
$cÚ‹Á
[0]);

39 
funùiÚ
 
	$ignÜe
(
$şass
) {

40 
$»gi¡ry
 = &
Sim¶eTe¡
::
	`g‘Regi¡ry
();

41 
$»gi¡ry
['IgnÜeLi¡'][
	`¡¹Şow”
(
$şass
)] = 
Œue
;

42 
	}
}

57 
funùiÚ
 
	$ignÜeP¬’tsIfIgnÜed
(
$şas£s
) {

58 
$»gi¡ry
 = &
Sim¶eTe¡
::
	`g‘Regi¡ry
();

59 
	`fÜ—ch
 (
$şas£s
 
as
 
$şass
) {

60 ià(
Sim¶eTe¡
::
	`isIgnÜed
(
$şass
)) {

61 
$»æeùiÚ
 = 
Ãw
 
	`Sim¶eReæeùiÚ
(
$şass
);

62 ià(
$·»Á
 = 
$»æeùiÚ
->
	`g‘P¬’t
()) {

63 
Sim¶eTe¡
::
	`ignÜe
(
$·»Á
);

67 
	}
}

76 
funùiÚ
 
	$´eãr
(
$objeù
) {

77 
$»gi¡ry
 = &
Sim¶eTe¡
::
	`g‘Regi¡ry
();

78 
$»gi¡ry
['P»ã¼ed'][] = 
$objeù
;

79 
	}
}

89 
funùiÚ
 
	$´eã¼ed
(
$şas£s
) {

90 ià(! 
	`is_¬¿y
(
$şas£s
)) {

91 
$şas£s
 = 
	`¬¿y
($classes);

93 
$»gi¡ry
 = &
Sim¶eTe¡
::
	`g‘Regi¡ry
();

94 
$i
 = 
	`couÁ
(
$»gi¡ry
['Preferred']) - 1; $i >= 0; $i--) {

95 
	`fÜ—ch
 (
$şas£s
 
as
 
$şass
) {

96 ià(
Sim¶eTe¡Com·tib™y
::
	`isA
(
$»gi¡ry
['P»ã¼ed'][
$i
], 
$şass
)) {

97  
$»gi¡ry
['P»ã¼ed'][
$i
];

101  
nuÎ
;

102 
	}
}

113 
funùiÚ
 
	$isIgnÜed
(
$şass
) {

114 
$»gi¡ry
 = &
Sim¶eTe¡
::
	`g‘Regi¡ry
();

115  
	`is£t
(
$»gi¡ry
['IgnÜeLi¡'][
	`¡¹Şow”
(
$şass
)]);

116 
	}
}

127 
funùiÚ
 
	$u£Proxy
(
$´oxy
, 
$u£ºame
 = 
çl£
, 
$·sswÜd
 = false) {

128 
$»gi¡ry
 = &
Sim¶eTe¡
::
	`g‘Regi¡ry
();

129 
$»gi¡ry
['DeçuÉProxy'] = 
$´oxy
;

130 
$»gi¡ry
['DeçuÉProxyU£ºame'] = 
$u£ºame
;

131 
$»gi¡ry
['DeçuÉProxyPasswÜd'] = 
$·sswÜd
;

132 
	}
}

138 
funùiÚ
 
	$g‘DeçuÉProxy
() {

139 
$»gi¡ry
 = &
Sim¶eTe¡
::
	`g‘Regi¡ry
();

140  
$»gi¡ry
['DefaultProxy'];

141 
	}
}

147 
funùiÚ
 
	$g‘DeçuÉProxyU£ºame
() {

148 
$»gi¡ry
 = &
Sim¶eTe¡
::
	`g‘Regi¡ry
();

149  
$»gi¡ry
['DefaultProxyUsername'];

150 
	}
}

156 
funùiÚ
 
	$g‘DeçuÉProxyPasswÜd
() {

157 
$»gi¡ry
 = &
Sim¶eTe¡
::
	`g‘Regi¡ry
();

158  
$»gi¡ry
['DefaultProxyPassword'];

159 
	}
}

167 
funùiÚ
 
	$g‘P¬£rs
() {

168 
$»gi¡ry
 = &
Sim¶eTe¡
::
	`g‘Regi¡ry
();

169  
$»gi¡ry
['Parsers'];

170 
	}
}

178 
funùiÚ
 
	$£tP¬£rs
(
$·r£rs
) {

179 
$»gi¡ry
 = &
Sim¶eTe¡
::
	`g‘Regi¡ry
();

180 
$»gi¡ry
['P¬£rs'] = 
$·r£rs
;

181 
	}
}

187 
´Ùeùed
 
	gfunùiÚ
 &
	$g‘Regi¡ry
() {

188 
$»gi¡ry
 = 
çl£
;

189 ià(! 
$»gi¡ry
) {

190 
$»gi¡ry
 = 
Sim¶eTe¡
::
	`g‘DeçuÉs
();

192  
$»gi¡ry
;

193 
	}
}

200 
funùiÚ
 
	$g‘CÚ‹xt
() {

201 
$cÚ‹xt
 = 
çl£
;

202 ià(! 
$cÚ‹xt
) {

203 
$cÚ‹xt
 = 
Ãw
 
	`Sim¶eTe¡CÚ‹xt
();

205  
$cÚ‹xt
;

206 
	}
}

212 
´Ùeùed
 
funùiÚ
 
	$g‘DeçuÉs
() {

213  
	`¬¿y
(

214 'P¬£rs' => 
çl£
,

216 'IgnÜeLi¡' => 
	`¬¿y
(),

217 'DeçuÉProxy' => 
çl£
,

218 'DeçuÉProxyU£ºame' => 
çl£
,

219 'DeçuÉProxyPasswÜd' => 
çl£
,

220 'P»ã¼ed' => 
	`¬¿y
(
Ãw
 
	`HtmlR•Ü‹r
(),‚ew 
	`TextR•Ü‹r
(),‚ew 
	`XmlR•Ü‹r
()));

221 
	}
}

226 
funùiÚ
 
	$£tMockBa£CÏss
(
$mock_ba£
) {

227 
$»gi¡ry
 = &
Sim¶eTe¡
::
	`g‘Regi¡ry
();

228 
$»gi¡ry
['MockBa£CÏss'] = 
$mock_ba£
;

229 
	}
}

234 
funùiÚ
 
	$g‘MockBa£CÏss
() {

235 
$»gi¡ry
 = &
Sim¶eTe¡
::
	`g‘Regi¡ry
();

236  
$»gi¡ry
['MockBaseClass'];

237 
	}
}

248 şas 
	cSim¶eTe¡CÚ‹xt
 {

249 
´iv©e
 
	m$‹¡
;

250 
´iv©e
 
	m$»pÜ‹r
;

251 
´iv©e
 
	m$»sourûs
;

257 
funùiÚ
 
	$ş—r
() {

258 
$this
->
»sourûs
 = 
	`¬¿y
();

267 
funùiÚ
 
	$£tTe¡
(
$‹¡
) {

268 
$this
->
	`ş—r
();

269 
$this
->
‹¡
 = 
$‹¡
;

270 
	}
}

276 
funùiÚ
 
	$g‘Te¡
() {

277  
$this
->
‹¡
;

278 
	}
}

286 
funùiÚ
 
	$£tR•Ü‹r
(
$»pÜ‹r
) {

287 
$this
->
	`ş—r
();

288 
$this
->
»pÜ‹r
 = 
$»pÜ‹r
;

289 
	}
}

295 
funùiÚ
 
	$g‘R•Ü‹r
() {

296  
$this
->
»pÜ‹r
;

297 
	}
}

303 
funùiÚ
 
	$g‘
(
$»sourû
) {

304 ià(! 
	`is£t
(
$this
->
»sourûs
[
$»sourû
])) {

305 
$this
->
»sourûs
[
$»sourû
] = 
Ãw
 
	`$»sourû
();

307  
$this
->
»sourûs
[
$»sourû
];

308 
	}
}

317 şas 
	cSim¶eSckT¿û
 {

318 
´iv©e
 
	m$´efixes
;

325 
funùiÚ
 
	$__cÚ¡ruù
(
$´efixes
) {

326 
$this
->
´efixes
 = 
$´efixes
;

336 
funùiÚ
 
	$ŒaûM‘hod
(
$¡ack
 = 
çl£
) {

337 
$¡ack
 = $¡ack ? $¡ack : 
$this
->
	`ÿ±u»T¿û
();

338 
	`fÜ—ch
 (
$¡ack
 
as
 
$äame
) {

339 ià(
$this
->
	`äameL›sW™hšSim¶eTe¡FŞd”
(
$äame
)) {

342 ià(
$this
->
	`äameM©chesP»fix
(
$äame
)) {

343  '‡ˆ[' . 
$äame
['file'] . '†ine ' . $frame['line'] . ']';

347 
	}
}

354 
´Ùeùed
 
funùiÚ
 
	$äameL›sW™hšSim¶eTe¡FŞd”
(
$äame
) {

355 ià(
	`is£t
(
$äame
['file'])) {

356 
$·th
 = 
	`sub¡r
(
SIMPLE_TEST
, 0, -1);

357 ià(
	`¡½os
(
$äame
['fe'], 
$·th
) === 0) {

358 ià(
	`dœÇme
(
$äame
['fe']è=ğ
$·th
) {

359  
Œue
;

363  
çl£
;

364 
	}
}

371 
´Ùeùed
 
funùiÚ
 
	$äameM©chesP»fix
(
$äame
) {

372 
	`fÜ—ch
 (
$this
->
´efixes
 
as
 
$´efix
) {

373 ià(
	`¡ºcmp
(
$äame
['funùiÚ'], 
$´efix
, 
	`¡¾’
($prefix)) == 0) {

374  
Œue
;

377  
çl£
;

378 
	}
}

384 
´Ùeùed
 
funùiÚ
 
	$ÿ±u»T¿û
() {

385 ià(
	`funùiÚ_exi¡s
('debug_backtrace')) {

386  
	`¬¿y_»v”£
(
	`debug_backŒaû
());

388  
	`¬¿y
();

389 
	}
}

	@F:\Site\stew\1\_lp\simpletest\socket.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/compatibility.php');

21 şas 
	cSim¶eStickyE¼Ü
 {

22 
´iv©e
 
	m$”rÜ
 = 'Constructor‚ot chained';

28 
funùiÚ
 
	$__cÚ¡ruù
() {

29 
$this
->
	`ş—rE¼Ü
();

37 
funùiÚ
 
	$isE¼Ü
() {

38  (
$this
->
”rÜ
 != '');

39 
	}
}

47 
funùiÚ
 
	$g‘E¼Ü
() {

48  
$this
->
”rÜ
;

49 
	}
}

56 
funùiÚ
 
	$£tE¼Ü
(
$”rÜ
) {

57 
$this
->
”rÜ
 = 
$”rÜ
;

58 
	}
}

64 
funùiÚ
 
	$ş—rE¼Ü
() {

65 
$this
->
	`£tE¼Ü
('');

66 
	}
}

73 şas 
	cSim¶eFeSock‘
 
ex‹nds
 
	mSim¶eStickyE¼Ü
 {

74 
´iv©e
 
	m$hªdË
;

75 
´iv©e
 
	m$is_İ’
 = 
çl£
;

76 
´iv©e
 
	m$£Á
 = '';

77 
´iv©e
 
	m$block_size
;

85 
funùiÚ
 
	$__cÚ¡ruù
(
$fe
, 
$block_size
 = 1024) {

86 
·»Á
::
	`__cÚ¡ruù
();

87 ià(! (
$this
->
hªdË
 = $this->
	`İ’Fe
(
$fe
, 
$”rÜ
))) {

88 
$fe_¡ršg
 = 
$fe
->
	`asSŒšg
();

89 
$this
->
	`£tE¼Ü
("Cannot open [$file_string] with [$error]");

92 
$this
->
is_İ’
 = 
Œue
;

93 
$this
->
block_size
 = 
$block_size
;

102 
funùiÚ
 
	$wr™e
(
$mes§ge
) {

103  
Œue
;

104 
	}
}

114 
funùiÚ
 
	$»ad
() {

115 
$¿w
 = @
	`ä—d
(
$this
->
hªdË
, $this->
block_size
);

116 ià(
$¿w
 ==ğ
çl£
) {

117 
$this
->
	`£tE¼Ü
('Cannot„ead from socket');

118 
$this
->
	`şo£
();

120  
$¿w
;

121 
	}
}

128 
funùiÚ
 
	$isO³n
() {

129  
$this
->
is_İ’
;

130 
	}
}

138 
funùiÚ
 
	$şo£
() {

139 ià(!
$this
->
is_İ’
è 
çl£
;

140 
$this
->
is_İ’
 = 
çl£
;

141  
	`fşo£
(
$this
->
hªdË
);

142 
	}
}

149 
funùiÚ
 
	$g‘S’t
() {

150  
$this
->
£Á
;

151 
	}
}

160 
´Ùeùed
 
funùiÚ
 
	$İ’Fe
(
$fe
, &
$”rÜ
) {

161  @
	`fİ’
(
$fe
->
	`asSŒšg
(), 'r');

162 
	}
}

170 şas 
	cSim¶eSock‘
 
ex‹nds
 
	mSim¶eStickyE¼Ü
 {

171 
´iv©e
 
	m$hªdË
;

172 
´iv©e
 
	m$is_İ’
 = 
çl£
;

173 
´iv©e
 
	m$£Á
 = '';

174 
´iv©e
 
	m$lock_size
;

184 
funùiÚ
 
	$__cÚ¡ruù
(
$ho¡
, 
$pÜt
, 
$timeout
, 
$block_size
 = 255) {

185 
·»Á
::
	`__cÚ¡ruù
();

186 ià(! (
$this
->
hªdË
 = $this->
	`İ’Sock‘
(
$ho¡
, 
$pÜt
, 
$”rÜ_numb”
, 
$”rÜ
, 
$timeout
))) {

187 
$this
->
	`£tE¼Ü
("Cannot open [$host:$port] with [$error] within [$timeout] seconds");

190 
$this
->
is_İ’
 = 
Œue
;

191 
$this
->
block_size
 = 
$block_size
;

192 
Sim¶eTe¡Com·tib™y
::
	`£tTimeout
(
$this
->
hªdË
, 
$timeout
);

201 
funùiÚ
 
	$wr™e
(
$mes§ge
) {

202 ià(
$this
->
	`isE¼Ü
(è|| ! $this->
	`isO³n
()) {

203  
çl£
;

205 
$couÁ
 = 
	`fwr™e
(
$this
->
hªdË
, 
$mes§ge
);

206 ià(! 
$couÁ
) {

207 ià(
$couÁ
 ==ğ
çl£
) {

208 
$this
->
	`£tE¼Ü
('Cannot writeo socket');

209 
$this
->
	`şo£
();

211  
çl£
;

213 
	`fæush
(
$this
->
hªdË
);

214 
$this
->
£Á
 .ğ
$mes§ge
;

215  
Œue
;

216 
	}
}

226 
funùiÚ
 
	$»ad
() {

227 ià(
$this
->
	`isE¼Ü
(è|| ! $this->
	`isO³n
()) {

228  
çl£
;

230 
$¿w
 = @
	`ä—d
(
$this
->
hªdË
, $this->
block_size
);

231 ià(
$¿w
 ==ğ
çl£
) {

232 
$this
->
	`£tE¼Ü
('Cannot„ead from socket');

233 
$this
->
	`şo£
();

235  
$¿w
;

236 
	}
}

243 
funùiÚ
 
	$isO³n
() {

244  
$this
->
is_İ’
;

245 
	}
}

253 
funùiÚ
 
	$şo£
() {

254 
$this
->
is_İ’
 = 
çl£
;

255  
	`fşo£
(
$this
->
hªdË
);

256 
	}
}

263 
funùiÚ
 
	$g‘S’t
() {

264  
$this
->
£Á
;

265 
	}
}

276 
´Ùeùed
 
funùiÚ
 
	$İ’Sock‘
(
$ho¡
, 
$pÜt
, &
$”rÜ_numb”
, &
$”rÜ
, 
$timeout
) {

277  @
	`fsockİ’
(
$ho¡
, 
$pÜt
, 
$”rÜ_numb”
, 
$”rÜ
, 
$timeout
);

278 
	}
}

286 şas 
	cSim¶eSecu»Sock‘
 
ex‹nds
 
	mSim¶eSock‘
 {

295 
funùiÚ
 
	$__cÚ¡ruù
(
$ho¡
, 
$pÜt
, 
$timeout
) {

296 
·»Á
::
	`__cÚ¡ruù
(
$ho¡
, 
$pÜt
, 
$timeout
);

308 
funùiÚ
 
	$İ’Sock‘
(
$ho¡
, 
$pÜt
, &
$”rÜ_numb”
, &
$”rÜ
, 
$timeout
) {

309  
·»Á
::
	`İ’Sock‘
("s://$ho¡", 
$pÜt
, 
$”rÜ_numb”
, 
$”rÜ
, 
$timeout
);

310 
	}
}

	@F:\Site\stew\1\_lp\simpletest\tag.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/page.php');

13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/encoding.php');

22 şas 
	cSim¶eTagBud”
 {

33 
funùiÚ
 
	$ü—‹Tag
(
$Çme
, 
$©Œibu‹s
) {

34 
$m­
 = 
	`¬¿y
(

44 
$©Œibu‹s
 = 
$this
->
	`keysToLow”Ca£
($attributes);

45 ià(
	`¬¿y_key_exi¡s
(
$Çme
, 
$m­
)) {

46 
$g_şass
 = 
$m­
[
$Çme
];

47  
Ãw
 
	`$g_şass
(
$©Œibu‹s
);

48 } 
	`–£if
 (
$Çme
 == 'select') {

49  
$this
->
	`ü—‹S–eùiÚTag
(
$©Œibu‹s
);

50 } 
	`–£if
 (
$Çme
 == 'input') {

51  
$this
->
	`ü—‹IÅutTag
(
$©Œibu‹s
);

53  
Ãw
 
	`Sim¶eTag
(
$Çme
, 
$©Œibu‹s
);

62 
´Ùeùed
 
funùiÚ
 
	$ü—‹S–eùiÚTag
(
$©Œibu‹s
) {

63 ià(
	`is£t
(
$©Œibu‹s
['multiple'])) {

64  
Ãw
 
	`MuÉËS–eùiÚTag
(
$©Œibu‹s
);

66  
Ãw
 
	`Sim¶eS–eùiÚTag
(
$©Œibu‹s
);

67 
	}
}

75 
´Ùeùed
 
funùiÚ
 
	$ü—‹IÅutTag
(
$©Œibu‹s
) {

76 ià(! 
	`is£t
(
$©Œibu‹s
['type'])) {

77  
Ãw
 
	`Sim¶eTextTag
(
$©Œibu‹s
);

79 
$ty³
 = 
	`¡¹Şow”
(
	`Œim
(
$©Œibu‹s
['type']));

80 
$m­
 = 
	`¬¿y
(

89 ià(
	`¬¿y_key_exi¡s
(
$ty³
, 
$m­
)) {

90 
$g_şass
 = 
$m­
[
$ty³
];

91  
Ãw
 
	`$g_şass
(
$©Œibu‹s
);

93  
çl£
;

94 
	}
}

102 
´Ùeùed
 
funùiÚ
 
	$keysToLow”Ca£
(
$m­
) {

103 
$low”
 = 
	`¬¿y
();

104 
	`fÜ—ch
 (
$m­
 
as
 
$key
 => 
$v®ue
) {

105 
$low”
[
	`¡¹Şow”
(
$key
)] = 
$v®ue
;

107  
$low”
;

108 
	}
}

116 şas 
	cSim¶eTag
 {

117 
´iv©e
 
	m$Çme
;

118 
´iv©e
 
	m$©Œibu‹s
;

119 
´iv©e
 
	m$cÚ‹Á
;

129 
funùiÚ
 
	$__cÚ¡ruù
(
$Çme
, 
$©Œibu‹s
) {

130 
$this
->
Çme
 = 
	`¡¹Şow”
(
	`Œim
(
$Çme
));

131 
$this
->
©Œibu‹s
 = 
$©Œibu‹s
;

132 
$this
->
cÚ‹Á
 = '';

141 
funùiÚ
 
	$ex³ùEndTag
() {

142  
Œue
;

143 
	}
}

154 
funùiÚ
 
	$isPriv©eCÚ‹Á
() {

155  
çl£
;

156 
	}
}

163 
funùiÚ
 
	$addCÚ‹Á
(
$cÚ‹Á
) {

164 
$this
->
cÚ‹Á
 .ğ(
¡ršg
)
$cÚ‹Á
;

165  
$this
;

166 
	}
}

173 
funùiÚ
 
	$addTag
(
$g
) {

174 
	}
}

180 
funùiÚ
 
	$addTags
(
$gs
) {

181 
	`fÜ—ch
 (
$gs
 
as
 
$g
) {

182 
$this
->
	`addTag
(
$g
);

184 
	}
}

191 
funùiÚ
 
	$g‘TagName
() {

192  
$this
->
Çme
;

193 
	}
}

200 
funùiÚ
 
	$g‘ChdEËm’ts
() {

201  
	`¬¿y
();

202 
	}
}

210 
funùiÚ
 
	$g‘A‰ribu‹
(
$Ïb–
) {

211 
$Ïb–
 = 
	`¡¹Şow”
($label);

212 ià(! 
	`is£t
(
$this
->
©Œibu‹s
[
$Ïb–
])) {

213  
çl£
;

215  (
¡ršg
)
$this
->
©Œibu‹s
[
$Ïb–
];

216 
	}
}

224 
´Ùeùed
 
funùiÚ
 
	$£tA‰ribu‹
(
$Ïb–
, 
$v®ue
) {

225 
$this
->
©Œibu‹s
[
	`¡¹Şow”
(
$Ïb–
)] = 
$v®ue
;

226 
	}
}

233 
funùiÚ
 
	$g‘CÚ‹Á
() {

234  
$this
->
cÚ‹Á
;

235 
	}
}

244 
funùiÚ
 
	$g‘Text
() {

245  
Sim¶ePage
::
	`nÜm®i£
(
$this
->
cÚ‹Á
);

246 
	}
}

254 
funùiÚ
 
	$isId
(
$id
) {

255  (
$this
->
	`g‘A‰ribu‹
('id'è=ğ
$id
);

256 
	}
}

264 şas 
	cSim¶eBa£Tag
 
ex‹nds
 
	mSim¶eTag
 {

271 
funùiÚ
 
	$__cÚ¡ruù
(
$©Œibu‹s
) {

272 
·»Á
::
	`__cÚ¡ruù
('ba£', 
$©Œibu‹s
);

280 
funùiÚ
 
	$ex³ùEndTag
() {

281  
çl£
;

282 
	}
}

290 şas 
	cSim¶eT™ËTag
 
ex‹nds
 
	mSim¶eTag
 {

297 
funùiÚ
 
	$__cÚ¡ruù
(
$©Œibu‹s
) {

298 
·»Á
::
	`__cÚ¡ruù
('t™Ë', 
$©Œibu‹s
);

300 
	}
}

307 şas 
	cSim¶eAnchÜTag
 
ex‹nds
 
	mSim¶eTag
 {

314 
funùiÚ
 
	$__cÚ¡ruù
(
$©Œibu‹s
) {

315 
·»Á
::
	`__cÚ¡ruù
('a', 
$©Œibu‹s
);

323 
funùiÚ
 
	$g‘H»f
() {

324 
$u¾
 = 
$this
->
	`g‘A‰ribu‹
('href');

325 ià(
	`is_boŞ
(
$u¾
)) {

326 
$u¾
 = '';

328  
$u¾
;

329 
	}
}

337 şas 
	cSim¶eWidg‘
 
ex‹nds
 
	mSim¶eTag
 {

338 
´iv©e
 
	m$v®ue
;

339 
´iv©e
 
	m$Ïb–
;

340 
´iv©e
 
	m$is_£t
;

348 
funùiÚ
 
	$__cÚ¡ruù
(
$Çme
, 
$©Œibu‹s
) {

349 
·»Á
::
	`__cÚ¡ruù
(
$Çme
, 
$©Œibu‹s
);

350 
$this
->
v®ue
 = 
çl£
;

351 
$this
->
Ïb–
 = 
çl£
;

352 
$this
->
is_£t
 = 
çl£
;

361 
funùiÚ
 
	$g‘Name
() {

362  
$this
->
	`g‘A‰ribu‹
('name');

363 
	}
}

370 
funùiÚ
 
	$g‘DeçuÉ
() {

371  
$this
->
	`g‘A‰ribu‹
('value');

372 
	}
}

381 
funùiÚ
 
	$g‘V®ue
() {

382 ià(! 
$this
->
is_£t
) {

383  
$this
->
	`g‘DeçuÉ
();

385  
$this
->
v®ue
;

386 
	}
}

394 
funùiÚ
 
	$£tV®ue
(
$v®ue
) {

395 
$this
->
v®ue
 = 
$v®ue
;

396 
$this
->
is_£t
 = 
Œue
;

397  
Œue
;

398 
	}
}

405 
funùiÚ
 
	$»£tV®ue
() {

406 
$this
->
is_£t
 = 
çl£
;

407 
	}
}

415 
funùiÚ
 
	$£tLab–
(
$Ïb–
) {

416 
$this
->
Ïb–
 = 
	`Œim
(
$Ïb–
);

417  
$this
;

418 
	}
}

426 
funùiÚ
 
	$isLab–
(
$Ïb–
) {

427  
$this
->
Ïb–
 =ğ
	`Œim
(
$Ïb–
);

428 
	}
}

435 
funùiÚ
 
	$wr™e
(
$’codšg
) {

436 ià(
$this
->
	`g‘Name
()) {

437 
$’codšg
->
	`add
(
$this
->
	`g‘Name
(), $this->
	`g‘V®ue
());

439 
	}
}

447 şas 
	cSim¶eTextTag
 
ex‹nds
 
	mSim¶eWidg‘
 {

454 
funùiÚ
 
	$__cÚ¡ruù
(
$©Œibu‹s
) {

455 
·»Á
::
	`__cÚ¡ruù
('šput', 
$©Œibu‹s
);

456 ià(
$this
->
	`g‘A‰ribu‹
('v®ue'è==ğ
çl£
) {

457 
$this
->
	`£tA‰ribu‹
('value', '');

466 
funùiÚ
 
	$ex³ùEndTag
() {

467  
çl£
;

468 
	}
}

477 
funùiÚ
 
	$£tV®ue
(
$v®ue
) {

478 ià(
$this
->
	`g‘A‰ribu‹
('type') == 'hidden') {

479  
çl£
;

481  
·»Á
::
	`£tV®ue
(
$v®ue
);

482 
	}
}

490 şas 
	cSim¶eSubm™Tag
 
ex‹nds
 
	mSim¶eWidg‘
 {

497 
funùiÚ
 
	$__cÚ¡ruù
(
$©Œibu‹s
) {

498 
·»Á
::
	`__cÚ¡ruù
('šput', 
$©Œibu‹s
);

499 ià(
$this
->
	`g‘A‰ribu‹
('v®ue'è==ğ
çl£
) {

500 
$this
->
	`£tA‰ribu‹
('value', 'Submit');

509 
funùiÚ
 
	$ex³ùEndTag
() {

510  
çl£
;

511 
	}
}

519 
funùiÚ
 
	$£tV®ue
(
$v®ue
) {

520  
çl£
;

521 
	}
}

528 
funùiÚ
 
	$g‘Lab–
() {

529  
$this
->
	`g‘V®ue
();

530 
	}
}

538 
funùiÚ
 
	$isLab–
(
$Ïb–
) {

539  
	`Œim
(
$Ïb–
è=ğŒim(
$this
->
	`g‘Lab–
());

540 
	}
}

548 şas 
	cSim¶eImageSubm™Tag
 
ex‹nds
 
	mSim¶eWidg‘
 {

555 
funùiÚ
 
	$__cÚ¡ruù
(
$©Œibu‹s
) {

556 
·»Á
::
	`__cÚ¡ruù
('šput', 
$©Œibu‹s
);

564 
funùiÚ
 
	$ex³ùEndTag
() {

565  
çl£
;

566 
	}
}

574 
funùiÚ
 
	$£tV®ue
(
$v®ue
) {

575  
çl£
;

576 
	}
}

583 
funùiÚ
 
	$g‘Lab–
() {

584 ià(
$this
->
	`g‘A‰ribu‹
('title')) {

585  
$this
->
	`g‘A‰ribu‹
('title');

587  
$this
->
	`g‘A‰ribu‹
('alt');

588 
	}
}

596 
funùiÚ
 
	$isLab–
(
$Ïb–
) {

597  
	`Œim
(
$Ïb–
è=ğŒim(
$this
->
	`g‘Lab–
());

598 
	}
}

607 
funùiÚ
 
	$wr™e
(
$’codšg
, 
$x
 = 1, 
$y
 = 1) {

608 ià(
$this
->
	`g‘Name
()) {

609 
$’codšg
->
	`add
(
$this
->
	`g‘Name
(è. '.x', 
$x
);

610 
$’codšg
->
	`add
(
$this
->
	`g‘Name
(è. '.y', 
$y
);

612 
$’codšg
->
	`add
('x', 
$x
);

613 
$’codšg
->
	`add
('y', 
$y
);

615 
	}
}

623 şas 
	cSim¶eBu‰ÚTag
 
ex‹nds
 
	mSim¶eWidg‘
 {

631 
funùiÚ
 
	$__cÚ¡ruù
(
$©Œibu‹s
) {

632 
·»Á
::
	`__cÚ¡ruù
('bu‰Ú', 
$©Œibu‹s
);

641 
funùiÚ
 
	$ex³ùEndTag
() {

642  
Œue
;

643 
	}
}

651 
funùiÚ
 
	$£tV®ue
(
$v®ue
) {

652  
çl£
;

653 
	}
}

660 
funùiÚ
 
	$g‘Lab–
() {

661  
$this
->
	`g‘CÚ‹Á
();

662 
	}
}

670 
funùiÚ
 
	$isLab–
(
$Ïb–
) {

671  
	`Œim
(
$Ïb–
è=ğŒim(
$this
->
	`g‘Lab–
());

672 
	}
}

680 şas 
	cSim¶eTextA»aTag
 
ex‹nds
 
	mSim¶eWidg‘
 {

687 
funùiÚ
 
	$__cÚ¡ruù
(
$©Œibu‹s
) {

688 
·»Á
::
	`__cÚ¡ruù
('‹x»a', 
$©Œibu‹s
);

696 
funùiÚ
 
	$g‘DeçuÉ
() {

697  
$this
->
	`w¿p
(
	`html_’t™y_decode
($this->
	`g‘CÚ‹Á
(), 
ENT_QUOTES
));

698 
	}
}

706 
funùiÚ
 
	$£tV®ue
(
$v®ue
) {

707  
·»Á
::
	`£tV®ue
(
$this
->
	`w¿p
(
$v®ue
));

708 
	}
}

715 
funùiÚ
 
	$w¿pIsEÇbËd
() {

716 ià(
$this
->
	`g‘A‰ribu‹
('cols')) {

717 
$w¿p
 = 
$this
->
	`g‘A‰ribu‹
('wrap');

718 ià((
$w¿p
 == 'physical') || ($wrap == 'hard')) {

719  
Œue
;

722  
çl£
;

723 
	}
}

735 
´Ùeùed
 
funùiÚ
 
	$w¿p
(
$‹xt
) {

736 
$‹xt
 = 
	`¡r_»¶aû
("\r\r\n", "\r\n", str_replace("\n", "\r\n", $text));

737 
$‹xt
 = 
	`¡r_»¶aû
("\r\n\n", "\r\n", str_replace("\r", "\r\n", $text));

738 ià(
	`¡ºcmp
(
$‹xt
, "\r\n", 
	`¡¾’
("\r\n")) == 0) {

739 
$‹xt
 = 
	`sub¡r
($‹xt, 
	`¡¾’
("\r\n"));

741 ià(
$this
->
	`w¿pIsEÇbËd
()) {

742  
	`wÜdw¿p
(

743 
$‹xt
,

744 (
š‹g”
)
$this
->
	`g‘A‰ribu‹
('cols'),

747  
$‹xt
;

748 
	}
}

755 
funùiÚ
 
	$isPriv©eCÚ‹Á
() {

756  
Œue
;

757 
	}
}

765 şas 
	cSim¶eU¶ßdTag
 
ex‹nds
 
	mSim¶eWidg‘
 {

772 
funùiÚ
 
	$__cÚ¡ruù
(
$©Œibu‹s
) {

773 
·»Á
::
	`__cÚ¡ruù
('šput', 
$©Œibu‹s
);

781 
funùiÚ
 
	$ex³ùEndTag
() {

782  
çl£
;

783 
	}
}

790 
funùiÚ
 
	$wr™e
(
$’codšg
) {

791 ià(! 
	`fe_exi¡s
(
$this
->
	`g‘V®ue
())) {

794 
$’codšg
->
	`©ch
(

795 
$this
->
	`g‘Name
(),

796 
	`im¶ode
('', 
	`fe
(
$this
->
	`g‘V®ue
())),

797 
	`ba£Çme
(
$this
->
	`g‘V®ue
()));

798 
	}
}

806 şas 
	cSim¶eS–eùiÚTag
 
ex‹nds
 
	mSim¶eWidg‘
 {

807 
´iv©e
 
	m$İtiÚs
;

808 
´iv©e
 
	m$choiû
;

815 
funùiÚ
 
	$__cÚ¡ruù
(
$©Œibu‹s
) {

816 
·»Á
::
	`__cÚ¡ruù
('£Ëù', 
$©Œibu‹s
);

817 
$this
->
İtiÚs
 = 
	`¬¿y
();

818 
$this
->
choiû
 = 
çl£
;

826 
funùiÚ
 
	$addTag
(
$g
) {

827 ià(
$g
->
	`g‘TagName
() == 'option') {

828 
$this
->
İtiÚs
[] = 
$g
;

830 
	}
}

837 
funùiÚ
 
	$addCÚ‹Á
(
$cÚ‹Á
) {

838  
$this
;

839 
	}
}

847 
funùiÚ
 
	$g‘DeçuÉ
() {

848 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$this
->
İtiÚs
); $i < $count; $i++) {

849 ià(
$this
->
İtiÚs
[
$i
]->
	`g‘A‰ribu‹
('£Ëùed'è!=ğ
çl£
) {

850  
$this
->
İtiÚs
[
$i
]->
	`g‘DeçuÉ
();

853 ià(
$couÁ
 > 0) {

854  
$this
->
İtiÚs
[0]->
	`g‘DeçuÉ
();

857 
	}
}

865 
funùiÚ
 
	$£tV®ue
(
$v®ue
) {

866 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$this
->
İtiÚs
); $i < $count; $i++) {

867 ià(
$this
->
İtiÚs
[
$i
]->
	`isV®ue
(
$v®ue
)) {

868 
$this
->
choiû
 = 
$i
;

869  
Œue
;

872  
çl£
;

873 
	}
}

881 
funùiÚ
 
	$g‘V®ue
() {

882 ià(
$this
->
choiû
 ==ğ
çl£
) {

883  
$this
->
	`g‘DeçuÉ
();

885  
$this
->
İtiÚs
[$this->
choiû
]->
	`g‘V®ue
();

886 
	}
}

894 şas 
	cMuÉËS–eùiÚTag
 
ex‹nds
 
	mSim¶eWidg‘
 {

895 
´iv©e
 
	m$İtiÚs
;

896 
´iv©e
 
	m$v®ues
;

903 
funùiÚ
 
	$__cÚ¡ruù
(
$©Œibu‹s
) {

904 
·»Á
::
	`__cÚ¡ruù
('£Ëù', 
$©Œibu‹s
);

905 
$this
->
İtiÚs
 = 
	`¬¿y
();

906 
$this
->
v®ues
 = 
çl£
;

914 
funùiÚ
 
	$addTag
(
$g
) {

915 ià(
$g
->
	`g‘TagName
() == 'option') {

916 
$this
->
İtiÚs
[] = &
$g
;

918 
	}
}

925 
funùiÚ
 
	$addCÚ‹Á
(
$cÚ‹Á
) {

926  
$this
;

927 
	}
}

935 
funùiÚ
 
	$g‘DeçuÉ
() {

936 
$deçuÉ
 = 
	`¬¿y
();

937 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$this
->
İtiÚs
); $i < $count; $i++) {

938 ià(
$this
->
İtiÚs
[
$i
]->
	`g‘A‰ribu‹
('£Ëùed'è!=ğ
çl£
) {

939 
$deçuÉ
[] = 
$this
->
İtiÚs
[
$i
]->
	`g‘DeçuÉ
();

942  
$deçuÉ
;

943 
	}
}

953 
funùiÚ
 
	$£tV®ue
(
$desœed
) {

954 
$ach›ved
 = 
	`¬¿y
();

955 
	`fÜ—ch
 (
$desœed
 
as
 
$v®ue
) {

956 
$sucûss
 = 
çl£
;

957 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$this
->
İtiÚs
); $i < $count; $i++) {

958 ià(
$this
->
İtiÚs
[
$i
]->
	`isV®ue
(
$v®ue
)) {

959 
$ach›ved
[] = 
$this
->
İtiÚs
[
$i
]->
	`g‘V®ue
();

960 
$sucûss
 = 
Œue
;

964 ià(! 
$sucûss
) {

965  
çl£
;

968 
$this
->
v®ues
 = 
$ach›ved
;

969  
Œue
;

970 
	}
}

977 
funùiÚ
 
	$g‘V®ue
() {

978 ià(
$this
->
v®ues
 ==ğ
çl£
) {

979  
$this
->
	`g‘DeçuÉ
();

981  
$this
->
v®ues
;

982 
	}
}

990 şas 
	cSim¶eO±iÚTag
 
ex‹nds
 
	mSim¶eWidg‘
 {

995 
funùiÚ
 
	$__cÚ¡ruù
(
$©Œibu‹s
) {

996 
·»Á
::
	`__cÚ¡ruù
('İtiÚ', 
$©Œibu‹s
);

1005 
funùiÚ
 
	$£tV®ue
(
$v®ue
) {

1006  
çl£
;

1007 
	}
}

1015 
funùiÚ
 
	$isV®ue
(
$com·»
) {

1016 
$com·»
 = 
	`Œim
($compare);

1017 ià(
	`Œim
(
$this
->
	`g‘V®ue
()è=ğ
$com·»
) {

1018  
Œue
;

1020  
	`Œim
(
	`¡r_gs
(
$this
->
	`g‘CÚ‹Á
())è=ğ
$com·»
;

1021 
	}
}

1029 
funùiÚ
 
	$g‘DeçuÉ
() {

1030 ià(
$this
->
	`g‘A‰ribu‹
('v®ue'è==ğ
çl£
) {

1031  
	`¡r_gs
(
$this
->
	`g‘CÚ‹Á
());

1033  
$this
->
	`g‘A‰ribu‹
('value');

1034 
	}
}

1041 
funùiÚ
 
	$isPriv©eCÚ‹Á
() {

1042  
Œue
;

1043 
	}
}

1051 şas 
	cSim¶eRadioBu‰ÚTag
 
ex‹nds
 
	mSim¶eWidg‘
 {

1057 
funùiÚ
 
	$__cÚ¡ruù
(
$©Œibu‹s
) {

1058 
·»Á
::
	`__cÚ¡ruù
('šput', 
$©Œibu‹s
);

1059 ià(
$this
->
	`g‘A‰ribu‹
('v®ue'è==ğ
çl£
) {

1060 
$this
->
	`£tA‰ribu‹
('value', 'on');

1069 
funùiÚ
 
	$ex³ùEndTag
() {

1070  
çl£
;

1071 
	}
}

1080 
funùiÚ
 
	$£tV®ue
(
$v®ue
) {

1081 ià(
$v®ue
 ==ğ
çl£
) {

1082  
·»Á
::
	`£tV®ue
(
$v®ue
);

1084 ià(
$v®ue
 !ğ
$this
->
	`g‘A‰ribu‹
('value')) {

1085  
çl£
;

1087  
·»Á
::
	`£tV®ue
(
$v®ue
);

1088 
	}
}

1095 
funùiÚ
 
	$g‘DeçuÉ
() {

1096 ià(
$this
->
	`g‘A‰ribu‹
('checked'è!=ğ
çl£
) {

1097  
$this
->
	`g‘A‰ribu‹
('value');

1099  
çl£
;

1100 
	}
}

1108 şas 
	cSim¶eCheckboxTag
 
ex‹nds
 
	mSim¶eWidg‘
 {

1115 
funùiÚ
 
	$__cÚ¡ruù
(
$©Œibu‹s
) {

1116 
·»Á
::
	`__cÚ¡ruù
('šput', 
$©Œibu‹s
);

1117 ià(
$this
->
	`g‘A‰ribu‹
('v®ue'è==ğ
çl£
) {

1118 
$this
->
	`£tA‰ribu‹
('value', 'on');

1127 
funùiÚ
 
	$ex³ùEndTag
() {

1128  
çl£
;

1129 
	}
}

1140 
funùiÚ
 
	$£tV®ue
(
$v®ue
) {

1141 ià(
$v®ue
 ==ğ
çl£
) {

1142  
·»Á
::
	`£tV®ue
(
$v®ue
);

1144 ià(
$v®ue
 ==ğ
Œue
) {

1145  
·»Á
::
	`£tV®ue
(
$this
->
	`g‘A‰ribu‹
('value'));

1147 ià(
$v®ue
 !ğ
$this
->
	`g‘A‰ribu‹
('value')) {

1148  
çl£
;

1150  
·»Á
::
	`£tV®ue
(
$v®ue
);

1151 
	}
}

1159 
funùiÚ
 
	$g‘DeçuÉ
() {

1160 ià(
$this
->
	`g‘A‰ribu‹
('checked'è!=ğ
çl£
) {

1161  
$this
->
	`g‘A‰ribu‹
('value');

1163  
çl£
;

1164 
	}
}

1172 şas 
	cSim¶eTagGroup
 {

1173 
´iv©e
 
	m$widg‘s
 = 
¬¿y
();

1180 
funùiÚ
 
	$addWidg‘
(
$widg‘
) {

1181 
$this
->
widg‘s
[] = 
$widg‘
;

1189 
´Ùeùed
 
funùiÚ
 &
	$g‘Widg‘s
() {

1190  
$this
->
widg‘s
;

1191 
	}
}

1199 
funùiÚ
 
	$g‘A‰ribu‹
(
$Ïb–
) {

1200  
çl£
;

1201 
	}
}

1209 
funùiÚ
 
	$g‘Name
() {

1210 ià(
	`couÁ
(
$this
->
widg‘s
) > 0) {

1211  
$this
->
widg‘s
[0]->
	`g‘Name
();

1213 
	}
}

1222 
funùiÚ
 
	$isId
(
$id
) {

1223 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$this
->
widg‘s
); $i < $count; $i++) {

1224 ià(
$this
->
widg‘s
[
$i
]->
	`isId
(
$id
)) {

1225  
Œue
;

1228  
çl£
;

1229 
	}
}

1238 
funùiÚ
 
	$isLab–
(
$Ïb–
) {

1239 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$this
->
widg‘s
); $i < $count; $i++) {

1240 ià(
$this
->
widg‘s
[
$i
]->
	`isLab–
(
$Ïb–
)) {

1241  
Œue
;

1244  
çl£
;

1245 
	}
}

1252 
funùiÚ
 
	$wr™e
(
$’codšg
) {

1253 
$’codšg
->
	`add
(
$this
->
	`g‘Name
(), $this->
	`g‘V®ue
());

1254 
	}
}

1262 şas 
	cSim¶eCheckboxGroup
 
ex‹nds
 
	mSim¶eTagGroup
 {

1270 
funùiÚ
 
	$g‘V®ue
() {

1271 
$v®ues
 = 
	`¬¿y
();

1272 
$widg‘s
 = 
$this
->
	`g‘Widg‘s
();

1273 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$widg‘s
); $i < $count; $i++) {

1274 ià(
$widg‘s
[
$i
]->
	`g‘V®ue
(è!=ğ
çl£
) {

1275 
$v®ues
[] = 
$widg‘s
[
$i
]->
	`g‘V®ue
();

1278  
$this
->
	`cÛrûV®ues
(
$v®ues
);

1286 
funùiÚ
 
	$g‘DeçuÉ
() {

1287 
$v®ues
 = 
	`¬¿y
();

1288 
$widg‘s
 = 
$this
->
	`g‘Widg‘s
();

1289 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$widg‘s
); $i < $count; $i++) {

1290 ià(
$widg‘s
[
$i
]->
	`g‘DeçuÉ
(è!=ğ
çl£
) {

1291 
$v®ues
[] = 
$widg‘s
[
$i
]->
	`g‘DeçuÉ
();

1294  
$this
->
	`cÛrûV®ues
(
$v®ues
);

1295 
	}
}

1304 
funùiÚ
 
	$£tV®ue
(
$v®ues
) {

1305 
$v®ues
 = 
$this
->
	`makeA¼ay
($values);

1306 ià(! 
$this
->
	`v®uesA»PossibË
(
$v®ues
)) {

1307  
çl£
;

1309 
$widg‘s
 = 
$this
->
	`g‘Widg‘s
();

1310 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$widg‘s
); $i < $count; $i++) {

1311 
$possibË
 = 
$widg‘s
[
$i
]->
	`g‘A‰ribu‹
('value');

1312 ià(
	`š_¬¿y
(
$widg‘s
[
$i
]->
	`g‘A‰ribu‹
('v®ue'), 
$v®ues
)) {

1313 
$widg‘s
[
$i
]->
	`£tV®ue
(
$possibË
);

1315 
$widg‘s
[
$i
]->
	`£tV®ue
(
çl£
);

1318  
Œue
;

1319 
	}
}

1329 
´Ùeùed
 
funùiÚ
 
	$v®uesA»PossibË
(
$v®ues
) {

1330 
$m©ches
 = 
	`¬¿y
();

1331 
$widg‘s
 = &
$this
->
	`g‘Widg‘s
();

1332 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$widg‘s
); $i < $count; $i++) {

1333 
$possibË
 = 
$widg‘s
[
$i
]->
	`g‘A‰ribu‹
('value');

1334 ià(
	`š_¬¿y
(
$possibË
, 
$v®ues
)) {

1335 
$m©ches
[] = 
$possibË
;

1338  (
$v®ues
 =ğ
$m©ches
);

1339 
	}
}

1349 
´Ùeùed
 
funùiÚ
 
	$cÛrûV®ues
(
$v®ues
) {

1350 ià(
	`couÁ
(
$v®ues
) == 0) {

1351  
çl£
;

1352 } 
	`–£if
 (
	`couÁ
(
$v®ues
) == 1) {

1353  
$v®ues
[0];

1355  
$v®ues
;

1357 
	}
}

1368 
´Ùeùed
 
funùiÚ
 
	$makeA¼ay
(
$v®ue
) {

1369 ià(
$v®ue
 ==ğ
çl£
) {

1370  
	`¬¿y
();

1372 ià(
	`is_¡ršg
(
$v®ue
)) {

1373  
	`¬¿y
(
$v®ue
);

1375  
$v®ue
;

1376 
	}
}

1385 şas 
	cSim¶eRadioGroup
 
ex‹nds
 
	mSim¶eTagGroup
 {

1395 
funùiÚ
 
	$£tV®ue
(
$v®ue
) {

1396 ià(! 
$this
->
	`v®ueIsPossibË
(
$v®ue
)) {

1397  
çl£
;

1399 
$šdex
 = 
çl£
;

1400 
$widg‘s
 = 
$this
->
	`g‘Widg‘s
();

1401 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$widg‘s
); $i < $count; $i++) {

1402 ià(! 
$widg‘s
[
$i
]->
	`£tV®ue
(
$v®ue
)) {

1403 
$widg‘s
[
$i
]->
	`£tV®ue
(
çl£
);

1406  
Œue
;

1415 
´Ùeùed
 
funùiÚ
 
	$v®ueIsPossibË
(
$v®ue
) {

1416 
$widg‘s
 = 
$this
->
	`g‘Widg‘s
();

1417 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$widg‘s
); $i < $count; $i++) {

1418 ià(
$widg‘s
[
$i
]->
	`g‘A‰ribu‹
('v®ue'è=ğ
$v®ue
) {

1419  
Œue
;

1422  
çl£
;

1423 
	}
}

1432 
funùiÚ
 
	$g‘V®ue
() {

1433 
$widg‘s
 = 
$this
->
	`g‘Widg‘s
();

1434 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$widg‘s
); $i < $count; $i++) {

1435 ià(
$widg‘s
[
$i
]->
	`g‘V®ue
(è!=ğ
çl£
) {

1436  
$widg‘s
[
$i
]->
	`g‘V®ue
();

1439  
çl£
;

1440 
	}
}

1448 
funùiÚ
 
	$g‘DeçuÉ
() {

1449 
$widg‘s
 = 
$this
->
	`g‘Widg‘s
();

1450 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$widg‘s
); $i < $count; $i++) {

1451 ià(
$widg‘s
[
$i
]->
	`g‘DeçuÉ
(è!=ğ
çl£
) {

1452  
$widg‘s
[
$i
]->
	`g‘DeçuÉ
();

1455  
çl£
;

1456 
	}
}

1464 şas 
	cSim¶eLab–Tag
 
ex‹nds
 
	mSim¶eTag
 {

1471 
funùiÚ
 
	$__cÚ¡ruù
(
$©Œibu‹s
) {

1472 
·»Á
::
	`__cÚ¡ruù
('Ïb–', 
$©Œibu‹s
);

1480 
funùiÚ
 
	$g‘FÜ
() {

1481  
$this
->
	`g‘A‰ribu‹
('for');

1482 
	}
}

1490 şas 
	cSim¶eFÜmTag
 
ex‹nds
 
	mSim¶eTag
 {

1497 
funùiÚ
 
	$__cÚ¡ruù
(
$©Œibu‹s
) {

1498 
·»Á
::
	`__cÚ¡ruù
('fÜm', 
$©Œibu‹s
);

1500 
	}
}

1507 şas 
	cSim¶eF¿meTag
 
ex‹nds
 
	mSim¶eTag
 {

1514 
funùiÚ
 
	$__cÚ¡ruù
(
$©Œibu‹s
) {

1515 
·»Á
::
	`__cÚ¡ruù
('äame', 
$©Œibu‹s
);

1523 
funùiÚ
 
	$ex³ùEndTag
() {

1524  
çl£
;

1525 
	}
}

	@F:\Site\stew\1\_lp\simpletest\test_case.php

1 <?
php


13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/invoker.php');

14 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/errors.php');

15 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/compatibility.php');

16 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/scorer.php');

17 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/expectation.php');

18 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/dumper.php');

19 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/simpletest.php');

20 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/exceptions.php');

21 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/reflection_php5.php');

23 ià(! 
defšed
('SIMPLE_TEST')) {

27 
defše
('SIMPLE_TEST', 
dœÇme
(
__FILE__
è. 
DIRECTORY_SEPARATOR
);

38 şas 
	cSim¶eTe¡Ca£
 {

39 
´iv©e
 
	m$Ïb–
 = 
çl£
;

40 
´Ùeùed
 
	m$»pÜ‹r
;

41 
´iv©e
 
	m$ob£rv”s
;

42 
´iv©e
 
	m$should_sk
 = 
çl£
;

50 
funùiÚ
 
	$__cÚ¡ruù
(
$Ïb–
 = 
çl£
) {

51 ià(
$Ïb–
) {

52 
$this
->
Ïb–
 = 
$Ïb–
;

61 
funùiÚ
 
	$g‘Lab–
() {

62  
$this
->
Ïb–
 ? $this->Ïb– : 
	`g‘_şass
($this);

63 
	}
}

71 
funùiÚ
 
	$sk
() {

72 
	}
}

81 
funùiÚ
 
skIf
(
$should_sk
, 
$mes§ge
 = '%s') {

82 ià(
$should_sk
 && ! 
$this
->
should_sk
) {

83 
$this
->
should_sk
 = 
Œue
;

84 
	g$mes§ge
 = 
¥rštf
(
$mes§ge
, 'Skpšg [' . 
g‘_şass
(
$this
) . ']');

85 
	g$this
->
	g»pÜ‹r
->
·štSk
(
$mes§ge
 . 
$this
->
g‘As£¹iÚLše
());

93 
funùiÚ
 
	$shouldSk
() {

94  
$this
->
should_sk
;

95 
	}
}

104 
funùiÚ
 
	$skUÆess
(
$shouldÁ_sk
, 
$mes§ge
 = 
çl£
) {

105 
$this
->
	`skIf
(! 
$shouldÁ_sk
, 
$mes§ge
);

106 
	}
}

113 
funùiÚ
 
	$ü—‹Invok”
() {

114  
Ãw
 
	`Sim¶eE¼ÜT¿µšgInvok”
(

115 
Ãw
 
	`Sim¶eExû±iÚT¿µšgInvok”
Òew 
	`Sim¶eInvok”
(
$this
)));

116 
	}
}

126 
funùiÚ
 
	$run
(
$»pÜ‹r
) {

127 
$cÚ‹xt
 = 
Sim¶eTe¡
::
	`g‘CÚ‹xt
();

128 
$cÚ‹xt
->
	`£tTe¡
(
$this
);

129 
$cÚ‹xt
->
	`£tR•Ü‹r
(
$»pÜ‹r
);

130 
$this
->
»pÜ‹r
 = 
$»pÜ‹r
;

131 
$¡¬‹d
 = 
çl£
;

132 
	`fÜ—ch
 (
$this
->
	`g‘Te¡s
(è
as
 
$m‘hod
) {

133 ià(
$»pÜ‹r
->
	`shouldInvoke
(
$this
->
	`g‘Lab–
(), 
$m‘hod
)) {

134 
$this
->
	`sk
();

135 ià(
$this
->
should_sk
) {

138 ià(! 
$¡¬‹d
) {

139 
$»pÜ‹r
->
	`·štCa£S¹
(
$this
->
	`g‘Lab–
());

140 
$¡¬‹d
 = 
Œue
;

142 
$švok”
 = 
$this
->
»pÜ‹r
->
	`ü—‹Invok”
($this->createInvoker());

143 
$švok”
->
	`befÜe
(
$m‘hod
);

144 
$švok”
->
	`švoke
(
$m‘hod
);

145 
$švok”
->
	`aá”
(
$m‘hod
);

148 ià(
$¡¬‹d
) {

149 
$»pÜ‹r
->
	`·štCa£End
(
$this
->
	`g‘Lab–
());

151 
	`un£t
(
$this
->
»pÜ‹r
);

152 
$cÚ‹xt
->
	`£tTe¡
(
nuÎ
);

153  
$»pÜ‹r
->
	`g‘Stus
();

154 
	}
}

164 
funùiÚ
 
	$g‘Te¡s
() {

165 
$m‘hods
 = 
	`¬¿y
();

166 
	`fÜ—ch
 (
	`g‘_şass_m‘hods
(
	`g‘_şass
(
$this
)è
as
 
$m‘hod
) {

167 ià(
$this
->
	`isTe¡
(
$m‘hod
)) {

168 
$m‘hods
[] = 
$m‘hod
;

171  
$m‘hods
;

172 
	}
}

182 
´Ùeùed
 
funùiÚ
 
	$isTe¡
(
$m‘hod
) {

183 ià(
	`¡¹Şow”
(
	`sub¡r
(
$m‘hod
, 0, 4)) == 'test') {

184  ! 
Sim¶eTe¡Com·tib™y
::
	`isA
(
$this
, 
	`¡¹Şow”
(
$m‘hod
));

186  
çl£
;

187 
	}
}

194 
funùiÚ
 
	$befÜe
(
$m‘hod
) {

195 
$this
->
»pÜ‹r
->
	`·štM‘hodS¹
(
$m‘hod
);

196 
$this
->
ob£rv”s
 = 
	`¬¿y
();

197 
	}
}

205 
funùiÚ
 
	$£tUp
() {

206 
	}
}

213 
funùiÚ
 
	$‹¬Down
() {

214 
	}
}

221 
funùiÚ
 
	$aá”
(
$m‘hod
) {

222 
$i
 = 0; $˜< 
	`couÁ
(
$this
->
ob£rv”s
); $i++) {

223 
$this
->
ob£rv”s
[
$i
]->
	`©Te¡End
(
$m‘hod
, $this);

225 
$this
->
»pÜ‹r
->
	`·štM‘hodEnd
(
$m‘hod
);

226 
	}
}

234 
funùiÚ
 
	$‹Î
(
$ob£rv”
) {

235 
$this
->
ob£rv”s
[] = &
$ob£rv”
;

236 
	}
}

241 
funùiÚ
 
·ss
(
$mes§ge
 = "Pass") {

242 ià(! 
is£t
(
$this
->
»pÜ‹r
)) {

243 
Œigg”_”rÜ
('Can only make‡ssertions withinest methods');

245 
	g$this
->
	g»pÜ‹r
->
·štPass
(

246 
$mes§ge
 . 
$this
->
g‘As£¹iÚLše
());

247  
	gŒue
;

255 
funùiÚ
 
ç
(
$mes§ge
 = "Fail") {

256 ià(! 
is£t
(
$this
->
»pÜ‹r
)) {

257 
Œigg”_”rÜ
('Can only make‡ssertions withinest methods');

259 
	g$this
->
	g»pÜ‹r
->
·štFa
(

260 
$mes§ge
 . 
$this
->
g‘As£¹iÚLše
());

261  
	gçl£
;

273 
funùiÚ
 
	$”rÜ
(
$£v”™y
, 
$mes§ge
, 
$fe
, 
$lše
) {

274 ià(! 
	`is£t
(
$this
->
»pÜ‹r
)) {

275 
	`Œigg”_”rÜ
('Can only make‡ssertions withinest methods');

277 
$this
->
»pÜ‹r
->
	`·štE¼Ü
(

279 
	}
}

287 
funùiÚ
 
	$exû±iÚ
(
$exû±iÚ
) {

288 
$this
->
»pÜ‹r
->
	`·štExû±iÚ
(
$exû±iÚ
);

289 
	}
}

296 
funùiÚ
 
	$sigÇl
(
$ty³
, 
$·ylßd
) {

297 ià(! 
	`is£t
(
$this
->
»pÜ‹r
)) {

298 
	`Œigg”_”rÜ
('Can only make‡ssertions withinest methods');

300 
$this
->
»pÜ‹r
->
	`·štSigÇl
(
$ty³
, 
$·ylßd
);

301 
	}
}

312 
funùiÚ
 
as£¹
(
$ex³ù©iÚ
, 
$com·»
, 
$mes§ge
 = '%s') {

313 ià(
$ex³ù©iÚ
->
‹¡
(
$com·»
)) {

314  
$this
->
·ss
(
¥rštf
(

315 
$mes§ge
,

316 
$ex³ù©iÚ
->
ov”ÏyMes§ge
(
$com·»
, 
$this
->
»pÜ‹r
->
g‘Dum³r
())));

318  
	g$this
->
ç
(
¥rštf
(

319 
$mes§ge
,

320 
$ex³ù©iÚ
->
ov”ÏyMes§ge
(
$com·»
, 
$this
->
»pÜ‹r
->
g‘Dum³r
())));

330 
funùiÚ
 
	$g‘As£¹iÚLše
() {

331 
$Œaû
 = 
Ãw
 
	`Sim¶eSckT¿û
(
	`¬¿y
('assert', 'expect', 'pass', 'fail', 'skip'));

332  
$Œaû
->
	`ŒaûM‘hod
();

333 
	}
}

344 
funùiÚ
 
	$dump
(
$v¬ŸbË
, 
$mes§ge
 = 
çl£
) {

345 
$dum³r
 = 
$this
->
»pÜ‹r
->
	`g‘Dum³r
();

346 
$fÜm©‹d
 = 
$dum³r
->
	`dump
(
$v¬ŸbË
);

347 ià(
$mes§ge
) {

348 
$fÜm©‹d
 = 
$mes§ge
 . "\n" . $formatted;

350 
$this
->
»pÜ‹r
->
	`·štFÜm©‹dMes§ge
(
$fÜm©‹d
);

351  
$v¬ŸbË
;

352 
	}
}

359 
funùiÚ
 
	$g‘Size
() {

361 
	}
}

369 şas 
	cSim¶eFeLßd”
 {

379 
funùiÚ
 
	$lßd
(
$‹¡_fe
) {

380 
$exi¡šg_şas£s
 = 
	`g‘_deş¬ed_şas£s
();

381 
$exi¡šg_glob®s
 = 
	`g‘_defšed_v¬s
();

382 
	`šşude_Úû
(
$‹¡_fe
);

383 
$Ãw_glob®s
 = 
	`g‘_defšed_v¬s
();

384 
$this
->
	`makeFeV¬ŸbËsGlob®
(
$exi¡šg_glob®s
, 
$Ãw_glob®s
);

385 
$Ãw_şas£s
 = 
	`¬¿y_diff
(
	`g‘_deş¬ed_şas£s
(), 
$exi¡šg_şas£s
);

386 ià(
	`em±y
(
$Ãw_şas£s
)) {

387 
$Ãw_şas£s
 = 
$this
->
	`sü­eCÏs£sFromFe
(
$‹¡_fe
);

389 
$şas£s
 = 
$this
->
	`£ËùRuÂabËTe¡s
(
$Ãw_şas£s
);

390  
$this
->
	`ü—‹Su™eFromCÏs£s
(
$‹¡_fe
, 
$şas£s
);

399 
´Ùeùed
 
funùiÚ
 
	$makeFeV¬ŸbËsGlob®
(
$exi¡šg
, 
$Ãw
) {

400 
$glob®s
 = 
	`¬¿y_diff
(
	`¬¿y_keys
(
$Ãw
),‡¼ay_keys(
$exi¡šg
));

401 
	`fÜ—ch
 (
$glob®s
 
as
 
$glob®
) {

402 
$GLOBALS
[
$glob®
] = 
$Ãw
[$global];

404 
	}
}

416 
´Ùeùed
 
funùiÚ
 
	$sü­eCÏs£sFromFe
(
$‹¡_fe
) {

417 
	`´eg_m©ch_®l
('~^\s*class\s+(\w+)(\s+(extends|implements)\s+\w+)*\s*\{~mi',

418 
	`fe_g‘_cÚ‹Ás
(
$‹¡_fe
),

419 
$m©ches
 );

420  
$m©ches
[1];

421 
	}
}

431 
funùiÚ
 
	$£ËùRuÂabËTe¡s
(
$ÿndid©es
) {

432 
$şas£s
 = 
	`¬¿y
();

433 
	`fÜ—ch
 (
$ÿndid©es
 
as
 
$şass
) {

434 ià(
Te¡Su™e
::
	`g‘Ba£Te¡Ca£
(
$şass
)) {

435 
$»æeùiÚ
 = 
Ãw
 
	`Sim¶eReæeùiÚ
(
$şass
);

436 ià(
$»æeùiÚ
->
	`isAb¡¿ù
()) {

437 
Sim¶eTe¡
::
	`ignÜe
(
$şass
);

439 
$şas£s
[] = 
$şass
;

443  
$şas£s
;

444 
	}
}

454 
funùiÚ
 
	$ü—‹Su™eFromCÏs£s
(
$t™Ë
, 
$şas£s
) {

455 ià(
	`couÁ
(
$şas£s
) == 0) {

456 
$su™e
 = 
Ãw
 
	`BadTe¡Su™e
(
$t™Ë
, "No„unnableest cases in [$title]");

457  
$su™e
;

459 
Sim¶eTe¡
::
	`ignÜeP¬’tsIfIgnÜed
(
$şas£s
);

460 
$su™e
 = 
Ãw
 
	`Te¡Su™e
(
$t™Ë
);

461 
	`fÜ—ch
 (
$şas£s
 
as
 
$şass
) {

462 ià(! 
Sim¶eTe¡
::
	`isIgnÜed
(
$şass
)) {

463 
$su™e
->
	`add
(
$şass
);

466  
$su™e
;

467 
	}
}

477 şas 
	cTe¡Su™e
 {

478 
´iv©e
 
	m$Ïb–
;

479 
´iv©e
 
	m$‹¡_ÿ£s
;

487 
funùiÚ
 
	$Te¡Su™e
(
$Ïb–
 = 
çl£
) {

488 
$this
->
Ïb–
 = 
$Ïb–
;

489 
$this
->
‹¡_ÿ£s
 = 
	`¬¿y
();

498 
funùiÚ
 
	$g‘Lab–
() {

499 ià(! 
$this
->
Ïb–
) {

500  (
$this
->
	`g‘Size
() == 1) ?

501 
	`g‘_şass
(
$this
->
‹¡_ÿ£s
[0]) : get_class($this);

503  
$this
->
Ïb–
;

505 
	}
}

515 
funùiÚ
 
	$add
(
$‹¡_ÿ£
) {

516 ià(! 
	`is_¡ršg
(
$‹¡_ÿ£
)) {

517 
$this
->
‹¡_ÿ£s
[] = 
$‹¡_ÿ£
;

518 } 
	`–£if
 (
Te¡Su™e
::
	`g‘Ba£Te¡Ca£
(
$‹¡_ÿ£
) == 'testsuite') {

519 
$this
->
‹¡_ÿ£s
[] = 
Ãw
 
	`$‹¡_ÿ£
();

521 
$this
->
‹¡_ÿ£s
[] = 
$‹¡_ÿ£
;

523 
	}
}

532 
funùiÚ
 
	$addFe
(
$‹¡_fe
) {

533 
$exŒaùÜ
 = 
Ãw
 
	`Sim¶eFeLßd”
();

534 
$this
->
	`add
(
$exŒaùÜ
->
	`lßd
(
$‹¡_fe
));

535 
	}
}

544 
funùiÚ
 
	$cŞËù
(
$·th
, 
$cŞËùÜ
) {

545 
$cŞËùÜ
->
	`cŞËù
(
$this
, 
$·th
);

546 
	}
}

554 
funùiÚ
 
	$run
(
$»pÜ‹r
) {

555 
$»pÜ‹r
->
	`·štGroupS¹
(
$this
->
	`g‘Lab–
(), $this->
	`g‘Size
());

556 
$i
 = 0, 
$couÁ
 = 
	`couÁ
(
$this
->
‹¡_ÿ£s
); $i < $count; $i++) {

557 ià(
	`is_¡ršg
(
$this
->
‹¡_ÿ£s
[
$i
])) {

558 
$şass
 = 
$this
->
‹¡_ÿ£s
[
$i
];

559 
$‹¡
 = 
Ãw
 
	`$şass
();

560 
$‹¡
->
	`run
(
$»pÜ‹r
);

561 
	`un£t
(
$‹¡
);

563 
$this
->
‹¡_ÿ£s
[
$i
]->
	`run
(
$»pÜ‹r
);

566 
$»pÜ‹r
->
	`·štGroupEnd
(
$this
->
	`g‘Lab–
());

567  
$»pÜ‹r
->
	`g‘Stus
();

568 
	}
}

575 
funùiÚ
 
	$g‘Size
() {

576 
$couÁ
 = 0;

577 
	`fÜ—ch
 (
$this
->
‹¡_ÿ£s
 
as
 
$ÿ£
) {

578 ià(
	`is_¡ršg
(
$ÿ£
)) {

579 ià(! 
Sim¶eTe¡
::
	`isIgnÜed
(
$ÿ£
)) {

580 
$couÁ
++;

583 
$couÁ
 +ğ
$ÿ£
->
	`g‘Size
();

586  
$couÁ
;

587 
	}
}

595 
funùiÚ
 
	$g‘Ba£Te¡Ca£
(
$şass
) {

596 
$şass
 = 
	`g‘_·»Á_şass
($class)) {

597 
$şass
 = 
	`¡¹Şow”
($class);

598 ià(
$şass
 == 'simpletestcase' || $class == 'testsuite') {

599  
$şass
;

602  
çl£
;

603 
	}
}

612 şas 
	cBadTe¡Su™e
 {

613 
´iv©e
 
	m$Ïb–
;

614 
´iv©e
 
	m$”rÜ
;

622 
funùiÚ
 
	$BadTe¡Su™e
(
$Ïb–
, 
$”rÜ
) {

623 
$this
->
Ïb–
 = 
$Ïb–
;

624 
$this
->
”rÜ
 = 
$”rÜ
;

632 
funùiÚ
 
	$g‘Lab–
() {

633  
$this
->
Ïb–
;

634 
	}
}

641 
funùiÚ
 
	$run
(
$»pÜ‹r
) {

642 
$»pÜ‹r
->
	`·štGroupS¹
(
$this
->
	`g‘Lab–
(), $this->
	`g‘Size
());

643 
$»pÜ‹r
->
	`·štFa
('Bad Te¡Su™[' . 
$this
->
	`g‘Lab–
() .

644 '] w™hƒ¼Ü [' . 
$this
->
”rÜ
 . ']');

645 
$»pÜ‹r
->
	`·štGroupEnd
(
$this
->
	`g‘Lab–
());

646  
$»pÜ‹r
->
	`g‘Stus
();

647 
	}
}

654 
funùiÚ
 
	$g‘Size
() {

656 
	}
}

	@F:\Site\stew\1\_lp\simpletest\tidy_parser.php

1 <?
php


14 şas 
	cSim¶eTidyPageBud”
 {

15 
´iv©e
 
	m$·ge
;

16 
´iv©e
 
	m$fÜms
 = 
¬¿y
();

17 
´iv©e
 
	m$Ïb–s
 = 
¬¿y
();

18 
´iv©e
 
	m$widg‘s_by_id
 = 
¬¿y
();

20 
public
 
funùiÚ
 
	$__de¡ruù
() {

21 
$this
->
	`ä“
();

28 
´iv©e
 
funùiÚ
 
	$ä“
() {

29 
	`un£t
(
$this
->
·ge
);

30 
$this
->
fÜms
 = 
	`¬¿y
();

31 
$this
->
Ïb–s
 = 
	`¬¿y
();

32 
	}
}

38 
funùiÚ
 
	$ÿn
() {

39  
	`ex‹nsiÚ_lßded
('tidy');

40 
	}
}

47 
funùiÚ
 
	$·r£
(
$»¥Ú£
) {

48 
$this
->
·ge
 = 
Ãw
 
	`Sim¶ePage
(
$»¥Ú£
);

49 
$tid›d
 = 
	`tidy_·r£_¡ršg
(
$šput
 = 
$this
->
	`š£¹Gu¬ds
(
$»¥Ú£
->
	`g‘CÚ‹Á
()),

50 
	`¬¿y
('ouut-xml' => 
çl£
, 'wrap' => '0', 'indent' => 'no'),

52 
$this
->
	`w®kT»e
(
$tid›d
->
	`html
());

53 
$this
->
	`©chLab–s
($this->
widg‘s_by_id
, $this->
Ïb–s
);

54 
$this
->
·ge
->
	`£tFÜms
($this->
fÜms
);

55 
$·ge
 = 
$this
->
·ge
;

56 
$this
->
	`ä“
();

57  
$·ge
;

58 
	}
}

65 
´iv©e
 
funùiÚ
 
	$š£¹Gu¬ds
(
$html
) {

66  
$this
->
	`š£¹Em±yTagGu¬ds
($this->
	`š£¹Tex»aSim¶eWh™e¥aûGu¬ds
(
$html
));

67 
	}
}

76 
´iv©e
 
funùiÚ
 
	$¡rGu¬ds
(
$html
) {

77  
$this
->
	`¡rTex»aWh™e¥aûGu¬ds
($this->
	`¡rEm±yTagGu¬ds
(
$html
));

78 
	}
}

86 
´iv©e
 
funùiÚ
 
	$š£¹Em±yTagGu¬ds
(
$html
) {

87  
	`´eg_»¶aû
('#<(option|textarea)([^>]*)>(\s*)</(option|textarea)>#is',

89 
$html
);

90 
	}
}

100 
´iv©e
 
funùiÚ
 
	$¡rEm±yTagGu¬ds
(
$html
) {

101  
	`´eg_»¶aû
('#(^|>)(\s*)___EMPTY___(\s*)(</|$)#i', '\2\3', 
$html
);

102 
	}
}

111 
´iv©e
 
funùiÚ
 
	$š£¹Tex»aSim¶eWh™e¥aûGu¬ds
(
$html
) {

112  
	`´eg_»¶aû_ÿÎback
('#<textarea([^>]*)>(.*?)</textarea>#is',

113 
	`¬¿y
(
$this
, 'insertWhitespaceGuards'),

114 
$html
);

115 
	}
}

122 
´iv©e
 
funùiÚ
 
	$š£¹Wh™e¥aûGu¬ds
(
$m©ches
) {

123  '<‹x»a' . 
$m©ches
[1] . '>' .

124 
	`¡r_»¶aû
(
	`¬¿y
("\n", "\r", "\t", ' '),

125 
	`¬¿y
('___NEWLINE___', '___CR___', '___TAB___', '___SPACE___'),

126 
$m©ches
[2]) .

128 
	}
}

136 
´iv©e
 
funùiÚ
 
	$¡rTex»aWh™e¥aûGu¬ds
(
$html
) {

137  
	`¡r_»¶aû
(
	`¬¿y
('___NEWLINE___', '___CR___', '___TAB___', '___SPACE___'),

138 
	`¬¿y
("\n", "\r", "\t", ' '),

139 
$html
);

140 
	}
}

146 
´iv©e
 
funùiÚ
 
	$w®kT»e
(
$node
) {

147 ià(
$node
->
Çme
 == 'a') {

148 
$this
->
·ge
->
	`addLšk
($this->
	`gs
()->
	`ü—‹Tag
(
$node
->
Çme
, (
¬¿y
)$node->
©Œibu‹
)

149 ->
	`addCÚ‹Á
(
$this
->
	`šÃrHtml
(
$node
)));

150 } 
	`–£if
 (
$node
->
Çme
 =ğ'ba£' 
ªd
 
	`is£t
($node->
©Œibu‹
['href'])) {

151 
$this
->
·ge
->
	`£tBa£
(
$node
->
©Œibu‹
['href']);

152 } 
	`–£if
 (
$node
->
Çme
 == 'title') {

153 
$this
->
·ge
->
	`£tT™Ë
($this->
	`gs
()->
	`ü—‹Tag
(
$node
->
Çme
, (
¬¿y
)$node->
©Œibu‹
)

154 ->
	`addCÚ‹Á
(
$this
->
	`šÃrHtml
(
$node
)));

155 } 
	`–£if
 (
$node
->
Çme
 == 'frameset') {

156 
$this
->
·ge
->
	`£tF¿mes
($this->
	`cŞËùF¿mes
(
$node
));

157 } 
	`–£if
 (
$node
->
Çme
 == 'form') {

158 
$this
->
fÜms
[] = $this->
	`w®kFÜm
(
$node
, $this->
	`ü—‹Em±yFÜm
($node));

159 } 
	`–£if
 (
$node
->
Çme
 == 'label') {

160 
$this
->
Ïb–s
[] = $this->
	`gs
()->
	`ü—‹Tag
(
$node
->
Çme
, (
¬¿y
)$node->
©Œibu‹
)

161 ->
	`addCÚ‹Á
(
$this
->
	`šÃrHtml
(
$node
));

163 
$this
->
	`w®kChd»n
(
$node
);

165 
	}
}

171 
´iv©e
 
funùiÚ
 
	$w®kChd»n
(
$node
) {

172 ià(
$node
->
	`hasChd»n
()) {

173 
	`fÜ—ch
 (
$node
->
chd
 
as
 
$chd
) {

174 
$this
->
	`w®kT»e
(
$chd
);

177 
	}
}

184 
´iv©e
 
funùiÚ
 
	$ü—‹Em±yFÜm
(
$node
) {

185  
Ãw
 
	`Sim¶eFÜm
(
$this
->
	`gs
()->
	`ü—‹Tag
(
$node
->
Çme
, (
¬¿y
)$node->
©Œibu‹
), $this->
·ge
);

186 
	}
}

192 
´iv©e
 
funùiÚ
 
w®kFÜm
(
$node
, 
$fÜm
, 
$’şosšg_Ïb–
 = '') {

193 ià(
$node
->
Çme
 == 'a') {

194 
$this
->
·ge
->
addLšk
($this->
gs
()->
ü—‹Tag
(
$node
->
Çme
, (
¬¿y
)$node->
©Œibu‹
)

195 ->
addCÚ‹Á
(
$this
->
šÃrHtml
(
$node
)));

196 } 
–£if
 (
š_¬¿y
(
$node
->
Çme
, 
¬¿y
('input', 'button', 'textarea', 'select'))) {

197 
	g$this
->
addWidg‘ToFÜm
(
$node
, 
$fÜm
, 
$’şosšg_Ïb–
);

198 } 
–£if
 (
$node
->
Çme
 == 'label') {

199 
$this
->
Ïb–s
[] = $this->
gs
()->
ü—‹Tag
(
$node
->
Çme
, (
¬¿y
)$node->
©Œibu‹
)

200 ->
addCÚ‹Á
(
$this
->
šÃrHtml
(
$node
));

201 ià(
	g$node
->
hasChd»n
()) {

202 
fÜ—ch
 (
$node
->
chd
 
as
 
$chd
) {

203 
	g$this
->
w®kFÜm
(
$chd
, 
$fÜm
, 
Sim¶ePage
::
nÜm®i£
(
$this
->
šÃrHtml
(
$node
)));

206 } 
–£if
 (
$node
->
hasChd»n
()) {

207 
fÜ—ch
 (
$node
->
chd
 
as
 
$chd
) {

208 
	g$this
->
w®kFÜm
(
$chd
, 
$fÜm
);

211  
	g$fÜm
;

220 
´iv©e
 
funùiÚ
 
	$hasFÜ
(
$node
) {

221  
	`is£t
(
$node
->
©Œibu‹
è
ªd
 $node->attribute['for'];

222 
	}
}

231 
´iv©e
 
funùiÚ
 
	$addWidg‘ToFÜm
(
$node
, 
$fÜm
, 
$’şosšg_Ïb–
) {

232 
$widg‘
 = 
$this
->
	`gs
()->
	`ü—‹Tag
(
$node
->
Çme
, $this->
	`©Œibu‹s
($node));

233 ià(! 
$widg‘
) {

236 
$widg‘
->
	`£tLab–
(
$’şosšg_Ïb–
)

237 ->
	`addCÚ‹Á
(
$this
->
	`šÃrHtml
(
$node
));

238 ià(
$node
->
Çme
 == 'select') {

239 
$widg‘
->
	`addTags
(
$this
->
	`cŞËùS–eùO±iÚs
(
$node
));

241 
$fÜm
->
	`addWidg‘
(
$widg‘
);

242 
$this
->
	`šdexWidg‘ById
(
$widg‘
);

243 
	}
}

249 
´iv©e
 
funùiÚ
 
	$šdexWidg‘ById
(
$widg‘
) {

250 
$id
 = 
$widg‘
->
	`g‘A‰ribu‹
('id');

251 ià(! 
$id
) {

254 ià(! 
	`is£t
(
$this
->
widg‘s_by_id
[
$id
])) {

255 
$this
->
widg‘s_by_id
[
$id
] = 
	`¬¿y
();

257 
$this
->
widg‘s_by_id
[
$id
][] = 
$widg‘
;

258 
	}
}

265 
´iv©e
 
funùiÚ
 
	$cŞËùS–eùO±iÚs
(
$node
) {

266 
$İtiÚs
 = 
	`¬¿y
();

267 ià(
$node
->
Çme
 == 'option') {

268 
$İtiÚs
[] = 
$this
->
	`gs
()->
	`ü—‹Tag
(
$node
->
Çme
, $this->
	`©Œibu‹s
($node))

269 ->
	`addCÚ‹Á
(
$this
->
	`šÃrHtml
(
$node
));

271 ià(
$node
->
	`hasChd»n
()) {

272 
	`fÜ—ch
 (
$node
->
chd
 
as
 
$chd
) {

273 
$İtiÚs
 = 
	`¬¿y_m”ge
($İtiÚs, 
$this
->
	`cŞËùS–eùO±iÚs
(
$chd
));

276  
$İtiÚs
;

277 
	}
}

285 
´iv©e
 
funùiÚ
 
	$©Œibu‹s
(
$node
) {

286 ià(! 
	`´eg_m©ch
('|<[^ ]+\s(.*?)/?>|s', 
$node
->
v®ue
, 
$fœ¡_g_cÚ‹Ás
)) {

287  
	`¬¿y
();

289 
$©Œibu‹s
 = 
	`¬¿y
();

290 
	`´eg_m©ch_®l
('/\S+\s*=\s*\'[^\']*\'|(\S+\s*=\s*"[^"]*")|([^ =]+\s*=\s*[^ "\']+?)|[^ "\']+/', 
$fœ¡_g_cÚ‹Ás
[1], 
$m©ches
);

291 
	`fÜ—ch
(
$m©ches
[0] 
as
 
$uÅ¬£d
) {

292 
$©Œibu‹s
 = 
$this
->
	`m”geA‰ribu‹
($©Œibu‹s, 
$uÅ¬£d
);

294  
$©Œibu‹s
;

295 
	}
}

304 
´iv©e
 
funùiÚ
 
	$m”geA‰ribu‹
(
$©Œibu‹s
, 
$¿w
) {

305 
$·¹s
 = 
	`ex¶ode
('=', 
$¿w
);

306 
	`li¡
(
$Çme
, 
$v®ue
èğ
	`couÁ
(
$·¹s
è=ğ1 ? 
	`¬¿y
($parts[0], $parts[0]) : $parts;

307 
$©Œibu‹s
[
	`Œim
(
$Çme
)] = 
	`html_’t™y_decode
(
$this
->
	`dequÙe
Ñrim(
$v®ue
)), 
ENT_QUOTES
);

308  
$©Œibu‹s
;

309 
	}
}

316 
´iv©e
 
funùiÚ
 
	$dequÙe
(
$quÙed
) {

317 ià(
	`´eg_m©ch
('/^(\'([^\']*)\'|"([^"]*)")$/', 
$quÙed
, 
$m©ches
)) {

318  
	`is£t
(
$m©ches
[3]) ? $matches[3] : $matches[2];

320  
$quÙed
;

321 
	}
}

328 
´iv©e
 
funùiÚ
 
	$cŞËùF¿mes
(
$node
) {

329 
$äames
 = 
	`¬¿y
();

330 ià(
$node
->
Çme
 == 'frame') {

331 
$äames
 = 
	`¬¿y
(
$this
->
	`gs
()->
	`ü—‹Tag
(
$node
->
Çme
, (
¬¿y
)$node->
©Œibu‹
));

332 } ià(
$node
->
	`hasChd»n
()) {

333 
$äames
 = 
	`¬¿y
();

334 
	`fÜ—ch
 (
$node
->
chd
 
as
 
$chd
) {

335 
$äames
 = 
	`¬¿y_m”ge
($äames, 
$this
->
	`cŞËùF¿mes
(
$chd
));

338  
$äames
;

339 
	}
}

346 
´iv©e
 
funùiÚ
 
	$šÃrHtml
(
$node
) {

347 
$¿w
 = '';

348 ià(
$node
->
	`hasChd»n
()) {

349 
	`fÜ—ch
 (
$node
->
chd
 
as
 
$chd
) {

350 
$¿w
 .ğ
$chd
->
v®ue
;

353  
$this
->
	`¡rGu¬ds
(
$¿w
);

354 
	}
}

360 
´iv©e
 
funùiÚ
 
	$gs
() {

361  
Ãw
 
	`Sim¶eTagBud”
();

362 
	}
}

370 
´iv©e
 
funùiÚ
 
	$©chLab–s
(
$widg‘s_by_id
, 
$Ïb–s
) {

371 
	`fÜ—ch
 (
$Ïb–s
 
as
 
$Ïb–
) {

372 
$fÜ
 = 
$Ïb–
->
	`g‘FÜ
();

373 ià(
$fÜ
 
ªd
 
	`is£t
(
$widg‘s_by_id
[$for])) {

374 
$‹xt
 = 
$Ïb–
->
	`g‘Text
();

375 
	`fÜ—ch
 (
$widg‘s_by_id
[
$fÜ
] 
as
 
$widg‘
) {

376 
$widg‘
->
	`£tLab–
(
$‹xt
);

380 
	}
}

	@F:\Site\stew\1\_lp\simpletest\unit_tester.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/test_case.php');

13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/dumper.php');

23 şas 
	cUn™Te¡Ca£
 
ex‹nds
 
	mSim¶eTe¡Ca£
 {

32 
funùiÚ
 
	$__cÚ¡ruù
(
$Ïb–
 = 
çl£
) {

33 ià(! 
$Ïb–
) {

34 
$Ïb–
 = 
	`g‘_şass
(
$this
);

36 
·»Á
::
	`__cÚ¡ruù
(
$Ïb–
);

48 
funùiÚ
 
	`as£¹True
(
$»suÉ
, 
$mes§ge
 = '%s') {

49  
$this
->
	`as£¹
(
Ãw
 
	`TrueEx³ù©iÚ
(), 
$»suÉ
, 
$mes§ge
);

50 
	}
}

62 
funùiÚ
 
as£¹F®£
(
$»suÉ
, 
$mes§ge
 = '%s') {

63  
$this
->
as£¹
(
Ãw
 
F®£Ex³ù©iÚ
(), 
$»suÉ
, 
$mes§ge
);

73 
funùiÚ
 
as£¹NuÎ
(
$v®ue
, 
$mes§ge
 = '%s') {

74 
$dum³r
 = 
Ãw
 
Sim¶eDum³r
();

75 
	g$mes§ge
 = 
¥rštf
(

76 
$mes§ge
,

77 '[' . 
$dum³r
->
desüibeV®ue
(
$v®ue
) . '] should be‚ull');

78  
	g$this
->
as£¹True
(! 
is£t
(
$v®ue
), 
$mes§ge
);

88 
funùiÚ
 
as£¹NÙNuÎ
(
$v®ue
, 
$mes§ge
 = '%s') {

89 
$dum³r
 = 
Ãw
 
Sim¶eDum³r
();

90 
	g$mes§ge
 = 
¥rštf
(

91 
$mes§ge
,

92 '[' . 
$dum³r
->
desüibeV®ue
(
$v®ue
) . '] should‚ot be‚ull');

93  
	g$this
->
as£¹True
(
is£t
(
$v®ue
), 
$mes§ge
);

106 
funùiÚ
 
as£¹IsA
(
$objeù
, 
$ty³
, 
$mes§ge
 = '%s') {

107  
$this
->
as£¹
(

108 
Ãw
 
IsAEx³ù©iÚ
(
$ty³
),

109 
$objeù
,

110 
$mes§ge
);

123 
funùiÚ
 
as£¹NÙA
(
$objeù
, 
$ty³
, 
$mes§ge
 = '%s') {

124  
$this
->
as£¹
(

125 
Ãw
 
NÙAEx³ù©iÚ
(
$ty³
),

126 
$objeù
,

127 
$mes§ge
);

139 
funùiÚ
 
as£¹Equ®
(
$fœ¡
, 
$£cÚd
, 
$mes§ge
 = '%s') {

140  
$this
->
as£¹
(

141 
Ãw
 
Equ®Ex³ù©iÚ
(
$fœ¡
),

142 
$£cÚd
,

143 
$mes§ge
);

155 
funùiÚ
 
as£¹NÙEqu®
(
$fœ¡
, 
$£cÚd
, 
$mes§ge
 = '%s') {

156  
$this
->
as£¹
(

157 
Ãw
 
NÙEqu®Ex³ù©iÚ
(
$fœ¡
),

158 
$£cÚd
,

159 
$mes§ge
);

172 
funùiÚ
 
as£¹W™hšM¬gš
(
$fœ¡
, 
$£cÚd
, 
$m¬gš
, 
$mes§ge
 = '%s') {

173  
$this
->
as£¹
(

174 
Ãw
 
W™hšM¬gšEx³ù©iÚ
(
$fœ¡
, 
$m¬gš
),

175 
$£cÚd
,

176 
$mes§ge
);

189 
funùiÚ
 
as£¹OutsideM¬gš
(
$fœ¡
, 
$£cÚd
, 
$m¬gš
, 
$mes§ge
 = '%s') {

190  
$this
->
as£¹
(

191 
Ãw
 
OutsideM¬gšEx³ù©iÚ
(
$fœ¡
, 
$m¬gš
),

192 
$£cÚd
,

193 
$mes§ge
);

205 
funùiÚ
 
as£¹Id’tiÿl
(
$fœ¡
, 
$£cÚd
, 
$mes§ge
 = '%s') {

206  
$this
->
as£¹
(

207 
Ãw
 
Id’tiÿlEx³ù©iÚ
(
$fœ¡
),

208 
$£cÚd
,

209 
$mes§ge
);

221 
funùiÚ
 
as£¹NÙId’tiÿl
(
$fœ¡
, 
$£cÚd
, 
$mes§ge
 = '%s') {

222  
$this
->
as£¹
(

223 
Ãw
 
NÙId’tiÿlEx³ù©iÚ
(
$fœ¡
),

224 
$£cÚd
,

225 
$mes§ge
);

240 
funùiÚ
 
as£¹Reã»nû
(&
$fœ¡
, &
$£cÚd
, 
$mes§ge
 = '%s') {

241 
$dum³r
 = 
Ãw
 
Sim¶eDum³r
();

242 
	g$mes§ge
 = 
¥rštf
(

243 
$mes§ge
,

244 '[' . 
$dum³r
->
desüibeV®ue
(
$fœ¡
) .

245 ']‡nd [' . 
$dum³r
->
desüibeV®ue
(
$£cÚd
) .

247  
	g$this
->
as£¹True
(

248 
Sim¶eTe¡Com·tib™y
::
isReã»nû
(
$fœ¡
, 
$£cÚd
),

249 
$mes§ge
);

265 
funùiÚ
 
as£¹Same
(
$fœ¡
, 
$£cÚd
, 
$mes§ge
 = '%s') {

266 
$dum³r
 = 
Ãw
 
Sim¶eDum³r
();

267 
	g$mes§ge
 = 
¥rštf
(

268 
$mes§ge
,

269 '[' . 
$dum³r
->
desüibeV®ue
(
$fœ¡
) .

270 ']‡nd [' . 
$dum³r
->
desüibeV®ue
(
$£cÚd
) .

272  
	g$this
->
as£¹True
(
$fœ¡
 ==ğ
$£cÚd
, 
$mes§ge
);

285 
funùiÚ
 
as£¹ClÚe
(
$fœ¡
, 
$£cÚd
, 
$mes§ge
 = '%s') {

286 
$dum³r
 = 
Ãw
 
Sim¶eDum³r
();

287 
	g$mes§ge
 = 
¥rštf
(

288 
$mes§ge
,

289 '[' . 
$dum³r
->
desüibeV®ue
(
$fœ¡
) .

290 ']‡nd [' . 
$dum³r
->
desüibeV®ue
(
$£cÚd
) .

292 
	g$id’tiÿl
 = 
Ãw
 
Id’tiÿlEx³ù©iÚ
(
$fœ¡
);

293  
	g$this
->
as£¹True
(

294 
$id’tiÿl
->
‹¡
(
$£cÚd
è&& ! (
$fœ¡
 === $second),

295 
$mes§ge
);

310 
funùiÚ
 
as£¹Cİy
(&
$fœ¡
, &
$£cÚd
, 
$mes§ge
 = "%s") {

311 
$dum³r
 = 
Ãw
 
Sim¶eDum³r
();

312 
	g$mes§ge
 = 
¥rštf
(

313 
$mes§ge
,

314 "[" . 
$dum³r
->
desüibeV®ue
(
$fœ¡
) .

315 "]‡nd [" . 
$dum³r
->
desüibeV®ue
(
$£cÚd
) .

317  
	g$this
->
as£¹F®£
(

318 
Sim¶eTe¡Com·tib™y
::
isReã»nû
(
$fœ¡
, 
$£cÚd
),

319 
$mes§ge
);

332 
funùiÚ
 
as£¹P©‹º
(
$·‰”n
, 
$subjeù
, 
$mes§ge
 = '%s') {

333  
$this
->
as£¹
(

334 
Ãw
 
P©‹ºEx³ù©iÚ
(
$·‰”n
),

335 
$subjeù
,

336 
$mes§ge
);

349 
funùiÚ
 
as£¹NoP©‹º
(
$·‰”n
, 
$subjeù
, 
$mes§ge
 = '%s') {

350  
$this
->
as£¹
(

351 
Ãw
 
NoP©‹ºEx³ù©iÚ
(
$·‰”n
),

352 
$subjeù
,

353 
$mes§ge
);

364 
funùiÚ
 
ex³ùE¼Ü
(
$ex³ùed
 = 
çl£
, 
$mes§ge
 = '%s') {

365 
$queue
 = 
Sim¶eTe¡
::
g‘CÚ‹xt
()->
g‘
('SimpleErrorQueue');

366 
	g$queue
->
ex³ùE¼Ü
(
$this
->
cÛrûEx³ù©iÚ
(
$ex³ùed
), 
$mes§ge
);

377 
funùiÚ
 
ex³ùExû±iÚ
(
$ex³ùed
 = 
çl£
, 
$mes§ge
 = '%s') {

378 
$queue
 = 
Sim¶eTe¡
::
g‘CÚ‹xt
()->
g‘
('SimpleExceptionTrap');

379 
	g$lše
 = 
$this
->
g‘As£¹iÚLše
();

380 
	g$queue
->
ex³ùExû±iÚ
(
$ex³ùed
, 
$mes§ge
 . 
$lše
);

390 
funùiÚ
 
	$ignÜeExû±iÚ
(
$ignÜed
 = 
çl£
) {

391 
Sim¶eTe¡
::
	`g‘CÚ‹xt
()->
	`g‘
('Sim¶eExû±iÚT¿p')->
	`ignÜeExû±iÚ
(
$ignÜed
);

392 
	}
}

402 
´Ùeùed
 
funùiÚ
 
	$cÛrûEx³ù©iÚ
(
$ex³ùed
) {

403 ià(
$ex³ùed
 =ğ
çl£
) {

404  
Ãw
 
	`TrueEx³ù©iÚ
();

406 ià(
Sim¶eTe¡Com·tib™y
::
	`isA
(
$ex³ùed
, 'SimpleExpectation')) {

407  
$ex³ùed
;

409  
Ãw
 
	`Equ®Ex³ù©iÚ
(

410 
	`is_¡ršg
(
$ex³ùed
è? 
	`¡r_»¶aû
('%', '%%', $expected) : $expected);

411 
	}
}

	@F:\Site\stew\1\_lp\simpletest\url.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/encoding.php');

25 şas 
	cSim¶eU¾
 {

26 
´iv©e
 
	m$scheme
;

27 
´iv©e
 
	m$u£ºame
;

28 
´iv©e
 
	m$·sswÜd
;

29 
´iv©e
 
	m$ho¡
;

30 
´iv©e
 
	m$pÜt
;

31 
public
 
	m$·th
;

32 
´iv©e
 
	m$»que¡
;

33 
´iv©e
 
	m$äagm’t
;

34 
´iv©e
 
	m$x
;

35 
´iv©e
 
	m$y
;

36 
´iv©e
 
	m$rg‘
;

37 
´iv©e
 
	m$¿w
 = 
çl£
;

44 
funùiÚ
 
__cÚ¡ruù
(
$u¾
 = '') {

45 
li¡
(
$x
, 
$y
èğ
$this
->
chompCoÜdš©es
(
$u¾
);

46 
	m$this
->
£tCoÜdš©es
(
$x
, 
$y
);

47 
	m$this
->
	mscheme
 = 
$this
->
chompScheme
(
$u¾
);

48 ià(
	m$this
->
	mscheme
 === 'file') {

54 
$u¾
 = 
¡r_»¶aû
('\\', '/', $url);

56 
li¡
(
$this
->
u£ºame
, $this->
·sswÜd
èğ$this->
chompLogš
(
$u¾
);

57 
	m$this
->
	mho¡
 = 
$this
->
chompHo¡
(
$u¾
);

58 
	m$this
->
	mpÜt
 = 
çl£
;

59 ià(
´eg_m©ch
('/(.*?):(.*)/', 
$this
->
ho¡
, 
$ho¡_·¹s
)) {

60 ià(
	m$this
->
	mscheme
 ==ğ'fe' && 
¡¾’
(
$this
->
ho¡
) === 2) {

62 
$u¾
 = '/' . 
$this
->
ho¡
 . $url;

63 
	m$this
->
	mho¡
 = 
çl£
;

65 
	m$this
->
	mho¡
 = 
$ho¡_·¹s
[1];

66 
	m$this
->
	mpÜt
 = (
š‹g”
)
$ho¡_·¹s
[2];

69 
	m$this
->
	m·th
 = 
$this
->
chompP©h
(
$u¾
);

70 
	m$this
->
	m»que¡
 = 
$this
->
·r£Reque¡
($this->
chompReque¡
(
$u¾
));

71 
	m$this
->
	mäagm’t
 = (
¡ºcmp
(
$u¾
, "#", 1è=ğ0 ? 
sub¡r
($u¾, 1è: 
çl£
);

72 
	m$this
->
	mrg‘
 = 
çl£
;

82 
´Ùeùed
 
funùiÚ
 
	$chompCoÜdš©es
(&
$u¾
) {

83 ià(
	`´eg_m©ch
('/(.*)\?(\d+),(\d+)$/', 
$u¾
, 
$m©ches
)) {

84 
$u¾
 = 
$m©ches
[1];

85  
	`¬¿y
((
š‹g”
)
$m©ches
[2], (integer)$matches[3]);

87  
	`¬¿y
(
çl£
, false);

88 
	}
}

97 
´Ùeùed
 
funùiÚ
 
	$chompScheme
(&
$u¾
) {

98 ià(
	`´eg_m©ch
('#^([^/:]*):(//)(.*)#', 
$u¾
, 
$m©ches
)) {

99 
$u¾
 = 
$m©ches
[2] . $matches[3];

100  
$m©ches
[1];

102  
çl£
;

103 
	}
}

115 
´Ùeùed
 
funùiÚ
 
	$chompLogš
(&
$u¾
) {

116 
$´efix
 = '';

117 ià(
	`´eg_m©ch
('#^(//)(.*)#', 
$u¾
, 
$m©ches
)) {

118 
$´efix
 = 
$m©ches
[1];

119 
$u¾
 = 
$m©ches
[2];

121 ià(
	`´eg_m©ch
('#^([^/]*)@(.*)#', 
$u¾
, 
$m©ches
)) {

122 
$u¾
 = 
$´efix
 . 
$m©ches
[2];

123 
$·¹s
 = 
	`ex¶ode
(":", 
$m©ches
[1]);

124  
	`¬¿y
(

125 
	`u¾decode
(
$·¹s
[0]),

126 
	`is£t
(
$·¹s
[1]è? 
	`u¾decode
($·¹s[1]è: 
çl£
);

128 
$u¾
 = 
$´efix
 . $url;

129  
	`¬¿y
(
çl£
, false);

130 
	}
}

143 
´Ùeùed
 
funùiÚ
 
	$chompHo¡
(&
$u¾
) {

144 ià(
	`´eg_m©ch
('!^(//)(.*?)(/.*|\?.*|#.*|$)!', 
$u¾
, 
$m©ches
)) {

145 
$u¾
 = 
$m©ches
[3];

146  
$m©ches
[2];

148 ià(
	`´eg_m©ch
('!(.*?)(\.\./|\./|/|\?|#|$)(.*)!', 
$u¾
, 
$m©ches
)) {

149 
$ds
 = 
Sim¶eU¾
::
	`g‘AÎTİLev–Domašs
();

150 ià(
	`´eg_m©ch
('/[a-z0-9\-]+\.(' . 
$ds
 . ')/i', 
$m©ches
[1])) {

151 
$u¾
 = 
$m©ches
[2] . $matches[3];

152  
$m©ches
[1];

153 } 
	`–£if
 (
	`´eg_m©ch
('/[a-z0-9\-]+\.[a-z0-9\-]+\.[a-z0-9\-]+/i', 
$m©ches
[1])) {

154 
$u¾
 = 
$m©ches
[2] . $matches[3];

155  
$m©ches
[1];

158  
çl£
;

159 
	}
}

169 
´Ùeùed
 
funùiÚ
 
	$chompP©h
(&
$u¾
) {

170 ià(
	`´eg_m©ch
('/(.*?)(\?|#|$)(.*)/', 
$u¾
, 
$m©ches
)) {

171 
$u¾
 = 
$m©ches
[2] . $matches[3];

172  (
$m©ches
[1] ? $matches[1] : '');

175 
	}
}

184 
´Ùeùed
 
funùiÚ
 
	$chompReque¡
(&
$u¾
) {

185 ià(
	`´eg_m©ch
('/\?(.*?)(#|$)(.*)/', 
$u¾
, 
$m©ches
)) {

186 
$u¾
 = 
$m©ches
[2] . $matches[3];

187  
$m©ches
[1];

190 
	}
}

198 
´Ùeùed
 
funùiÚ
 
	$·r£Reque¡
(
$¿w
) {

199 
$this
->
¿w
 = 
$¿w
;

200 
$»que¡
 = 
Ãw
 
	`Sim¶eG‘Encodšg
();

201 
	`fÜ—ch
 (
	`ex¶ode
("&", 
$¿w
è
as
 
$·œ
) {

202 ià(
	`´eg_m©ch
('/(.*?)=(.*)/', 
$·œ
, 
$m©ches
)) {

203 
$»que¡
->
	`add
(
	`u¾decode
(
$m©ches
[1]), urldecode($matches[2]));

204 } 
	`–£if
 (
$·œ
) {

205 
$»que¡
->
	`add
(
	`u¾decode
(
$·œ
), '');

208  
$»que¡
;

209 
	}
}

217 
funùiÚ
 
	$g‘Scheme
(
$deçuÉ
 = 
çl£
) {

218  
$this
->
scheme
 ? $this->schem: 
$deçuÉ
;

219 
	}
}

226 
funùiÚ
 
	$g‘U£ºame
() {

227  
$this
->
u£ºame
;

228 
	}
}

235 
funùiÚ
 
	$g‘PasswÜd
() {

236  
$this
->
·sswÜd
;

237 
	}
}

245 
funùiÚ
 
	$g‘Ho¡
(
$deçuÉ
 = 
çl£
) {

246  
$this
->
ho¡
 ? $this->ho¡ : 
$deçuÉ
;

247 
	}
}

254 
funùiÚ
 
	$g‘Tld
() {

255 
$·th_·¹s
 = 
	`·thšfo
(
$this
->
	`g‘Ho¡
());

256  (
	`is£t
(
$·th_·¹s
['ex‹nsiÚ']è? $·th_·¹s['ex‹nsiÚ'] : 
çl£
);

257 
	}
}

264 
funùiÚ
 
	$g‘PÜt
() {

265  
$this
->
pÜt
;

266 
	}
}

273 
funùiÚ
 
	$g‘P©h
() {

274 ià(! 
$this
->
·th
 && $this->
ho¡
) {

277  
$this
->
·th
;

278 
	}
}

286 
funùiÚ
 
	$g‘Page
() {

287 ià(! 
	`´eg_m©ch
('/([^\/]*?)$/', 
$this
->
	`g‘P©h
(), 
$m©ches
)) {

288  
çl£
;

290  
$m©ches
[1];

291 
	}
}

298 
funùiÚ
 
	$g‘Ba£P©h
() {

299 ià(! 
	`´eg_m©ch
('/(.*\/)[^\/]*?$/', 
$this
->
	`g‘P©h
(), 
$m©ches
)) {

300  
çl£
;

302  
$m©ches
[1];

303 
	}
}

310 
funùiÚ
 
	$g‘F¿gm’t
() {

311  
$this
->
äagm’t
;

312 
	}
}

321 
funùiÚ
 
	$£tCoÜdš©es
(
$x
 = 
çl£
, 
$y
 = false) {

322 ià((
$x
 ==ğ
çl£
è|| (
$y
 === false)) {

323 
$this
->
x
 = $this->
y
 = 
çl£
;

326 
$this
->
x
 = (
š‹g”
)
$x
;

327 
$this
->
y
 = (
š‹g”
)
$y
;

328 
	}
}

335 
funùiÚ
 
	$g‘X
() {

336  
$this
->
x
;

337 
	}
}

344 
funùiÚ
 
	$g‘Y
() {

345  
$this
->
y
;

346 
	}
}

356 
funùiÚ
 
	$g‘EncodedReque¡
() {

357 ià(
$this
->
¿w
) {

358 
$’coded
 = 
$this
->
¿w
;

360 
$’coded
 = 
$this
->
»que¡
->
	`asU¾Reque¡
();

362 ià(
$’coded
) {

363  '?' . 
	`´eg_»¶aû
('/^\?/', '', 
$’coded
);

366 
	}
}

374 
funùiÚ
 
	$addReque¡P¬am‘”
(
$key
, 
$v®ue
) {

375 
$this
->
¿w
 = 
çl£
;

376 
$this
->
»que¡
->
	`add
(
$key
, 
$v®ue
);

377 
	}
}

385 
funùiÚ
 
	$addReque¡P¬am‘”s
(
$·¿m‘”s
) {

386 
$this
->
¿w
 = 
çl£
;

387 
$this
->
»que¡
->
	`m”ge
(
$·¿m‘”s
);

388 
	}
}

394 
funùiÚ
 
	$ş—rReque¡
() {

395 
$this
->
¿w
 = 
çl£
;

396 
$this
->
»que¡
 = 
Ãw
 
	`Sim¶eG‘Encodšg
();

397 
	}
}

406 
funùiÚ
 
	$g‘T¬g‘
() {

407  
$this
->
rg‘
;

408 
	}
}

415 
funùiÚ
 
	$£tT¬g‘
(
$äame
) {

416 
$this
->
¿w
 = 
çl£
;

417 
$this
->
rg‘
 = 
$äame
;

418 
	}
}

425 
funùiÚ
 
	$asSŒšg
() {

426 
$·th
 = 
$this
->
·th
;

427 
$scheme
 = 
$id’t™y
 = 
$ho¡
 = 
$pÜt
 = 
$’coded
 = 
$äagm’t
 = '';

428 ià(
$this
->
u£ºame
 && $this->
·sswÜd
) {

429 
$id’t™y
 = 
$this
->
u£ºame
 . ':' . $this->
·sswÜd
 . '@';

431 ià(
$this
->
	`g‘Ho¡
()) {

432 
$scheme
 = 
$this
->
	`g‘Scheme
() ? $this->getScheme() : 'http';

433 
$scheme
 .= '://';

434 
$ho¡
 = 
$this
->
	`g‘Ho¡
();

435 } 
	`–£if
 (
$this
->
	`g‘Scheme
() === 'file') {

439 
$scheme
 = 'file://';

441 ià(
$this
->
	`g‘PÜt
() && $this->getPort() != 80 ) {

442 
$pÜt
 = ':'.
$this
->
	`g‘PÜt
();

445 ià(
	`sub¡r
(
$this
->
·th
, 0, 1) == '/') {

446 
$·th
 = 
$this
->
	`nÜm®i£P©h
($this->
·th
);

448 
$’coded
 = 
$this
->
	`g‘EncodedReque¡
();

449 
$äagm’t
 = 
$this
->
	`g‘F¿gm’t
() ? '#'. $this->getFragment() : '';

450 
$coÜds
 = 
$this
->
	`g‘X
(è==ğ
çl£
 ? '' : '?' . $this->g‘X(è. ',' . $this->
	`g‘Y
();

452 
	}
}

461 
funùiÚ
 
	$makeAbsŞu‹
(
$ba£
) {

462 ià(! 
	`is_objeù
(
$ba£
)) {

463 
$ba£
 = 
Ãw
 
	`Sim¶eU¾
($base);

465 ià(
$this
->
	`g‘Ho¡
()) {

466 
$scheme
 = 
$this
->
	`g‘Scheme
();

467 
$ho¡
 = 
$this
->
	`g‘Ho¡
();

468 
$pÜt
 = 
$this
->
	`g‘PÜt
() ? ':' . $this->getPort() : '';

469 
$id’t™y
 = 
$this
->
	`g‘Id’t™y
() ? $this->getIdentity() . '@' : '';

470 ià(! 
$id’t™y
) {

471 
$id’t™y
 = 
$ba£
->
	`g‘Id’t™y
() ? $base->getIdentity() . '@' : '';

474 
$scheme
 = 
$ba£
->
	`g‘Scheme
();

475 
$ho¡
 = 
$ba£
->
	`g‘Ho¡
();

476 
$pÜt
 = 
$ba£
->
	`g‘PÜt
() ? ':' . $base->getPort() : '';

477 
$id’t™y
 = 
$ba£
->
	`g‘Id’t™y
() ? $base->getIdentity() . '@' : '';

479 
$·th
 = 
$this
->
	`nÜm®i£P©h
($this->
	`exŒaùAbsŞu‹P©h
(
$ba£
));

480 
$’coded
 = 
$this
->
	`g‘EncodedReque¡
();

481 
$äagm’t
 = 
$this
->
	`g‘F¿gm’t
() ? '#'. $this->getFragment() : '';

482 
$coÜds
 = 
$this
->
	`g‘X
(è==ğ
çl£
 ? '' : '?' . $this->g‘X(è. ',' . $this->
	`g‘Y
();

483  
Ãw
 
	`Sim¶eU¾
("$scheme://$identity$host$port$path$encoded$fragment$coords");

484 
	}
}

493 
´Ùeùed
 
funùiÚ
 
	$exŒaùAbsŞu‹P©h
(
$ba£
) {

494 ià(
$this
->
	`g‘Ho¡
()) {

495  
$this
->
·th
;

497 ià(! 
$this
->
	`isR–©iveP©h
($this->
·th
)) {

498  
$this
->
·th
;

500 ià(
$this
->
·th
) {

501  
$ba£
->
	`g‘Ba£P©h
(è. 
$this
->
·th
;

503  
$ba£
->
	`g‘P©h
();

504 
	}
}

512 
´Ùeùed
 
funùiÚ
 
	$isR–©iveP©h
(
$·th
) {

513  (
	`sub¡r
(
$·th
, 0, 1) != '/');

514 
	}
}

522 
funùiÚ
 
	$g‘Id’t™y
() {

523 ià(
$this
->
u£ºame
 && $this->
·sswÜd
) {

524  
$this
->
u£ºame
 . ':' . $this->
·sswÜd
;

526  
çl£
;

527 
	}
}

535 
funùiÚ
 
	$nÜm®i£P©h
(
$·th
) {

536 
$·th
 = 
	`´eg_»¶aû
('|/\./|', '/', $path);

537  
	`´eg_»¶aû
('|/[^/]+/\.\./|', '/', 
$·th
);

538 
	}
}

546 
funùiÚ
 
	$g‘AÎTİLev–Domašs
() {

548 
	}
}

	@F:\Site\stew\1\_lp\simpletest\user_agent.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/cookies.php');

13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/http.php');

14 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/encoding.php');

15 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/authentication.php');

18 ià(! 
defšed
('DEFAULT_MAX_REDIRECTS')) {

19 
defše
('DEFAULT_MAX_REDIRECTS', 3);

21 ià(! 
defšed
('DEFAULT_CONNECTION_TIMEOUT')) {

22 
defše
('DEFAULT_CONNECTION_TIMEOUT', 15);

31 şas 
	cSim¶eU£rAg’t
 {

32 
´iv©e
 
	m$cook›_j¬
;

33 
´iv©e
 
	m$cook›s_’abËd
 = 
Œue
;

34 
´iv©e
 
	m$auth’tiÿtÜ
;

35 
´iv©e
 
	m$max_»dœeùs
 = 
DEFAULT_MAX_REDIRECTS
;

36 
´iv©e
 
	m$´oxy
 = 
çl£
;

37 
´iv©e
 
	m$´oxy_u£ºame
 = 
çl£
;

38 
´iv©e
 
	m$´oxy_·sswÜd
 = 
çl£
;

39 
´iv©e
 
	m$cÚÃùiÚ_timeout
 = 
DEFAULT_CONNECTION_TIMEOUT
;

40 
´iv©e
 
	m$add™iÚ®_h—d”s
 = 
¬¿y
();

46 
funùiÚ
 
	$__cÚ¡ruù
() {

47 
$this
->
cook›_j¬
 = 
Ãw
 
	`Sim¶eCook›J¬
();

48 
$this
->
auth’tiÿtÜ
 = 
Ãw
 
	`Sim¶eAuth’tiÿtÜ
();

60 
funùiÚ
 
	$»¡¬t
(
$d©e
 = 
çl£
) {

61 
$this
->
cook›_j¬
->
	`»¡¬tSessiÚ
(
$d©e
);

62 
$this
->
auth’tiÿtÜ
->
	`»¡¬tSessiÚ
();

63 
	}
}

71 
funùiÚ
 
	$addH—d”
(
$h—d”
) {

72 
$this
->
add™iÚ®_h—d”s
[] = 
$h—d”
;

73 
	}
}

80 
funùiÚ
 
	$ageCook›s
(
$š‹rv®
) {

81 
$this
->
cook›_j¬
->
	`ageP»m©u»ly
(
$š‹rv®
);

82 
	}
}

94 
funùiÚ
 
£tCook›
(
$Çme
, 
$v®ue
, 
$ho¡
 = 
çl£
, 
$·th
 = '/', 
$expœy
 = false) {

95 
$this
->
cook›_j¬
->
£tCook›
(
$Çme
, 
$v®ue
, 
$ho¡
, 
$·th
, 
$expœy
);

108 
funùiÚ
 
	$g‘Cook›V®ue
(
$ho¡
, 
$·th
, 
$Çme
) {

109  
$this
->
cook›_j¬
->
	`g‘Cook›V®ue
(
$ho¡
, 
$·th
, 
$Çme
);

110 
	}
}

120 
funùiÚ
 
	$g‘Ba£Cook›V®ue
(
$Çme
, 
$ba£
) {

121 ià(! 
$ba£
) {

122  
nuÎ
;

124  
$this
->
	`g‘Cook›V®ue
(
$ba£
->
	`g‘Ho¡
(), $ba£->
	`g‘P©h
(), 
$Çme
);

125 
	}
}

131 
funùiÚ
 
	$ignÜeCook›s
() {

132 
$this
->
cook›s_’abËd
 = 
çl£
;

133 
	}
}

139 
funùiÚ
 
	$u£Cook›s
() {

140 
$this
->
cook›s_’abËd
 = 
Œue
;

141 
	}
}

148 
funùiÚ
 
	$£tCÚÃùiÚTimeout
(
$timeout
) {

149 
$this
->
cÚÃùiÚ_timeout
 = 
$timeout
;

150 
	}
}

158 
funùiÚ
 
	$£tMaximumRedœeùs
(
$max
) {

159 
$this
->
max_»dœeùs
 = 
$max
;

160 
	}
}

171 
funùiÚ
 
	$u£Proxy
(
$´oxy
, 
$u£ºame
, 
$·sswÜd
) {

172 ià(! 
$´oxy
) {

173 
$this
->
´oxy
 = 
çl£
;

176 ià((
	`¡ºcmp
(
$´oxy
, 'http://', 7) != 0) && (strncmp($proxy, 'https://', 8) != 0)) {

177 
$´oxy
 = 'http://'. $proxy;

179 
$this
->
´oxy
 = 
Ãw
 
	`Sim¶eU¾
(
$´oxy
);

180 
$this
->
´oxy_u£ºame
 = 
$u£ºame
;

181 
$this
->
´oxy_·sswÜd
 = 
$·sswÜd
;

182 
	}
}

190 
´Ùeùed
 
funùiÚ
 
	$isTooMªyRedœeùs
(
$»dœeùs
) {

191  (
$»dœeùs
 > 
$this
->
max_»dœeùs
);

192 
	}
}

202 
funùiÚ
 
	$£tId’t™y
(
$ho¡
, 
$»®m
, 
$u£ºame
, 
$·sswÜd
) {

203 
$this
->
auth’tiÿtÜ
->
	`£tId’t™yFÜR—lm
(
$ho¡
, 
$»®m
, 
$u£ºame
, 
$·sswÜd
);

204 
	}
}

214 
funùiÚ
 
	$ãtchRe¥Ú£
(
$u¾
, 
$’codšg
) {

215 ià(
$’codšg
->
	`g‘M‘hod
() != 'POST') {

216 
$u¾
->
	`addReque¡P¬am‘”s
(
$’codšg
);

217 
$’codšg
->
	`ş—r
();

219 
$»¥Ú£
 = 
$this
->
	`ãtchWheRedœeùed
(
$u¾
, 
$’codšg
);

220 ià(
$h—d”s
 = 
$»¥Ú£
->
	`g‘H—d”s
()) {

221 ià(
$h—d”s
->
	`isCh®Ënge
()) {

222 
$this
->
auth’tiÿtÜ
->
	`addR—lm
(

223 
$u¾
,

224 
$h—d”s
->
	`g‘Auth’tiÿtiÚ
(),

225 
$h—d”s
->
	`g‘R—lm
());

228  
$»¥Ú£
;

229 
	}
}

239 
´Ùeùed
 
funùiÚ
 
	$ãtchWheRedœeùed
(
$u¾
, 
$’codšg
) {

240 
$»dœeùs
 = 0;

242 
$»¥Ú£
 = 
$this
->
	`ãtch
(
$u¾
, 
$’codšg
);

243 ià(
$»¥Ú£
->
	`isE¼Ü
()) {

244  
$»¥Ú£
;

246 
$h—d”s
 = 
$»¥Ú£
->
	`g‘H—d”s
();

247 ià(
$this
->
cook›s_’abËd
) {

248 
$h—d”s
->
	`wr™eCook›sToJ¬
(
$this
->
cook›_j¬
, 
$u¾
);

250 ià(! 
$h—d”s
->
	`isRedœeù
()) {

253 
$loÿtiÚ
 = 
Ãw
 
	`Sim¶eU¾
(
$h—d”s
->
	`g‘LoÿtiÚ
());

254 
$u¾
 = 
$loÿtiÚ
->
	`makeAbsŞu‹
($url);

255 
$’codšg
 = 
Ãw
 
	`Sim¶eG‘Encodšg
();

256 } ! 
$this
->
	`isTooMªyRedœeùs
(++
$»dœeùs
));

257  
$»¥Ú£
;

258 
	}
}

267 
´Ùeùed
 
funùiÚ
 
	$ãtch
(
$u¾
, 
$’codšg
) {

268 
$»que¡
 = 
$this
->
	`ü—‹Reque¡
(
$u¾
, 
$’codšg
);

269  
$»que¡
->
	`ãtch
(
$this
->
cÚÃùiÚ_timeout
);

270 
	}
}

279 
´Ùeùed
 
funùiÚ
 
	$ü—‹Reque¡
(
$u¾
, 
$’codšg
) {

280 
$»que¡
 = 
$this
->
	`ü—‹H‰pReque¡
(
$u¾
, 
$’codšg
);

281 
$this
->
	`addAdd™iÚ®H—d”s
(
$»que¡
);

282 ià(
$this
->
cook›s_’abËd
) {

283 
$»que¡
->
	`»adCook›sFromJ¬
(
$this
->
cook›_j¬
, 
$u¾
);

285 
$this
->
auth’tiÿtÜ
->
	`addH—d”s
(
$»que¡
, 
$u¾
);

286  
$»que¡
;

287 
	}
}

296 
´Ùeùed
 
funùiÚ
 
	$ü—‹H‰pReque¡
(
$u¾
, 
$’codšg
) {

297  
Ãw
 
	`Sim¶eH‰pReque¡
(
$this
->
	`ü—‹Rou‹
(
$u¾
), 
$’codšg
);

298 
	}
}

306 
´Ùeùed
 
funùiÚ
 
	$ü—‹Rou‹
(
$u¾
) {

307 ià(
$this
->
´oxy
) {

308  
Ãw
 
	`Sim¶eProxyRou‹
(

309 
$u¾
,

310 
$this
->
´oxy
,

311 
$this
->
´oxy_u£ºame
,

312 
$this
->
´oxy_·sswÜd
);

314  
Ãw
 
	`Sim¶eRou‹
(
$u¾
);

315 
	}
}

322 
´Ùeùed
 
funùiÚ
 
	$addAdd™iÚ®H—d”s
(&
$»que¡
) {

323 
	`fÜ—ch
 (
$this
->
add™iÚ®_h—d”s
 
as
 
$h—d”
) {

324 
$»que¡
->
	`addH—d”Lše
(
$h—d”
);

326 
	}
}

	@F:\Site\stew\1\_lp\simpletest\web_tester.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/test_case.php');

13 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/browser.php');

14 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/page.php');

15 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/expectation.php');

23 şas 
	cF›ldEx³ù©iÚ
 
ex‹nds
 
	mSim¶eEx³ù©iÚ
 {

24 
´iv©e
 
	m$v®ue
;

34 
funùiÚ
 
__cÚ¡ruù
(
$v®ue
, 
$mes§ge
 = '%s') {

35 
·»Á
::
__cÚ¡ruù
(
$mes§ge
);

36 ià(
is_¬¿y
(
$v®ue
)) {

37 
sÜt
(
$v®ue
);

39 
	m$this
->
	mv®ue
 = 
$v®ue
;

50 
funùiÚ
 
	$‹¡
(
$com·»
) {

51 ià(
$this
->
v®ue
 ==ğ
çl£
) {

52  (
$com·»
 ==ğ
çl£
);

54 ià(
$this
->
	`isSšgË
($this->
v®ue
)) {

55  
$this
->
	`‹¡SšgË
(
$com·»
);

57 ià(
	`is_¬¿y
(
$this
->
v®ue
)) {

58  
$this
->
	`‹¡MuÉË
(
$com·»
);

60  
çl£
;

61 
	}
}

69 
´Ùeùed
 
funùiÚ
 
	$isSšgË
(
$v®ue
) {

70  
	`is_¡ršg
(
$v®ue
è|| 
	`is_š‹g”
($v®ueè|| 
	`is_æßt
($value);

71 
	}
}

79 
´Ùeùed
 
funùiÚ
 
	$‹¡SšgË
(
$com·»
) {

80 ià(
	`is_¬¿y
(
$com·»
è&& 
	`couÁ
($compare) == 1) {

81 
$com·»
 = $compare[0];

83 ià(! 
$this
->
	`isSšgË
(
$com·»
)) {

84  
çl£
;

86  (
$this
->
v®ue
 =ğ
$com·»
);

87 
	}
}

95 
´Ùeùed
 
funùiÚ
 
	$‹¡MuÉË
(
$com·»
) {

96 ià(
	`is_¡ršg
(
$com·»
)) {

97 
$com·»
 = 
	`¬¿y
($compare);

99 ià(! 
	`is_¬¿y
(
$com·»
)) {

100  
çl£
;

102 
	`sÜt
(
$com·»
);

103  (
$this
->
v®ue
 ==ğ
$com·»
);

104 
	}
}

113 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

114 
$dum³r
 = 
$this
->
	`g‘Dum³r
();

115 ià(
	`is_¬¿y
(
$com·»
)) {

116 
	`sÜt
(
$com·»
);

118 ià(
$this
->
	`‹¡
(
$com·»
)) {

119  "F›ldƒx³ù©iÚ [" . 
$dum³r
->
	`desüibeV®ue
(
$this
->
v®ue
) . "]";

121  "F›ldƒx³ù©iÚ [" . 
$dum³r
->
	`desüibeV®ue
(
$this
->
v®ue
) .

123 
$dum³r
->
	`desüibeV®ue
(
$com·»
) . "] " .

124 
$dum³r
->
	`desüibeDifã»nû
(
$this
->
v®ue
, 
$com·»
);

126 
	}
}

134 şas 
	cH‰pH—d”Ex³ù©iÚ
 
ex‹nds
 
	mSim¶eEx³ù©iÚ
 {

135 
´iv©e
 
	m$ex³ùed_h—d”
;

136 
´iv©e
 
	m$ex³ùed_v®ue
;

148 
funùiÚ
 
__cÚ¡ruù
(
$h—d”
, 
$v®ue
 = 
çl£
, 
$mes§ge
 = '%s') {

149 
·»Á
::
__cÚ¡ruù
(
$mes§ge
);

150 
	m$this
->
	mex³ùed_h—d”
 = 
$this
->
nÜm®i£H—d”
(
$h—d”
);

151 
	m$this
->
	mex³ùed_v®ue
 = 
$v®ue
;

159 
´Ùeùed
 
funùiÚ
 
	$g‘Ex³ù©iÚ
() {

160  
$this
->
ex³ùed_v®ue
;

161 
	}
}

170 
´Ùeùed
 
funùiÚ
 
	$nÜm®i£H—d”
(
$h—d”
) {

171  
	`¡¹Şow”
(
	`Œim
(
$h—d”
));

172 
	}
}

181 
funùiÚ
 
	$‹¡
(
$com·»
) {

182  
	`is_¡ršg
(
$this
->
	`fšdH—d”
(
$com·»
));

183 
	}
}

192 
´Ùeùed
 
funùiÚ
 
	$fšdH—d”
(
$com·»
) {

193 
$lšes
 = 
	`ex¶ode
("\r\n", 
$com·»
);

194 
	`fÜ—ch
 (
$lšes
 
as
 
$lše
) {

195 ià(
$this
->
	`‹¡H—d”Lše
(
$lše
)) {

196  
$lše
;

199  
çl£
;

200 
	}
}

208 
´Ùeùed
 
funùiÚ
 
	$‹¡H—d”Lše
(
$lše
) {

209 ià(
	`couÁ
(
$·r£d
 = 
	`ex¶ode
(':', 
$lše
, 2)) < 2) {

210  
çl£
;

212 
	`li¡
(
$h—d”
, 
$v®ue
èğ
$·r£d
;

213 ià(
$this
->
	`nÜm®i£H—d”
(
$h—d”
è!ğ$this->
ex³ùed_h—d”
) {

214  
çl£
;

216  
$this
->
	`‹¡H—d”V®ue
(
$v®ue
, $this->
ex³ùed_v®ue
);

217 
	}
}

226 
´Ùeùed
 
funùiÚ
 
	$‹¡H—d”V®ue
(
$v®ue
, 
$ex³ùed
) {

227 ià(
$ex³ùed
 ==ğ
çl£
) {

228  
Œue
;

230 ià(
Sim¶eEx³ù©iÚ
::
	`isEx³ù©iÚ
(
$ex³ùed
)) {

231  
$ex³ùed
->
	`‹¡
(
	`Œim
(
$v®ue
));

233  (
	`Œim
(
$v®ue
è=ğŒim(
$ex³ùed
));

234 
	}
}

243 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

244 ià(
Sim¶eEx³ù©iÚ
::
	`isEx³ù©iÚ
(
$this
->
ex³ùed_v®ue
)) {

245 
$mes§ge
 = 
$this
->
ex³ùed_v®ue
->
	`ov”ÏyMes§ge
(
$com·»
, $this->
	`g‘Dum³r
());

247 
$mes§ge
 = 
$this
->
ex³ùed_h—d”
 .

248 (
$this
->
ex³ùed_v®ue
 ? ': ' . $this->expected_value : '');

250 ià(
	`is_¡ršg
(
$lše
 = 
$this
->
	`fšdH—d”
(
$com·»
))) {

255 
	}
}

264 şas 
	cNoH‰pH—d”Ex³ù©iÚ
 
ex‹nds
 
	mH‰pH—d”Ex³ù©iÚ
 {

265 
´iv©e
 
	m$ex³ùed_h—d”
;

266 
´iv©e
 
	m$ex³ùed_v®ue
;

274 
funùiÚ
 
__cÚ¡ruù
(
$unwª‹d
, 
$mes§ge
 = '%s') {

275 
·»Á
::
__cÚ¡ruù
(
$unwª‹d
, 
çl£
, 
$mes§ge
);

284 
funùiÚ
 
	$‹¡
(
$com·»
) {

285  (
$this
->
	`fšdH—d”
(
$com·»
è==ğ
çl£
);

286 
	}
}

295 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

296 
$ex³ù©iÚ
 = 
$this
->
	`g‘Ex³ù©iÚ
();

297 ià(
	`is_¡ršg
(
$lše
 = 
$this
->
	`fšdH—d”
(
$com·»
))) {

302 
	}
}

310 şas 
	cTextEx³ù©iÚ
 
ex‹nds
 
	mSim¶eEx³ù©iÚ
 {

311 
´iv©e
 
	m$sub¡ršg
;

319 
funùiÚ
 
__cÚ¡ruù
(
$sub¡ršg
, 
$mes§ge
 = '%s') {

320 
·»Á
::
__cÚ¡ruù
(
$mes§ge
);

321 
	m$this
->
	msub¡ršg
 = 
$sub¡ršg
;

329 
´Ùeùed
 
funùiÚ
 
	$g‘Sub¡ršg
() {

330  
$this
->
sub¡ršg
;

331 
	}
}

340 
funùiÚ
 
	$‹¡
(
$com·»
) {

341  (
	`¡½os
(
$com·»
, 
$this
->
sub¡ršg
è!=ğ
çl£
);

342 
	}
}

351 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

352 ià(
$this
->
	`‹¡
(
$com·»
)) {

353  
$this
->
	`desüibeTextM©ch
($this->
	`g‘Sub¡ršg
(), 
$com·»
);

355 
$dum³r
 = 
$this
->
	`g‘Dum³r
();

356  "Texˆ[" . 
$this
->
	`g‘Sub¡ršg
() .

358 
$dum³r
->
	`desüibeV®ue
(
$com·»
) . "]";

360 
	}
}

369 
´Ùeùed
 
funùiÚ
 
	$desüibeTextM©ch
(
$sub¡ršg
, 
$subjeù
) {

370 
$pos™iÚ
 = 
	`¡½os
(
$subjeù
, 
$sub¡ršg
);

371 
$dum³r
 = 
$this
->
	`g‘Dum³r
();

373 
$dum³r
->
	`desüibeV®ue
(
$subjeù
) . "] in„egion [" .

374 
$dum³r
->
	`şSŒšg
(
$subjeù
, 100, 
$pos™iÚ
) . "]";

375 
	}
}

384 şas 
	cNoTextEx³ù©iÚ
 
ex‹nds
 
	mTextEx³ù©iÚ
 {

392 
funùiÚ
 
__cÚ¡ruù
(
$sub¡ršg
, 
$mes§ge
 = '%s') {

393 
·»Á
::
__cÚ¡ruù
(
$sub¡ršg
, 
$mes§ge
);

403 
funùiÚ
 
	$‹¡
(
$com·»
) {

404  ! 
·»Á
::
	`‹¡
(
$com·»
);

405 
	}
}

414 
funùiÚ
 
	$‹¡Mes§ge
(
$com·»
) {

415 ià(
$this
->
	`‹¡
(
$com·»
)) {

416 
$dum³r
 = 
$this
->
	`g‘Dum³r
();

417  "Texˆ[" . 
$this
->
	`g‘Sub¡ršg
() .

419 
$dum³r
->
	`desüibeV®ue
(
$com·»
) . "]";

421  
$this
->
	`desüibeTextM©ch
($this->
	`g‘Sub¡ršg
(), 
$com·»
);

423 
	}
}

433 şas 
	cWebTe¡Ca£
 
ex‹nds
 
	mSim¶eTe¡Ca£
 {

434 
´iv©e
 
	m$brow£r
;

435 
´iv©e
 
	m$ignÜe_”rÜs
 = 
çl£
;

444 
funùiÚ
 
	$__cÚ¡ruù
(
$Ïb–
 = 
çl£
) {

445 
·»Á
::
	`__cÚ¡ruù
(
$Ïb–
);

453 
funùiÚ
 
	$befÜe
(
$m‘hod
) {

454 
·»Á
::
	`befÜe
(
$m‘hod
);

455 
$this
->
	`£tBrow£r
($this->
	`ü—‹Brow£r
());

456 
	}
}

463 
funùiÚ
 
	$aá”
(
$m‘hod
) {

464 
$this
->
	`un£tBrow£r
();

465 
·»Á
::
	`aá”
(
$m‘hod
);

466 
	}
}

475 
funùiÚ
 
	$g‘Brow£r
() {

476  
$this
->
brow£r
;

477 
	}
}

486 
funùiÚ
 
	$£tBrow£r
(
$brow£r
) {

487  
$this
->
brow£r
 = 
$brow£r
;

488 
	}
}

495 
funùiÚ
 
	$£tP¬£r
(
$·r£r
) {

496 
$this
->
brow£r
->
	`£tP¬£r
(
$·r£r
);

497 
	}
}

504 
funùiÚ
 
	$un£tBrow£r
() {

505 
	`un£t
(
$this
->
brow£r
);

506 
	}
}

514 
funùiÚ
 
	$ü—‹Brow£r
() {

515  
Ãw
 
	`Sim¶eBrow£r
();

516 
	}
}

523 
funùiÚ
 
	$g‘T¿n¥ÜtE¼Ü
() {

524  
$this
->
brow£r
->
	`g‘T¿n¥ÜtE¼Ü
();

525 
	}
}

533 
funùiÚ
 
	$g‘U¾
() {

534  
$this
->
brow£r
->
	`g‘U¾
();

535 
	}
}

541 
funùiÚ
 
	$showReque¡
() {

542 
$this
->
	`dump
($this->
brow£r
->
	`g‘Reque¡
());

543 
	}
}

549 
funùiÚ
 
	$showH—d”s
() {

550 
$this
->
	`dump
($this->
brow£r
->
	`g‘H—d”s
());

551 
	}
}

557 
funùiÚ
 
	$showSourû
() {

558 
$this
->
	`dump
($this->
brow£r
->
	`g‘CÚ‹Á
());

559 
	}
}

565 
funùiÚ
 
	$showText
() {

566 
$this
->
	`dump
(
	`wÜdw¿p
($this->
brow£r
->
	`g‘CÚ‹ÁAsText
(), 80));

567 
	}
}

580 
funùiÚ
 
	$»¡¬t
(
$d©e
 = 
çl£
) {

581 ià(
$d©e
 ==ğ
çl£
) {

582 
$d©e
 = 
	`time
();

584 
$this
->
brow£r
->
	`»¡¬t
(
$d©e
);

585 
	}
}

593 
funùiÚ
 
	$ageCook›s
(
$š‹rv®
) {

594 
$this
->
brow£r
->
	`ageCook›s
(
$š‹rv®
);

595 
	}
}

602 
funùiÚ
 
	$ignÜeF¿mes
() {

603 
$this
->
brow£r
->
	`ignÜeF¿mes
();

604 
	}
}

610 
funùiÚ
 
	$ignÜeCook›s
() {

611 
$this
->
brow£r
->
	`ignÜeCook›s
();

612 
	}
}

620 
funùiÚ
 
	$ignÜeE¼Üs
() {

621 
$this
->
ignÜe_”rÜs
 = 
Œue
;

622 
	}
}

632 
´Ùeùed
 
funùiÚ
 
	$çOnE¼Ü
(
$»suÉ
) {

633 ià(! 
$this
->
ignÜe_”rÜs
) {

634 ià(
$”rÜ
 = 
$this
->
brow£r
->
	`g‘T¿n¥ÜtE¼Ü
()) {

635 
$this
->
	`ç
(
$”rÜ
);

638 
$this
->
ignÜe_”rÜs
 = 
çl£
;

639  
$»suÉ
;

640 
	}
}

648 
funùiÚ
 
	$addH—d”
(
$h—d”
) {

649 
$this
->
brow£r
->
	`addH—d”
(
$h—d”
);

650 
	}
}

658 
funùiÚ
 
	$£tMaximumRedœeùs
(
$max
) {

659 ià(! 
$this
->
brow£r
) {

660 
	`Œigg”_”rÜ
(

663 
$this
->
brow£r
->
	`£tMaximumRedœeùs
(
$max
);

664 
	}
}

672 
funùiÚ
 
	$£tCÚÃùiÚTimeout
(
$timeout
) {

673 
$this
->
brow£r
->
	`£tCÚÃùiÚTimeout
(
$timeout
);

674 
	}
}

685 
funùiÚ
 
	$u£Proxy
(
$´oxy
, 
$u£ºame
 = 
çl£
, 
$·sswÜd
 = false) {

686 
$this
->
brow£r
->
	`u£Proxy
(
$´oxy
, 
$u£ºame
, 
$·sswÜd
);

687 
	}
}

699 
funùiÚ
 
	$g‘
(
$u¾
, 
$·¿m‘”s
 = 
çl£
) {

700  
$this
->
	`çOnE¼Ü
($this->
brow£r
->
	`g‘
(
$u¾
, 
$·¿m‘”s
));

701 
	}
}

714 
funùiÚ
 
	$po¡
(
$u¾
, 
$·¿m‘”s
 = 
çl£
, 
$cÚ‹Á_ty³
 = false) {

715  
$this
->
	`çOnE¼Ü
($this->
brow£r
->
	`po¡
(
$u¾
, 
$·¿m‘”s
, 
$cÚ‹Á_ty³
));

716 
	}
}

729 
funùiÚ
 
	$put
(
$u¾
, 
$body
 = 
çl£
, 
$cÚ‹Á_ty³
 = false) {

730  
$this
->
	`çOnE¼Ü
($this->
brow£r
->
	`put
(
$u¾
, 
$body
, 
$cÚ‹Á_ty³
));

731 
	}
}

740 
funùiÚ
 
	$d–‘e
(
$u¾
, 
$·¿m‘”s
 = 
çl£
) {

741  
$this
->
	`çOnE¼Ü
($this->
brow£r
->
	`d–‘e
(
$u¾
, 
$·¿m‘”s
));

742 
	}
}

753 
funùiÚ
 
	$h—d
(
$u¾
, 
$·¿m‘”s
 = 
çl£
) {

754  
$this
->
	`çOnE¼Ü
($this->
brow£r
->
	`h—d
(
$u¾
, 
$·¿m‘”s
));

755 
	}
}

763 
funùiÚ
 
	$»Œy
() {

764  
$this
->
	`çOnE¼Ü
($this->
brow£r
->
	`»Œy
());

765 
	}
}

774 
funùiÚ
 
	$back
() {

775  
$this
->
	`çOnE¼Ü
($this->
brow£r
->
	`back
());

776 
	}
}

785 
funùiÚ
 
	$fÜw¬d
() {

786  
$this
->
	`çOnE¼Ü
($this->
brow£r
->
	`fÜw¬d
());

787 
	}
}

799 
funùiÚ
 
	$auth’tiÿ‹
(
$u£ºame
, 
$·sswÜd
) {

800  
$this
->
	`çOnE¼Ü
(

801 
$this
->
brow£r
->
	`auth’tiÿ‹
(
$u£ºame
, 
$·sswÜd
));

802 
	}
}

810 
funùiÚ
 
	$g‘Cook›
(
$Çme
) {

811  
$this
->
brow£r
->
	`g‘Cu¼’tCook›V®ue
(
$Çme
);

812 
	}
}

823 
funùiÚ
 
£tCook›
(
$Çme
, 
$v®ue
, 
$ho¡
 = 
çl£
, 
$·th
 = '/', 
$expœy
 = false) {

824 
$this
->
brow£r
->
£tCook›
(
$Çme
, 
$v®ue
, 
$ho¡
, 
$·th
, 
$expœy
);

835 
funùiÚ
 
	$g‘F¿meFocus
() {

836  
$this
->
brow£r
->
	`g‘F¿meFocus
();

837 
	}
}

845 
funùiÚ
 
	$£tF¿meFocusByIndex
(
$choiû
) {

846  
$this
->
brow£r
->
	`£tF¿meFocusByIndex
(
$choiû
);

847 
	}
}

855 
funùiÚ
 
	$£tF¿meFocus
(
$Çme
) {

856  
$this
->
brow£r
->
	`£tF¿meFocus
(
$Çme
);

857 
	}
}

864 
funùiÚ
 
	$ş—rF¿meFocus
() {

865  
$this
->
brow£r
->
	`ş—rF¿meFocus
();

866 
	}
}

875 
funùiÚ
 
	$şick
(
$Ïb–
) {

876  
$this
->
	`çOnE¼Ü
($this->
brow£r
->
	`şick
(
$Ïb–
));

877 
	}
}

885 
funùiÚ
 
as£¹ClickabË
(
$Ïb–
, 
$mes§ge
 = '%s') {

886  
$this
->
as£¹True
(

887 
$this
->
brow£r
->
isClickabË
(
$Ïb–
),

888 
¥rštf
(
$mes§ge
, "Clickarget [$label] shouldƒxist"));

900 
funùiÚ
 
şickSubm™
(
$Ïb–
 = 'Subm™', 
$add™iÚ®
 = 
çl£
) {

901  
$this
->
çOnE¼Ü
(

902 
$this
->
brow£r
->
şickSubm™
(
$Ïb–
, 
$add™iÚ®
));

913 
funùiÚ
 
	$şickSubm™ByName
(
$Çme
, 
$add™iÚ®
 = 
çl£
) {

914  
$this
->
	`çOnE¼Ü
(

915 
$this
->
brow£r
->
	`şickSubm™ByName
(
$Çme
, 
$add™iÚ®
));

916 
	}
}

926 
funùiÚ
 
	$şickSubm™ById
(
$id
, 
$add™iÚ®
 = 
çl£
) {

927  
$this
->
	`çOnE¼Ü
(

928 
$this
->
brow£r
->
	`şickSubm™ById
(
$id
, 
$add™iÚ®
));

929 
	}
}

937 
funùiÚ
 
as£¹Subm™
(
$Ïb–
, 
$mes§ge
 = '%s') {

938  
$this
->
as£¹True
(

939 
$this
->
brow£r
->
isSubm™
(
$Ïb–
),

940 
¥rštf
(
$mes§ge
, "Submit button [$label] shouldƒxist"));

956 
funùiÚ
 
	$şickImage
(
$Ïb–
, 
$x
 = 1, 
$y
 = 1, 
$add™iÚ®
 = 
çl£
) {

957  
$this
->
	`çOnE¼Ü
(

958 
$this
->
brow£r
->
	`şickImage
(
$Ïb–
, 
$x
, 
$y
, 
$add™iÚ®
));

959 
	}
}

974 
funùiÚ
 
	$şickImageByName
(
$Çme
, 
$x
 = 1, 
$y
 = 1, 
$add™iÚ®
 = 
çl£
) {

975  
$this
->
	`çOnE¼Ü
(

976 
$this
->
brow£r
->
	`şickImageByName
(
$Çme
, 
$x
, 
$y
, 
$add™iÚ®
));

977 
	}
}

991 
funùiÚ
 
	$şickImageById
(
$id
, 
$x
 = 1, 
$y
 = 1, 
$add™iÚ®
 = 
çl£
) {

992  
$this
->
	`çOnE¼Ü
(

993 
$this
->
brow£r
->
	`şickImageById
(
$id
, 
$x
, 
$y
, 
$add™iÚ®
));

994 
	}
}

1002 
funùiÚ
 
as£¹Image
(
$Ïb–
, 
$mes§ge
 = '%s') {

1003  
$this
->
as£¹True
(

1004 
$this
->
brow£r
->
isImage
(
$Ïb–
),

1005 
¥rštf
(
$mes§ge
, "Image withext [$label] shouldƒxist"));

1015 
funùiÚ
 
	$subm™FÜmById
(
$id
, 
$add™iÚ®
 = 
çl£
) {

1016  
$this
->
	`çOnE¼Ü
($this->
brow£r
->
	`subm™FÜmById
(
$id
, 
$add™iÚ®
));

1017 
	}
}

1029 
funùiÚ
 
	$şickLšk
(
$Ïb–
, 
$šdex
 = 0) {

1030  
$this
->
	`çOnE¼Ü
($this->
brow£r
->
	`şickLšk
(
$Ïb–
, 
$šdex
));

1031 
	}
}

1039 
funùiÚ
 
	$şickLškById
(
$id
) {

1040  
$this
->
	`çOnE¼Ü
($this->
brow£r
->
	`şickLškById
(
$id
));

1041 
	}
}

1053 
funùiÚ
 
as£¹Lšk
(
$Ïb–
, 
$ex³ùed
 = 
Œue
, 
$mes§ge
 = '%s') {

1054 
$u¾
 = 
$this
->
brow£r
->
g‘Lšk
(
$Ïb–
);

1055 ià(
	g$ex³ùed
 ==ğ
Œue
 || (
$ex³ùed
 !=ğŒu&& 
$u¾
 ==ğ
çl£
)) {

1056  
$this
->
as£¹True
(
$u¾
 !=ğ
çl£
, 
¥rštf
(
$mes§ge
, "Link [$label] shouldƒxist"));

1058 ià(! 
	gSim¶eEx³ù©iÚ
::
isEx³ù©iÚ
(
$ex³ùed
)) {

1059 
$ex³ùed
 = 
Ãw
 
Id’tiÿlEx³ù©iÚ
($expected);

1061  
	g$this
->
as£¹
(
$ex³ùed
, 
$u¾
->
asSŒšg
(), 
¥rštf
(
$mes§ge
, "Link [$label] should match"));

1074 
funùiÚ
 
as£¹NoLšk
(
$Ïb–
, 
$mes§ge
 = '%s') {

1075  
$this
->
as£¹True
(

1076 
$this
->
brow£r
->
g‘Lšk
(
$Ïb–
è==ğ
çl£
,

1077 
¥rštf
(
$mes§ge
, "Link [$label] should‚otƒxist"));

1089 
funùiÚ
 
as£¹LškById
(
$id
, 
$ex³ùed
 = 
Œue
, 
$mes§ge
 = '%s') {

1090 
$u¾
 = 
$this
->
brow£r
->
g‘LškById
(
$id
);

1091 ià(
	g$ex³ùed
 ==ğ
Œue
) {

1092  
$this
->
as£¹True
(
$u¾
 !=ğ
çl£
, 
¥rštf
(
$mes§ge
, "Link ID [$id] shouldƒxist"));

1094 ià(! 
	gSim¶eEx³ù©iÚ
::
isEx³ù©iÚ
(
$ex³ùed
)) {

1095 
$ex³ùed
 = 
Ãw
 
Id’tiÿlEx³ù©iÚ
($expected);

1097  
	g$this
->
as£¹
(
$ex³ùed
, 
$u¾
->
asSŒšg
(), 
¥rštf
(
$mes§ge
, "Link ID [$id] should match"));

1109 
funùiÚ
 
as£¹NoLškById
(
$id
, 
$mes§ge
 = '%s') {

1110  
$this
->
as£¹True
(

1111 
$this
->
brow£r
->
g‘LškById
(
$id
è==ğ
çl£
,

1112 
¥rštf
(
$mes§ge
, "Link ID [$id] should‚otƒxist"));

1123 
funùiÚ
 
	$£tF›ld
(
$Ïb–
, 
$v®ue
, 
$pos™iÚ
=
çl£
) {

1124  
$this
->
brow£r
->
	`£tF›ld
(
$Ïb–
, 
$v®ue
, 
$pos™iÚ
);

1125 
	}
}

1134 
funùiÚ
 
	$£tF›ldByName
(
$Çme
, 
$v®ue
, 
$pos™iÚ
=
çl£
) {

1135  
$this
->
brow£r
->
	`£tF›ldByName
(
$Çme
, 
$v®ue
, 
$pos™iÚ
);

1136 
	}
}

1145 
funùiÚ
 
	$£tF›ldById
(
$id
, 
$v®ue
) {

1146  
$this
->
brow£r
->
	`£tF›ldById
(
$id
, 
$v®ue
);

1147 
	}
}

1162 
funùiÚ
 
as£¹F›ld
(
$Ïb–
, 
$ex³ùed
 = 
Œue
, 
$mes§ge
 = '%s') {

1163 
$v®ue
 = 
$this
->
brow£r
->
g‘F›ld
(
$Ïb–
);

1164  
	g$this
->
as£¹F›ldV®ue
(
$Ïb–
, 
$v®ue
, 
$ex³ùed
, 
$mes§ge
);

1180 
funùiÚ
 
as£¹F›ldByName
(
$Çme
, 
$ex³ùed
 = 
Œue
, 
$mes§ge
 = '%s') {

1181 
$v®ue
 = 
$this
->
brow£r
->
g‘F›ldByName
(
$Çme
);

1182  
	g$this
->
as£¹F›ldV®ue
(
$Çme
, 
$v®ue
, 
$ex³ùed
, 
$mes§ge
);

1198 
funùiÚ
 
as£¹F›ldById
(
$id
, 
$ex³ùed
 = 
Œue
, 
$mes§ge
 = '%s') {

1199 
$v®ue
 = 
$this
->
brow£r
->
g‘F›ldById
(
$id
);

1200  
	g$this
->
as£¹F›ldV®ue
(
$id
, 
$v®ue
, 
$ex³ùed
, 
$mes§ge
);

1212 
´Ùeùed
 
funùiÚ
 
	$as£¹F›ldV®ue
(
$id’tif›r
, 
$v®ue
, 
$ex³ùed
, 
$mes§ge
) {

1213 ià(
$ex³ùed
 ==ğ
Œue
) {

1214  
$this
->
	`as£¹True
(

1215 
	`is£t
(
$v®ue
),

1216 
	`¥rštf
(
$mes§ge
, "Field [$identifier] shouldƒxist"));

1218 ià(! 
Sim¶eEx³ù©iÚ
::
	`isEx³ù©iÚ
(
$ex³ùed
)) {

1219 
$id’tif›r
 = 
	`¡r_»¶aû
('%', '%%', $identifier);

1220 
$ex³ùed
 = 
Ãw
 
	`F›ldEx³ù©iÚ
(

1221 
$ex³ùed
,

1224  
$this
->
	`as£¹
(
$ex³ùed
, 
$v®ue
, 
$mes§ge
);

1225 
	}
}

1236 
funùiÚ
 
as£¹Re¥Ú£
(
$»¥Ú£s
, 
$mes§ge
 = '%s') {

1237 
$»¥Ú£s
 = (
is_¬¿y
($»¥Ú£sè? $»¥Ú£ : 
¬¿y
($responses));

1238 
	g$code
 = 
$this
->
brow£r
->
g‘Re¥Ú£Code
();

1239 
	g$mes§ge
 = 
¥rštf
(
$mes§ge
, "Expecting„esponse in [" .

1240 
im¶ode
(", ", 
$»¥Ú£s
) . "] got [$code]");

1241  
	g$this
->
as£¹True
(
š_¬¿y
(
$code
, 
$»¥Ú£s
), 
$mes§ge
);

1252 
funùiÚ
 
as£¹Mime
(
$ty³s
, 
$mes§ge
 = '%s') {

1253 
$ty³s
 = (
is_¬¿y
($ty³sè? $ty³ : 
¬¿y
($types));

1254 
	g$ty³
 = 
$this
->
brow£r
->
g‘MimeTy³
();

1255 
	g$mes§ge
 = 
¥rštf
(
$mes§ge
, "Expecting mimeype in [" .

1256 
im¶ode
(", ", 
$ty³s
) . "] got [$type]");

1257  
	g$this
->
as£¹True
(
š_¬¿y
(
$ty³
, 
$ty³s
), 
$mes§ge
);

1268 
funùiÚ
 
as£¹Auth’tiÿtiÚ
(
$auth’tiÿtiÚ
 = 
çl£
, 
$mes§ge
 = '%s') {

1269 ià(! 
$auth’tiÿtiÚ
) {

1270 
$mes§ge
 = 
¥rštf
($message, "Expected‡ny‡uthenticationype, got [" .

1271 
$this
->
brow£r
->
g‘Auth’tiÿtiÚ
() . "]");

1272  
	g$this
->
as£¹True
(

1273 
$this
->
brow£r
->
g‘Auth’tiÿtiÚ
(),

1274 
$mes§ge
);

1276 
	g$mes§ge
 = 
¥rštf
(
$mes§ge
, "Expected‡uthentication [$authentication] got [" .

1277 
$this
->
brow£r
->
g‘Auth’tiÿtiÚ
() . "]");

1278  
	g$this
->
as£¹True
(

1279 
¡¹Şow”
(
$this
->
brow£r
->
g‘Auth’tiÿtiÚ
()è=ğ¡¹Şow”(
$auth’tiÿtiÚ
),

1280 
$mes§ge
);

1291 
funùiÚ
 
as£¹NoAuth’tiÿtiÚ
(
$mes§ge
 = '%s') {

1292 
$mes§ge
 = 
¥rštf
($message, "Expected‚o‡uthenticationype, got [" .

1293 
$this
->
brow£r
->
g‘Auth’tiÿtiÚ
() . "]");

1294  
	g$this
->
as£¹F®£
(
$this
->
brow£r
->
g‘Auth’tiÿtiÚ
(), 
$mes§ge
);

1304 
funùiÚ
 
as£¹R—lm
(
$»®m
, 
$mes§ge
 = '%s') {

1305 ià(! 
Sim¶eEx³ù©iÚ
::
isEx³ù©iÚ
(
$»®m
)) {

1306 
$»®m
 = 
Ãw
 
Equ®Ex³ù©iÚ
($realm);

1308  
	g$this
->
as£¹
(

1309 
$»®m
,

1310 
$this
->
brow£r
->
g‘R—lm
(),

1324 
funùiÚ
 
as£¹H—d”
(
$h—d”
, 
$v®ue
 = 
çl£
, 
$mes§ge
 = '%s') {

1325  
$this
->
as£¹
(

1326 
Ãw
 
H‰pH—d”Ex³ù©iÚ
(
$h—d”
, 
$v®ue
),

1327 
$this
->
brow£r
->
g‘H—d”s
(),

1328 
$mes§ge
);

1340 
funùiÚ
 
as£¹NoH—d”
(
$h—d”
, 
$mes§ge
 = '%s') {

1341  
$this
->
as£¹
(

1342 
Ãw
 
NoH‰pH—d”Ex³ù©iÚ
(
$h—d”
),

1343 
$this
->
brow£r
->
g‘H—d”s
(),

1344 
$mes§ge
);

1354 
funùiÚ
 
as£¹T™Ë
(
$t™Ë
 = 
çl£
, 
$mes§ge
 = '%s') {

1355 ià(! 
Sim¶eEx³ù©iÚ
::
isEx³ù©iÚ
(
$t™Ë
)) {

1356 
$t™Ë
 = 
Ãw
 
Equ®Ex³ù©iÚ
($title);

1358  
	g$this
->
as£¹
(
$t™Ë
, 
$this
->
brow£r
->
g‘T™Ë
(), 
$mes§ge
);

1369 
funùiÚ
 
as£¹Text
(
$‹xt
, 
$mes§ge
 = '%s') {

1370  
$this
->
as£¹
(

1371 
Ãw
 
TextEx³ù©iÚ
(
$‹xt
),

1372 
$this
->
brow£r
->
g‘CÚ‹ÁAsText
(),

1373 
$mes§ge
);

1384 
funùiÚ
 
as£¹NoText
(
$‹xt
, 
$mes§ge
 = '%s') {

1385  
$this
->
as£¹
(

1386 
Ãw
 
NoTextEx³ù©iÚ
(
$‹xt
),

1387 
$this
->
brow£r
->
g‘CÚ‹ÁAsText
(),

1388 
$mes§ge
);

1400 
funùiÚ
 
as£¹P©‹º
(
$·‰”n
, 
$mes§ge
 = '%s') {

1401  
$this
->
as£¹
(

1402 
Ãw
 
P©‹ºEx³ù©iÚ
(
$·‰”n
),

1403 
$this
->
brow£r
->
g‘CÚ‹Á
(),

1404 
$mes§ge
);

1416 
funùiÚ
 
as£¹NoP©‹º
(
$·‰”n
, 
$mes§ge
 = '%s') {

1417  
$this
->
as£¹
(

1418 
Ãw
 
NoP©‹ºEx³ù©iÚ
(
$·‰”n
),

1419 
$this
->
brow£r
->
g‘CÚ‹Á
(),

1420 
$mes§ge
);

1433 
funùiÚ
 
as£¹Cook›
(
$Çme
, 
$ex³ùed
 = 
çl£
, 
$mes§ge
 = '%s') {

1434 
$v®ue
 = 
$this
->
g‘Cook›
(
$Çme
);

1435 ià(! 
	g$ex³ùed
) {

1436  
	g$this
->
as£¹True
(

1437 
$v®ue
,

1438 
¥rštf
(
$mes§ge
, "Expecting cookie [$name]"));

1440 ià(! 
	gSim¶eEx³ù©iÚ
::
isEx³ù©iÚ
(
$ex³ùed
)) {

1441 
$ex³ùed
 = 
Ãw
 
Equ®Ex³ù©iÚ
($expected);

1443  
	g$this
->
as£¹
(
$ex³ùed
, 
$v®ue
, "Expecting cookie [$name] -> $message");

1454 
funùiÚ
 
as£¹NoCook›
(
$Çme
, 
$mes§ge
 = '%s') {

1455  
$this
->
as£¹True
(

1456 
$this
->
g‘Cook›
(
$Çme
è==ğ
nuÎ
 
Ü
 $this->g‘Cook›($Çmeè==ğ
çl£
,

1457 
¥rštf
(
$mes§ge
, "Notƒxpecting cookie [$name]"));

1469 
funùiÚ
 
as£¹True
(
$»suÉ
, 
$mes§ge
 = '%s') {

1470  
$this
->
as£¹
(
Ãw
 
TrueEx³ù©iÚ
(), 
$»suÉ
, 
$mes§ge
);

1483 
funùiÚ
 
as£¹F®£
(
$»suÉ
, 
$mes§ge
 = '%s') {

1484  
$this
->
as£¹
(
Ãw
 
F®£Ex³ù©iÚ
(), 
$»suÉ
, 
$mes§ge
);

1497 
funùiÚ
 
as£¹Equ®
(
$fœ¡
, 
$£cÚd
, 
$mes§ge
 = '%s') {

1498  
$this
->
as£¹
(

1499 
Ãw
 
Equ®Ex³ù©iÚ
(
$fœ¡
),

1500 
$£cÚd
,

1501 
$mes§ge
);

1514 
funùiÚ
 
as£¹NÙEqu®
(
$fœ¡
, 
$£cÚd
, 
$mes§ge
 = '%s') {

1515  
$this
->
as£¹
(

1516 
Ãw
 
NÙEqu®Ex³ù©iÚ
(
$fœ¡
),

1517 
$£cÚd
,

1518 
$mes§ge
);

1527 
funùiÚ
 
	$g‘As£¹iÚLše
() {

1528 
$Œaû
 = 
Ãw
 
	`Sim¶eSckT¿û
(
	`¬¿y
('assert', 'click', 'pass', 'fail'));

1529  
$Œaû
->
	`ŒaûM‘hod
();

1530 
	}
}

	@F:\Site\stew\1\_lp\simpletest\xml.php

1 <?
php


12 
»quœe_Úû
(
dœÇme
(
__FILE__
) . '/scorer.php');

21 şas 
	cXmlR•Ü‹r
 
ex‹nds
 
	mSim¶eR•Ü‹r
 {

22 
´iv©e
 
	m$šd’t
;

23 
´iv©e
 
	m$Çme¥aû
;

31 
funùiÚ
 
__cÚ¡ruù
(
$Çme¥aû
 = 
çl£
, 
$šd’t
 = ' ') {

32 
·»Á
::
__cÚ¡ruù
();

33 
	m$this
->
	mÇme¥aû
 = (
$Çme¥aû
 ? $namespace . ':' : '');

34 
	m$this
->
	mšd’t
 = 
$šd’t
;

44 
´Ùeùed
 
funùiÚ
 
	$g‘Ind’t
(
$off£t
 = 0) {

45  
	`¡r_»³©
(

46 
$this
->
šd’t
,

47 
	`couÁ
(
$this
->
	`g‘Te¡Li¡
()è+ 
$off£t
);

48 
	}
}

57 
funùiÚ
 
	$toP¬£dXml
(
$‹xt
) {

58  
	`¡r_»¶aû
(

59 
	`¬¿y
('&', '<', '>', '"', '\''),

60 
	`¬¿y
('&amp;', '&lt;', '&gt;', '&quot;', '&apos;'),

61 
$‹xt
);

62 
	}
}

70 
funùiÚ
 
	$·štGroupS¹
(
$‹¡_Çme
, 
$size
) {

71 
·»Á
::
	`·štGroupS¹
(
$‹¡_Çme
, 
$size
);

72 
´št
 
$this
->
	`g‘Ind’t
();

73 
´št
 "<" . 
$this
->
Çme¥aû
 . "group size=\"$size\">\n";

74 
´št
 
$this
->
	`g‘Ind’t
(1);

75 
´št
 "<" . 
$this
->
Çme¥aû
 . "name>" .

76 
$this
->
	`toP¬£dXml
(
$‹¡_Çme
) .

77 "</" . 
$this
->
Çme¥aû
 . "name>\n";

78 
	}
}

85 
funùiÚ
 
	$·štGroupEnd
(
$‹¡_Çme
) {

86 
´št
 
$this
->
	`g‘Ind’t
();

87 
´št
 "</" . 
$this
->
Çme¥aû
 . "group>\n";

88 
·»Á
::
	`·štGroupEnd
(
$‹¡_Çme
);

89 
	}
}

96 
funùiÚ
 
	$·štCa£S¹
(
$‹¡_Çme
) {

97 
·»Á
::
	`·štCa£S¹
(
$‹¡_Çme
);

98 
´št
 
$this
->
	`g‘Ind’t
();

99 
´št
 "<" . 
$this
->
Çme¥aû
 . "case>\n";

100 
´št
 
$this
->
	`g‘Ind’t
(1);

101 
´št
 "<" . 
$this
->
Çme¥aû
 . "name>" .

102 
$this
->
	`toP¬£dXml
(
$‹¡_Çme
) .

103 "</" . 
$this
->
Çme¥aû
 . "name>\n";

104 
	}
}

111 
funùiÚ
 
	$·štCa£End
(
$‹¡_Çme
) {

112 
´št
 
$this
->
	`g‘Ind’t
();

113 
´št
 "</" . 
$this
->
Çme¥aû
 . "case>\n";

114 
·»Á
::
	`·štCa£End
(
$‹¡_Çme
);

115 
	}
}

122 
funùiÚ
 
	$·štM‘hodS¹
(
$‹¡_Çme
) {

123 
·»Á
::
	`·štM‘hodS¹
(
$‹¡_Çme
);

124 
´št
 
$this
->
	`g‘Ind’t
();

125 
´št
 "<" . 
$this
->
Çme¥aû
 . "test>\n";

126 
´št
 
$this
->
	`g‘Ind’t
(1);

127 
´št
 "<" . 
$this
->
Çme¥aû
 . "name>" .

128 
$this
->
	`toP¬£dXml
(
$‹¡_Çme
) .

129 "</" . 
$this
->
Çme¥aû
 . "name>\n";

130 
	}
}

138 
funùiÚ
 
	$·štM‘hodEnd
(
$‹¡_Çme
) {

139 
´št
 
$this
->
	`g‘Ind’t
();

140 
´št
 "</" . 
$this
->
Çme¥aû
 . "test>\n";

141 
·»Á
::
	`·štM‘hodEnd
(
$‹¡_Çme
);

142 
	}
}

149 
funùiÚ
 
	$·štPass
(
$mes§ge
) {

150 
·»Á
::
	`·štPass
(
$mes§ge
);

151 
´št
 
$this
->
	`g‘Ind’t
(1);

152 
´št
 "<" . 
$this
->
Çme¥aû
 . "pass>";

153 
´št
 
$this
->
	`toP¬£dXml
(
$mes§ge
);

154 
´št
 "</" . 
$this
->
Çme¥aû
 . "pass>\n";

155 
	}
}

162 
funùiÚ
 
	$·štFa
(
$mes§ge
) {

163 
·»Á
::
	`·štFa
(
$mes§ge
);

164 
´št
 
$this
->
	`g‘Ind’t
(1);

165 
´št
 "<" . 
$this
->
Çme¥aû
 . "fail>";

166 
´št
 
$this
->
	`toP¬£dXml
(
$mes§ge
);

167 
´št
 "</" . 
$this
->
Çme¥aû
 . "fail>\n";

168 
	}
}

175 
funùiÚ
 
	$·štE¼Ü
(
$mes§ge
) {

176 
·»Á
::
	`·štE¼Ü
(
$mes§ge
);

177 
´št
 
$this
->
	`g‘Ind’t
(1);

178 
´št
 "<" . 
$this
->
Çme¥aû
 . "exception>";

179 
´št
 
$this
->
	`toP¬£dXml
(
$mes§ge
);

180 
´št
 "</" . 
$this
->
Çme¥aû
 . "exception>\n";

181 
	}
}

188 
funùiÚ
 
	$·štExû±iÚ
(
$exû±iÚ
) {

189 
·»Á
::
	`·štExû±iÚ
(
$exû±iÚ
);

190 
´št
 
$this
->
	`g‘Ind’t
(1);

191 
´št
 "<" . 
$this
->
Çme¥aû
 . "exception>";

192 
$mes§ge
 = 'UÃx³ùedƒxû±iÚ oàty³ [' . 
	`g‘_şass
(
$exû±iÚ
) .

193 '] w™h mes§g['. 
$exû±iÚ
->
	`g‘Mes§ge
() .

194 '] iÀ['. 
$exû±iÚ
->
	`g‘Fe
() .

195 '†š' . 
$exû±iÚ
->
	`g‘Lše
() . ']';

196 
´št
 
$this
->
	`toP¬£dXml
(
$mes§ge
);

197 
´št
 "</" . 
$this
->
Çme¥aû
 . "exception>\n";

198 
	}
}

205 
funùiÚ
 
	$·štSk
(
$mes§ge
) {

206 
·»Á
::
	`·štSk
(
$mes§ge
);

207 
´št
 
$this
->
	`g‘Ind’t
(1);

208 
´št
 "<" . 
$this
->
Çme¥aû
 . "skip>";

209 
´št
 
$this
->
	`toP¬£dXml
(
$mes§ge
);

210 
´št
 "</" . 
$this
->
Çme¥aû
 . "skip>\n";

211 
	}
}

218 
funùiÚ
 
	$·štMes§ge
(
$mes§ge
) {

219 
·»Á
::
	`·štMes§ge
(
$mes§ge
);

220 
´št
 
$this
->
	`g‘Ind’t
(1);

221 
´št
 "<" . 
$this
->
Çme¥aû
 . "message>";

222 
´št
 
$this
->
	`toP¬£dXml
(
$mes§ge
);

223 
´št
 "</" . 
$this
->
Çme¥aû
 . "message>\n";

224 
	}
}

232 
funùiÚ
 
	$·štFÜm©‹dMes§ge
(
$mes§ge
) {

233 
·»Á
::
	`·štFÜm©‹dMes§ge
(
$mes§ge
);

234 
´št
 
$this
->
	`g‘Ind’t
(1);

235 
´št
 "<" . 
$this
->
Çme¥aû
 . "formatted>";

236 
´št
 "<![CDATA[$message]]>";

237 
´št
 "</" . 
$this
->
Çme¥aû
 . "formatted>\n";

238 
	}
}

246 
funùiÚ
 
	$·štSigÇl
(
$ty³
, 
$·ylßd
) {

247 
·»Á
::
	`·štSigÇl
(
$ty³
, 
$·ylßd
);

248 
´št
 
$this
->
	`g‘Ind’t
(1);

249 
´št
 "<" . 
$this
->
Çme¥aû
 . "signalype=\"$type\">";

250 
´št
 "<![CDATA[" . 
	`£rŸlize
(
$·ylßd
) . "]]>";

251 
´št
 "</" . 
$this
->
Çme¥aû
 . "signal>\n";

252 
	}
}

261 
funùiÚ
 
	$·štH—d”
(
$‹¡_Çme
) {

262 ià(! 
Sim¶eR•Ü‹r
::
	`šCli
()) {

263 
	`h—d”
('Content-type:ext/xml');

265 
´št
 "<?xml version=\"1.0\"";

266 ià(
$this
->
Çme¥aû
) {

267 
´št
 " xmÊs:" . 
$this
->
Çme¥aû
 .

270 
´št
 "?>\n";

271 
´št
 "<" . 
$this
->
Çme¥aû
 . "run>\n";

272 
	}
}

280 
funùiÚ
 
	$·štFoÙ”
(
$‹¡_Çme
) {

281 
´št
 "</" . 
$this
->
Çme¥aû
 . "run>\n";

282 
	}
}

292 şas 
	cNe¡šgXmlTag
 {

293 
´iv©e
 
	m$Çme
;

294 
´iv©e
 
	m$©Œibu‹s
;

302 
funùiÚ
 
	$Ne¡šgXmlTag
(
$©Œibu‹s
) {

303 
$this
->
Çme
 = 
çl£
;

304 
$this
->
©Œibu‹s
 = 
$©Œibu‹s
;

312 
funùiÚ
 
	$£tName
(
$Çme
) {

313 
$this
->
Çme
 = 
$Çme
;

314 
	}
}

321 
funùiÚ
 
	$g‘Name
() {

322  
$this
->
Çme
;

323 
	}
}

330 
´Ùeùed
 
funùiÚ
 
	$g‘A‰ribu‹s
() {

331  
$this
->
©Œibu‹s
;

332 
	}
}

342 şas 
	cNe¡šgM‘hodTag
 
ex‹nds
 
	mNe¡šgXmlTag
 {

350 
funùiÚ
 
	$Ne¡šgM‘hodTag
(
$©Œibu‹s
) {

351 
$this
->
	`Ne¡šgXmlTag
(
$©Œibu‹s
);

360 
funùiÚ
 
	$·štS¹
(&
$li¡’”
) {

361 
$li¡’”
->
	`·štM‘hodS¹
(
$this
->
	`g‘Name
());

362 
	}
}

370 
funùiÚ
 
	$·štEnd
(&
$li¡’”
) {

371 
$li¡’”
->
	`·štM‘hodEnd
(
$this
->
	`g‘Name
());

372 
	}
}

382 şas 
	cNe¡šgCa£Tag
 
ex‹nds
 
	mNe¡šgXmlTag
 {

390 
funùiÚ
 
	$Ne¡šgCa£Tag
(
$©Œibu‹s
) {

391 
$this
->
	`Ne¡šgXmlTag
(
$©Œibu‹s
);

400 
funùiÚ
 
	$·štS¹
(&
$li¡’”
) {

401 
$li¡’”
->
	`·štCa£S¹
(
$this
->
	`g‘Name
());

402 
	}
}

410 
funùiÚ
 
	$·štEnd
(&
$li¡’”
) {

411 
$li¡’”
->
	`·štCa£End
(
$this
->
	`g‘Name
());

412 
	}
}

422 şas 
	cNe¡šgGroupTag
 
ex‹nds
 
	mNe¡šgXmlTag
 {

430 
funùiÚ
 
	$Ne¡šgGroupTag
(
$©Œibu‹s
) {

431 
$this
->
	`Ne¡šgXmlTag
(
$©Œibu‹s
);

440 
funùiÚ
 
	$·štS¹
(&
$li¡’”
) {

441 
$li¡’”
->
	`·štGroupS¹
(
$this
->
	`g‘Name
(), $this->
	`g‘Size
());

442 
	}
}

450 
funùiÚ
 
	$·štEnd
(&
$li¡’”
) {

451 
$li¡’”
->
	`·štGroupEnd
(
$this
->
	`g‘Name
());

452 
	}
}

459 
funùiÚ
 
	$g‘Size
() {

460 
$©Œibu‹s
 = 
$this
->
	`g‘A‰ribu‹s
();

461 ià(
	`is£t
(
$©Œibu‹s
['SIZE'])) {

462  (
š‹g”
)
$©Œibu‹s
['SIZE'];

465 
	}
}

474 şas 
	cSim¶eTe¡XmlP¬£r
 {

475 
´iv©e
 
	m$li¡’”
;

476 
´iv©e
 
	m$ex·t
;

477 
´iv©e
 
	m$g_¡ack
;

478 
´iv©e
 
	m$š_cÚ‹Á_g
;

479 
´iv©e
 
	m$cÚ‹Á
;

480 
´iv©e
 
	m$©Œibu‹s
;

488 
funùiÚ
 
	$Sim¶eTe¡XmlP¬£r
(&
$li¡’”
) {

489 
$this
->
li¡’”
 = &
$li¡’”
;

490 
$this
->
ex·t
 = &$this->
	`ü—‹P¬£r
();

491 
$this
->
g_¡ack
 = 
	`¬¿y
();

492 
$this
->
š_cÚ‹Á_g
 = 
çl£
;

493 
$this
->
cÚ‹Á
 = '';

494 
$this
->
©Œibu‹s
 = 
	`¬¿y
();

504 
funùiÚ
 
	$·r£
(
$chunk
) {

505 ià(! 
	`xml_·r£
(
$this
->
ex·t
, 
$chunk
)) {

506 
	`Œigg”_”rÜ
('XML…arseƒrror with ' .

507 
	`xml_”rÜ_¡ršg
(
	`xml_g‘_”rÜ_code
(
$this
->
ex·t
)));

508  
çl£
;

510  
Œue
;

511 
	}
}

518 
´Ùeùed
 
	gfunùiÚ
 &
	$ü—‹P¬£r
() {

519 
$ex·t
 = 
	`xml_·r£r_ü—‹
();

520 
	`xml_£t_objeù
(
$ex·t
, 
$this
);

521 
	`xml_£t_–em’t_hªdËr
(
$ex·t
, 'startElement', 'endElement');

522 
	`xml_£t_ch¬aù”_d©a_hªdËr
(
$ex·t
, 'addContent');

523 
	`xml_£t_deçuÉ_hªdËr
(
$ex·t
, 'defaultContent');

524  
$ex·t
;

525 
	}
}

533 
´Ùeùed
 
funùiÚ
 
	$pushNe¡šgTag
(
$Ã¡ed
) {

534 
	`¬¿y_unshiá
(
$this
->
g_¡ack
, 
$Ã¡ed
);

535 
	}
}

543 
´Ùeùed
 
	gfunùiÚ
 &
	$g‘Cu¼’tNe¡šgTag
() {

544  
$this
->
g_¡ack
[0];

545 
	}
}

553 
´Ùeùed
 
funùiÚ
 
	$pİNe¡šgTag
() {

554  
	`¬¿y_shiá
(
$this
->
g_¡ack
);

555 
	}
}

563 
´Ùeùed
 
funùiÚ
 
	$isL—f
(
$g
) {

564  
	`š_¬¿y
(
$g
, 
	`¬¿y
(

566 
	}
}

577 
´Ùeùed
 
funùiÚ
 
	$¡¬tEËm’t
(
$ex·t
, 
$g
, 
$©Œibu‹s
) {

578 
$this
->
©Œibu‹s
 = 
$©Œibu‹s
;

579 ià(
$g
 == 'GROUP') {

580 
$this
->
	`pushNe¡šgTag
(
Ãw
 
	`Ne¡šgGroupTag
(
$©Œibu‹s
));

581 } 
	`–£if
 (
$g
 == 'CASE') {

582 
$this
->
	`pushNe¡šgTag
(
Ãw
 
	`Ne¡šgCa£Tag
(
$©Œibu‹s
));

583 } 
	`–£if
 (
$g
 == 'TEST') {

584 
$this
->
	`pushNe¡šgTag
(
Ãw
 
	`Ne¡šgM‘hodTag
(
$©Œibu‹s
));

585 } 
	`–£if
 (
$this
->
	`isL—f
(
$g
)) {

586 
$this
->
š_cÚ‹Á_g
 = 
Œue
;

587 
$this
->
cÚ‹Á
 = '';

589 
	}
}

597 
´Ùeùed
 
funùiÚ
 
	$’dEËm’t
(
$ex·t
, 
$g
) {

598 
$this
->
š_cÚ‹Á_g
 = 
çl£
;

599 ià(
	`š_¬¿y
(
$g
, 
	`¬¿y
('GROUP', 'CASE', 'TEST'))) {

600 
$Ã¡šg_g
 = 
$this
->
	`pİNe¡šgTag
();

601 
$Ã¡šg_g
->
	`·štEnd
(
$this
->
li¡’”
);

602 } 
	`–£if
 (
$g
 == 'NAME') {

603 
$Ã¡šg_g
 = &
$this
->
	`g‘Cu¼’tNe¡šgTag
();

604 
$Ã¡šg_g
->
	`£tName
(
$this
->
cÚ‹Á
);

605 
$Ã¡šg_g
->
	`·štS¹
(
$this
->
li¡’”
);

606 } 
	`–£if
 (
$g
 == 'PASS') {

607 
$this
->
li¡’”
->
	`·štPass
($this->
cÚ‹Á
);

608 } 
	`–£if
 (
$g
 == 'FAIL') {

609 
$this
->
li¡’”
->
	`·štFa
($this->
cÚ‹Á
);

610 } 
	`–£if
 (
$g
 == 'EXCEPTION') {

611 
$this
->
li¡’”
->
	`·štE¼Ü
($this->
cÚ‹Á
);

612 } 
	`–£if
 (
$g
 == 'SKIP') {

613 
$this
->
li¡’”
->
	`·štSk
($this->
cÚ‹Á
);

614 } 
	`–£if
 (
$g
 == 'SIGNAL') {

615 
$this
->
li¡’”
->
	`·štSigÇl
(

616 
$this
->
©Œibu‹s
['TYPE'],

617 
	`un£rŸlize
(
$this
->
cÚ‹Á
));

618 } 
	`–£if
 (
$g
 == 'MESSAGE') {

619 
$this
->
li¡’”
->
	`·štMes§ge
($this->
cÚ‹Á
);

620 } 
	`–£if
 (
$g
 == 'FORMATTED') {

621 
$this
->
li¡’”
->
	`·štFÜm©‹dMes§ge
($this->
cÚ‹Á
);

623 
	}
}

631 
´Ùeùed
 
funùiÚ
 
	$addCÚ‹Á
(
$ex·t
, 
$‹xt
) {

632 ià(
$this
->
š_cÚ‹Á_g
) {

633 
$this
->
cÚ‹Á
 .ğ
$‹xt
;

635  
Œue
;

636 
	}
}

644 
´Ùeùed
 
funùiÚ
 
	$deçuÉCÚ‹Á
(
$ex·t
, 
$deçuÉ
) {

645 
	}
}

	@F:\Site\stew\1\_lp\st.init.php

1 <?
php


3 ifĞ!
defšed
('AROOT'èè
d›
('NO AROOT!');

4 ifĞ!
defšed
('DS'èè
defše
Ğ'DS' , 
DIRECTORY_SEPARATOR
 );

8 
defše
Ğ'IN' , 
Œue
 );

10 
defše
Ğ'ROOT' , 
dœÇme
Ğ
__FILE__
 ) . 
DS
 );

11 
defše
Ğ'CROOT' , 
ROOT
 . 'cÜe' . 
DS
 );

12 
defše
Ğ'TROOT' , 
ROOT
 . 'sim¶‘e¡' . 
DS
 );

16 
”rÜ_»pÜtšg
(
E_ALL
^
E_NOTICE
);

17 
ši_£t
Ğ'di¥Ïy_”rÜs' , 
Œue
 );

19 
šşude_Úû
Ğ
CROOT
 . 'lib' . 
DS
 . 'core.function.php' );

20 @
šşude_Úû
Ğ
AROOT
 . 'lib' . 
DS
 . 'app.function.php' );

22 
šşude_Úû
Ğ
CROOT
 . 'cÚfig' . 
DS
 . 'core.config.php' );

23 
šşude_Úû
Ğ
AROOT
 . 'cÚfig' . 
DS
 . 'app.config.php' );

25 
»quœe_Úû
Ğ
TROOT
 . 'autorun.php');

26 
»quœe_Úû
Ğ
TROOT
 . 'web_tester.php' );

29 
	g$‹¡
 = 
Ãw
 
Te¡Su™e
('LazyPHP Test Center');

31 
fÜ—ch
Ğ
glob
Ğ
AROOT
 . '‹¡'. 
DS
 .'ph±e¡' . DS . '*.‹¡.php' ) 
as
 
$f
 )

32 
	g$‹¡
->
addFe
Ğ
$f
 );

36 
un£t
Ğ
$‹¡
 );

	@F:\Site\stew\1\config\app.config.php

1 <?
php


2 
	g$GLOBALS
['config']['site_name'] = 'LazyPHP3';

3 
	g$GLOBALS
['config']['site_domain'] = 'lazyphp3.sinaapp.com';

	@F:\Site\stew\1\config\db.config.php

1 <?
php


3 ifĞ
defšed
('SAE_APPNAME') )

5 
	g$GLOBALS
['cÚfig']['db']['db_ho¡'] = 
SAE_MYSQL_HOST_M
;

6 
	g$GLOBALS
['cÚfig']['db']['db_ho¡_»ad'] = 
SAE_MYSQL_HOST_S
;

8 
	g$GLOBALS
['cÚfig']['db']['db_pÜt'] = 
SAE_MYSQL_PORT
;

10 
	g$GLOBALS
['cÚfig']['db']['db_u£r'] = 
SAE_MYSQL_USER
;

11 
	g$GLOBALS
['cÚfig']['db']['db_·sswÜd'] = 
SAE_MYSQL_PASS
;

12 
	g$GLOBALS
['cÚfig']['db']['db_Çme'] = 
SAE_MYSQL_DB
;

17 
	g$GLOBALS
['config']['db']['db_host'] = 'localhost';

18 
	g$GLOBALS
['config']['db']['db_port'] = 3306;

19 
	g$GLOBALS
['config']['db']['db_user'] = 'root';

20 
	g$GLOBALS
['config']['db']['db_password'] = '';

21 
	g$GLOBALS
['config']['db']['db_name'] = 'lpdb';

	@F:\Site\stew\1\controller\app.class.php

1 <?
php


2 ifĞ!
defšed
('IN'èè
d›
('bad„equest');

3 
šşude_Úû
Ğ
CROOT
 . 'cÚŒŞËr' . 
DS
 . 'core.class.php' );

5 şas 
	c­pCÚŒŞËr
 
ex‹nds
 
	mcÜeCÚŒŞËr


7 
funùiÚ
 
	$__cÚ¡ruù
()

10 
·»Á
::
	`__cÚ¡ruù
();

16 
	}
}

	@F:\Site\stew\1\controller\default.class.php

1 <?
php


2 ifĞ!
defšed
('IN'èè
d›
('bad„equest');

3 
šşude_Úû
Ğ
AROOT
 . 'cÚŒŞËr'.
DS
.'app.class.php' );

5 şas 
	cdeçuÉCÚŒŞËr
 
ex‹nds
 
	m­pCÚŒŞËr


7 
funùiÚ
 
	$__cÚ¡ruù
()

9 
·»Á
::
	`__cÚ¡ruù
();

12 
funùiÚ
 
	$šdex
()

14 
$d©a
['title'] = $data['top_title'] = 'é¦–é¡µ';

15 
echo
 "$data";

16 
echo
 " byƒcho <br />";

17 
	`´št_r
(
$d©a
);

18 
echo
 " by…ring_r <br />";

19 
	`v¬_dump
(
$d©a
);

20 
echo
 " by var_dump <br />";

21 
	`v¬_expÜt
(
$d©a
);

22 
echo
 " by var_export <br />";

23 
	`debug_zv®_dump
(
$d©a
);

24 
echo
 " by debug_zval_dump <br />";

25 
	`debug_´št_backŒaû
();

26 
echo
 " by debug_pring_backtrace <br />";

27 
	`šşude_Úû
('FirePHPCore/fb.php');

28 
FB
::
	`log
(
$d©a
);

29 
	`»nd”
Ğ
$d©a
 );

30 
	}
}

32 
funùiÚ
 
	$ajax_‹¡
()

34  
	`ajax_echo
('1234');

35 
	}
}

37 
funùiÚ
 
	$»¡
()

39 
$d©a
 = 
	`¬¿y
( );

40 ifĞ
	`štv®
(
	`v
('o')) == 1 )

42 
$d©a
['code'] = 123;

43 
$d©a
['message'] = 'RPWT';

47 
$d©a
['code'] = 0 ;

48 
$d©a
['d©a'] = 
	`¬¿y
( '2' , '4' , '6' , '8' );

51 
	`»nd”
Ğ
$d©a
 , 'rest' );

52 
	}
}

54 
funùiÚ
 
	$mobe
()

56 
$d©a
['title'] = $data['top_title'] = 'JQMobi';

57 
	`»nd”
Ğ
$d©a
 , 'mobile' );

58 
	}
}

60 
funùiÚ
 
	$ajax_lßd
()

62  
	`ajax_echo
('H–lØ' . 
	`d©e
("Y-m-d H:i:s"));

63 
	}
}

65 
funùiÚ
 
	$about
()

67  
	`šfo_·ge
( "ftqq.com è£èª‰å‡ºå“" , "About" );

68 
	}
}

70 
funùiÚ
 
	$cÚù
()

72  
	`šfo_·ge
( "Sina Weibo - <a href='http://weibo.com/easy'arget='_blank'>@Easy</a> | Twitter - @Easychen" , "Follow Me" );

73 
	}
}

75 
funùiÚ
 
	$‹¡
()

77 
$d©a
['title'] = $data['top_title'] = 'è‡ªåŠ¨æµ‹è¯•é¡µ';

78 
$d©a
['info'] = 'æ ¹æ®è®¿é—®æ¥æºè‡ªåŠ¨åˆ‡æ¢Layout';

80  
	`»nd”
Ğ
$d©a
 );

81 
	}
}

83 
funùiÚ
 
	$sql
()

85 
	`db
();

86 
echo
 
$sql
 = 
	`´•¬e
Ğ"SELECT * FROM `u£r` WHERE `Çme` = ? AND `uid` = ?˜AND `Ëv–` = ? LIMIT 1" , 
	`¬¿y
( "Easy'" , '-1', '9.56' ) );

87 
	}
}

	@F:\Site\stew\1\controller\show.class.php

1 <?
php


2 şas 
	cshowCouŒŞËr
 
ex‹nds
 
	mcÜeCÚŒŞËr


4 
funùiÚ
 
	$show
(){

5 
$uid
 = 
	`štv®
(
$_REQUEST
['uid']);

6 ifĞ
$uid
 < 1 )  
	`šfo_·ge
(â€˜é”™è¯¯çš„
uid
â€™);

7 
$d©a
['u£r'] = 
	`g‘_u£r_šfo_by_id
Ğ
$uid
 );

8 
	`»nd”
Ğ
$d©a
 );

10 
	}
}

	@F:\Site\stew\1\controller\user.class.php

1 <?
php


2 
šşude_Úû
Ğ
AROOT
 . 'cÚŒŞËr'.
DS
.'app.class.php' );

4 şas 
	cu£rCÚŒŞËr
 
ex‹nds
 
	m­pCÚŒŞËr


6 
funùiÚ
 
	$__cÚ¡ruù
()

8 
·»Á
::
	`__cÚ¡ruù
();

11 
funùiÚ
 
	$logš
()

14 
	}
}

16 
funùiÚ
 ()

19 
	}
}

21 
funùiÚ
 
	$logout
()

24 
	}
}

26 
funùiÚ
 
	$d‘a
()

29 
	}
}

	@F:\Site\stew\1\index.php

1 <?
php


5 
defše
Ğ'DS' , 
DIRECTORY_SEPARATOR
 );

6 
defše
Ğ'AROOT' , 
dœÇme
Ğ
__FILE__
 ) . 
DS
 );

9 
šşude_Úû
Ğ'_Í'.
DS
 .'lp.init.php' );

	@F:\Site\stew\1\lib\app.function.php

	@F:\Site\stew\1\lib\tiny_but_strong.class.php

1 <?
php


16 ià(
v”siÚ_com·»
(
PHP_VERSION
,'5.0')<0è
	gecho
 '<br><b>TšyButSŒÚg E¼Ü</b> (PHP V”siÚ Checkè: You¸PHP v”siÚ i '.
	gPHP_VERSION
.' while TinyButStrong‚eeds PHP version 5.0 or higher. You shouldry with TinyButStrong Edition for PHP 4.';

19 
defše
('TBS_NOTHING', 0);

20 
defše
('TBS_OUTPUT', 1);

21 
defše
('TBS_EXIT', 2);

24 
defše
('TBS_INSTALL', -1);

25 
defše
('TBS_ISINSTALLED', -3);

29 şas 
	cşsTbsLoÿtÜ
 {

30 
public
 
	m$PosBeg
 = 
çl£
;

31 
public
 
	m$PosEnd
 = 
çl£
;

32 
public
 
	m$EÆ¬ged
 = 
çl£
;

33 
public
 
	m$FuÎName
 = 
çl£
;

34 
public
 
	m$SubName
 = '';

35 
public
 
	m$SubOk
 = 
çl£
;

36 
public
 
	m$SubL¡
 = 
¬¿y
();

37 
public
 
	m$SubNbr
 = 0;

38 
public
 
	m$PrmL¡
 = 
¬¿y
();

39 
public
 
	m$PrmIfNbr
 = 
çl£
;

40 
public
 
	m$MagÃtId
 = 
çl£
;

41 
public
 
	m$BlockFound
 = 
çl£
;

42 
public
 
	m$Fœ¡M”ge
 = 
Œue
;

43 
public
 
	m$CÚvPrÙeù
 = 
Œue
;

44 
public
 
	m$CÚvSŒ
 = 
Œue
;

45 
public
 
	m$CÚvMode
 = 1;

46 
public
 
	m$CÚvBr
 = 
Œue
;

51 şas 
	cşsTbsD©aSourû
 {

53 
public
 
	m$Ty³
 = 
çl£
;

54 
public
 
	m$SubTy³
 = 0;

55 
public
 
	m$SrcId
 = 
çl£
;

56 
public
 
	m$Qu”y
 = '';

57 
public
 
	m$RecS‘
 = 
çl£
;

58 
public
 
	m$RecKey
 = '';

59 
public
 
	m$RecNum
 = 0;

60 
public
 
	m$RecNumIn™
 = 0;

61 
public
 
	m$RecSavšg
 = 
çl£
;

62 
public
 
	m$RecSaved
 = 
çl£
;

63 
public
 
	m$RecBufãr
 = 
çl£
;

64 
public
 
	m$Cu¼Rec
 = 
çl£
;

65 
public
 
	m$TBS
 = 
çl£
;

66 
public
 
	m$OnD©aOk
 = 
çl£
;

67 
public
 
	m$OnD©aPrm
 = 
çl£
;

68 
public
 
	m$OnD©aPrmDÚe
 = 
¬¿y
();

69 
public
 
	m$OnD©aPi
 = 
çl£
;

71 
public
 
funùiÚ
 
	$D©aAË¹
(
$Msg
) {

72 ià(
	`is_¬¿y
(
$this
->
TBS
->
_Cu¼Block
)) {

73  
$this
->
TBS
->
	`m‘h_Misc_AË¹
('wh’ m”gšg block "'.
	`im¶ode
(',',$this->TBS->
_Cu¼Block
).'"',
$Msg
);

75  
$this
->
TBS
->
	`m‘h_Misc_AË¹
('wh’ m”gšg block '.$this->TBS->
_ChrO³n
.$this->TBS->
_Cu¼Block
.$this->TBS->
_ChrClo£
,
$Msg
);

79 
public
 
funùiÚ
 
	$D©aP»·»
(&
$SrcId
,&
$TBS
) {

81 
$this
->
SrcId
 = &
$SrcId
;

82 
$this
->
TBS
 = &
$TBS
;

83 
$FùInfo
 = 
çl£
;

84 
$FùObj
 = 
çl£
;

86 ià(
	`is_¬¿y
(
$SrcId
)) {

87 
$this
->
Ty³
 = 0;

88 } 
	`–£if
 (
	`is_»sourû
(
$SrcId
)) {

90 
$Key
 = 
	`g‘_»sourû_ty³
(
$SrcId
);

91 
$Key
) {

92 'mysqÈlšk' : 
$this
->
Ty³
 = 6; ;

93 'mysqÈlšk…”si¡’t' : 
$this
->
Ty³
 = 6; ;

94 'mysqÈ»suÉ' : 
$this
->
Ty³
 = 6; $this->
SubTy³
 = 1; ;

95 'pgsqÈlšk' : 
$this
->
Ty³
 = 7; ;

96 'pgsqÈlšk…”si¡’t' : 
$this
->
Ty³
 = 7; ;

97 'pgsqÈ»suÉ' : 
$this
->
Ty³
 = 7; $this->
SubTy³
 = 1; ;

98 'sql™d©aba£' : 
$this
->
Ty³
 = 8; ;

99 'sql™d©aba£ (³rsi¡’t)' : 
$this
->
Ty³
 = 8; ;

100 'sql™»suÉ' : 
$this
->
Ty³
 = 8; $this->
SubTy³
 = 1; ;

102 
$FùInfo
 = 
$Key
;

103 
$FùC©
 = 'r';

106 } 
	`–£if
 (
	`is_¡ršg
(
$SrcId
)) {

108 
	`¡¹Şow”
(
$SrcId
)) {

109 '¬¿y' : 
$this
->
Ty³
 = 0; $this->
SubTy³
 = 1; ;

110 'ş—r' : 
$this
->
Ty³
 = 0; $this->
SubTy³
 = 3; ;

111 'mysql' : 
$this
->
Ty³
 = 6; $this->
SubTy³
 = 2; ;

112 '‹xt' : 
$this
->
Ty³
 = 2; ;

113 'num' : 
$this
->
Ty³
 = 1; ;

115 
$FùInfo
 = 
$SrcId
;

116 
$FùC©
 = 'k';

119 } 
	`–£if
 (
$SrcId
 
š¡ªûof
 
I‹¿tÜ
) {

120 
$this
->
Ty³
 = 9; $this->
SubTy³
 = 1;

121 } 
	`–£if
 (
$SrcId
 
š¡ªûof
 
A¼ayObjeù
) {

122 
$this
->
Ty³
 = 9; $this->
SubTy³
 = 2;

123 } 
	`–£if
 (
$SrcId
 
š¡ªûof
 
I‹¿tÜAgg»g©e
) {

124 
$this
->
Ty³
 = 9; $this->
SubTy³
 = 3;

125 } 
	`–£if
 (
$SrcId
 
š¡ªûof
 
MySQLi
) {

126 
$this
->
Ty³
 = 10;

127 } 
	`–£if
 (
$SrcId
 
š¡ªûof
 
PDO
) {

128 
$this
->
Ty³
 = 11;

129 } 
	`–£if
 (
$SrcId
 
š¡ªûof
 
Z’d_Db_Ad­‹r_Ab¡¿ù
) {

130 
$this
->
Ty³
 = 12;

131 } 
	`–£if
 (
	`is_objeù
(
$SrcId
)) {

132 
$FùInfo
 = 
	`g‘_şass
(
$SrcId
);

133 
$FùC©
 = 'o';

134 
$FùObj
 = &
$SrcId
;

135 
$this
->
SrcId
 = &
$SrcId
;

136 } 
	`–£if
 (
$SrcId
===
çl£
) {

137 
$this
->
	`D©aAË¹
('the specified source is seto FALSE. Maybe your connection has failed.');

139 
$this
->
	`D©aAË¹
('unsuµÜ‹d v¬ŸbËy³ : \''.
	`g‘ty³
(
$SrcId
).'\'.');

142 ià(
$FùInfo
!==
çl£
) {

143 
$E¼Msg
 = 
çl£
;

144 ià(
$TBS
->
	`m‘h_Misc_U£rFùCheck
(
$FùInfo
,
$FùC©
,
$FùObj
,
$E¼Msg
,
çl£
)) {

145 
$this
->
Ty³
 = 
$FùInfo
['type'];

146 ià(
$this
->
Ty³
!==5) {

147 ià(
$this
->
Ty³
===4) {

148 
$this
->
FùPrm
 = 
	`¬¿y
(
çl£
,0);

149 
$this
->
SrcId
 = &
$FùInfo
['open'][0];

151 
$this
->
FùO³n
 = &
$FùInfo
['open'];

152 
$this
->
FùF‘ch
 = &
$FùInfo
['fetch'];

153 
$this
->
FùClo£
 = &
$FùInfo
['close'];

156 
$this
->
Ty³
 = $this->
	`D©aAË¹
(
$E¼Msg
);

160  (
$this
->
Ty³
!==
çl£
);

162 
	}
}

164 
public
 
funùiÚ
 
	$D©aO³n
(&
$Qu”y
,
$QryPrms
=
çl£
) {

167 
	`un£t
(
$this
->
Cu¼Rec
); $this->Cu¼Reøğ
Œue
;

168 ià(
$this
->
RecSaved
) {

169 
$this
->
Fœ¡Rec
 = 
Œue
;

170 
	`un£t
(
$this
->
RecKey
); $this->RecKey = '';

171 
$this
->
RecNum
 = $this->
RecNumIn™
;

172 ià(
$this
->
OnD©aOk
è$this->
OnD©aArgs
[1] = &$this->
Cu¼Rec
;

173  
Œue
;

175 
	`un£t
(
$this
->
RecS‘
); $this->RecS‘ = 
çl£
;

176 
$this
->
RecNumIn™
 = 0;

177 
$this
->
RecNum
 = 0;

179 ià(
	`is£t
(
$this
->
TBS
->
_piOnD©a
)) {

180 
$this
->
OnD©aPi
 = 
Œue
;

181 
$this
->
OnD©aPiRef
 = &$this->
TBS
->
_piOnD©a
;

182 
$this
->
OnD©aOk
 = 
Œue
;

184 ià(
$this
->
OnD©aOk
) {

185 
$this
->
OnD©aArgs
 = 
	`¬¿y
();

186 
$this
->
OnD©aArgs
[0] = &$this->
TBS
->
_Cu¼Block
;

187 
$this
->
OnD©aArgs
[1] = &$this->
Cu¼Rec
;

188 
$this
->
OnD©aArgs
[2] = &$this->
RecNum
;

189 
$this
->
OnD©aArgs
[3] = &$this->
TBS
;

192 
$this
->
Ty³
) {

194 ià((
$this
->
SubTy³
===1è
	`ªd
 (
	`is_¡ršg
(
$Qu”y
))) $this->SubType = 2;

195 ià(
$this
->
SubTy³
===0) {

196 
$this
->
RecS‘
 = &$this->
SrcId
;

197 } 
	`–£if
 (
$this
->
SubTy³
===1) {

198 ià(
	`is_¬¿y
(
$Qu”y
)) {

199 
$this
->
RecS‘
 = &
$Qu”y
;

201 
$this
->
	`D©aAË¹
('ty³ \''.
	`g‘ty³
(
$Qu”y
).'\'‚ot supported forhe Query Parameter going with \'array\' Source Type.');

203 } 
	`–£if
 (
$this
->
SubTy³
===2) {

205 
$x
 = 
	`Œim
(
$Qu”y
);

206 
$z
 = 
	`chr
(0);

207 
$x
 = 
	`¡r_»¶aû
(
	`¬¿y
(']->','][','->','['),
$z
,$x);

208 ià(
	`sub¡r
(
$x
,
	`¡¾’
($x)-1,1)===']') $x = substr($x,0,strlen($x)-1);

209 
$I‹mL¡
 = 
	`ex¶ode
(
$z
,
$x
);

210 
$I‹mNbr
 = 
	`couÁ
(
$I‹mL¡
);

211 
$I‹m0
 = &
$I‹mL¡
[0];

213 ià(
$I‹m0
[0]==='~') {

214 
$I‹m0
 = 
	`sub¡r
($Item0,1);

215 ià(
$this
->
TBS
->
ObjeùRef
!==
çl£
) {

216 
$V¬
 = &
$this
->
TBS
->
ObjeùRef
;

217 
$i
 = 0;

219 
$i
 = 
$this
->
	`D©aAË¹
('šv®id qu”y \''.
$Qu”y
.'\' because…roperty ObjectRef is‚ot set.');

222 ià(
	`is£t
(
$this
->
TBS
->
V¬Ref
[
$I‹m0
])) {

223 
$V¬
 = &
$this
->
TBS
->
V¬Ref
[
$I‹m0
];

224 
$i
 = 1;

226 
$i
 = 
$this
->
	`D©aAË¹
('šv®id qu”y \''.
$Qu”y
.'\' beÿu£ V¬Reà™em \''.
$I‹m0
.'\' is‚ot found.');

230 
$Em±y
 = 
çl£
;

231 (
$i
!==
çl£
è
	`ªd
 ($i<
$I‹mNbr
èªd (
$Em±y
===false)) {

232 
$x
 = 
$I‹mL¡
[
$i
];

233 ià(
	`is_¬¿y
(
$V¬
)) {

234 ià(
	`is£t
(
$V¬
[
$x
])) {

235 
$V¬
 = &$V¬[
$x
];

237 
$Em±y
 = 
Œue
;

239 } 
	`–£if
 (
	`is_objeù
(
$V¬
)) {

240 
$ArgL¡
 = 
$this
->
TBS
->
	`f_Misc_CheckArgL¡
(
$x
);

241 ià(
	`m‘hod_exi¡s
(
$V¬
,
$x
)) {

242 
$f
 = 
	`¬¿y
(&
$V¬
,
$x
); 
	`un£t
($Var);

243 
$V¬
 = 
	`ÿÎ_u£r_func_¬¿y
(
$f
,
$ArgL¡
);

244 } 
	`–£if
 (
	`´İ”ty_exi¡s
(
	`g‘_şass
(
$V¬
),
$x
)) {

245 ià(
	`is£t
(
$V¬
->
$x
)) $Var = &$Var->$x;

246 } 
	`–£if
 (
	`is£t
(
$V¬
->
$x
)) {

247 
$V¬
 = $V¬->
$x
;

249 
$Em±y
 = 
Œue
;

252 
$i
 = 
$this
->
	`D©aAË¹
('šv®id qu”y \''.
$Qu”y
.'\' beÿu£ i‹m \''.
$I‹mL¡
[$i].'\' i Ã™h”‡ÀA¼ay‚Ü‡ÀObjeù. It ty³ i \''.
	`g‘ty³
(
$V¬
).'\'.');

254 ià(
$i
!==
çl£
) $i++;

257 ià(
$i
!==
çl£
) {

258 ià(
$Em±y
) {

259 
$this
->
RecS‘
 = 
	`¬¿y
();

261 
$this
->
RecS‘
 = &
$V¬
;

264 } 
	`–£if
 (
$this
->
SubTy³
===3) {

265 
$this
->
RecS‘
 = 
	`¬¿y
();

268 ià(
$this
->
RecS‘
!==
çl£
) {

269 
$this
->
RecNbr
 = $this->
RecNumIn™
 + 
	`couÁ
($this->
RecS‘
);

270 
$this
->
Fœ¡Rec
 = 
Œue
;

271 
$this
->
RecSaved
 = 
Œue
;

272 
$this
->
RecSavšg
 = 
çl£
;

276 
$this
->
SubTy³
) {

277 0: 
$this
->
RecS‘
 = @
	`mysql_qu”y
(
$Qu”y
,$this->
SrcId
); ;

278 1: 
$this
->
RecS‘
 = $this->
SrcId
; ;

279 2: 
$this
->
RecS‘
 = @
	`mysql_qu”y
(
$Qu”y
); ;

281 ià(
$this
->
RecS‘
===
çl£
è$this->
	`D©aAË¹
('MySqÈ”rÜ mes§gwh’ o³nšghqu”y: '.
	`mysql_”rÜ
());

284 
$this
->
RecS‘
 = 
Œue
;

285 
$this
->
NumMš
 = 1;

286 
$this
->
NumMax
 = 1;

287 
$this
->
NumS‹p
 = 1;

288 ià(
	`is_¬¿y
(
$Qu”y
)) {

289 ià(
	`is£t
(
$Qu”y
['mš'])è
$this
->
NumMš
 = $Query['min'];

290 ià(
	`is£t
(
$Qu”y
['¡•'])è
$this
->
NumS‹p
 = $Query['step'];

291 ià(
	`is£t
(
$Qu”y
['max'])) {

292 
$this
->
NumMax
 = 
$Qu”y
['max'];

294 
$this
->
RecS‘
 = $this->
	`D©aAË¹
('the \'num\' source is‡n‡rrayhat has‚o value forhe \'max\' key.');

296 ià(
$this
->
NumS‹p
==0è$this->
RecS‘
 = $this->
	`D©aAË¹
('the \'num\' source is‡n‡rrayhat has‡ step value seto zero.');

298 
$this
->
NumMax
 = 
	`û
(
$Qu”y
);

300 ià(
$this
->
RecS‘
) {

301 ià(
$this
->
NumS‹p
>0) {

302 
$this
->
NumV®
 = $this->
NumMš
;

304 
$this
->
NumV®
 = $this->
NumMax
;

309 ià(
	`is_¡ršg
(
$Qu”y
)) {

310 
$this
->
RecS‘
 = &
$Qu”y
;

312 
$this
->
RecS‘
 = ''.
$Qu”y
;

316 
$FùO³n
 = 
$this
->
FùO³n
;

317 
$this
->
RecS‘
 = 
	`$FùO³n
($this->
SrcId
,
$Qu”y
,
$QryPrms
);

318 ià(
$this
->
RecS‘
===
çl£
è$this->
	`D©aAË¹
('funùiÚ '.
$FùO³n
.'(èha çedØİ’ qu”y {'.
$Qu”y
.'}');

321 
$this
->
RecS‘
 = 
	`ÿÎ_u£r_func_¬¿y
($this->
FùO³n
,
	`¬¿y
(&$this->
SrcId
,&
$Qu”y
,&
$QryPrms
));

322 ià(
$this
->
RecS‘
===
çl£
è$this->
	`D©aAË¹
('m‘hod '.
	`g‘_şass
($this->
FùO³n
[0]).'::'.$this->FùO³n[1].'(èha çedØİ’ qu”y {'.
$Qu”y
.'}');

325 
$this
->
RecS‘
 = $this->
SrcId
->
	`tbsdb_İ’
($this->SrcId,
$Qu”y
,
$QryPrms
);

326 ià(
$this
->
RecS‘
===
çl£
è$this->
	`D©aAË¹
('m‘hod '.
	`g‘_şass
($this->
SrcId
).'::tbsdb_İ’(èha çedØİ’ qu”y {'.
$Qu”y
.'}');

329 
$this
->
SubTy³
) {

330 0: 
$this
->
RecS‘
 = @
	`pg_qu”y
($this->
SrcId
,
$Qu”y
); ;

331 1: 
$this
->
RecS‘
 = $this->
SrcId
; ;

333 ià(
$this
->
RecS‘
===
çl£
è$this->
	`D©aAË¹
('Po¡g»SQLƒ¼Ü mes§gwh’ o³nšghqu”y: '.
	`pg_Ï¡_”rÜ
($this->
SrcId
));

336 
$this
->
SubTy³
) {

337 0: 
$this
->
RecS‘
 = @
	`sql™e_qu”y
($this->
SrcId
,
$Qu”y
); ;

338 1: 
$this
->
RecS‘
 = $this->
SrcId
; ;

340 ià(
$this
->
RecS‘
===
çl£
è$this->
	`D©aAË¹
('SQL™”rÜ mes§gwh’ o³nšghqu”y:'.
	`sql™e_”rÜ_¡ršg
(
	`sql™e_Ï¡_”rÜ
($this->
SrcId
)));

343 ià(
$this
->
SubTy³
==1) {

344 
$this
->
RecS‘
 = $this->
SrcId
;

346 
$this
->
RecS‘
 = $this->
SrcId
->
	`g‘I‹¿tÜ
();

348 
$this
->
RecS‘
->
	`»wšd
();

351 
$this
->
RecS‘
 = $this->
SrcId
->
	`qu”y
(
$Qu”y
);

352 ià(
$this
->
RecS‘
===
çl£
è$this->
	`D©aAË¹
('MySQL˜”rÜ mes§gwh’ o³nšghqu”y:'.$this->
SrcId
->
”rÜ
);

355 
$this
->
RecS‘
 = $this->
SrcId
->
	`´•¬e
(
$Qu”y
);

356 ià(
$this
->
RecS‘
===
çl£
) {

357 
$ok
 = 
çl£
;

359 ià(!
	`is_¬¿y
(
$QryPrms
)è$QryPrm ğ
	`¬¿y
();

360 
$ok
 = 
$this
->
RecS‘
->
	`execu‹
(
$QryPrms
);

362 ià(!
$ok
) {

363 
$”r
 = 
$this
->
SrcId
->
	`”rÜInfo
();

364 
$this
->
	`D©aAË¹
('PDOƒ¼Ü mes§gwh’ o³nšghqu”y:'.
$”r
[2]);

368 
Œy
 {

369 ià(!
	`is_¬¿y
(
$QryPrms
)è$QryPrm ğ
	`¬¿y
();

370 
$this
->
RecS‘
 = $this->
SrcId
->
	`qu”y
(
$Qu”y
, 
$QryPrms
);

371 } 
	`ÿtch
 (
Exû±iÚ
 
$e
) {

372 
$this
->
	`D©aAË¹
('Z’d_DB_Ad­‹¸”rÜ mes§gwh’ o³nšghqu”y: '.
$e
->
	`g‘Mes§ge
());

377 ià((
$this
->
Ty³
===0è
	`Ü
 ($this->Type===9)) {

378 
	`un£t
(
$this
->
RecKey
); $this->RecKey = '';

380 ià(
$this
->
RecSavšg
) {

381 
	`un£t
(
$this
->
RecBufãr
); $this->RecBufã¸ğ
	`¬¿y
();

383 
$this
->
RecKey
 = &$this->
RecNum
;

386  (
$this
->
RecS‘
!==
çl£
);

388 
	}
}

390 
public
 
funùiÚ
 
	$D©aF‘ch
() {

392 ià(
$this
->
RecSaved
) {

393 ià(
$this
->
RecNum
<$this->
RecNbr
) {

394 ià(
$this
->
Fœ¡Rec
) {

395 ià(
$this
->
SubTy³
===2) {

396 
	`»£t
(
$this
->
RecS‘
);

397 
$this
->
RecKey
 = 
	`key
($this->
RecS‘
);

398 
$this
->
Cu¼Rec
 = &$this->
RecS‘
[$this->
RecKey
];

400 
$this
->
Cu¼Rec
 = 
	`»£t
($this->
RecS‘
);

401 
$this
->
RecKey
 = 
	`key
($this->
RecS‘
);

403 
$this
->
Fœ¡Rec
 = 
çl£
;

405 ià(
$this
->
SubTy³
===2) {

406 
	`Ãxt
(
$this
->
RecS‘
);

407 
$this
->
RecKey
 = 
	`key
($this->
RecS‘
);

408 
$this
->
Cu¼Rec
 = &$this->
RecS‘
[$this->
RecKey
];

410 
$this
->
Cu¼Rec
 = 
	`Ãxt
($this->
RecS‘
);

411 
$this
->
RecKey
 = 
	`key
($this->
RecS‘
);

414 ià((!
	`is_¬¿y
(
$this
->
Cu¼Rec
)è
	`ªd
 (!
	`is_objeù
($this->Cu¼Rec))è$this->Cu¼Reøğ
	`¬¿y
('key'=>$this->
RecKey
, 'val'=>$this->CurrRec);

415 
$this
->
RecNum
++;

416 ià(
$this
->
OnD©aOk
) {

417 
$this
->
OnD©aArgs
[1] = &$this->
Cu¼Rec
;

418 ià(
$this
->
OnD©aPrm
è
	`ÿÎ_u£r_func_¬¿y
($this->
OnD©aPrmRef
,$this->
OnD©aArgs
);

419 ià(
$this
->
OnD©aPi
è$this->
TBS
->
	`m‘h_PlugIn_RunAÎ
($this->
OnD©aPiRef
,$this->
OnD©aArgs
);

420 ià(
$this
->
SubTy³
!==2è$this->
RecS‘
[$this->
RecKey
] = $this->
Cu¼Rec
;

423 
	`un£t
(
$this
->
Cu¼Rec
); $this->Cu¼Reøğ
çl£
;

428 
$this
->
Ty³
) {

430 
$this
->
Cu¼Rec
 = 
	`mysql_ãtch_assoc
($this->
RecS‘
);

433 ià((
$this
->
NumV®
>=$this->
NumMš
è
	`ªd
 ($this->NumV®<=$this->
NumMax
)) {

434 
$this
->
Cu¼Rec
 = 
	`¬¿y
('v®'=>$this->
NumV®
);

435 
$this
->
NumV®
 +ğ$this->
NumS‹p
;

437 
$this
->
Cu¼Rec
 = 
çl£
;

441 ià(
$this
->
RecNum
===0) {

442 ià(
$this
->
RecS‘
==='') {

443 
$this
->
Cu¼Rec
 = 
çl£
;

445 
$this
->
Cu¼Rec
 = &$this->
RecS‘
;

448 
$this
->
Cu¼Rec
 = 
çl£
;

452 
$FùF‘ch
 = 
$this
->
FùF‘ch
;

453 
$this
->
Cu¼Rec
 = 
	`$FùF‘ch
($this->
RecS‘
,$this->
RecNum
+1);

456 
$this
->
FùPrm
[0] = &$this->
RecS‘
; $this->FùPrm[1] = $this->
RecNum
+1;

457 
$this
->
Cu¼Rec
 = 
	`ÿÎ_u£r_func_¬¿y
($this->
FùF‘ch
,$this->
FùPrm
);

460 
$this
->
Cu¼Rec
 = $this->
SrcId
->
	`tbsdb_ãtch
($this->
RecS‘
,$this->
RecNum
+1);

463 
$this
->
Cu¼Rec
 = 
	`pg_ãtch_assoc
($this->
RecS‘
);

466 
$this
->
Cu¼Rec
 = 
	`sql™e_ãtch_¬¿y
($this->
RecS‘
,
SQLITE_ASSOC
);

469 ià(
$this
->
RecS‘
->
	`v®id
()) {

470 
$this
->
Cu¼Rec
 = $this->
RecS‘
->
	`cu¼’t
();

471 
$this
->
RecKey
 = $this->
RecS‘
->
	`key
();

472 
$this
->
RecS‘
->
	`Ãxt
();

474 
$this
->
Cu¼Rec
 = 
çl£
;

478 
$this
->
Cu¼Rec
 = $this->
RecS‘
->
	`ãtch_assoc
();

479 ià(
	`is_nuÎ
(
$this
->
Cu¼Rec
)è$this->Cu¼Reøğ
çl£
;

482 
$this
->
Cu¼Rec
 = $this->
RecS‘
->
	`ãtch
(
PDO
::
FETCH_ASSOC
);

485 
$this
->
Cu¼Rec
 = $this->
RecS‘
->
	`ãtch
(
Z’d_Db
::
FETCH_ASSOC
);

490 ià(
$this
->
Cu¼Rec
!==
çl£
) {

491 
$this
->
RecNum
++;

492 ià(
$this
->
OnD©aOk
) {

493 ià(
$this
->
OnD©aPrm
è
	`ÿÎ_u£r_func_¬¿y
($this->
OnD©aPrmRef
,$this->
OnD©aArgs
);

494 ià(
$this
->
OnD©aPi
è$this->
TBS
->
	`m‘h_PlugIn_RunAÎ
($this->
OnD©aPiRef
,$this->
OnD©aArgs
);

496 ià(
$this
->
RecSavšg
è$this->
RecBufãr
[$this->
RecKey
] = $this->
Cu¼Rec
;

499 
	}
}

501 
public
 
funùiÚ
 
	$D©aClo£
() {

502 
$this
->
OnD©aOk
 = 
çl£
;

503 
$this
->
OnD©aPrm
 = 
çl£
;

504 
$this
->
OnD©aPi
 = 
çl£
;

505 ià(
$this
->
RecSaved
) ;

506 
$this
->
Ty³
) {

507 6: 
	`mysql_ä“_»suÉ
(
$this
->
RecS‘
); ;

508 3: 
$FùClo£
=
$this
->
FùClo£
; 
	`$FùClo£
($this->
RecS‘
); ;

509 4: 
	`ÿÎ_u£r_func_¬¿y
(
$this
->
FùClo£
,
	`¬¿y
(&$this->
RecS‘
)); ;

510 5: 
$this
->
SrcId
->
	`tbsdb_şo£
($this->
RecS‘
); ;

511 7: 
	`pg_ä“_»suÉ
(
$this
->
RecS‘
); ;

512 10: 
$this
->
RecS‘
->
	`ä“
(); ;

515 ià(
$this
->
RecSavšg
) {

516 
$this
->
RecS‘
 = &$this->
RecBufãr
;

517 
$this
->
RecNbr
 = $this->
RecNumIn™
 + 
	`couÁ
($this->
RecS‘
);

518 
$this
->
RecSavšg
 = 
çl£
;

519 
$this
->
RecSaved
 = 
Œue
;

521 
	}
}

527 şas 
	cşsTšyButSŒÚg
 {

530 
public
 
	m$Sourû
 = '';

531 
public
 
	m$R’d”
 = 3;

532 
public
 
	m$T¶V¬s
 = 
¬¿y
();

533 
public
 
	m$ObjeùRef
 = 
çl£
;

534 
public
 
	m$NoE¼
 = 
çl£
;

535 
public
 
	m$AssigÃd
 = 
¬¿y
();

537 
public
 
	m$V”siÚ
 = '3.8.1';

538 
public
 
	m$Ch¬£t
 = '';

539 
public
 
	m$TurboBlock
 = 
Œue
;

540 
public
 
	m$V¬P»fix
 = '';

541 
public
 
	m$V¬Ref
 = 
nuÎ
;

542 
public
 
	m$FùP»fix
 = '';

543 
public
 
	m$PrÙeù
 = 
Œue
;

544 
public
 
	m$E¼CouÁ
 = 0;

545 
public
 
	m$E¼Msg
 = '';

546 
public
 
	m$A‰D–im
 = 
çl£
;

547 
public
 
	m$M‘hodsAÎowed
 = 
çl£
;

548 
public
 
	m$OnLßd
 = 
Œue
;

549 
public
 
	m$OnShow
 = 
Œue
;

550 
public
 
	m$InşudeP©h
 = 
¬¿y
();

551 
public
 
	m$Ex‹ndedM‘hods
 = 
¬¿y
();

552 
public
 
	m$T¶StÜe
 = 
¬¿y
();

554 
public
 
	m$_E¼MsgName
 = '';

555 
public
 
	m$_La¡Fe
 = '';

556 
public
 
	m$_Ch¬£tFù
 = 
çl£
;

557 
public
 
	m$_Mode
 = 0;

558 
public
 
	m$_Cu¼Block
 = '';

559 
public
 
	m$_ChrO³n
 = '[';

560 
public
 
	m$_ChrClo£
 = ']';

561 
public
 
	m$_ChrV®
 = '[val]';

562 
public
 
	m$_ChrPrÙeù
 = '&#91;';

563 
public
 
	m$_PlugIns
 = 
¬¿y
();

564 
public
 
	m$_PlugIns_Ok
 = 
çl£
;

565 
public
 
	m$_piOnFrm_Ok
 = 
çl£
;

567 
funùiÚ
 
__cÚ¡ruù
(
$O±iÚs
=
nuÎ
,
$V¬P»fix
='',
$FùP»fix
='') {

570 ià(
is_¡ršg
(
$O±iÚs
)) {

571 
$Chrs
 = 
$O±iÚs
;

572 
	m$O±iÚs
 = 
¬¿y
('v¬_´efix'=>
$V¬P»fix
, 'fù_´efix'=>
$FùP»fix
);

573 ià(
	m$Chrs
!=='') {

574 
$E¼
 = 
Œue
;

575 
	m$L’
 = 
¡¾’
(
$Chrs
);

576 ià(
	m$L’
===2) {

577 
$O±iÚs
['chr_İ’'] = 
$Chrs
[0];

578 
	m$O±iÚs
['chr_şo£'] = 
$Chrs
[1];

579 
	m$E¼
 = 
çl£
;

581 
	m$Pos
 = 
¡½os
(
$Chrs
,',');

582 ià((
	m$Pos
!==
çl£
è
ªd
 (
$Pos
>0èªd ($Pos<
$L’
-1)) {

583 
$O±iÚs
['chr_İ’'] = 
sub¡r
(
$Chrs
,0,
$Pos
);

584 
	m$O±iÚs
['chr_şo£'] = 
sub¡r
(
$Chrs
,
$Pos
+1);

585 
	m$E¼
 = 
çl£
;

588 ià(
	m$E¼
è
	m$this
->
m‘h_Misc_AË¹
('w™h clsTšyButSŒÚg(èfunùiÚ','v®u\''.
$Chrs
.'\' is‡ badag delimitor definition.');

593 
	m$this
->
	mV¬Ref
 =& 
$GLOBALS
;

594 ià(
is_¬¿y
(
$O±iÚs
)è
	m$this
->
S‘O±iÚ
($Options);

597 
glob®
 
	m$_TBS_FÜm©L¡
, 
	m$_TBS_U£rFùL¡
, 
	m$_TBS_BlockAlŸs
, 
	m$_TBS_AutoIn¡®lPlugIns
;

598 ià(!
is£t
(
$_TBS_FÜm©L¡
)è
	m$_TBS_FÜm©L¡
 = 
¬¿y
();

599 ià(!
is£t
(
$_TBS_U£rFùL¡
)è
	m$_TBS_U£rFùL¡
 = 
¬¿y
();

600 ià(!
is£t
(
$_TBS_BlockAlŸs
)è
	m$_TBS_BlockAlŸs
 = 
¬¿y
();

601 
	m$this
->
	m_U£rFùL¡
 = &
$_TBS_U£rFùL¡
;

604 ià(
is£t
(
$_TBS_AutoIn¡®lPlugIns
)è
fÜ—ch
 ($_TBS_AutoIn¡®lPlugIn 
as
 
$pi
è
	m$this
->
PlugIn
(
TBS_INSTALL
,$pi);

608 
funùiÚ
 
	$__ÿÎ
(
$m‘h
, 
$¬gs
) {

609 ià(
	`is£t
(
$this
->
Ex‹ndedM‘hods
[
$m‘h
])) {

610 iàĞ
	`is_¬¿y
(
$this
->
Ex‹ndedM‘hods
[
$m‘h
]è|| 
	`is_¡ršg
($this->ExtendedMethods[$meth]) ) {

611  
	`ÿÎ_u£r_func_¬¿y
(
$this
->
Ex‹ndedM‘hods
[
$m‘h
], 
$¬gs
);

613  
	`ÿÎ_u£r_func_¬¿y
(
	`¬¿y
(&
$this
->
Ex‹ndedM‘hods
[
$m‘h
], $m‘h), 
$¬gs
);

616 
$this
->
	`m‘h_Misc_AË¹
('M‘hod‚Ù found','\''.
$m‘h
.'\' is‚either‡‚ative‚or‡nƒxtended method of TinyButStrong.');

618 
	}
}

620 
funùiÚ
 
	$S‘O±iÚ
(
$o
, 
$v
=
çl£
, 
$d
=false) {

621 ià(!
	`is_¬¿y
(
$o
)è$Øğ
	`¬¿y
($o=>
$v
);

622 ià(
	`is£t
(
$o
['v¬_´efix'])è
$this
->
V¬P»fix
 = $o['var_prefix'];

623 ià(
	`is£t
(
$o
['fù_´efix'])è
$this
->
FùP»fix
 = $o['fct_prefix'];

624 ià(
	`is£t
(
$o
['nÛ¼'])è
$this
->
NoE¼
 = $o['noerr'];

625 ià(
	`is£t
(
$o
['auto_merge'])) {

626 
$this
->
OnLßd
 = 
$o
['auto_merge'];

627 
$this
->
OnShow
 = 
$o
['auto_merge'];

629 ià(
	`is£t
(
$o
['Úlßd'])è
$this
->
OnLßd
 = $o['onload'];

630 ià(
	`is£t
(
$o
['Úshow'])è
$this
->
OnShow
 = $o['onshow'];

631 ià(
	`is£t
(
$o
['©t_d–im'])è
$this
->
A‰D–im
 = $o['att_delim'];

632 ià(
	`is£t
(
$o
['´Ùeù'])è
$this
->
PrÙeù
 = $o['protect'];

633 ià(
	`is£t
(
$o
['turbo_block'])è
$this
->
TurboBlock
 = $o['turbo_block'];

634 ià(
	`is£t
(
$o
['ch¬£t'])è
$this
->
	`m‘h_Misc_Ch¬£t
($o['charset']);

635 
$Upd©eChr
 = 
çl£
;

636 ià(
	`is£t
(
$o
['chr_open'])) {

637 
$this
->
_ChrO³n
 = 
$o
['chr_open'];

638 
$Upd©eChr
 = 
Œue
;

640 ià(
	`is£t
(
$o
['chr_close'])) {

641 
$this
->
_ChrClo£
 = 
$o
['chr_close'];

642 
$Upd©eChr
 = 
Œue
;

644 ià(
$Upd©eChr
) {

645 
$this
->
_ChrV®
 = $this->
_ChrO³n
.'v®'.$this->
_ChrClo£
;

646 
$this
->
_ChrPrÙeù
 = '&#'.
	`Üd
($this->
_ChrO³n
[0]).';'.
	`sub¡r
($this->_ChrOpen,1);

648 ià(
	`¬¿y_key_exi¡s
('l_äms',
$o
)è
£lf
::
	`f_Misc_Upd©eA¼ay
(
$GLOBALS
['_TBS_FÜm©L¡'], 'äm', $o['l_äms'], 
$d
);

649 ià(
	`¬¿y_key_exi¡s
('block_®Ÿs',
$o
)è
£lf
::
	`f_Misc_Upd©eA¼ay
(
$GLOBALS
['_TBS_BlockAlŸs'], 
çl£
, $o['block_®Ÿs'], 
$d
);

650 ià(
	`¬¿y_key_exi¡s
('šşude_·th',
$o
)è
£lf
::
	`f_Misc_Upd©eA¼ay
(
$this
->
InşudeP©h
, 
Œue
, $o['šşude_·th'], 
$d
);

651 ià(
	`is£t
(
$o
['»nd”'])è
$this
->
R’d”
 = $o['render'];

652 
	}
}

654 
funùiÚ
 
	$G‘O±iÚ
(
$o
) {

655 ià(
$o
==='all') {

656 
$x
 = 
	`ex¶ode
(',', 'var_prefix,fct_prefix,noerr,auto_merge,onload,onshow,att_delim,protect,turbo_block,charset,chr_open,chr_close,tpl_frms,block_alias,include_path,render');

657 
$r
 = 
	`¬¿y
();

658 
	`fÜ—ch
 (
$x
 
as
 
$o
è
$r
[$o] = 
$this
->
	`G‘O±iÚ
($o);

659  
$r
;

661 ià(
$o
==='v¬_´efix'è 
$this
->
V¬P»fix
;

662 ià(
$o
==='fù_´efix'è 
$this
->
FùP»fix
;

663 ià(
$o
==='nÛ¼'è 
$this
->
NoE¼
;

664 ià(
$o
==='auto_m”ge'è (
$this
->
OnLßd
 && $this->
OnShow
);

665 ià(
$o
==='Úlßd'è 
$this
->
OnLßd
;

666 ià(
$o
==='Úshow'è 
$this
->
OnShow
;

667 ià(
$o
==='©t_d–im'è 
$this
->
A‰D–im
;

668 ià(
$o
==='´Ùeù'è 
$this
->
PrÙeù
;

669 ià(
$o
==='turbo_block'è 
$this
->
TurboBlock
;

670 ià(
$o
==='ch¬£t'è 
$this
->
Ch¬£t
;

671 ià(
$o
==='chr_İ’'è 
$this
->
_ChrO³n
;

672 ià(
$o
==='chr_şo£'è 
$this
->
_ChrClo£
;

673 ià(
$o
==='tpl_frms') {

675 
$x
 = 
	`¬¿y
();

676 
	`fÜ—ch
 (
$GLOBALS
['_TBS_FÜm©L¡'] 
as
 
$s
=>
$i
è
$x
[$s] = $i['Str'];

677  
$x
;

679 ià(
$o
==='šşude_·th'è 
$this
->
InşudeP©h
;

680 ià(
$o
==='»nd”'è 
$this
->
R’d”
;

681  
$this
->
	`m‘h_Misc_AË¹
('w™h G‘O±iÚ(èm‘hod','İtiÚ \''.
$o
.'\' is‚ot supported.');;

682 
	}
}

684 
public
 
funùiÚ
 
	$Re£tV¬Ref
(
$ToGlob®
) {

685 ià(
$ToGlob®
) {

686 
$this
->
V¬Ref
 = &
$GLOBALS
;

688 
$x
 = 
	`¬¿y
();

689 
$this
->
V¬Ref
 = &
$x
;

691 
	}
}

694 
public
 
funùiÚ
 
LßdTem¶©e
(
$Fe
,
$Ch¬£t
='') {

695 ià(
$Fe
==='') {

696 
$this
->
m‘h_Misc_Ch¬£t
(
$Ch¬£t
);

697  
	gŒue
;

699 
	g$Ok
 = 
Œue
;

700 ià(
	g$this
->
	g_PlugIns_Ok
) {

701 ià(
is£t
(
$this
->
_piBefÜeLßdTem¶©e
è
Ü
 is£t($this->
_piAá”LßdTem¶©e
)) {

703 
	g$ArgL¡
 = 
func_g‘_¬gs
();

704 
	g$ArgL¡
[0] = &
$Fe
;

705 
	g$ArgL¡
[1] = &
$Ch¬£t
;

706 ià(
is£t
(
$this
->
_piBefÜeLßdTem¶©e
)è
	g$Ok
 = $this->
m‘h_PlugIn_RunAÎ
($this->_piBefÜeLßdTem¶©e,
$ArgL¡
);

710 ià(
	g$Ok
!==
çl£
) {

711 ià(!
is_nuÎ
(
$Fe
)) {

712 
$x
 = '';

713 ià(!
	g$this
->
f_Misc_G‘Fe
(
$x
, 
$Fe
, 
$this
->
_La¡Fe
, $this->
InşudeP©h
)è $this->
m‘h_Misc_AË¹
('with LoadTemplate() method','file \''.$File.'\' is‚ot found or‚ot„eadable.');

714 ià(
	g$Ch¬£t
==='+') {

715 
$this
->
Sourû
 .ğ
$x
;

717 
	g$this
->
	gSourû
 = 
$x
;

720 ià(
	g$this
->
	g_Mode
==0) {

721 ià(!
is_nuÎ
(
$Fe
)è
$this
->
_La¡Fe
 = $File;

722 ià(
	g$Ch¬£t
!=='+'è
$this
->
T¶V¬s
 = 
¬¿y
();

723 
	g$this
->
m‘h_Misc_Ch¬£t
(
$Ch¬£t
);

726 ià(
	g$this
->
	gOnLßd
è$this->
m‘h_M”ge_AutoOn
(
$this
->
Sourû
,'Úlßd',
Œue
,true);

729 ià(
	g$this
->
_PlugIns_Ok
 
ªd
 
is£t
(
$ArgL¡
èªd is£t(
$this
->
_piAá”LßdTem¶©e
)è
	g$Ok
 = $this->
m‘h_PlugIn_RunAÎ
($this->_piAfterLoadTemplate,$ArgLst);

730  
	g$Ok
;

733 
public
 
funùiÚ
 
	$G‘BlockSourû
(
$BlockName
,
$AsA¼ay
=
çl£
,
$DefTags
=
Œue
,
$R•ÏûW™h
=false) {

734 
$R‘V®
 = 
	`¬¿y
();

735 
$Nbr
 = 0;

736 
$Pos
 = 0;

737 
$F›ldOutside
 = 
çl£
;

738 
$P1
 = 
çl£
;

739 
$Mode
 = (
$DefTags
) ? 3 : 2;

740 
$PosBeg1
 = 0;

741 
$PosEndP»c
 = 
çl£
;

742 
$Loc
 = 
$this
->
	`m‘h_LoÿtÜ_FšdBlockNext
($this->
Sourû
,
$BlockName
,
$Pos
,'.',
$Mode
,
$P1
,
$F›ldOutside
)) {

743 
$Nbr
++;

744 
$S•
 = '';

745 ià(
$Nbr
==1) {

746 
$PosBeg1
 = 
$Loc
->
PosBeg
;

747 } 
	`–£if
 (!
$AsA¼ay
) {

748 
$S•
 = 
	`sub¡r
(
$this
->
Sourû
,
$PosS•
,
$Loc
->
PosBeg
-$PosSep);

750 
$R‘V®
[
$Nbr
] = 
$S•
.
$Loc
->
BlockSrc
;

751 
$Pos
 = 
$Loc
->
PosEnd
;

752 
$PosS•
 = 
$Loc
->
PosEnd
+1;

753 
$P1
 = 
çl£
;

755 ià(
$Nbr
==0è 
çl£
;

756 ià(!
$AsA¼ay
) {

757 ià(
$DefTags
) {

759 
$R‘V®
 = 
	`sub¡r
(
$this
->
Sourû
,
$PosBeg1
,
$Pos
-$PosBeg1+1);

762 
$R‘V®
 = 
	`im¶ode
('', $RetVal);

765 ià(
$R•ÏûW™h
!==
çl£
è
$this
->
Sourû
 = 
	`sub¡r
($this->Sourû,0,
$PosBeg1
).$R•ÏûW™h.sub¡r($this->Sourû,
$Pos
+1);

766  
$R‘V®
;

767 
	}
}

769 
public
 
funùiÚ
 
M”geBlock
(
$BlockL¡
,
$SrcId
='assigÃd',
$Qu”y
='',
$QryPrms
=
çl£
) {

771 ià(
$SrcId
==='assigned') {

772 
$Arg
 = 
¬¿y
(
$BlockL¡
,&
$SrcId
,&
$Qu”y
,&
$QryPrms
);

773 ià(!
	g$this
->
m‘h_Misc_Assign
(
$BlockL¡
, 
$Arg
, 'MergeBlock'))  0;

774 
	g$BlockL¡
 = 
$Arg
[0]; 
	g$SrcId
 = &$Arg[1]; 
	g$Qu”y
 = &$Arg[2];

777 ià(
is_¡ršg
(
$BlockL¡
)è
	g$BlockL¡
 = 
ex¶ode
(',',$BlockLst);

779 ià(
	g$SrcId
==='cond') {

780 
$Nbr
 = 0;

781 
fÜ—ch
 (
$BlockL¡
 
as
 
$Block
) {

782 
	g$Block
 = 
Œim
(
$Block
);

783 ià(
	g$Block
!==''è
$Nbr
 +ğ
$this
->
m‘h_M”ge_AutoOn
($this->
Sourû
,
$Block
,
Œue
,true);

785  
	g$Nbr
;

787  
	g$this
->
m‘h_M”ge_Block
(
$this
->
Sourû
,
$BlockL¡
,
$SrcId
,
$Qu”y
,
çl£
,0,
$QryPrms
);

792 
public
 
funùiÚ
 
M”geF›ld
(
$NameL¡
,
$V®ue
='assigÃd',
$IsU£rFù
=
çl£
,
$DeçuÉPrm
=false) {

794 
$FùCheck
 = 
$IsU£rFù
;

795 ià(
	g$PlugIn
 = 
is£t
(
$this
->
_piOnM”geF›ld
)è
$ArgPi
 = 
¬¿y
('','',&
$V®ue
,0,&$this->
Sourû
,0,0);

796 
	g$SubS¹
 = 0;

797 
	g$Ok
 = 
Œue
;

798 
	g$Prm
 = 
is_¬¿y
(
$DeçuÉPrm
);

800 iàĞ(
	g$V®ue
==='assigÃd'è
ªd
 (
$NameL¡
!=='var')‡nd ($NameLst!=='onshow')‡nd ($NameLst!=='onload') ) {

801 
$Arg
 = 
¬¿y
(
$NameL¡
,&
$V®ue
,&
$IsU£rFù
,&
$DeçuÉPrm
);

802 ià(!
	g$this
->
m‘h_Misc_Assign
(
$NameL¡
, 
$Arg
, 'M”geF›ld')è 
	gçl£
;

803 
	g$NameL¡
 = 
$Arg
[0]; 
	g$V®ue
 = &$Arg[1]; 
	g$IsU£rFù
 = &$Arg[2]; 
	g$DeçuÉPrm
 = &$Arg[3];

806 
	g$NameL¡
 = 
ex¶ode
(',',
$NameL¡
);

808 
fÜ—ch
 (
$NameL¡
 
as
 
$Name
) {

809 
	g$Name
 = 
Œim
(
$Name
);

810 
	g$CÚt
 = 
çl£
;

811 
	g$Name
) {

812 '': 
$CÚt
=
Œue
;;

813 'Úlßd': 
$this
->
m‘h_M”ge_AutoOn
($this->
Sourû
,'Úlßd',
Œue
,Œue);
	g$CÚt
=true;;

814 'Úshow': 
$this
->
m‘h_M”ge_AutoOn
($this->
Sourû
,'Úshow',
Œue
,Œue);
	g$CÚt
=true;;

815 'v¬': 
$this
->
m‘h_M”ge_AutoV¬
($this->
Sourû
,
Œue
);
	g$CÚt
=true;;

817 ià(
	g$CÚt
) ;

818 ià(
	g$PlugIn
è
	g$ArgPi
[0] = 
$Name
;

819 
	g$PosBeg
 = 0;

821 ià(
	g$FùCheck
) {

822 
	g$FùInfo
 = 
$V®ue
;

823 
	g$E¼Msg
 = 
çl£
;

824 ià(!
	g$this
->
m‘h_Misc_U£rFùCheck
(
$FùInfo
,'f',
$E¼Msg
,$E¼Msg,
çl£
)è $this->
m‘h_Misc_AË¹
('with MergeField() method',$ErrMsg);

825 
	g$FùArg
 = 
¬¿y
('','');

826 
	g$SubS¹
 = 
çl£
;

827 
	g$FùCheck
 = 
çl£
;

829 
	g$Loc
 = 
$this
->
m‘h_LoÿtÜ_FšdTbs
($this->
Sourû
,
$Name
,
$PosBeg
,'.')) {

830 ià(
	g$Prm
è
	g$Loc
->
	gPrmL¡
 = 
¬¿y_m”ge
(
$DeçuÉPrm
,
$Loc
->
PrmL¡
);

832 ià(
	g$IsU£rFù
) {

833 
	g$FùArg
[0] = &
$Loc
->
SubName
; $FùArg[1] = &$Loc->
PrmL¡
;

834 
	g$V®ue
 = 
ÿÎ_u£r_func_¬¿y
(
$FùInfo
,
$FùArg
);

837 ià(
	g$PlugIn
) {

838 
	g$ArgPi
[1] = 
$Loc
->
SubName
; $ArgPi[3] = &$Loc->
PrmL¡
; $ArgPi[5] = &$Loc->
PosBeg
; $ArgPi[6] = &$Loc->
PosEnd
;

839 
	g$Ok
 = 
$this
->
m‘h_PlugIn_RunAÎ
($this->
_piOnM”geF›ld
,
$ArgPi
);

842 ià(
	g$Ok
) {

843 
	g$PosBeg
 = 
$this
->
m‘h_LoÿtÜ_R•Ïû
($this->
Sourû
,
$Loc
,
$V®ue
,
$SubS¹
);

845 
	g$PosBeg
 = 
$Loc
->
PosEnd
;

851 
public
 
funùiÚ
 
	$Show
(
$R’d”
=
çl£
) {

852 
$Ok
 = 
Œue
;

853 ià(
$R’d”
===
çl£
è$R’d” = 
$this
->
R’d”
;

854 ià(
$this
->
_PlugIns_Ok
) {

855 ià(
	`is£t
(
$this
->
_piBefÜeShow
è
Ü
 is£t($this->
_piAá”Show
)) {

857 
$ArgL¡
 = 
	`func_g‘_¬gs
();

858 
$ArgL¡
[0] = &
$R’d”
;

859 ià(
	`is£t
(
$this
->
_piBefÜeShow
)è
$Ok
 = $this->
	`m‘h_PlugIn_RunAÎ
($this->_piBefÜeShow,
$ArgL¡
);

862 ià(
$Ok
!==
çl£
) {

863 ià(
$this
->
OnShow
è$this->
	`m‘h_M”ge_AutoOn
($this->
Sourû
,'Úshow',
Œue
,true);

864 
$this
->
	`m‘h_M”ge_AutoV¬
($this->
Sourû
,
Œue
);

866 ià(
$this
->
_PlugIns_Ok
 
ªd
 
	`is£t
(
$ArgL¡
èªd is£t($this->
_piAá”Show
)è$this->
	`m‘h_PlugIn_RunAÎ
($this->_piAfterShow,$ArgLst);

867 ià(
$this
->
_E¼MsgName
!==''è$this->
	`M”geF›ld
($this->_E¼MsgName, $this->
E¼Msg
);

868 ià((
$R’d”
 & 
TBS_OUTPUT
)==TBS_OUTPUTè
echo
 
$this
->
Sourû
;

869 ià((
$this
->
_Mode
==0è
	`ªd
 ((
$R’d”
 & 
TBS_EXIT
)==TBS_EXIT)è
ex™
;

870  
$Ok
;

871 
	}
}

873 
public
 
funùiÚ
 
	$PlugIn
(
$Prm1
,
$Prm2
=0) {

875 ià(
	`is_num”ic
(
$Prm1
)) {

876 
$Prm1
) {

877 
TBS_INSTALL
:

878 
$PlugInId
 = 
$Prm2
;

879 ià(
	`is£t
(
$this
->
_PlugIns
[
$PlugInId
])) {

880  
$this
->
	`m‘h_Misc_AË¹
('w™h PlugIn(èm‘hod','¶ug-š \''.
$PlugInId
.'\' is‡lready installed.');

882 
$ArgL¡
 = 
	`func_g‘_¬gs
();

883 
	`¬¿y_shiá
(
$ArgL¡
);‡rray_shift($ArgLst);

884  
$this
->
	`m‘h_PlugIn_In¡®l
(
$PlugInId
,
$ArgL¡
,
çl£
);

886 
TBS_ISINSTALLED
:

887  
	`is£t
(
$this
->
_PlugIns
[
$Prm2
]);

889 
$this
->
_PlugIns_Ok_§ve
 = $this->
_PlugIns_Ok
;

890 
$this
->
_PlugIns_Ok
 = 
çl£
;

891  
Œue
;

893 
$this
->
_piOnFrm_Ok_§ve
 = $this->
_piOnFrm_Ok
;

894 
$this
->
_piOnFrm_Ok
 = 
çl£
;

895  
Œue
;

897 ià(
	`is£t
(
$this
->
_PlugIns_Ok_§ve
)è$this->
_PlugIns_Ok
 = $this->_PlugIns_Ok_save;

898 ià(
	`is£t
(
$this
->
_piOnFrm_Ok_§ve
)è$this->
_piOnFrm_Ok
 = $this->_piOnFrm_Ok_save;

899  
Œue
;

902 } 
	`–£if
 (
	`is_¡ršg
(
$Prm1
)) {

904 
$p
 = 
	`¡½os
(
$Prm1
,'.');

905 ià(
$p
===
çl£
) {

906 
$PlugInId
 = 
$Prm1
;

908 
$PlugInId
 = 
	`sub¡r
(
$Prm1
,0,
$p
);

910 ià(!
	`is£t
(
$this
->
_PlugIns
[
$PlugInId
])) {

911 ià(!
$this
->
	`m‘h_PlugIn_In¡®l
(
$PlugInId
,
	`¬¿y
(),
Œue
)è 
çl£
;

913 ià(!
	`is£t
(
$this
->
_piOnCommªd
[
$PlugInId
])è $this->
	`m‘h_Misc_AË¹
('with PlugIn() method','plug-in \''.$PlugInId.'\' can\'t„un‡ny command becausehe OnCommandƒvent is‚ot defined or‡ctivated.');

914 
$ArgL¡
 = 
	`func_g‘_¬gs
();

915 ià(
$p
===
çl£
è
	`¬¿y_shiá
(
$ArgL¡
);

916 
$Ok
 = 
	`ÿÎ_u£r_func_¬¿y
(
$this
->
_piOnCommªd
[
$PlugInId
],
$ArgL¡
);

917 ià(
	`is_nuÎ
(
$Ok
)è$Ok = 
Œue
;

918  
$Ok
;

920  
$this
->
	`m‘h_Misc_AË¹
('w™h PlugIn(èm‘hod','\''.
$Prm1
.'\' i ª inv®id…lug-š key,hty³ oàthv®ui \''.
	`g‘ty³
($Prm1).'\'.');

922 
	}
}

926 
funùiÚ
 
	$m‘h_LoÿtÜ_FšdTbs
(&
$Txt
,
$Name
,
$Pos
,
$ChrSub
) {

929 
$PosEnd
 = 
çl£
;

930 
$PosMax
 = 
	`¡¾’
(
$Txt
) -1;

931 
$S¹
 = 
$this
->
_ChrO³n
.
$Name
;

935 ià(
$Pos
>
$PosMax
è 
çl£
;

936 
$Pos
 = 
	`¡½os
(
$Txt
,
$S¹
,$Pos);

939 ià(
$Pos
===
çl£
) {

940  
çl£
;

942 
$Loc
 = 
Ãw
 
şsTbsLoÿtÜ
;

943 
$R—dPrm
 = 
çl£
;

944 
$PosX
 = 
$Pos
 + 
	`¡¾’
(
$S¹
);

945 
$x
 = 
$Txt
[
$PosX
];

947 ià(
$x
===
$this
->
_ChrClo£
) {

948 
$PosEnd
 = 
$PosX
;

949 } 
	`–£if
 (
$x
===
$ChrSub
) {

950 
$Loc
->
SubOk
 = 
Œue
;

951 
$R—dPrm
 = 
Œue
;

952 
$PosX
++;

953 } 
	`–£if
 (
	`¡½os
(';',
$x
)!==
çl£
) {

954 
$R—dPrm
 = 
Œue
;

955 
$PosX
++;

957 
$Pos
++;

960 
$Loc
->
PosBeg
 = 
$Pos
;

961 ià(
$R—dPrm
) {

962 
£lf
::
	`f_Loc_PrmR—d
(
$Txt
,
$PosX
,
çl£
,'\'',
$this
->
_ChrO³n
,$this->
_ChrClo£
,
$Loc
,
$PosEnd
);

963 ià(
$PosEnd
===
çl£
) {

964 
$this
->
	`m‘h_Misc_AË¹
('','ÿn\'ˆfoundh’d oàthg \''.
	`sub¡r
(
$Txt
,
$Pos
,
$PosX
-$Pos+10).'...\'.');

965 
$Pos
++;

971 } 
$PosEnd
===
çl£
);

973 
$Loc
->
PosEnd
 = 
$PosEnd
;

974 ià(
$Loc
->
SubOk
) {

975 
$Loc
->
FuÎName
 = 
$Name
.'.'.$Loc->
SubName
;

976 
$Loc
->
SubL¡
 = 
	`ex¶ode
('.',$Loc->
SubName
);

977 
$Loc
->
SubNbr
 = 
	`couÁ
($Loc->
SubL¡
);

979 
$Loc
->
FuÎName
 = 
$Name
;

981 iàĞ
$R—dPrm
 && ( 
	`is£t
(
$Loc
->
PrmL¡
['enlarge']) || isset($Loc->PrmLst['comm']) ) ) {

982 
$Loc
->
PosBeg0
 = $Loc->
PosBeg
;

983 
$Loc
->
PosEnd0
 = $Loc->
PosEnd
;

984 
$’Ïrge
 = (
	`is£t
(
$Loc
->
PrmL¡
['enlarge'])) ? $Loc->PrmLst['enlarge'] : $Loc->PrmLst['comm'];

985 ià((
$’Ïrge
===
Œue
) || ($enlarge==='')) {

986 
$Loc
->
EÆ¬ged
 = 
£lf
::
	`f_Loc_EÆ¬geToSŒ
(
$Txt
,$Loc,'<!--' ,'-->');

988 
$Loc
->
EÆ¬ged
 = 
£lf
::
	`f_Loc_EÆ¬geToTag
(
$Txt
,$Loc,
$’Ïrge
,
çl£
);

992  
$Loc
;

994 
	}
}

996 
	gfunùiÚ
 &
	$m‘h_LoÿtÜ_SeùiÚNewBDef
(&
$LocR
,
$BlockName
,
$Txt
,
$PrmL¡
,
$Cache
) {

998 
$Chk
 = 
Œue
;

999 
$LocL¡
 = 
	`¬¿y
();

1000 
$LocNbr
 = 0;

1002 ià(
$this
->
_PlugIns_Ok
 && 
	`is£t
($this->
_piOnCacheF›ld
)) {

1003 
$pi
 = 
Œue
;

1004 
$ArgL¡
 = 
	`¬¿y
(0=>
$BlockName
, 1=>
çl£
, 2=>&
$Txt
, 3=>¬¿y('©t'=>
Œue
));

1006 
$pi
 = 
çl£
;

1010 
$Cache
 = ($Cach&& 
$this
->
TurboBlock
);

1011 ià(
$Cache
) {

1013 
$Chk
 = 
çl£
;

1014 
$Pos
 = 0;

1015 
$P»vEnd
 = -1;

1016 
$P»vIsAMF
 = 
çl£
;

1017 
$Loc
 = 
$this
->
	`m‘h_LoÿtÜ_FšdTbs
(
$Txt
,
$BlockName
,
$Pos
,'.')) {

1019 
$IsAMF
 = 
çl£
;

1020 
$IsA‰
 = 
çl£
;

1021 
$NewIdx
 = 
çl£
;

1023 ià(
$pi
) {

1024 
$ArgL¡
[1] = &
$Loc
;

1025 
$this
->
	`m‘h_Plugš_RunAÎ
($this->
_piOnCacheF›ld
,
$ArgL¡
);

1028 ià((
$Loc
->
SubName
==='#'è
	`Ü
 ($Loc->SubName==='$')) {

1029 
$Loc
->
IsRecInfo
 = 
Œue
;

1030 
$Loc
->
RecInfo
 = $Loc->
SubName
;

1031 
$Loc
->
SubName
 = '';

1033 
$Loc
->
IsRecInfo
 = 
çl£
;

1036 ià(
$Loc
->
PosBeg
>
$P»vEnd
) {

1037 ià(
	`is£t
(
$Loc
->
PrmL¡
['att'])) {

1038 
$LocSrc
 = 
	`sub¡r
(
$Txt
,
$Loc
->
PosBeg
,$Loc->
PosEnd
-$Loc->PosBeg+1);

1039 
$this
->
	`f_Xml_A‰Fšd
(
$Txt
,
$Loc
,
Œue
,$this->
A‰D–im
);

1040 ià(
	`is£t
(
$Loc
->
PrmL¡
['atttrue'])) {

1041 
$Loc
->
PrmL¡
['magnet'] = '#';

1042 
$Loc
->
PrmL¡
['İe'] = (
	`is£t
($Loc->PrmLst['ope'])) ? $Loc->PrmLst['ope'].',attbool' : 'attbool';

1044 
$IsA‰
 = 
Œue
;

1045 ià(
$Loc
->
A‰FÜw¬d
) {

1046 
$IsAMF
 = 
Œue
;

1048 ià(
$Loc
->
A‰InsL’
>0) {

1049 
$i
=
$LocNbr
;$i>0;$i--) {

1050 ià(
$LocL¡
[
$i
]->
PosEnd
>=
$Loc
->
PosBeg
) {

1051 
$NewIdx
 = 
$i
;

1052 
$li
 = 
$LocL¡
[
$i
];

1053 
$li
->
PosBeg
 +ğ
$Loc
->
A‰InsL’
;

1054 
$li
->
PosEnd
 +ğ
$Loc
->
A‰InsL’
;

1055 
$LocL¡
[
$i
+1] = 
$li
;

1057 
$i
 = 0;

1062 
	`un£t
(
$Loc
->
PrmL¡
['att']);

1064 
$LocNbr
++;

1067 
$Chk
 = 
Œue
;

1068 ià(
$P»vIsAMF
) {

1069 
$l
 = &
$LocL¡
[
$LocNbr
];

1070 
$this
->
	`m‘h_Misc_AË¹
('','TBS i nÙ‡bËØm”gthf›ld '.
$LocSrc
.' because…arameter \'att\' makeshis fied moving forward over‡nother TBS field.');

1074 
$P»vIsAMF
 = 
çl£
;

1075 ià(
$IsA‰
) {

1076 
$Pos
 = 
$Loc
->
P»vPosBeg
;

1077 ià(
$IsAMF
è
$P»vIsAMF
 = 
Œue
;

1078 } 
	`–£if
 (
$Loc
->
EÆ¬ged
) {

1079 
$Pos
 = 
$Loc
->
PosBeg0
+1;

1080 
$Loc
->
EÆ¬ged
 = 
çl£
;

1082 
$Pos
 = 
$Loc
->
PosBeg
+1;

1085 ià(
$NewIdx
===
çl£
) {

1086 
$LocL¡
[
$LocNbr
] = 
$Loc
;

1087 
$P»vEnd
 = 
$Loc
->
PosEnd
;

1089 
$LocL¡
[
$NewIdx
] = 
$Loc
;

1090 
$P»vEnd
 = 
$LocL¡
[
$LocNbr
]->
PosEnd
;

1098 
$o
 = (
objeù
è
nuÎ
;

1099 
$o
->
Prm
 = 
$PrmL¡
;

1100 
$o
->
LocL¡
 = 
$LocL¡
;

1101 
$o
->
LocNbr
 = 
$LocNbr
;

1102 
$o
->
Name
 = 
$BlockName
;

1103 
$o
->
Src
 = 
$Txt
;

1104 
$o
->
Chk
 = 
$Chk
;

1105 
$o
->
IsS”Ÿl
 = 
çl£
;

1106 
$o
->
AutoSub
 = 
çl£
;

1107 
$i
 = 1;

1108 
	`is£t
(
$PrmL¡
['sub'.
$i
])) {

1109 
$o
->
AutoSub
 = 
$i
;

1110 
$i
++;

1113 
$LocR
->
BDefL¡
[] = &
$o
;

1114  
$o
;

1116 
	}
}

1118 
funùiÚ
 
	$m‘h_LoÿtÜ_SeùiÚAddG½
(&
$LocR
,
$BlockName
,&
$BDef
,
$Ty³
,
$F›ld
,
$Prm
) {

1120 
$BDef
->
P»vV®ue
 = 
çl£
;

1121 
$BDef
->
Ty³
 = 
$Ty³
;

1124 
$F›ld0
 = 
$F›ld
;

1125 ià(
	`¡½os
(
$F›ld
,
$this
->
_ChrO³n
)===
çl£
è$F›ld = $this->_ChrO³n.
$BlockName
.'.'.$F›ld.$this->
_ChrClo£
;

1126 
$BDef
->
FDef
 = &
$this
->
	`m‘h_LoÿtÜ_SeùiÚNewBDef
(
$LocR
,
$BlockName
,
$F›ld
,
	`¬¿y
(),
Œue
);

1127 ià(
$BDef
->
FDef
->
LocNbr
==0è
$this
->
	`m‘h_Misc_AË¹
('P¬am‘” '.
$Prm
,'Thv®u\''.
$F›ld0
.'\' is unvalide forhis…arameter.');

1129 ià(
$Ty³
==='H') {

1130 ià(
$LocR
->
H—d”Found
===
çl£
) {

1131 
$LocR
->
H—d”Found
 = 
Œue
;

1132 
$LocR
->
H—d”Nbr
 = 0;

1133 
$LocR
->
H—d”Def
 = 
	`¬¿y
();

1135 
$i
 = ++
$LocR
->
H—d”Nbr
;

1136 
$LocR
->
H—d”Def
[
$i
] = &
$BDef
;

1138 ià(
$LocR
->
FoÙ”Found
===
çl£
) {

1139 
$LocR
->
FoÙ”Found
 = 
Œue
;

1140 
$LocR
->
FoÙ”Nbr
 = 0;

1141 
$LocR
->
FoÙ”Def
 = 
	`¬¿y
();

1143 
$BDef
->
AddLa¡G½
 = (
$Ty³
==='F');

1144 
$i
 = ++
$LocR
->
FoÙ”Nbr
;

1145 
$LocR
->
FoÙ”Def
[
$i
] = &
$BDef
;

1148 
	}
}

1150 
funùiÚ
 
	$m‘h_LoÿtÜ_R•Ïû
(&
$Txt
,&
$Loc
,&
$V®ue
,
$SubS¹
) {

1155 ià((
$SubS¹
!==
çl£
è
ªd
 
$Loc
->
SubOk
) {

1156 
$i
=
$SubS¹
;$i<
$Loc
->
SubNbr
;$i++) {

1157 
$x
 = 
$Loc
->
SubL¡
[
$i
];

1158 ià(
	`is_¬¿y
(
$V®ue
)) {

1159 ià(
	`is£t
(
$V®ue
[
$x
])) {

1160 
$V®ue
 = &$V®ue[
$x
];

1161 } 
	`–£if
 (
	`¬¿y_key_exi¡s
(
$x
,
$V®ue
)) {

1162 
$V®ue
 = &$V®ue[
$x
];

1164 ià(!
	`is£t
(
$Loc
->
PrmL¡
['nÛ¼'])è
$this
->
	`m‘h_Misc_AË¹
($Loc,'™em \''.
$x
.'\' i nÙ‡Àexi¡šg key iÀth¬¿y.',
Œue
);

1165 
	`un£t
(
$V®ue
); $Value = ''; ;

1167 } 
	`–£if
 (
	`is_objeù
(
$V®ue
)) {

1168 
$ArgL¡
 = 
$this
->
	`f_Misc_CheckArgL¡
(
$x
);

1169 ià(
	`m‘hod_exi¡s
(
$V®ue
,
$x
)) {

1170 ià(
$this
->
M‘hodsAÎowed
 
Ü
 !
	`š_¬¿y
(
	`¡¹ok
(
$Loc
->
FuÎName
,'.'),
	`¬¿y
('onload','onshow','var')) ) {

1171 
$x
 = 
	`ÿÎ_u£r_func_¬¿y
(
	`¬¿y
(&
$V®ue
,$x),
$ArgL¡
);

1173 ià(!
	`is£t
(
$Loc
->
PrmL¡
['nÛ¼'])è
$this
->
	`m‘h_Misc_AË¹
($Loc,'\''.
$x
.'\' i ¨m‘hod‡ndhcu¼’ˆTBS s‘tšg dØnÙ‡ÎowØÿÎ m‘hod Ú‡utom©iøf›lds.',
Œue
);

1174 
$x
 = '';

1176 } 
	`–£if
 (
	`´İ”ty_exi¡s
(
$V®ue
,
$x
)) {

1177 
$x
 = &
$V®ue
->$x;

1178 } 
	`–£if
 (
	`is£t
(
$V®ue
->
$x
)) {

1179 
$x
 = 
$V®ue
->$x;

1181 ià(!
	`is£t
(
$Loc
->
PrmL¡
['nÛ¼'])è
$this
->
	`m‘h_Misc_AË¹
($Loc,'™em '.
$x
.'\' i Ã™h”‡ m‘hod‚Ü‡…rİ”ty iÀthşas \''.
	`g‘_şass
(
$V®ue
).'\'.',
Œue
);

1182 
	`un£t
(
$V®ue
); $Value = ''; ;

1184 
$V®ue
 = &
$x
; 
	`un£t
($x); $x = '';

1186 ià(!
	`is£t
(
$Loc
->
PrmL¡
['nÛ¼'])è
$this
->
	`m‘h_Misc_AË¹
($Loc,'™em befÜ\''.
$x
.'\' i Ã™h”‡Àobjeù‚Ü‡À¬¿y. It ty³ i '.
	`g‘ty³
(
$V®ue
).'.',
Œue
);

1187 
	`un£t
(
$V®ue
); $Value = ''; ;

1192 
$Cu¼V®
 = 
$V®ue
;

1194 ià(
	`is£t
(
$Loc
->
PrmL¡
['onformat'])) {

1195 ià(
$Loc
->
Fœ¡M”ge
) {

1196 
$Loc
->
OnFrmInfo
 = $Loc->
PrmL¡
['onformat'];

1197 
$Loc
->
OnFrmArg
 = 
	`¬¿y
($Loc->
FuÎName
,'',&$Loc->
PrmL¡
,&
$this
);

1198 
$E¼Msg
 = 
çl£
;

1199 ià(!
$this
->
	`m‘h_Misc_U£rFùCheck
(
$Loc
->
OnFrmInfo
,'f',
$E¼Msg
,$E¼Msg,
Œue
)) {

1200 
	`un£t
(
$Loc
->
PrmL¡
['onformat']);

1201 ià(!
	`is£t
(
$Loc
->
PrmL¡
['nÛ¼'])è
$this
->
	`m‘h_Misc_AË¹
($Loc,'Õ¬am‘” onfÜm©è'.
$E¼Msg
);

1202 
$Loc
->
OnFrmInfo
 = 'pi';

1205 
$Loc
->
OnFrmArg
[3] = &
$this
;

1207 
$Loc
->
OnFrmArg
[1] = &
$Cu¼V®
;

1208 ià(
	`is£t
(
$Loc
->
PrmL¡
['subtpl'])) {

1209 
$this
->
	`m‘h_Misc_ChªgeMode
(
Œue
,
$Loc
,
$Cu¼V®
);

1210 
	`ÿÎ_u£r_func_¬¿y
(
$Loc
->
OnFrmInfo
,$Loc->
OnFrmArg
);

1211 
$this
->
	`m‘h_Misc_ChªgeMode
(
çl£
,
$Loc
,
$Cu¼V®
);

1212 
$Loc
->
CÚvPrÙeù
 = 
çl£
;

1213 
$Loc
->
CÚvSŒ
 = 
çl£
;

1215 
	`ÿÎ_u£r_func_¬¿y
(
$Loc
->
OnFrmInfo
,$Loc->
OnFrmArg
);

1219 ià(
$Loc
->
Fœ¡M”ge
) {

1220 ià(
	`is£t
(
$Loc
->
PrmL¡
['frm'])) {

1221 
$Loc
->
CÚvMode
 = 0;

1222 
$Loc
->
CÚvPrÙeù
 = 
çl£
;

1225 ià(
	`is£t
(
$Loc
->
PrmL¡
['strconv'])) {

1226 
$this
->
	`m‘h_CÚv_P»·»
(
$Loc
, $Loc->
PrmL¡
['strconv']);

1227 } 
	`–£if
 (
	`is£t
(
$Loc
->
PrmL¡
['htmlconv'])) {

1228 
$this
->
	`m‘h_CÚv_P»·»
(
$Loc
, $Loc->
PrmL¡
['htmlconv']);

1230 ià(
$this
->
Ch¬£t
===
çl£
è
$Loc
->
CÚvSŒ
 = false;

1233 ià(
	`is£t
(
$Loc
->
PrmL¡
['protect'])) {

1234 
$x
 = 
	`¡¹Şow”
(
$Loc
->
PrmL¡
['protect']);

1235 ià(
$x
==='no') {

1236 
$Loc
->
CÚvPrÙeù
 = 
çl£
;

1237 } 
	`–£if
 (
$x
==='yes') {

1238 
$Loc
->
CÚvPrÙeù
 = 
Œue
;

1240 } 
	`–£if
 (
$this
->
PrÙeù
===
çl£
) {

1241 
$Loc
->
CÚvPrÙeù
 = 
çl£
;

1244 ià(
$Loc
->
O³
 = 
	`is£t
($Loc->
PrmL¡
['ope'])) {

1245 
$O³L¡
 = 
	`ex¶ode
(',',
$Loc
->
PrmL¡
['ope']);

1246 
$Loc
->
O³Aù
 = 
	`¬¿y
();

1247 
$Loc
->
O³Arg
 = 
	`¬¿y
();

1248 
$Loc
->
O³Utf8
 = 
çl£
;

1249 
	`fÜ—ch
 (
$O³L¡
 
as
 
$i
=>
$İe
) {

1250 ià(
$İe
==='list') {

1251 
$Loc
->
O³Aù
[
$i
] = 1;

1252 
$Loc
->
O³Prm
[
$i
] = (
	`is£t
($Loc->
PrmL¡
['valsep'])) ? $Loc->PrmLst['valsep'] : ',';

1253 ià((
$Loc
->
CÚvMode
===1è&& $Loc->
CÚvSŒ
) $Loc->ConvMode = -1;

1254 } 
	`–£if
 (
$İe
==='minv') {

1255 
$Loc
->
O³Aù
[
$i
] = 11;

1256 
$Loc
->
MSave
 = $Loc->
MagÃtId
;

1257 } 
	`–£if
 (
$İe
==='attbool') {

1258 
$Loc
->
O³Aù
[
$i
] = 14;

1259 } 
	`–£if
 (
$İe
==='utf8'è{ 
$Loc
->
O³Utf8
 = 
Œue
;

1260 } 
	`–£if
 (
$İe
==='uµ”'è{ 
$Loc
->
O³Aù
[
$i
] = 15;

1261 } 
	`–£if
 (
$İe
==='low”'è{ 
$Loc
->
O³Aù
[
$i
] = 16;

1262 } 
	`–£if
 (
$İe
==='uµ”1'è{ 
$Loc
->
O³Aù
[
$i
] = 17;

1263 } 
	`–£if
 (
$İe
==='uµ”w'è{ 
$Loc
->
O³Aù
[
$i
] = 18;

1265 
$x
 = 
	`sub¡r
(
$İe
,0,4);

1266 ià(
$x
==='max:') {

1267 
$Loc
->
O³Aù
[
$i
] = (
	`is£t
($Loc->
PrmL¡
['maxhtml'])) ? 2 : 3;

1268 ià(
	`is£t
(
$Loc
->
PrmL¡
['maxutf8'])è$Loc->
O³Utf8
 = 
Œue
;

1269 
$Loc
->
O³Prm
[
$i
] = 
	`štv®
(
	`Œim
(
	`sub¡r
(
$İe
,4)));

1270 
$Loc
->
O³End
 = (
	`is£t
($Loc->
PrmL¡
['maxend'])) ? $Loc->PrmLst['maxend'] : '...';

1271 ià(
$Loc
->
O³Prm
[
$i
]<=0è$Loc->
O³
 = 
çl£
;

1272 } 
	`–£if
 (
$x
==='mod:'è{
$Loc
->
O³Aù
[
$i
] = 5; $Loc->
O³Prm
[$i] = '0'+
	`Œim
(
	`sub¡r
(
$İe
,4));

1273 } 
	`–£if
 (
$x
==='add:'è{
$Loc
->
O³Aù
[
$i
] = 6; $Loc->
O³Prm
[$i] = '0'+
	`Œim
(
	`sub¡r
(
$İe
,4));

1274 } 
	`–£if
 (
$x
==='mul:'è{
$Loc
->
O³Aù
[
$i
] = 7; $Loc->
O³Prm
[$i] = '0'+
	`Œim
(
	`sub¡r
(
$İe
,4));

1275 } 
	`–£if
 (
$x
==='div:'è{
$Loc
->
O³Aù
[
$i
] = 8; $Loc->
O³Prm
[$i] = '0'+
	`Œim
(
	`sub¡r
(
$İe
,4));

1276 } 
	`–£if
 (
$x
==='mok:'è{
$Loc
->
O³Aù
[
$i
] = 9; $Loc->
O³MOK
[] = 
	`Œim
(
	`sub¡r
(
$İe
,4)); $Loc->
MSave
 = $Loc->
MagÃtId
;

1277 } 
	`–£if
 (
$x
==='mko:'è{
$Loc
->
O³Aù
[
$i
] =10; $Loc->
O³MKO
[] = 
	`Œim
(
	`sub¡r
(
$İe
,4)); $Loc->
MSave
 = $Loc->
MagÃtId
;

1278 } 
	`–£if
 (
$x
==='nif:'è{
$Loc
->
O³Aù
[
$i
] =12; $Loc->
O³Prm
[$i] = 
	`Œim
(
	`sub¡r
(
$İe
,4));

1279 } 
	`–£if
 (
$x
==='msk:'è{
$Loc
->
O³Aù
[
$i
] =13; $Loc->
O³Prm
[$i] = 
	`Œim
(
	`sub¡r
(
$İe
,4));

1280 } 
	`–£if
 (
	`is£t
(
$this
->
_piOnO³¿tiÚ
)) {

1281 
$Loc
->
O³Aù
[
$i
] = 0;

1282 
$Loc
->
O³Prm
[
$i
] = 
$İe
;

1283 
$Loc
->
O³Arg
[
$i
] = 
	`¬¿y
($Loc->
FuÎName
,&
$Cu¼V®
,&$Loc->
PrmL¡
,&
$Txt
,$Loc->
PosBeg
,$Loc->
PosEnd
,&$Loc);

1284 
$Loc
->
PrmL¡
['_ope'] = $Loc->PrmLst['ope'];

1285 } 
	`–£if
 (!
	`is£t
(
$Loc
->
PrmL¡
['noerr'])) {

1286 
$this
->
	`m‘h_Misc_AË¹
(
$Loc
,'·¿m‘” o³ dÛ¢\'ˆsuµÜˆv®u\''.
$İe
.'\'.',
Œue
);

1291 
$Loc
->
Fœ¡M”ge
 = 
çl£
;

1293 
$CÚvPrÙeù
 = 
$Loc
->
CÚvPrÙeù
;

1296 ià(
$this
->
_piOnFrm_Ok
) {

1297 ià(
	`is£t
(
$Loc
->
OnFrmArgPi
)) {

1298 
$Loc
->
OnFrmArgPi
[1] = &
$Cu¼V®
;

1299 
$Loc
->
OnFrmArgPi
[3] = &
$this
;

1301 
$Loc
->
OnFrmArgPi
 = 
	`¬¿y
($Loc->
FuÎName
,&
$Cu¼V®
,&$Loc->
PrmL¡
,&
$this
);

1303 
$this
->
	`m‘h_PlugIn_RunAÎ
($this->
_piOnFÜm©
,
$Loc
->
OnFrmArgPi
);

1307 ià(
$Loc
->
O³
) {

1308 
	`fÜ—ch
 (
$Loc
->
O³Aù
 
as
 
$i
=>
$İe
) {

1309 
$İe
) {

1311 
$Loc
->
PrmL¡
['İe'] = $Loc->
O³Prm
[
$i
];

1312 
$O³Arg
 = &
$Loc
->
O³Arg
[
$i
];

1313 
$O³Arg
[1] = &
$Cu¼V®
; $O³Arg[3] = &
$Txt
;

1314 ià(!
$this
->
	`m‘h_PlugIn_RunAÎ
($this->
_piOnO³¿tiÚ
,
$O³Arg
)è 
$Loc
->
PosBeg
;

1317 ià(
$Loc
->
CÚvMode
===-1) {

1318 ià(
	`is_¬¿y
(
$Cu¼V®
)) {

1319 
	`fÜ—ch
 (
$Cu¼V®
 
as
 
$k
=>
$v
) {

1320 ià(!
	`is_¡ršg
(
$v
)è$v = (
¡ršg
)$v;

1321 
$this
->
	`m‘h_CÚv_SŒ
(
$v
,
$Loc
->
CÚvBr
);

1322 
$Cu¼V®
[
$k
] = 
$v
;

1324 
$Cu¼V®
 = 
	`im¶ode
(
$Loc
->
O³Prm
[
$i
],$CurrVal);

1326 ià(!
	`is_¡ršg
(
$Cu¼V®
)è$Cu¼V® = @(
¡ršg
)$CurrVal;

1327 
$this
->
	`m‘h_CÚv_SŒ
(
$Cu¼V®
,
$Loc
->
CÚvBr
);

1330 ià(
	`is_¬¿y
(
$Cu¼V®
)è$Cu¼V® = 
	`im¶ode
(
$Loc
->
O³Prm
[
$i
],$CurrVal);

1333 2: ià(
	`¡¾’
(''.
$Cu¼V®
)>
$Loc
->
O³Prm
[
$i
]è
$this
->
	`f_Xml_Max
($Cu¼V®,$Loc->O³Prm[$i],$Loc->
O³End
); ;

1334 3: ià(
	`¡¾’
(''.
$Cu¼V®
)>
$Loc
->
O³Prm
[
$i
]è$Cu¼V® = (($Loc->
O³Utf8
è? 
	`mb_sub¡r
(''.$Cu¼V®,0,$Loc->O³Prm[$i],'UTF-8'è: 
	`sub¡r
(''.$Cu¼V®,0,$Loc->O³Prm[$i])).$Loc->
O³End
; ;

1335 5: 
$Cu¼V®
 = ('0'+$Cu¼V®è% 
$Loc
->
O³Prm
[
$i
]; ;

1336 6: 
$Cu¼V®
 = ('0'+$Cu¼V®è+ 
$Loc
->
O³Prm
[
$i
]; ;

1337 7: 
$Cu¼V®
 = ('0'+$Cu¼V®è* 
$Loc
->
O³Prm
[
$i
]; ;

1338 8: 
$Cu¼V®
 = ('0'+$Cu¼V®è/ 
$Loc
->
O³Prm
[
$i
]; ;

1340 ià(
$İe
===9) {

1341 
$Cu¼V®
 = (
	`š_¬¿y
(@(
¡ršg
)$Cu¼V®,
$Loc
->
O³MOK
)) ? ' ' : '';

1343 
$Cu¼V®
 = (
	`š_¬¿y
(@(
¡ršg
)$Cu¼V®,
$Loc
->
O³MKO
)) ? '' : ' ';

1346 ià(@(
¡ršg
)
$Cu¼V®
==='') {

1347 ià(
$Loc
->
MagÃtId
===0è$Loc->MagÃtId = $Loc->
MSave
;

1349 ià(
$Loc
->
MagÃtId
!==0) {

1350 
$Loc
->
MSave
 = $Loc->
MagÃtId
;

1351 
$Loc
->
MagÃtId
 = 0;

1353 
$Cu¼V®
 = '';

1356 12: ià(@(
¡ršg
)
$Cu¼V®
===
$Loc
->
O³Prm
[
$i
]) $CurrVal = ''; ;

1357 13: 
$Cu¼V®
 = 
	`¡r_»¶aû
('*',$Cu¼V®,
$Loc
->
O³Prm
[
$i
]); ;

1358 14: 
$Cu¼V®
 = 
£lf
::
	`f_Loc_A‰BoŞ—n
($Cu¼V®, 
$Loc
->
PrmL¡
['©‰rue'], $Loc->
A‰Name
); ;

1359 15: 
$Cu¼V®
 = (
$Loc
->
O³Utf8
è? 
	`mb_cÚv”t_ÿ£
($Cu¼V®, 
MB_CASE_UPPER
, 'UTF-8'è: 
	`¡¹ouµ”
($CurrVal); ;

1360 16: 
$Cu¼V®
 = (
$Loc
->
O³Utf8
è? 
	`mb_cÚv”t_ÿ£
($Cu¼V®, 
MB_CASE_LOWER
, 'UTF-8'è: 
	`¡¹Şow”
($CurrVal); ;

1361 17: 
$Cu¼V®
 = 
	`ucfœ¡
($CurrVal); ;

1362 18: 
$Cu¼V®
 = (
$Loc
->
O³Utf8
è? 
	`mb_cÚv”t_ÿ£
($Cu¼V®, 
MB_CASE_TITLE
, 'UTF-8'è: 
	`ucwÜds
($CurrVal); ;

1368 ià(
$Loc
->
CÚvMode
===1) {

1369 ià(!
	`is_¡ršg
(
$Cu¼V®
)è$Cu¼V® = @(
¡ršg
)$CurrVal;

1370 ià(
$Loc
->
CÚvSŒ
è
$this
->
	`m‘h_CÚv_SŒ
(
$Cu¼V®
,$Loc->
CÚvBr
);

1371 } 
	`–£if
 (
$Loc
->
CÚvMode
===0) {

1372 
$Cu¼V®
 = 
$this
->
	`m‘h_Misc_FÜm©
($Cu¼V®,
$Loc
->
PrmL¡
);

1373 } 
	`–£if
 (
$Loc
->
CÚvMode
===2) {

1374 ià(!
	`is_¡ršg
(
$Cu¼V®
)è$Cu¼V® = @(
¡ršg
)$CurrVal;

1375 ià(
$Loc
->
CÚvSŒ
è
$this
->
	`m‘h_CÚv_SŒ
(
$Cu¼V®
,$Loc->
CÚvBr
);

1376 ià(
$Loc
->
CÚvEsc
è
$Cu¼V®
 = 
	`¡r_»¶aû
('\'','\'\'',$CurrVal);

1377 ià(
$Loc
->
CÚvWS
) {

1378 
$check
 = ' ';

1379 
$nb¥
 = '&nbsp;';

1381 
$pos
 = 
	`¡½os
(
$Cu¼V®
,
$check
);

1382 ià(
$pos
!==
çl£
è
$Cu¼V®
 = 
	`sub¡r_»¶aû
($Cu¼V®,
$nb¥
,$pos,1);

1383 } 
$pos
!==
çl£
);

1385 ià(
$Loc
->
CÚvJS
) {

1386 
$Cu¼V®
 = 
	`add¦ashes
($CurrVal);

1387 
$Cu¼V®
 = 
	`¡r_»¶aû
(
	`¬¿y
("\n","\r","\t"),array('\n','\r','\t'),$CurrVal);

1389 ià(
$Loc
->
CÚvU¾
è
$Cu¼V®
 = 
	`u¾’code
($CurrVal);

1390 ià(
$Loc
->
CÚvUtf8
è
$Cu¼V®
 = 
	`utf8_’code
($CurrVal);

1394 ià(
$Loc
->
PrmIfNbr
) {

1395 
$z
 = 
çl£
;

1396 
$i
 = 1;

1397 
$i
!==
çl£
) {

1398 ià(
$Loc
->
PrmIfV¬
[
$i
]è$Loc->PrmIfV¬[$i] = 
$this
->
	`m‘h_M”ge_AutoV¬
($Loc->
PrmIf
[$i],
Œue
);

1399 
$x
 = 
	`¡r_»¶aû
(
$this
->
_ChrV®
,
$Cu¼V®
,
$Loc
->
PrmIf
[
$i
]);

1400 ià(
$this
->
	`f_Misc_CheckCÚd™iÚ
(
$x
)) {

1401 ià(
	`is£t
(
$Loc
->
PrmTh’
[
$i
])) {

1402 ià(
$Loc
->
PrmTh’V¬
[
$i
]è$Loc->PrmTh’V¬[$i] = 
$this
->
	`m‘h_M”ge_AutoV¬
($Loc->
PrmTh’
[$i],
Œue
);

1403 
$z
 = 
$Loc
->
PrmTh’
[
$i
];

1405 
$i
 = 
çl£
;

1407 
$i
++;

1408 ià(
$i
>
$Loc
->
PrmIfNbr
) {

1409 ià(
	`is£t
(
$Loc
->
PrmL¡
['else'])) {

1410 ià(
$Loc
->
PrmEl£V¬
è$Loc->PrmEl£V¬ = 
$this
->
	`m‘h_M”ge_AutoV¬
($Loc->
PrmL¡
['–£'],
Œue
);

1411 
$z
 =
$Loc
->
PrmL¡
['else'];

1413 
$i
 = 
çl£
;

1417 ià(
$z
!==
çl£
) {

1418 ià(
$CÚvPrÙeù
) {

1419 
$Cu¼V®
 = 
	`¡r_»¶aû
(
$this
->
_ChrO³n
,$this->
_ChrPrÙeù
,$CurrVal);

1420 
$CÚvPrÙeù
 = 
çl£
;

1422 
$Cu¼V®
 = 
	`¡r_»¶aû
(
$this
->
_ChrV®
,$Cu¼V®,
$z
);

1426 ià(
	`is£t
(
$Loc
->
PrmL¡
['file'])) {

1427 
$x
 = 
$Loc
->
PrmL¡
['file'];

1428 ià(
$x
===
Œue
è$x = 
$Cu¼V®
;

1429 
$this
->
	`m‘h_M”ge_AutoV¬
(
$x
,
çl£
);

1430 
$x
 = 
	`Œim
(
	`¡r_»¶aû
(
$this
->
_ChrV®
,
$Cu¼V®
,$x));

1431 
$Cu¼V®
 = '';

1432 ià(
$x
!=='') {

1433 ià(
$this
->
	`f_Misc_G‘Fe
(
$Cu¼V®
, 
$x
, $this->
_La¡Fe
, $this->
InşudeP©h
)) {

1434 
$this
->
	`m‘h_LoÿtÜ_P¬tAndR’ame
(
$Cu¼V®
, 
$Loc
->
PrmL¡
);

1436 ià(!
	`is£t
(
$Loc
->
PrmL¡
['nÛ¼'])è
$this
->
	`m‘h_Misc_AË¹
($Loc,'thf\''.
$x
.'\' giv’ by…¬am‘” fi nÙ found o¸nÙ„—dabË.',
Œue
);

1438 
$CÚvPrÙeù
 = 
çl£
;

1442 ià(
	`is£t
(
$Loc
->
PrmL¡
['script'])) {

1443 
$x
 = 
$Loc
->
PrmL¡
['script'];

1444 ià(
$x
===
Œue
è$x = 
$Cu¼V®
;

1445 
$this
->
	`m‘h_M”ge_AutoV¬
(
$x
,
çl£
);

1446 
$x
 = 
	`Œim
(
	`¡r_»¶aû
(
$this
->
_ChrV®
,
$Cu¼V®
,$x));

1447 ià(
$x
!=='') {

1448 
$this
->
_Subsüt
 = 
$x
;

1449 
$this
->
Cu¼Prm
 = &
$Loc
->
PrmL¡
;

1450 
$sub
 = 
	`is£t
(
$Loc
->
PrmL¡
['subtpl']);

1451 ià(
$sub
è
$this
->
	`m‘h_Misc_ChªgeMode
(
Œue
,
$Loc
,
$Cu¼V®
);

1452 ià(
$this
->
	`m‘h_Misc_RunSubsüt
(
$Cu¼V®
,
$Loc
->
PrmL¡
)===
çl£
) {

1453 ià(!
	`is£t
(
$Loc
->
PrmL¡
['nÛ¼'])è
$this
->
	`m‘h_Misc_AË¹
($Loc,'thf\''.
$x
.'\' giv’ by…¬am‘” süˆi nÙ found o¸nÙ„—dabË.',
Œue
);

1455 ià(
$sub
è
$this
->
	`m‘h_Misc_ChªgeMode
(
çl£
,
$Loc
,
$Cu¼V®
);

1456 
$this
->
	`m‘h_LoÿtÜ_P¬tAndR’ame
(
$Cu¼V®
, 
$Loc
->
PrmL¡
);

1457 
	`un£t
(
$this
->
Cu¼Prm
);

1458 
$CÚvPrÙeù
 = 
çl£
;

1462 ià(
	`is£t
(
$Loc
->
PrmL¡
['att'])) {

1463 
$this
->
	`f_Xml_A‰Fšd
(
$Txt
,
$Loc
,
Œue
,$this->
A‰D–im
);

1464 ià(
	`is£t
(
$Loc
->
PrmL¡
['atttrue'])) {

1465 
$Cu¼V®
 = 
£lf
::
	`f_Loc_A‰BoŞ—n
($Cu¼V®, 
$Loc
->
PrmL¡
['©‰rue'], $Loc->
A‰Name
);

1466 
$Loc
->
PrmL¡
['magnet'] = '#';

1471 ià(
$Cu¼V®
==='') {

1473 ià(
$Loc
->
MagÃtId
===
çl£
) {

1474 ià(
	`is£t
(
$Loc
->
PrmL¡
['.'])) {

1475 
$Loc
->
MagÃtId
 = -1;

1476 } 
	`–£if
 (
	`is£t
(
$Loc
->
PrmL¡
['ifempty'])) {

1477 
$Loc
->
MagÃtId
 = -2;

1478 } 
	`–£if
 (
	`is£t
(
$Loc
->
PrmL¡
['magnet'])) {

1479 
$Loc
->
MagÃtId
 = 1;

1480 
$Loc
->
PosBeg0
 = $Loc->
PosBeg
;

1481 
$Loc
->
PosEnd0
 = $Loc->
PosEnd
;

1482 ià(
$Loc
->
PrmL¡
['magnet']==='#') {

1483 ià(!
	`is£t
(
$Loc
->
A‰Beg
)) {

1484 
$Loc
->
PrmL¡
['att'] = '.';

1485 
$this
->
	`f_Xml_A‰Fšd
(
$Txt
,
$Loc
,
Œue
,$this->
A‰D–im
);

1487 ià(
	`is£t
(
$Loc
->
A‰Beg
)) {

1488 
$Loc
->
MagÃtId
 = -3;

1490 
$this
->
	`m‘h_Misc_AË¹
(
$Loc
,'·¿m‘” \'magÃt=#\' cªnÙ b´oûs£d beÿu£hcÜ»¥Údšg‡‰ribu‹ i nÙ found.',
Œue
);

1492 } 
	`–£if
 (
	`is£t
(
$Loc
->
PrmL¡
['mtype'])) {

1493 
$Loc
->
PrmL¡
['mtype']) {

1494 'm+m': 
$Loc
->
MagÃtId
 = 2; ;

1495 'm*': 
$Loc
->
MagÃtId
 = 3; ;

1496 '*m': 
$Loc
->
MagÃtId
 = 4; ;

1499 } 
	`–£if
 (
	`is£t
(
$Loc
->
PrmL¡
['attadd'])) {

1501 
$Loc
->
PosBeg0
 = $Loc->
PosBeg
;

1502 
$Loc
->
PosEnd0
 = $Loc->
PosEnd
;

1503 
$Loc
->
MagÃtId
 = 5;

1505 
$Loc
->
MagÃtId
 = 0;

1509 
$Loc
->
MagÃtId
) {

1511 -1: 
$Cu¼V®
 = '&nbsp;'; ;

1512 -2: 
$Cu¼V®
 = 
$Loc
->
PrmL¡
['ifempty']; ;

1513 -3: 
$Loc
->
EÆ¬ged
 = 
Œue
; $Loc->
PosBeg
 = $Loc->
A‰BegM
; $Loc->
PosEnd
 = $Loc->
A‰End
; ;

1515 
$Loc
->
EÆ¬ged
 = 
Œue
;

1516 
$this
->
	`f_Loc_EÆ¬geToTag
(
$Txt
,
$Loc
,$Loc->
PrmL¡
['magÃt'],
çl£
);

1519 
$Loc
->
EÆ¬ged
 = 
Œue
;

1520 
$Cu¼V®
 = 
$this
->
	`f_Loc_EÆ¬geToTag
(
$Txt
,
$Loc
,$Loc->
PrmL¡
['magÃt'],
Œue
);

1523 
$Loc
->
EÆ¬ged
 = 
Œue
;

1524 
$Loc2
 = 
$this
->
	`f_Xml_FšdTag
(
$Txt
,
$Loc
->
PrmL¡
['magÃt'],
Œue
,$Loc->
PosBeg
,
çl£
,false,false);

1525 ià(
$Loc2
!==
çl£
) {

1526 
$Loc
->
PosBeg
 = 
$Loc2
->PosBeg;

1527 ià(
$Loc
->
PosEnd
<
$Loc2
->PosEnd) $Loc->PosEnd = $Loc2->PosEnd;

1531 
$Loc
->
EÆ¬ged
 = 
Œue
;

1532 
$Loc2
 = 
$this
->
	`f_Xml_FšdTag
(
$Txt
,
$Loc
->
PrmL¡
['magÃt'],
Œue
,$Loc->
PosBeg
,Œue,
çl£
,false);

1533 ià(
$Loc2
!==
çl£
è
$Loc
->
PosEnd
 = $Loc2->PosEnd;

1536 
$Loc
->
EÆ¬ged
 = 
Œue
;

1537 ià(
	`sub¡r
(
$Txt
,
$Loc
->
PosBeg
-1,1)==' ') $Loc->PosBeg--;

1540 
$NewEnd
 = 
$Loc
->
PosBeg
;

1543 ià(
$CÚvPrÙeù
è
$Cu¼V®
 = 
	`¡r_»¶aû
(
$this
->
_ChrO³n
,$this->
_ChrPrÙeù
,$CurrVal);

1544 
$NewEnd
 = 
$Loc
->
PosBeg
 + 
	`¡¾’
(
$Cu¼V®
);

1548 
$Txt
 = 
	`sub¡r_»¶aû
($Txt,
$Cu¼V®
,
$Loc
->
PosBeg
,$Loc->
PosEnd
-$Loc->PosBeg+1);

1549  
$NewEnd
;

1551 
	}
}

1553 
funùiÚ
 
	$m‘h_LoÿtÜ_FšdBlockNext
(&
$Txt
,
$BlockName
,
$PosBeg
,
$ChrSub
,
$Mode
,&
$P1
,&
$F›ldBefÜe
) {

1559 
$S—rchDef
 = 
Œue
;

1560 
$Fœ¡F›ld
 = 
çl£
;

1562 
$S—rchDef
 
	`ªd
 (
$Loc
 = 
$this
->
	`m‘h_LoÿtÜ_FšdTbs
(
$Txt
,
$BlockName
,
$PosBeg
,
$ChrSub
))) {

1563 ià(
	`is£t
(
$Loc
->
PrmL¡
['block'])) {

1564 ià(
	`is£t
(
$Loc
->
PrmL¡
['p1'])) {

1565 ià(
$P1
è 
çl£
;

1566 
$P1
 = 
Œue
;

1568 
$Block
 = 
$Loc
->
PrmL¡
['block'];

1569 
$S—rchDef
 = 
çl£
;

1570 } 
	`–£if
 (
$Mode
===1) {

1571  
$Loc
;

1572 } 
	`–£if
 (
$Fœ¡F›ld
===
çl£
) {

1573 
$Fœ¡F›ld
 = 
$Loc
;

1575 
$PosBeg
 = 
$Loc
->
PosEnd
;

1578 ià(
$S—rchDef
) {

1579 ià(
$Fœ¡F›ld
!==
çl£
è
$F›ldBefÜe
 = 
Œue
;

1580  
çl£
;

1583 
$Loc
->
PosDefBeg
 = -1;

1585 ià(
$Block
==='begin') {

1587 ià((
$Fœ¡F›ld
!==
çl£
è
	`ªd
 ($Fœ¡F›ld->
PosEnd
<
$Loc
->
PosBeg
)è
$F›ldBefÜe
 = 
Œue
;

1589 
$O³Ãd
 = 1;

1590 
$Loc2
 = 
$this
->
	`m‘h_LoÿtÜ_FšdTbs
(
$Txt
,
$BlockName
,
$PosBeg
,
$ChrSub
)) {

1591 ià(
	`is£t
(
$Loc2
->
PrmL¡
['block'])) {

1592 
$Loc2
->
PrmL¡
['block']) {

1593 '’d': 
$O³Ãd
--; ;

1594 'begš': 
$O³Ãd
++; ;

1596 ià(
$O³Ãd
==0) {

1597 ià(
$Mode
===1) {

1598 
$Loc
->
PosBeg2
 = 
$Loc2
->
PosBeg
;

1599 
$Loc
->
PosEnd2
 = 
$Loc2
->
PosEnd
;

1601 ià(
$Mode
===2) {

1602 
$Loc
->
BlockSrc
 = 
	`sub¡r
(
$Txt
,$Loc->
PosEnd
+1,
$Loc2
->
PosBeg
-$Loc->PosEnd-1);

1604 
$Loc
->
BlockSrc
 = 
	`sub¡r
(
$Txt
,$Loc->
PosBeg
,
$Loc2
->
PosEnd
-$Loc->PosBeg+1);

1606 
$Loc
->
PosEnd
 = 
$Loc2
->PosEnd;

1608 
$Loc
->
BlockFound
 = 
Œue
;

1609  
$Loc
;

1612 
$PosBeg
 = 
$Loc2
->
PosEnd
;

1615  
$this
->
	`m‘h_Misc_AË¹
(
$Loc
,'¨Ëa¡ oÃag w™h…¬am‘” \'blockónd\' i missšg.',
çl£
,'in block\'s definition');

1619 ià(
$Mode
===1) {

1620 
$Loc
->
PosBeg2
 = 
çl£
;

1622 
$beg
 = 
$Loc
->
PosBeg
;

1623 
$’d
 = 
$Loc
->
PosEnd
;

1624 ià(
$this
->
	`f_Loc_EÆ¬geToTag
(
$Txt
,
$Loc
,
$Block
,
çl£
)===çl£è $this->
	`m‘h_Misc_AË¹
($Loc,'©†—¡ oÃag cÜ»¥ÚdšgØ'.$Loc->
PrmL¡
['block'].' is‚ot found. Check openingags, closingags‡ndƒmbedding†evels.',false,'in block\'s definition');

1625 ià(
$Loc
->
SubOk
 
	`Ü
 (
$Mode
===3)) {

1626 
$Loc
->
BlockSrc
 = 
	`sub¡r
(
$Txt
,$Loc->
PosBeg
,$Loc->
PosEnd
-$Loc->PosBeg+1);

1627 
$Loc
->
PosDefBeg
 = 
$beg
 - $Loc->
PosBeg
;

1628 
$Loc
->
PosDefEnd
 = 
$’d
 - $Loc->
PosBeg
;

1630 
$Loc
->
BlockSrc
 = 
	`sub¡r
(
$Txt
,$Loc->
PosBeg
,
$beg
-$Loc->PosBeg).sub¡r($Txt,
$’d
+1,$Loc->
PosEnd
-$end);

1634 
$Loc
->
BlockFound
 = 
Œue
;

1635 ià((
$Fœ¡F›ld
!==
çl£
è
	`ªd
 ($Fœ¡F›ld->
PosEnd
<
$Loc
->
PosBeg
)è
$F›ldBefÜe
 = 
Œue
;

1636  
$Loc
;

1638 
	}
}

1640 
funùiÚ
 
	$m‘h_LoÿtÜ_P¬tAndR’ame
(&
$Cu¼V®
, &
$PrmL¡
) {

1643 ià(
	`is£t
(
$PrmL¡
['store'])) {

1644 
$¡Ü’ame
 = (
	`is£t
(
$PrmL¡
['storename'])) ? $PrmLst['storename'] : 'default';

1645 ià(!
	`is£t
(
$this
->
T¶StÜe
[
$¡Ü’ame
])) $this->TplStore[$storename] = '';

1646 
$this
->
T¶StÜe
[
$¡Ü’ame
] .ğ$this->
	`f_Xml_G‘P¬t
(
$Cu¼V®
, 
$PrmL¡
['¡Üe'], 
çl£
);

1650 ià(
	`is£t
(
$PrmL¡
['getpart'])) {

1651 
$·¹
 = 
$PrmL¡
['getpart'];

1652 } 
	`–£if
 (
	`is£t
(
$PrmL¡
['getbody'])) {

1653 
$·¹
 = 
$PrmL¡
['getbody'];

1655 
$·¹
 = 
çl£
;

1657 ià(
$·¹
!=
çl£
) {

1658 
$Cu¼V®
 = 
$this
->
	`f_Xml_G‘P¬t
($Cu¼V®, 
$·¹
, 
Œue
);

1662 ià(
	`is£t
(
$PrmL¡
['rename'])) {

1664 
$R•Ïû
 = 
$PrmL¡
['rename'];

1666 ià(
	`is_¡ršg
(
$R•Ïû
)è$R•Ïû = 
	`ex¶ode
(',',$Replace);

1667 
	`fÜ—ch
 (
$R•Ïû
 
as
 
$x
) {

1668 ià(
	`is_¡ršg
(
$x
)è$x = 
	`ex¶ode
('=', $x);

1669 ià(
	`couÁ
(
$x
)==2) {

1670 
$Şd
 = 
	`Œim
(
$x
[0]);

1671 
$Ãw
 = 
	`Œim
(
$x
[1]);

1672 ià(
$Şd
!=='') {

1673 ià(
$Ãw
==='') {

1674 
$q
 = 
çl£
;

1675 
$s
 = 'clear';

1676 
$this
->
	`m‘h_M”ge_Block
(
$Cu¼V®
, 
$Şd
, 
$s
, 
$q
, 
çl£
, false, false);

1678 
$Şd
 = 
$this
->
_ChrO³n
.$old;

1679 
$Şd
 = 
	`¬¿y
($Şd.'.', $Şd.' ', $Şd.';', $Şd.
$this
->
_ChrClo£
);

1680 
$Ãw
 = 
$this
->
_ChrO³n
.$new;

1681 
$Ãw
 = 
	`¬¿y
($Ãw.'.', $Ãw.' ', $Ãw.';', $Ãw.
$this
->
_ChrClo£
);

1682 
$Cu¼V®
 = 
	`¡r_»¶aû
(
$Şd
,
$Ãw
,$CurrVal);

1690 
	}
}

1692 
funùiÚ
 
	$m‘h_LoÿtÜ_FšdBlockL¡
(&
$Txt
,
$BlockName
,
$Pos
,
$S³Prm
) {

1695 
$LocR
 = 
Ãw
 
şsTbsLoÿtÜ
;

1696 
$LocR
->
P1
 = 
çl£
;

1697 
$LocR
->
F›ldOutside
 = 
çl£
;

1698 
$LocR
->
FOStİ
 = 
çl£
;

1699 
$LocR
->
BDefL¡
 = 
	`¬¿y
();

1701 
$LocR
->
NoD©a
 = 
çl£
;

1702 
$LocR
->
S³cŸl
 = 
çl£
;

1703 
$LocR
->
H—d”Found
 = 
çl£
;

1704 
$LocR
->
FoÙ”Found
 = 
çl£
;

1705 
$LocR
->
S”ŸlEm±y
 = 
çl£
;

1706 
$LocR
->
G½B»ak
 = 
çl£
;

1708 
$LocR
->
Wh’Found
 = 
çl£
;

1709 
$LocR
->
Wh’DeçuÉ
 = 
çl£
;

1711 
$LocR
->
SeùiÚNbr
 = 0;

1712 
$LocR
->
SeùiÚL¡
 = 
	`¬¿y
();

1714 
$BDef
 = 
çl£
;

1715 
$P¬’tL¡
 = 
	`¬¿y
();

1716 
$Pid
 = 0;

1720 ià(
$BlockName
==='') {

1721 
$Loc
 = 
çl£
;

1723 
$Loc
 = 
$this
->
	`m‘h_LoÿtÜ_FšdBlockNext
(
$Txt
,
$BlockName
,
$Pos
,'.',2,
$LocR
->
P1
,$LocR->
F›ldOutside
);

1726 ià(
$Loc
===
çl£
) {

1728 ià(
$Pid
>0) {

1729 
$P¬’t
 = &
$P¬’tL¡
[
$Pid
];

1730 
$Src
 = 
$Txt
;

1731 
$Txt
 = &
$P¬’t
->
Txt
;

1732 ià(
$LocR
->
BlockFound
) {

1734 
$P¬’t
->
Src
 = 
	`sub¡r
(
$Src
,0,
$LocR
->
PosBeg
);

1736 
$BDef
 = &
$this
->
	`m‘h_LoÿtÜ_SeùiÚNewBDef
(
$LocR
,
$BlockName
,
	`sub¡r
(
$Src
,$LocR->
PosEnd
+1),
$P¬’t
->
Prm
,
Œue
);

1737 
$this
->
	`m‘h_LoÿtÜ_SeùiÚAddG½
(
$LocR
,
$BlockName
,
$BDef
,'F',
$P¬’t
->
Fld
,'parentgrp');

1740 
$Pos
 = 
$P¬’t
->
Pos
;

1741 
$LocR
->
PosBeg
 = 
$P¬’t
->
Beg
;

1742 
$LocR
->
PosEnd
 = 
$P¬’t
->
End
;

1743 
$LocR
->
BlockFound
 = 
Œue
;

1744 
	`un£t
(
$P¬’t
);

1745 
	`un£t
(
$P¬’tL¡
[
$Pid
]);

1746 
$Pid
--;

1747 
$Loc
 = 
Œue
;

1752 
$Pos
 = 
$Loc
->
PosEnd
;

1755 ià(
$LocR
->
BlockFound
) {

1756 iàĞ
$LocR
->
PosBeg
 > 
$Loc
->PosBeg ) $LocR->PosBeg = $Loc->PosBeg;

1757 iàĞ
$LocR
->
PosEnd
 < 
$Loc
->PosEnd ) $LocR->PosEnd = $Loc->PosEnd;

1759 
$LocR
->
BlockFound
 = 
Œue
;

1760 
$LocR
->
PosBeg
 = 
$Loc
->PosBeg;

1761 
$LocR
->
PosEnd
 = 
$Loc
->PosEnd;

1765 ià(
	`couÁ
(
$Loc
->
PrmL¡
)>0è
$LocR
->PrmL¡ = 
	`¬¿y_m”ge
($LocR->PrmLst,$Loc->PrmLst);

1768 ià(
$Loc
->
PosDefBeg
>=0) {

1769 
$dyÅrm
 = 
	`¬¿y
('when','headergrp','footergrp','parentgrp');

1770 
	`fÜ—ch
(
$dyÅrm
 
as
 
$dp
) {

1771 
$n
 = 0;

1772 ià((
	`is£t
(
$Loc
->
PrmL¡
[
$dp
])è
	`ªd
 (
	`¡½os
($Loc->PrmL¡[$dp],
$this
->
_ChrO³n
.
$BlockName
)!==
çl£
)) {

1773 
$n
++;

1774 ià(
$n
==1) {

1775 
$Ën
 = 
$Loc
->
PosDefEnd
 - $Loc->
PosDefBeg
 + 1;

1776 
$x
 = 
	`sub¡r
(
$Loc
->
BlockSrc
,$Loc->
PosDefBeg
,
$Ën
);

1778 
$x
 = 
	`¡r_»¶aû
(
$Loc
->
PrmL¡
[
$dp
],'',$x);

1780 ià(
$n
>0è
$Loc
->
BlockSrc
 = 
	`sub¡r_»¶aû
($Loc->BlockSrc,
$x
,$Loc->
PosDefBeg
,
$Ën
);

1784 
$IsP¬’tG½
 = 
	`is£t
(
$Loc
->
PrmL¡
['parentgrp']);

1785 
$BDef
 = &
$this
->
	`m‘h_LoÿtÜ_SeùiÚNewBDef
(
$LocR
,
$BlockName
,
$Loc
->
BlockSrc
,$Loc->
PrmL¡
,!
$IsP¬’tG½
);

1788 ià(
	`is£t
(
$Loc
->
PrmL¡
['nodata'])) {

1789 
$LocR
->
NoD©a
 = &
$BDef
;

1790 } 
	`–£if
 ((
$S³Prm
!==
çl£
è
ªd
 
	`is£t
(
$Loc
->
PrmL¡
[$SpePrm])) {

1791 
$LocR
->
S³cŸl
 = &
$BDef
;

1792 } 
	`–£if
 (
	`is£t
(
$Loc
->
PrmL¡
['when'])) {

1793 ià(
$LocR
->
Wh’Found
===
çl£
) {

1794 
$LocR
->
Wh’Found
 = 
Œue
;

1795 
$LocR
->
Wh’Sev”®
 = 
çl£
;

1796 
$LocR
->
Wh’Nbr
 = 0;

1797 
$LocR
->
Wh’L¡
 = 
	`¬¿y
();

1799 
$this
->
	`m‘h_M”ge_AutoV¬
(
$Loc
->
PrmL¡
['wh’'],
çl£
);

1800 
$BDef
->
Wh’CÚd
 = &
$this
->
	`m‘h_LoÿtÜ_SeùiÚNewBDef
(
$LocR
,
$BlockName
,
$Loc
->
PrmL¡
['wh’'],
	`¬¿y
(),
Œue
);

1801 
$BDef
->
Wh’BefÜeNS
 = (
$LocR
->
SeùiÚNbr
===0);

1802 
$i
 = ++
$LocR
->
Wh’Nbr
;

1803 
$LocR
->
Wh’L¡
[
$i
] = &
$BDef
;

1804 ià(
	`is£t
(
$Loc
->
PrmL¡
['£v”®'])è
$LocR
->
Wh’Sev”®
 = 
Œue
;

1805 } 
	`–£if
 (
	`is£t
(
$Loc
->
PrmL¡
['default'])) {

1806 
$LocR
->
Wh’DeçuÉ
 = &
$BDef
;

1807 
$LocR
->
Wh’DeçuÉBefÜeNS
 = ($LocR->
SeùiÚNbr
===0);

1808 } 
	`–£if
 (
	`is£t
(
$Loc
->
PrmL¡
['headergrp'])) {

1809 
$this
->
	`m‘h_LoÿtÜ_SeùiÚAddG½
(
$LocR
,
$BlockName
,
$BDef
,'H',
$Loc
->
PrmL¡
['headergrp'],'headergrp');

1810 } 
	`–£if
 (
	`is£t
(
$Loc
->
PrmL¡
['footergrp'])) {

1811 
$this
->
	`m‘h_LoÿtÜ_SeùiÚAddG½
(
$LocR
,
$BlockName
,
$BDef
,'F',
$Loc
->
PrmL¡
['footergrp'],'footergrp');

1812 } 
	`–£if
 (
	`is£t
(
$Loc
->
PrmL¡
['splittergrp'])) {

1813 
$this
->
	`m‘h_LoÿtÜ_SeùiÚAddG½
(
$LocR
,
$BlockName
,
$BDef
,'S',
$Loc
->
PrmL¡
['splittergrp'],'splittergrp');

1814 } 
	`–£if
 (
$IsP¬’tG½
) {

1815 
$this
->
	`m‘h_LoÿtÜ_SeùiÚAddG½
(
$LocR
,
$BlockName
,
$BDef
,'H',
$Loc
->
PrmL¡
['parentgrp'],'parentgrp');

1816 
$BDef
->
Fld
 = 
$Loc
->
PrmL¡
['parentgrp'];

1817 
$BDef
->
Txt
 = &
$Txt
;

1818 
$BDef
->
Pos
 = 
$Pos
;

1819 
$BDef
->
Beg
 = 
$LocR
->
PosBeg
;

1820 
$BDef
->
End
 = 
$LocR
->
PosEnd
;

1821 
$Pid
++;

1822 
$P¬’tL¡
[
$Pid
] = &
$BDef
;

1823 
$Txt
 = &
$BDef
->
Src
;

1824 
$Pos
 = 
$Loc
->
PosDefBeg
 + 1;

1825 
$LocR
->
BlockFound
 = 
çl£
;

1826 
$LocR
->
PosBeg
 = 
çl£
;

1827 
$LocR
->
PosEnd
 = 
çl£
;

1828 } 
	`–£if
 (
	`is£t
(
$Loc
->
PrmL¡
['serial'])) {

1830 
$SrSrc
 = &
$BDef
->
Src
;

1832 ià(
$LocR
->
S”ŸlEm±y
===
çl£
) {

1833 
$SrName
 = 
$BlockName
.'_0';

1834 
$x
 = 
çl£
;

1835 
$SrLoc
 = 
$this
->
	`m‘h_LoÿtÜ_FšdBlockNext
(
$SrSrc
,
$SrName
,0,'.',2,
$x
,$x);

1836 ià(
$SrLoc
!==
çl£
) {

1837 
$LocR
->
S”ŸlEm±y
 = 
$SrLoc
->
BlockSrc
;

1838 
$SrSrc
 = 
	`sub¡r_»¶aû
($SrSrc,'',
$SrLoc
->
PosBeg
,$SrLoc->
PosEnd
-$SrLoc->PosBeg+1);

1841 
$SrName
 = 
$BlockName
.'_1';

1842 
$x
 = 
çl£
;

1843 
$SrLoc
 = 
$this
->
	`m‘h_LoÿtÜ_FšdBlockNext
(
$SrSrc
,
$SrName
,0,'.',2,
$x
,$x);

1844 ià(
$SrLoc
!==
çl£
) {

1845 
$SrId
 = 1;

1848 
$SrBDef
 = &
$this
->
	`m‘h_LoÿtÜ_SeùiÚNewBDef
(
$LocR
,
$SrName
,
$SrLoc
->
BlockSrc
,$SrLoc->
PrmL¡
,
Œue
);

1849 
$SrBDef
->
SrBeg
 = 
$SrLoc
->
PosBeg
;

1850 
$SrBDef
->
SrL’
 = 
$SrLoc
->
PosEnd
 - $SrLoc->
PosBeg
 + 1;

1851 
$SrBDef
->
SrTxt
 = 
çl£
;

1852 
$BDef
->
SrBDefL¡
[
$SrId
] = &
$SrBDef
;

1854 
$BDef
->
SrBDefOrd”ed
[
$SrId
] = &
$SrBDef
;

1855 
$i
 = 
$SrId
;

1856 (
$i
>1è
	`ªd
 (
$SrBDef
->
SrBeg
<
$BDef
->
SrBDefOrd”ed
[
$SrId
-1]->SrBeg)) {

1857 
$BDef
->
SrBDefOrd”ed
[
$i
] = &$BDef->SrBDefOrdered[$i-1];

1858 
$BDef
->
SrBDefOrd”ed
[
$i
-1] = &
$SrBDef
;

1859 
$i
--;

1862 
$SrId
++;

1863 
$SrName
 = 
$BlockName
.'_'.
$SrId
;

1864 
$x
 = 
çl£
;

1865 
$SrLoc
 = 
$this
->
	`m‘h_LoÿtÜ_FšdBlockNext
(
$SrSrc
,
$SrName
,0,'.',2,
$x
,$x);

1866 } 
$SrLoc
!==
çl£
);

1867 
$BDef
->
SrBDefNbr
 = 
$SrId
-1;

1868 
$BDef
->
IsS”Ÿl
 = 
Œue
;

1869 
$i
 = ++
$LocR
->
SeùiÚNbr
;

1870 
$LocR
->
SeùiÚL¡
[
$i
] = &
$BDef
;

1874 
$i
 = ++
$LocR
->
SeùiÚNbr
;

1875 
$LocR
->
SeùiÚL¡
[
$i
] = &
$BDef
;

1880 } 
$Loc
!==
çl£
);

1882 ià(
$LocR
->
Wh’Found
 
	`ªd
 ($LocR->
SeùiÚNbr
===0)) {

1884 
$BDef
 = &
$this
->
	`m‘h_LoÿtÜ_SeùiÚNewBDef
(
$LocR
,
$BlockName
,'',
	`¬¿y
(),
çl£
);

1885 
$LocR
->
SeùiÚNbr
 = 1;

1886 
$LocR
->
SeùiÚL¡
[1] = &
$BDef
;

1889  
$LocR
;

1891 
	}
}

1893 
funùiÚ
 
	$m‘h_M”ge_Block
(&
$Txt
,
$BlockL¡
,&
$SrcId
,&
$Qu”y
,
$S³Prm
,
$S³RecNum
,
$QryPrms
=
çl£
) {

1895 
$BlockSave
 = 
$this
->
_Cu¼Block
;

1896 
$this
->
_Cu¼Block
 = 
$BlockL¡
;

1899 
$Src
 = 
Ãw
 
şsTbsD©aSourû
;

1900 ià(!
$Src
->
	`D©aP»·»
(
$SrcId
,
$this
)) {

1901 
$this
->
_Cu¼Block
 = 
$BlockSave
;

1905 ià(
	`is_¡ršg
(
$BlockL¡
)è$BlockL¡ = 
	`ex¶ode
(',', $BlockLst);

1906 
$BlockNbr
 = 
	`couÁ
(
$BlockL¡
);

1907 
$BlockId
 = 0;

1908 
$WasP1
 = 
çl£
;

1909 
$NbrRecTÙ
 = 0;

1910 
$Qu”yZ
 = &
$Qu”y
;

1911 
$R‘uºD©a
 = 
çl£
;

1913 
$BlockId
<
$BlockNbr
) {

1915 
$RecS³
 = 0;

1916 
$Qu”yOk
 = 
Œue
;

1917 
$this
->
_Cu¼Block
 = 
	`Œim
(
$BlockL¡
[
$BlockId
]);

1918 ià(
$this
->
_Cu¼Block
==='*') {

1919 
$R‘uºD©a
 = 
Œue
;

1920 ià(
$Src
->
RecSaved
===
çl£
è$Src->
RecSavšg
 = 
Œue
;

1921 
$this
->
_Cu¼Block
 = '';

1925 
$LocR
 = 
$this
->
	`m‘h_LoÿtÜ_FšdBlockL¡
(
$Txt
,$this->
_Cu¼Block
,0,
$S³Prm
);

1927 ià(
$LocR
->
BlockFound
) {

1929 ià(
$LocR
->
S³cŸl
!==
çl£
è
$RecS³
 = 
$S³RecNum
;

1931 ià(
$Src
->
OnD©aPrm
 = 
	`is£t
(
$LocR
->
PrmL¡
['ondata'])) {

1932 
$Src
->
OnD©aPrmRef
 = 
$LocR
->
PrmL¡
['ondata'];

1933 ià(
	`is£t
(
$Src
->
OnD©aPrmDÚe
[$Src->
OnD©aPrmRef
])) {

1934 
$Src
->
OnD©aPrm
 = 
çl£
;

1936 
$E¼Msg
 = 
çl£
;

1937 ià(
$this
->
	`m‘h_Misc_U£rFùCheck
(
$Src
->
OnD©aPrmRef
,'f',
$E¼Msg
,$E¼Msg,
Œue
)) {

1938 
$Src
->
OnD©aOk
 = 
Œue
;

1940 
$LocR
->
FuÎName
 = 
$this
->
_Cu¼Block
;

1941 
$Src
->
OnD©aPrm
 = 
$this
->
	`m‘h_Misc_AË¹
(
$LocR
,'Õ¬am‘” ond©aè'.
$E¼Msg
,
çl£
,'block');

1946 ià(
$LocR
->
P1
) {

1947 iàĞ(
$LocR
->
PrmL¡
['p1']===
Œue
è&& ((!
	`is_¡ršg
(
$Qu”y
)è|| (
	`¡½os
($Qu”y,'%p1%')===
çl£
)) ) {

1948 ià(
$Src
->
RecSaved
===
çl£
è$Src->
RecSavšg
 = 
Œue
;

1949 } 
	`–£if
 (
	`is_¡ršg
(
$Qu”y
)) {

1950 
$Src
->
RecSaved
 = 
çl£
;

1951 
	`un£t
(
$Qu”yZ
); $Qu”yZ = ''.
$Qu”y
;

1952 
$i
 = 1;

1954 
$x
 = 'p'.
$i
;

1955 ià(
	`is£t
(
$LocR
->
PrmL¡
[
$x
])) {

1956 
$Qu”yZ
 = 
	`¡r_»¶aû
('%p'.
$i
.'%',
$LocR
->
PrmL¡
[
$x
],$QueryZ);

1957 
$i
++;

1959 
$i
 = 
çl£
;

1961 } 
$i
!==
çl£
);

1963 
$WasP1
 = 
Œue
;

1964 } 
	`–£if
 ((
$Src
->
RecSaved
===
çl£
è
	`ªd
 (
$BlockNbr
-
$BlockId
>1)) {

1965 
$Src
->
RecSavšg
 = 
Œue
;

1967 } 
	`–£if
 (
$WasP1
) {

1968 
$Qu”yOk
 = 
çl£
;

1969 
$WasP1
 = 
çl£
;

1973 ià(
$Qu”yOk
) {

1974 ià((!
$LocR
->
BlockFound
è
	`ªd
 (!$LocR->
F›ldOutside
)) {

1976 
$Qu”yOk
 = 
çl£
;

1977 ià(
$R‘uºD©a
 
	`ªd
 (!
$Src
->
RecSaved
)) {

1978 ià(
$Src
->
	`D©aO³n
(
$Qu”yZ
,
$QryPrms
)) {

1979 dØ{
$Src
->
	`D©aF‘ch
();} $Src->
Cu¼Rec
!==
çl£
);

1980 
$Src
->
	`D©aClo£
();

1984 
$Qu”yOk
 = 
$Src
->
	`D©aO³n
(
$Qu”yZ
,
$QryPrms
);

1985 ià(!
$Qu”yOk
) {

1986 ià(
$WasP1
è{ $WasP1 = 
çl£
;} {
$LocR
->
F›ldOutside
 = false;}

1992 ià(
$Qu”yOk
) {

1993 ià(
$Src
->
Ty³
===2) {

1994 ià(
$LocR
->
BlockFound
) {

1995 
$Txt
 = 
	`sub¡r_»¶aû
($Txt,
$Src
->
RecS‘
,
$LocR
->
PosBeg
,$LocR->
PosEnd
-$LocR->PosBeg+1);

1996 
$Src
->
	`D©aF‘ch
();

1997 
$Src
->
RecNum
 = 1;

1998 
$Src
->
Cu¼Rec
 = 
çl£
;

2000 
$Src
->
	`D©aAË¹
('can\'t mergehe block with‡ext value becausehe block definition is‚ot found.');

2002 } 
	`–£if
 (
$LocR
->
BlockFound
===
çl£
) {

2003 
$Src
->
	`D©aF‘ch
();

2005 
$this
->
	`m‘h_M”ge_BlockSeùiÚs
(
$Txt
,
$LocR
,
$Src
,
$RecS³
);

2007 
$Src
->
	`D©aClo£
();

2010 ià(!
$WasP1
) {

2011 
$NbrRecTÙ
 +ğ
$Src
->
RecNum
;

2012 
$BlockId
++;

2014 ià(
$LocR
->
F›ldOutside
è
$this
->
	`m‘h_M”ge_F›ldOutside
(
$Txt
,
$Src
->
Cu¼Rec
,$Src->
RecNum
,$LocR->
FOStİ
);

2019 
	`un£t
(
$LocR
);

2020 
$this
->
_Cu¼Block
 = 
$BlockSave
;

2021 ià(
$R‘uºD©a
) {

2022  
$Src
->
RecS‘
;

2024 
	`un£t
(
$Src
);

2025  
$NbrRecTÙ
;

2028 
	}
}

2030 
funùiÚ
 
	$m‘h_M”ge_BlockSeùiÚs
(&
$Txt
,&
$LocR
,&
$Src
,&
$RecS³
) {

2033 
$SecId
 = 0;

2034 
$SecOk
 = (
$LocR
->
SeùiÚNbr
>0);

2035 
$SecSrc
 = '';

2036 
$BlockRes
 = '';

2037 
$IsS”Ÿl
 = 
çl£
;

2038 
$SrId
 = 0;

2039 
$SrNbr
 = 0;

2040 
$G½Found
 = 
çl£
;

2041 ià(
$LocR
->
H—d”Found
 
Ü
 $LocR->
FoÙ”Found
) {

2042 
$G½Found
 = 
Œue
;

2043 
$piOMG
 = 
çl£
;

2044 ià(
$LocR
->
FoÙ”Found
è
$Src
->
P»vRec
 = (
objeù
è
nuÎ
;

2047 
$piOMS
 = 
çl£
;

2048 ià(
$this
->
_PlugIns_Ok
) {

2049 ià(
	`is£t
(
$this
->
_piBefÜeM”geBlock
)) {

2050 
$ArgL¡
 = 
	`¬¿y
(&
$Txt
,&
$LocR
->
PosBeg
,&$LocR->
PosEnd
,$LocR->
PrmL¡
,&
$Src
,&$LocR);

2051 
$this
->
	`m‘h_Plugš_RunAÎ
($this->
_piBefÜeM”geBlock
,
$ArgL¡
);

2053 ià(
	`is£t
(
$this
->
_piOnM”geSeùiÚ
)) {

2054 
$ArgL¡
 = 
	`¬¿y
(&
$BlockRes
,&
$SecSrc
);

2055 
$piOMS
 = 
Œue
;

2057 ià(
$G½Found
 
ªd
 
	`is£t
(
$this
->
_piOnM”geGroup
)) {

2058 
$ArgL¡2
 = 
	`¬¿y
(0,0,&
$Src
,&
$LocR
);

2059 
$piOMG
 = 
Œue
;

2064 
$Src
->
	`D©aF‘ch
();

2066 
$Src
->
Cu¼Rec
!==
çl£
) {

2069 ià(
$G½Found
) {

2070 
$brk_ªy
 = 
çl£
;

2071 
$brk_¤c
 = '';

2072 ià(
$LocR
->
FoÙ”Found
) {

2073 
$brk
 = 
çl£
;

2074 
$i
=
$LocR
->
FoÙ”Nbr
;$i>=1;$i--) {

2075 
$G½Def
 = &
$LocR
->
FoÙ”Def
[
$i
];

2076 
$x
 = 
$this
->
	`m‘h_M”ge_SeùiÚNÜm®
(
$G½Def
->
FDef
,
$Src
);

2077 ià(
$Src
->
RecNum
===1) {

2078 
$G½Def
->
P»vV®ue
 = 
$x
;

2079 
$brk_i
 = 
çl£
;

2081 ià(
$G½Def
->
AddLa¡G½
) {

2082 
$brk_i
 = &
$brk
;

2084 
	`un£t
(
$brk_i
); $brk_˜ğ
çl£
;

2086 ià(!
$brk_i
è$brk_˜ğ!(
$G½Def
->
P»vV®ue
===
$x
);

2087 ià(
$brk_i
) {

2088 
$brk_ªy
 = 
Œue
;

2089 
$ok
 = 
Œue
;

2090 ià(
$piOMG
è{
$ArgL¡2
[0]=&
$Src
->
P»vRec
; $ArgL¡2[1]=&
$G½Def
; 
$ok
 = 
$this
->
	`m‘h_PlugIn_RunAÎ
($this->
_piOnM”geGroup
,$ArgLst2);}

2091 ià(
$ok
!==
çl£
è
$brk_¤c
 = 
$this
->
	`m‘h_M”ge_SeùiÚNÜm®
(
$G½Def
,
$Src
->
P»vRec
).$brk_src;

2092 
$G½Def
->
P»vV®ue
 = 
$x
;

2096 
$Src
->
P»vRec
->
Cu¼Rec
 = $Src->CurrRec;

2097 
$Src
->
P»vRec
->
RecNum
 = $Src->RecNum;

2098 
$Src
->
P»vRec
->
RecKey
 = $Src->RecKey;

2100 ià(
$LocR
->
H—d”Found
) {

2101 
$brk
 = (
$Src
->
RecNum
===1);

2102 
$i
=1;$i<=
$LocR
->
H—d”Nbr
;$i++) {

2103 
$G½Def
 = &
$LocR
->
H—d”Def
[
$i
];

2104 
$x
 = 
$this
->
	`m‘h_M”ge_SeùiÚNÜm®
(
$G½Def
->
FDef
,
$Src
);

2105 ià(!
$brk
è$brk = !(
$G½Def
->
P»vV®ue
===
$x
);

2106 ià(
$brk
) {

2107 
$ok
 = 
Œue
;

2108 ià(
$piOMG
è{
$ArgL¡2
[0]=&
$Src
; $ArgL¡2[1]=&
$G½Def
; 
$ok
 = 
$this
->
	`m‘h_PlugIn_RunAÎ
($this->
_piOnM”geGroup
,$ArgLst2);}

2109 ià(
$ok
!==
çl£
è
$brk_¤c
 .ğ
$this
->
	`m‘h_M”ge_SeùiÚNÜm®
(
$G½Def
,
$Src
);

2110 
$G½Def
->
P»vV®ue
 = 
$x
;

2113 
$brk_ªy
 = ($brk_ªy 
Ü
 
$brk
);

2115 ià(
$brk_ªy
) {

2116 ià(
$IsS”Ÿl
) {

2117 
$BlockRes
 .ğ
$this
->
	`m‘h_M”ge_SeùiÚS”Ÿl
(
$SecDef
,
$SrId
,
$LocR
);

2118 
$IsS”Ÿl
 = 
çl£
;

2120 
$BlockRes
 .ğ
$brk_¤c
;

2125 ià((
$IsS”Ÿl
===
çl£
è
ªd
 
$SecOk
) {

2126 
$SecId
++;

2127 ià(
$SecId
>
$LocR
->
SeùiÚNbr
) $SecId = 1;

2128 
$SecDef
 = &
$LocR
->
SeùiÚL¡
[
$SecId
];

2129 
$IsS”Ÿl
 = 
$SecDef
->
IsS”Ÿl
;

2130 ià(
$IsS”Ÿl
) {

2131 
$SrId
 = 0;

2132 
$SrNbr
 = 
$SecDef
->
SrBDefNbr
;

2137 ià(
$IsS”Ÿl
) {

2138 
$SrId
++;

2139 
$SrBDef
 = &
$SecDef
->
SrBDefL¡
[
$SrId
];

2140 
$SrBDef
->
SrTxt
 = 
$this
->
	`m‘h_M”ge_SeùiÚNÜm®
($SrBDef,
$Src
);

2141 ià(
$SrId
>=
$SrNbr
) {

2142 
$SecSrc
 = 
$this
->
	`m‘h_M”ge_SeùiÚS”Ÿl
(
$SecDef
,
$SrId
,
$LocR
);

2143 
$BlockRes
 .ğ
$SecSrc
;

2144 
$IsS”Ÿl
 = 
çl£
;

2147 ià(
$SecOk
) {

2148 ià(
$Src
->
RecNum
===
$RecS³
è
$SecDef
 = &
$LocR
->
S³cŸl
;

2149 
$SecSrc
 = 
$this
->
	`m‘h_M”ge_SeùiÚNÜm®
(
$SecDef
,
$Src
);

2151 
$SecSrc
 = '';

2153 ià(
$LocR
->
Wh’Found
) {

2154 
$found
 = 
çl£
;

2155 
$cÚtšue
 = 
Œue
;

2156 
$i
 = 1;

2158 
$Wh’BDef
 = &
$LocR
->
Wh’L¡
[
$i
];

2159 
$cÚd
 = 
$this
->
	`m‘h_M”ge_SeùiÚNÜm®
(
$Wh’BDef
->
Wh’CÚd
,
$Src
);

2160 ià(
$this
->
	`f_Misc_CheckCÚd™iÚ
(
$cÚd
)) {

2161 
$x_wh’
 = 
$this
->
	`m‘h_M”ge_SeùiÚNÜm®
(
$Wh’BDef
,
$Src
);

2162 ià(
$Wh’BDef
->
Wh’BefÜeNS
è{
$SecSrc
 = 
$x_wh’
.$SecSrc;} {$SecSrc = $SecSrc.$x_when;}

2163 
$found
 = 
Œue
;

2164 ià(
$LocR
->
Wh’Sev”®
===
çl£
è
$cÚtšue
 = false;

2166 
$i
++;

2167 ià(
$i
>
$LocR
->
Wh’Nbr
è
$cÚtšue
 = 
çl£
;

2168 } 
$cÚtšue
);

2169 ià((
$found
===
çl£
è
	`ªd
 (
$LocR
->
Wh’DeçuÉ
!==false)) {

2170 
$x_wh’
 = 
$this
->
	`m‘h_M”ge_SeùiÚNÜm®
(
$LocR
->
Wh’DeçuÉ
,
$Src
);

2171 ià(
$LocR
->
Wh’DeçuÉBefÜeNS
è{
$SecSrc
 = 
$x_wh’
.$SecSrc;} {$SecSrc = $SecSrc.$x_when;}

2174 ià(
$piOMS
è
$this
->
	`m‘h_PlugIn_RunAÎ
($this->
_piOnM”geSeùiÚ
,
$ArgL¡
);

2175 
$BlockRes
 .ğ
$SecSrc
;

2179 
$Src
->
	`D©aF‘ch
();

2183 
$SecSrc
 = '';

2186 ià(
$IsS”Ÿl
è
$SecSrc
 .ğ
$this
->
	`m‘h_M”ge_SeùiÚS”Ÿl
(
$SecDef
,
$SrId
,
$LocR
);

2189 ià(
$LocR
->
FoÙ”Found
) {

2190 ià(
$Src
->
RecNum
>0) {

2191 
$i
=1;$i<=
$LocR
->
FoÙ”Nbr
;$i++) {

2192 
$G½Def
 = &
$LocR
->
FoÙ”Def
[
$i
];

2193 ià(
$G½Def
->
AddLa¡G½
) {

2194 
$ok
 = 
Œue
;

2195 ià(
$piOMG
è{
$ArgL¡2
[0]=&
$Src
->
P»vRec
; $ArgL¡2[1]=&
$G½Def
; 
$ok
 = 
$this
->
	`m‘h_PlugIn_RunAÎ
($this->
_piOnM”geGroup
,$ArgLst2);}

2196 ià(
$ok
!==
çl£
è
$SecSrc
 .ğ
$this
->
	`m‘h_M”ge_SeùiÚNÜm®
(
$G½Def
,
$Src
->
P»vRec
);

2203 ià(
$Src
->
RecNum
===0) {

2204 ià(
$LocR
->
NoD©a
!==
çl£
) {

2205 
$SecSrc
 = 
$LocR
->
NoD©a
->
Src
;

2206 } 
	`–£if
(
	`is£t
(
$LocR
->
PrmL¡
['bmagnet'])) {

2207 
$this
->
	`f_Loc_EÆ¬geToTag
(
$Txt
,
$LocR
,$LocR->
PrmL¡
['bmagÃt'],
çl£
);

2212 ià(
$piOMS
 
	`ªd
 (
$SecSrc
!=='')è
$this
->
	`m‘h_PlugIn_RunAÎ
($this->
_piOnM”geSeùiÚ
,
$ArgL¡
);

2214 
$BlockRes
 .ğ
$SecSrc
;

2217 ià(
$this
->
_PlugIns_Ok
 
ªd
 
	`is£t
(
$ArgL¡
èªd is£t($this->
_piAá”M”geBlock
)) {

2218 
$ArgL¡
 = 
	`¬¿y
(&
$BlockRes
,&
$Src
,&
$LocR
);

2219 
$this
->
	`m‘h_PlugIn_RunAÎ
($this->
_piAá”M”geBlock
,
$ArgL¡
);

2223 
$Txt
 = 
	`sub¡r_»¶aû
($Txt,
$BlockRes
,
$LocR
->
PosBeg
,$LocR->
PosEnd
-$LocR->PosBeg+1);

2224 ià(
$LocR
->
P1
è$LocR->
FOStİ
 = $LocR->
PosBeg
 + 
	`¡¾’
(
$BlockRes
) -1;

2226 
	}
}

2228 
funùiÚ
 
m‘h_M”ge_AutoV¬
(&
$Txt
,
$CÚvSŒ
,
$Id
='var') {

2231 
$P»f
 = &
$this
->
V¬P»fix
;

2232 
	g$P»fL
 = 
¡¾’
(
$P»f
);

2233 
	g$P»fOk
 = (
$P»fL
>0);

2235 ià(
	g$CÚvSŒ
===
çl£
) {

2236 
$Ch¬£t
 = 
$this
->
Ch¬£t
;

2237 
	g$this
->
	gCh¬£t
 = 
çl£
;

2241 
	g$x
 = '';

2242 
	g$Pos
 = 0;

2243 
	g$Loc
 = 
$this
->
m‘h_LoÿtÜ_FšdTbs
(
$Txt
,
$Id
,
$Pos
,'.')) {

2244 ià(
	g$Loc
->
	gSubNbr
==0è
$Loc
->
SubL¡
[0]='';

2245 ià(
	g$Loc
->
	gSubL¡
[0]==='') {

2246 
$Pos
 = 
$this
->
m‘h_M”ge_AutoS³
(
$Txt
,
$Loc
);

2247 } 
–£if
 (
$Loc
->
SubL¡
[0][0]==='~') {

2248 ià(!
is£t
(
$ObjOk
)è$ObjOk = (
is_objeù
(
$this
->
ObjeùRef
è
Ü
 
is_¬¿y
($this->ObjectRef));

2249 ià(
	g$ObjOk
) {

2250 
	g$Loc
->
	gSubL¡
[0] = 
sub¡r
(
$Loc
->
SubL¡
[0],1);

2251 
	g$Pos
 = 
$this
->
m‘h_LoÿtÜ_R•Ïû
(
$Txt
,
$Loc
,$this->
ObjeùRef
,0);

2252 } 
–£if
 (
is£t
(
$Loc
->
PrmL¡
['noerr'])) {

2253 
	g$Pos
 = 
$this
->
m‘h_LoÿtÜ_R•Ïû
(
$Txt
,
$Loc
,
$x
,
çl£
);

2255 
	g$this
->
m‘h_Misc_AË¹
(
$Loc
,'´İ”ty ObjeùReài Ã™h”‡Àobjeù‚Ü‡À¬¿y. It ty³ i \''.
g‘ty³
(
$this
->
ObjeùRef
).'\'.',
Œue
);

2256 
	g$Pos
 = 
$Loc
->
PosEnd
 + 1;

2258 } 
–£if
 (
$P»fOk
 
ªd
 (
sub¡r
(
$Loc
->
SubL¡
[0],0,
$P»fL
)!==
$P»f
)) {

2259 ià(
is£t
(
$Loc
->
PrmL¡
['noerr'])) {

2260 
$Pos
 = 
$this
->
m‘h_LoÿtÜ_R•Ïû
(
$Txt
,
$Loc
,
$x
,
çl£
);

2262 
	g$this
->
m‘h_Misc_AË¹
(
$Loc
,'dÛ nÙ m©chh®lowed…»fix.',
Œue
);

2263 
	g$Pos
 = 
$Loc
->
PosEnd
 + 1;

2265 } 
–£if
 (
is£t
(
$this
->
V¬Ref
[
$Loc
->
SubL¡
[0]])) {

2266 
	g$Pos
 = 
$this
->
m‘h_LoÿtÜ_R•Ïû
(
$Txt
,
$Loc
,$this->
V¬Ref
[$Loc->
SubL¡
[0]],1);

2268 ià(
is£t
(
$Loc
->
PrmL¡
['noerr'])) {

2269 
	g$Pos
 = 
$this
->
m‘h_LoÿtÜ_R•Ïû
(
$Txt
,
$Loc
,
$x
,
çl£
);

2271 
	g$Pos
 = 
$Loc
->
PosEnd
 + 1;

2272 
	g$msg
 = (
is£t
(
$this
->
V¬Ref
['GLOBALS'])) ? 'VarRef seems„eferso $GLOBALS' : 'VarRef seems„eferso‡ custom‡rray of values';

2273 
	g$this
->
m‘h_Misc_AË¹
(
$Loc
,'thkey \''.$Loc->
SubL¡
[0].'\' dÛ nÙƒxi¡ o¸i nÙ s‘ iÀV¬Ref. ('.
$msg
.')',
Œue
);

2278 ià(
	g$CÚvSŒ
===
çl£
è
$this
->
Ch¬£t
 = 
$Ch¬£t
;

2280  
	gçl£
;

2284 
funùiÚ
 
	$m‘h_M”ge_AutoS³
(&
$Txt
,&
$Loc
) {

2287 
$E¼Msg
 = 
çl£
;

2288 
$SubS¹
 = 
çl£
;

2289 ià(
	`is£t
(
$Loc
->
SubL¡
[1])) {

2290 
$Loc
->
SubL¡
[1]) {

2291 'now': 
$x
 = 
	`time
(); ;

2292 'v”siÚ': 
$x
 = 
$this
->
V”siÚ
; ;

2293 'süt_Çme': 
$x
 = 
	`ba£Çme
(((
	`is£t
(
$_SERVER
)è? $_SERVER['PHP_SELF'] : 
$GLOBALS
['HTTP_SERVER_VARS']['PHP_SELF'] )); ;

2294 '‹m¶©e_Çme': 
$x
 = 
$this
->
_La¡Fe
; ;

2295 '‹m¶©e_d©e': 
$x
 = ''; ià(
$this
->
	`f_Misc_G‘Fe
($x,$this->
_La¡Fe
,'',
	`¬¿y
(),
çl£
)) $x = $x['mtime']; ;

2296 '‹m¶©e_·th': 
$x
 = 
	`dœÇme
(
$this
->
_La¡Fe
).'/'; ;

2297 'Çme': 
$x
 = 'TinyButStrong'; ;

2298 'logo': 
$x
 = '**TinyButStrong**'; ;

2299 'ch¬£t': 
$x
 = 
$this
->
Ch¬£t
; ;

2300 '”rÜ_msg': 
$this
->
_E¼MsgName
 = 
$Loc
->
FuÎName
;  $Loc->
PosEnd
; ;

2301 '': 
$E¼Msg
 = 'it doesn\'t have‡ny keyword.'; ;

2303 ià(
$Loc
->
SubNbr
==2) {

2304 
$SubS¹
 = 2;

2305 
$x
 = 
	`im¶ode
(',',
	`¬¿y_keys
(
$this
->
T¶V¬s
));

2307 ià(
	`is£t
(
$this
->
T¶V¬s
[
$Loc
->
SubL¡
[2]])) {

2308 
$SubS¹
 = 3;

2309 
$x
 = &
$this
->
T¶V¬s
[
$Loc
->
SubL¡
[2]];

2311 
$E¼Msg
 = '´İ”ty T¶V¬ dÛ¢\'ˆhavªy i‹m‚amed \''.
$Loc
->
SubL¡
[2].'\'.';

2316 ià(
$Loc
->
SubNbr
==2) {

2317 
$SubS¹
 = 2;

2318 
$x
 = 
	`im¶ode
('',
$this
->
T¶StÜe
);

2320 ià(
	`is£t
(
$this
->
T¶StÜe
[
$Loc
->
SubL¡
[2]])) {

2321 
$SubS¹
 = 3;

2322 
$x
 = &
$this
->
T¶StÜe
[
$Loc
->
SubL¡
[2]];

2324 
$E¼Msg
 = 'StÜÇmed \''.
$Loc
->
SubL¡
[2].'\' is‚ot defined yet.';

2327 ià(!
	`is£t
(
$Loc
->
PrmL¡
['strconv'])) {$Loc->PrmLst['strconv'] = 'no'; $Loc->PrmLst['protect'] = 'no';}

2329 'c¡': 
$x
 = @
	`cÚ¡ªt
(
$Loc
->
SubL¡
[2]); ;

2331 
$x
 = 'TšyButSŒÚg v”siÚ '.
$this
->
V”siÚ
.' for PHP 5';

2332 
$x
 .ğ"\r\nIn¡®Ëd…lug-šs: ".
	`couÁ
(
$this
->
_PlugIns
);

2333 
	`fÜ—ch
 (
	`¬¿y_keys
(
$this
->
_PlugIns
è
as
 
$pi
) {

2334 
$o
 = &
$this
->
_PlugIns
[
$pi
];

2335 
$x
 .ğ"\r\n-…lug-š [".(
	`is£t
(
$o
->
Name
è? $o->Nam: 
$pi
 ).'] v”siÚ '.(is£t($o->
V”siÚ
) ? $o->Version : '?' );

2339 
	`ob_¡¬t
();

2340 
	`phpšfo
();

2341 
$x
 = 
	`ob_g‘_cÚ‹Ás
();

2342 
	`ob_’d_ş—n
();

2343 
$x
 = 
£lf
::
	`f_Xml_G‘P¬t
($x, '(¡yË)+body', 
çl£
);

2344 ià(!
	`is£t
(
$Loc
->
PrmL¡
['strconv'])) {$Loc->PrmLst['strconv'] = 'no'; $Loc->PrmLst['protect'] = 'no';}

2347 
$IsSuµÜ‹d
 = 
çl£
;

2348 ià(
	`is£t
(
$this
->
_piOnS³cŸlV¬
)) {

2349 
$x
 = '';

2350 
$ArgL¡
 = 
	`¬¿y
(
	`sub¡r
(
$Loc
->
SubName
,1),&
$IsSuµÜ‹d
 ,&
$x
, &$Loc->
PrmL¡
,&
$Txt
,&$Loc->
PosBeg
,&$Loc->
PosEnd
,&$Loc);

2351 
$this
->
	`m‘h_PlugIn_RunAÎ
($this->
_piOnS³cŸlV¬
,
$ArgL¡
);

2353 ià(!
$IsSuµÜ‹d
è
$E¼Msg
 = '\''.
$Loc
->
SubL¡
[1].'\' is‡n unsupported keyword.';

2356 
$E¼Msg
 = 'it doesn\'t have‡ny subname.';

2358 ià(
$E¼Msg
!==
çl£
) {

2359 
$this
->
	`m‘h_Misc_AË¹
(
$Loc
,
$E¼Msg
);

2360 
$x
 = '';

2362 ià(
$Loc
->
PosBeg
===
çl£
) {

2363  
$Loc
->
PosEnd
;

2365  
$this
->
	`m‘h_LoÿtÜ_R•Ïû
(
$Txt
,
$Loc
,
$x
,
$SubS¹
);

2367 
	}
}

2369 
funùiÚ
 
	$m‘h_M”ge_F›ldOutside
(&
$Txt
, &
$Cu¼Rec
, 
$RecNum
, 
$PosMax
) {

2370 
$Pos
 = 0;

2371 
$SubS¹
 = (
$Cu¼Rec
===
çl£
) ? false : 0;

2373 
$Loc
 = 
$this
->
	`m‘h_LoÿtÜ_FšdTbs
(
$Txt
,$this->
_Cu¼Block
,
$Pos
,'.');

2374 ià(
$Loc
!==
çl£
) {

2375 ià((
$PosMax
!==
çl£
è
	`ªd
 (
$Loc
->
PosEnd
>$PosMax)) ;

2376 ià(
$Loc
->
SubName
==='#') {

2377 
$NewEnd
 = 
$this
->
	`m‘h_LoÿtÜ_R•Ïû
(
$Txt
,
$Loc
,
$RecNum
,
çl£
);

2379 
$NewEnd
 = 
$this
->
	`m‘h_LoÿtÜ_R•Ïû
(
$Txt
,
$Loc
,
$Cu¼Rec
,
$SubS¹
);

2381 ià(
$PosMax
!==
çl£
è$PosMax +ğ
$NewEnd
 - 
$Loc
->
PosEnd
;

2382 
$Pos
 = 
$NewEnd
;

2384 } 
$Loc
!==
çl£
);

2385 
	}
}

2387 
funùiÚ
 
	$m‘h_M”ge_SeùiÚNÜm®
(&
$BDef
,&
$Src
) {

2389 
$Txt
 = 
$BDef
->
Src
;

2390 
$LocL¡
 = &
$BDef
->
LocL¡
;

2391 
$iMax
 = 
$BDef
->
LocNbr
;

2392 
$PosMax
 = 
	`¡¾’
(
$Txt
);

2394 ià(
$Src
===
çl£
) {

2396 
$x
 = '';

2399 
$i
=
$iMax
;$i>0;$i--) {

2400 ià(
$LocL¡
[
$i
]->
PosBeg
<
$PosMax
) {

2401 
$this
->
	`m‘h_LoÿtÜ_R•Ïû
(
$Txt
,
$LocL¡
[
$i
],
$x
,
çl£
);

2402 ià(
$LocL¡
[
$i
]->
EÆ¬ged
) {

2403 
$PosMax
 = 
$LocL¡
[
$i
]->
PosBeg
;

2404 
$LocL¡
[
$i
]->
PosBeg
 = $LocL¡[$i]->
PosBeg0
;

2405 
$LocL¡
[
$i
]->
PosEnd
 = $LocL¡[$i]->
PosEnd0
;

2406 
$LocL¡
[
$i
]->
EÆ¬ged
 = 
çl£
;

2412 ià(
$BDef
->
Chk
) {

2413 
$BlockName
 = &
$BDef
->
Name
;

2414 
$Pos
 = 0;

2415 
$Loc
 = 
$this
->
	`m‘h_LoÿtÜ_FšdTbs
(
$Txt
,
$BlockName
,
$Pos
,'.')è$Po ğ$this->
	`m‘h_LoÿtÜ_R•Ïû
($Txt,$Loc,
$x
,
çl£
);

2421 
$i
=
$iMax
;$i>0;$i--) {

2422 ià(
$LocL¡
[
$i
]->
PosBeg
<
$PosMax
) {

2423 ià(
$LocL¡
[
$i
]->
IsRecInfo
) {

2424 ià(
$LocL¡
[
$i
]->
RecInfo
==='#') {

2425 
$this
->
	`m‘h_LoÿtÜ_R•Ïû
(
$Txt
,
$LocL¡
[
$i
],
$Src
->
RecNum
,
çl£
);

2427 
$this
->
	`m‘h_LoÿtÜ_R•Ïû
(
$Txt
,
$LocL¡
[
$i
],
$Src
->
RecKey
,
çl£
);

2430 
$this
->
	`m‘h_LoÿtÜ_R•Ïû
(
$Txt
,
$LocL¡
[
$i
],
$Src
->
Cu¼Rec
,0);

2432 ià(
$LocL¡
[
$i
]->
EÆ¬ged
) {

2433 
$PosMax
 = 
$LocL¡
[
$i
]->
PosBeg
;

2434 
$LocL¡
[
$i
]->
PosBeg
 = $LocL¡[$i]->
PosBeg0
;

2435 
$LocL¡
[
$i
]->
PosEnd
 = $LocL¡[$i]->
PosEnd0
;

2436 
$LocL¡
[
$i
]->
EÆ¬ged
 = 
çl£
;

2442 ià(
$BDef
->
Chk
) {

2443 
$BlockName
 = &
$BDef
->
Name
;

2444 
	`fÜ—ch
 (
$Src
->
Cu¼Rec
 
as
 
$key
 => 
$v®
) {

2445 
$Pos
 = 0;

2446 
$Name
 = 
$BlockName
.'.'.
$key
;

2447 
$Loc
 = 
$this
->
	`m‘h_LoÿtÜ_FšdTbs
(
$Txt
,
$Name
,
$Pos
,'.')è$Po ğ$this->
	`m‘h_LoÿtÜ_R•Ïû
($Txt,$Loc,
$v®
,0);

2449 
$Pos
 = 0;

2450 
$Name
 = 
$BlockName
.'.#';

2451 
$Loc
 = 
$this
->
	`m‘h_LoÿtÜ_FšdTbs
(
$Txt
,
$Name
,
$Pos
,'.')è$Po ğ$this->
	`m‘h_LoÿtÜ_R•Ïû
($Txt,$Loc,
$Src
->
RecNum
,0);

2452 
$Pos
 = 0;

2453 
$Name
 = 
$BlockName
.'.$';

2454 
$Loc
 = 
$this
->
	`m‘h_LoÿtÜ_FšdTbs
(
$Txt
,
$Name
,
$Pos
,'.')è$Po ğ$this->
	`m‘h_LoÿtÜ_R•Ïû
($Txt,$Loc,
$Src
->
RecKey
,0);

2460 ià(
	`is£t
(
$BDef
->
AutoSub
)) {

2461 
$i
=1;$i<=
$BDef
->
AutoSub
;$i++) {

2462 
$Çme
 = 
$BDef
->
Name
.'_sub'.
$i
;

2463 
$qu”y
 = '';

2464 
$cŞ
 = 
$BDef
->
Prm
['sub'.
$i
];

2465 ià(
$cŞ
===
Œue
) $col = '';

2466 
$cŞ_İt
 = (
	`sub¡r
(
$cŞ
,0,1)==='(') && (substr($col,-1,1)===')');

2467 ià(
$cŞ_İt
è
$cŞ
 = 
	`sub¡r
($cŞ,1,
	`¡¾’
($col)-2);

2468 ià(
$cŞ
==='') {

2470 
$d©a
 = &
$Src
->
Cu¼Rec
;

2471 } 
	`–£if
 (
	`is_objeù
(
$Src
->
Cu¼Rec
)) {

2472 
$d©a
 = &
$Src
->
Cu¼Rec
->
$cŞ
;

2474 ià(
	`¬¿y_key_exi¡s
(
$cŞ
, 
$Src
->
Cu¼Rec
)) {

2475 
$d©a
 = &
$Src
->
Cu¼Rec
[
$cŞ
];

2477 ià(!
$cŞ_İt
è
$this
->
	`m‘h_Misc_AË¹
('fÜ m”gšghautom©iøsub-block ['.
$Çme
.']','key \''.
$cŞ
.'\' i nÙ found iÀ»cÜd #'.
$Src
->
RecNum
.' oàblock ['.
$BDef
->
Name
.']. Thi key cª becomİtiÚ® iàyou desigÇ‹ iˆw™h…¬’thesi šhmaš block, i.e.: sub'.
$i
.'=('.$col.')');

2478 
	`un£t
(
$d©a
); $d©¨ğ
	`¬¿y
();

2481 ià(
	`is_¡ršg
(
$d©a
)) {

2482 
$d©a
 = 
	`ex¶ode
(',',$data);

2483 } 
	`–£if
 (
	`is_nuÎ
(
$d©a
è|| ($d©a===
çl£
)) {

2484 
$d©a
 = 
	`¬¿y
();

2486 
$this
->
	`m‘h_M”ge_Block
(
$Txt
, 
$Çme
, 
$d©a
, 
$qu”y
, 
çl£
, 0, false);

2490  
$Txt
;

2492 
	}
}

2494 
funùiÚ
 
	$m‘h_M”ge_SeùiÚS”Ÿl
(&
$BDef
,&
$SrId
,&
$LocR
) {

2496 
$Txt
 = 
$BDef
->
Src
;

2497 
$SrBDefOrd”ed
 = &
$BDef
->
SrBDefOrd”ed
;

2498 
$Em±y
 = &
$LocR
->
S”ŸlEm±y
;

2501 
$F
 = 
çl£
;

2502 
$i
=
$BDef
->
SrBDefNbr
;$i>0;$i--) {

2503 
$SrBDef
 = &
$SrBDefOrd”ed
[
$i
];

2504 ià(
$SrBDef
->
SrTxt
===
çl£
) {

2505 ià(
$Em±y
===
çl£
) {

2506 
$SrBDef
->
SrTxt
 = 
$this
->
	`m‘h_M”ge_SeùiÚNÜm®
($SrBDef,
$F
);

2508 
$SrBDef
->
SrTxt
 = 
$Em±y
;

2511 
$Txt
 = 
	`sub¡r_»¶aû
($Txt,
$SrBDef
->
SrTxt
,$SrBDef->
SrBeg
,$SrBDef->
SrL’
);

2512 
$SrBDef
->
SrTxt
 = 
çl£
;

2515 
$SrId
 = 0;

2516  
$Txt
;

2518 
	}
}

2520 
funùiÚ
 
	$m‘h_M”ge_AutoOn
(&
$Txt
,
$Name
,
$T¶V¬
,
$M”geV¬
) {

2523 
$G½Di¥Ïyed
 = 
	`¬¿y
();

2524 
$G½Exşusive
 = 
	`¬¿y
();

2525 
$P1
 = 
çl£
;

2526 
$F›ldBefÜe
 = 
çl£
;

2527 
$Pos
 = 0;

2529 
$LocA
=
$this
->
	`m‘h_LoÿtÜ_FšdBlockNext
(
$Txt
,
$Name
,
$Pos
,'_',1,
$P1
,
$F›ldBefÜe
)) {

2531 ià(
$LocA
->
BlockFound
) {

2533 ià(!
	`is£t
(
$G½Di¥Ïyed
[
$LocA
->
SubName
])) {

2534 
$G½Di¥Ïyed
[
$LocA
->
SubName
] = 
çl£
;

2535 
$G½Exşusive
[
$LocA
->
SubName
] = ($LocA->SubName!=='');

2537 
$Di¥Ïyed
 = &
$G½Di¥Ïyed
[
$LocA
->
SubName
];

2538 
$Exşusive
 = &
$G½Exşusive
[
$LocA
->
SubName
];

2540 
$D–Block
 = 
çl£
;

2541 
$D–F›ld
 = 
çl£
;

2542 ià(
$Di¥Ïyed
 
ªd
 
$Exşusive
) {

2543 
$D–Block
 = 
Œue
;

2545 ià(
	`is£t
(
$LocA
->
PrmL¡
['when'])) {

2546 ià(
	`is£t
(
$LocA
->
PrmL¡
['£v”®'])è
$Exşusive
=
çl£
;

2547 
$x
 = 
$LocA
->
PrmL¡
['when'];

2548 
$this
->
	`m‘h_M”ge_AutoV¬
(
$x
,
çl£
);

2549 ià(
$this
->
	`f_Misc_CheckCÚd™iÚ
(
$x
)) {

2550 
$D–F›ld
 = 
Œue
;

2551 
$Di¥Ïyed
 = 
Œue
;

2553 
$D–Block
 = 
Œue
;

2555 } 
	`–£if
(
	`is£t
(
$LocA
->
PrmL¡
['default'])) {

2556 ià(
$Di¥Ïyed
) {

2557 
$D–Block
 = 
Œue
;

2559 
$Di¥Ïyed
 = 
Œue
;

2560 
$D–F›ld
 = 
Œue
;

2562 
$Exşusive
 = 
Œue
;

2567 ià(
$D–F›ld
) {

2568 ià(
$LocA
->
PosBeg2
!==
çl£
è
$Txt
 = 
	`sub¡r_»¶aû
($Txt,'',$LocA->PosBeg2,$LocA->
PosEnd2
-$LocA->PosBeg2+1);

2569 
$Txt
 = 
	`sub¡r_»¶aû
($Txt,'',
$LocA
->
PosBeg
,$LocA->
PosEnd
-$LocA->PosBeg+1);

2570 
$Pos
 = 
$LocA
->
PosBeg
;

2572 ià(
$LocA
->
PosBeg2
===
çl£
) {

2573 ià(
$this
->
	`f_Loc_EÆ¬geToTag
(
$Txt
,
$LocA
,$LocA->
PrmL¡
['block'],
çl£
)===çl£è$this->
	`m‘h_Misc_AË¹
($LocA,'at†east oneag correspondingo '.$LocA->PrmLst['block'].' is‚ot found. Check openingags, closingags‡ndƒmbedding†evels.',false,'in block\'s definition');

2575 
$LocA
->
PosEnd
 = $LocA->
PosEnd2
;

2577 ià(
$D–Block
) {

2578 
$Txt
 = 
	`sub¡r_»¶aû
($Txt,'',
$LocA
->
PosBeg
,$LocA->
PosEnd
-$LocA->PosBeg+1);

2581 
$x
 = '';

2582 
$this
->
	`m‘h_LoÿtÜ_R•Ïû
(
$Txt
,
$LocA
,
$x
,
çl£
);

2584 
$Pos
 = 
$LocA
->
PosBeg
;

2590 ià(
$T¶V¬
) {

2591 ià(
	`is£t
(
$LocA
->
PrmL¡
['lv¬s']è
Ü
 isset($LocA->PrmLst['tplfrms'])) {

2592 
$Sÿn
 = '';

2593 
	`fÜ—ch
 (
$LocA
->
PrmL¡
 
as
 
$Key
 => 
$V®
) {

2594 ià(
$Sÿn
=='v') {

2595 
$this
->
T¶V¬s
[
$Key
] = 
$V®
;

2596 } 
	`–£if
 (
$Sÿn
=='f') {

2597 
£lf
::
	`f_Misc_FÜm©Save
(
$V®
,
$Key
);

2598 } 
	`–£if
 (
$Key
==='tplvars') {

2599 
$Sÿn
 = 'v';

2600 } 
	`–£if
 (
$Key
==='tplfrms') {

2601 
$Sÿn
 = 'f';

2607 
$x
 = '';

2608 
$Pos
 = 
$this
->
	`m‘h_LoÿtÜ_R•Ïû
(
$Txt
,
$LocA
,
$x
,
çl£
);

2609 
$Pos
 = 
$LocA
->
PosBeg
;

2615 ià(
$M”geV¬
è
$this
->
	`m‘h_M”ge_AutoV¬
($this->
Sourû
,
Œue
,
$Name
);

2617 
	`fÜ—ch
 (
$this
->
AssigÃd
 
as
 
$n
=>
$a
) {

2618 ià(
	`is£t
(
$a
['auto']è
	`ªd
 ($a['auto']===
$Name
)) {

2619 
$x
 = 
	`¬¿y
();

2620 
$this
->
	`m‘h_Misc_Assign
(
$n
,
$x
,
çl£
);

2624 
	}
}

2627 
funùiÚ
 
	$m‘h_CÚv_P»·»
(&
$Loc
, 
$SŒCÚv
) {

2628 
$x
 = 
	`¡¹Şow”
(
$SŒCÚv
);

2629 
$x
 = '+'.
	`¡r_»¶aû
(' ','',$x).'+';

2630 ià(
	`¡½os
(
$x
,'+esc+')!==
çl£
è{
$this
->
	`f_Misc_CÚvS³
(
$Loc
); $Loc->
CÚvSŒ
 = f®£; $Loc->
CÚvEsc
 = 
Œue
; }

2631 ià(
	`¡½os
(
$x
,'+w¥+')!==
çl£
è{
$this
->
	`f_Misc_CÚvS³
(
$Loc
); $Loc->
CÚvWS
 = 
Œue
; }

2632 ià(
	`¡½os
(
$x
,'+js+')!==
çl£
è{
$this
->
	`f_Misc_CÚvS³
(
$Loc
); $Loc->
CÚvSŒ
 = f®£; $Loc->
CÚvJS
 = 
Œue
; }

2633 ià(
	`¡½os
(
$x
,'+u¾+')!==
çl£
è{
$this
->
	`f_Misc_CÚvS³
(
$Loc
); $Loc->
CÚvSŒ
 = f®£; $Loc->
CÚvU¾
 = 
Œue
; }

2634 ià(
	`¡½os
(
$x
,'+utf8+')!==
çl£
è{
$this
->
	`f_Misc_CÚvS³
(
$Loc
); $Loc->
CÚvSŒ
 = f®£; $Loc->
CÚvUtf8
 = 
Œue
; }

2635 ià(
	`¡½os
(
$x
,'+no+')!==
çl£
è
$Loc
->
CÚvSŒ
 = false;

2636 ià(
	`¡½os
(
$x
,'+yes+')!==
çl£
è
$Loc
->
CÚvSŒ
 = 
Œue
;

2637 ià(
	`¡½os
(
$x
,'+nobr+')!==
çl£
è{
$Loc
->
CÚvSŒ
 = 
Œue
; $Loc->
CÚvBr
 = false; }

2638 
	}
}

2641 
funùiÚ
 
	$m‘h_CÚv_SŒ
(&
$Txt
,
$CÚvBr
=
Œue
) {

2642 ià(
$this
->
Ch¬£t
==='') {

2643 
$Txt
 = 
	`html¥ecŸlch¬s
($Txt);

2644 ià(
$CÚvBr
è
$Txt
 = 
	`Æ2br
($Txt);

2645 } 
	`–£if
 (
$this
->
_Ch¬£tFù
) {

2646 
$Txt
 = 
	`ÿÎ_u£r_func
(
$this
->
Ch¬£t
,$Txt,
$CÚvBr
);

2648 
$Txt
 = 
	`html¥ecŸlch¬s
($Txt,
ENT_COMPAT
,
$this
->
Ch¬£t
);

2649 ià(
$CÚvBr
è
$Txt
 = 
	`Æ2br
($Txt);

2651 
	}
}

2654 
funùiÚ
 
	$m‘h_Misc_AË¹
(
$Src
,
$Msg
,
$NoE¼Msg
=
çl£
,
$SrcTy³
=false) {

2655 
$this
->
E¼CouÁ
++;

2656 ià(
$this
->
NoE¼
) {

2657 
$t
 = 
	`¬¿y
('','','','','');

2659 
$t
 = 
	`¬¿y
('<br /><b>','</b>','<em>','</em>','<br />');

2660 
$Msg
 = 
	`htmËÁ™›s
($Msg);

2662 ià(!
	`is_¡ršg
(
$Src
)) {

2663 ià(
$SrcTy³
===
çl£
) $SrcType='in field';

2664 
$Src
 = 
$SrcTy³
.' '.
$this
->
_ChrO³n
.$Src->
FuÎName
.'...'.$this->
_ChrClo£
;

2666 
$x
 = 
$t
[0].'TšyButSŒÚg E¼Ü'.$t[1].' '.
$Src
.': '.
$Msg
;

2667 ià(
$NoE¼Msg
è
$x
 = $x.' '.
$t
[2].'This message can be cancelled using…arameter \'noerr\'.'.$t[3];

2668 
$x
 = $x.
$t
[4]."\n";

2669 ià(
$this
->
NoE¼
) {

2670 
$this
->
E¼Msg
 .ğ
$x
;

2672 
$x
 = 
	`¡r_»¶aû
(
$this
->
_ChrO³n
,$this->
_ChrPrÙeù
,$x);

2673 
echo
 
$x
;

2675  
çl£
;

2676 
	}
}

2678 
funùiÚ
 
	$m‘h_Misc_Assign
(
$Name
,&
$ArgL¡
,
$C®lšgM‘h
) {

2681 ià(!
	`is£t
(
$this
->
AssigÃd
[
$Name
])) {

2682 ià(
$C®lšgM‘h
===
çl£
è 
Œue
;

2683  
$this
->
	`m‘h_Misc_AË¹
('w™h '.
$C®lšgM‘h
.'(èm‘hod','key \''.
$Name
.'\' is‚ot defined in…roperty Assigned.');

2686 
$a
 = &
$this
->
AssigÃd
[
$Name
];

2687 
$m‘h
 = (
	`is£t
(
$a
['type'])) ? $a['type'] : 'MergeBlock';

2688 ià((
$C®lšgM‘h
!==
çl£
è
	`ªd
 (
	`¡rÿ£cmp
($C®lšgM‘h,
$m‘h
)!=0)è 
$this
->
	`m‘h_Misc_AË¹
('w™h '.$C®lšgM‘h.'(èm‘hod','thassigÃd key \''.
$Name
.'\' cannot be used with method '.$CallingMeth.' because it is definedo„un with '.$meth.'.');

2690 
$n
 = 
	`couÁ
(
$a
);

2691 
$i
=0;$i<
$n
;$i++) {

2692 ià(
	`is£t
(
$a
[
$i
])è
$ArgL¡
[$i] = &$a[$i];

2695 ià(
$C®lšgM‘h
===
çl£
) {

2696 ià(
	`š_¬¿y
(
	`¡¹Şow”
(
$m‘h
),
	`¬¿y
('mergeblock','mergefield'))) {

2697 
	`ÿÎ_u£r_func_¬¿y
(
	`¬¿y
(&
$this
,
$m‘h
), 
$ArgL¡
);

2699  
$this
->
	`m‘h_Misc_AË¹
('ThassigÃd f›ld \''.
$Name
.'\'. cªnÙ bm”ged beÿu£ it ty³ \''.
$a
[0].'\' is‚ot supported.');

2702 ià(!
	`is£t
(
$a
['merged'])) $a['merged'] = 0;

2703 
$a
['merged']++;

2704  
Œue
;

2705 
	}
}

2707 
funùiÚ
 
	$m‘h_Misc_ChªgeMode
(
$In™
,&
$Loc
,&
$Cu¼V®
) {

2708 ià(
$In™
) {

2710 
$Loc
->
SaveSrc
 = &
$this
->
Sourû
;

2711 
$Loc
->
SaveR’d”
 = 
$this
->
R’d”
;

2712 
$Loc
->
SaveMode
 = 
$this
->
_Mode
;

2713 
$Loc
->
SaveV¬Ref
 = &
$this
->
V¬Ref
;

2714 
	`un£t
(
$this
->
Sourû
); $this->Source = '';

2715 
$this
->
R’d”
 = 
TBS_OUTPUT
;

2716 
$this
->
_Mode
++;

2717 
	`ob_¡¬t
();

2720 
$this
->
Sourû
 = &
$Loc
->
SaveSrc
;

2721 
$this
->
R’d”
 = 
$Loc
->
SaveR’d”
;

2722 
$this
->
_Mode
 = 
$Loc
->
SaveMode
;

2723 
$this
->
V¬Ref
 = &
$Loc
->
SaveV¬Ref
;

2724 
$Cu¼V®
 = 
	`ob_g‘_cÚ‹Ás
();

2725 
	`ob_’d_ş—n
();

2727 
	}
}

2729 
funùiÚ
 
	$m‘h_Misc_U£rFùCheck
(&
$FùInfo
,
$FùC©
,&
$FùObj
,&
$E¼Msg
,
$FùCheck
=
çl£
) {

2731 
$FùId
 = 
$FùC©
.':'.
$FùInfo
;

2732 ià(
	`is£t
(
$this
->
_U£rFùL¡
[
$FùId
])) {

2733 
$FùInfo
 = 
$this
->
_U£rFùL¡
[
$FùId
];

2734  
Œue
;

2738 
$FùSŒ
 = 
$FùInfo
;

2739 
$IsD©a
 = (
$FùC©
!=='f');

2740 
$Save
 = 
Œue
;

2741 ià(
$FùSŒ
[0]==='~') {

2742 
$ObjRef
 = &
$this
->
ObjeùRef
;

2743 
$L¡
 = 
	`ex¶ode
('.',
	`sub¡r
(
$FùSŒ
,1));

2744 
$iMax
 = 
	`couÁ
(
$L¡
) - 1;

2745 
$Suff
 = 'tbsdb';

2746 
$iMax0
 = 
$iMax
;

2747 ià(
$IsD©a
) {

2748 
$Suff
 = 
$L¡
[
$iMax
];

2749 
$iMax
--;

2752 
$i
=0;$i<=
$iMax
;$i++) {

2753 
$x
 = &
$L¡
[
$i
];

2754 ià(
	`is_objeù
(
$ObjRef
)) {

2755 
$ArgL¡
 = 
$this
->
	`f_Misc_CheckArgL¡
(
$x
);

2756 ià(
	`m‘hod_exi¡s
(
$ObjRef
,
$x
)) {

2757 ià(
$i
<
$iMax
) {

2758 
$f
 = 
	`¬¿y
(&
$ObjRef
,
$x
); 
	`un£t
($ObjRef);

2759 
$ObjRef
 = 
	`ÿÎ_u£r_func_¬¿y
(
$f
,
$ArgL¡
);

2761 } 
	`–£if
 (
$i
===
$iMax0
) {

2762 
$E¼Msg
 = 'Ex´essiÚ \''.
$FùSŒ
.'\' i šv®id beÿu£ \''.
$x
.'\' i nÙ‡ m‘hod iÀthşas \''.
	`g‘_şass
(
$ObjRef
).'\'.';

2763  
çl£
;

2764 } 
	`–£if
 (
	`is£t
(
$ObjRef
->
$x
)) {

2765 
$ObjRef
 = &$ObjRef->
$x
;

2767 
$E¼Msg
 = 'Ex´essiÚ \''.
$FùSŒ
.'\' i šv®id beÿu£ sub-™em \''.
$x
.'\' i Ã™h”‡ m‘hod‚Ü‡…rİ”ty iÀthşas \''.
	`g‘_şass
(
$ObjRef
).'\'.';

2768  
çl£
;

2770 } 
	`–£if
 ((
$i
<
$iMax0
è
ªd
 
	`is_¬¿y
(
$ObjRef
)) {

2771 ià(
	`is£t
(
$ObjRef
[
$x
])) {

2772 
$ObjRef
 = &$ObjRef[
$x
];

2774 
$E¼Msg
 = 'Ex´essiÚ \''.
$FùSŒ
.'\' i šv®id beÿu£ sub-™em \''.
$x
.'\' is‚ot‡ƒxisting key inhe‡rray.';

2775  
çl£
;

2778 
$E¼Msg
 = 'Ex´essiÚ \''.
$FùSŒ
.'\' i šv®id beÿu£ '.((
$i
===0)?'´İ”ty ObjeùRef':'sub-™em \''.
$x
.'\'').' i nÙ‡Àobjeù'.(($i<
$iMax
)?' or‡n‡rray.':'.');

2779  
çl£
;

2783 ià(
$IsD©a
) {

2784 
$FùInfo
 = 
	`¬¿y
('open'=>'','fetch'=>'','close'=>'');

2785 
	`fÜ—ch
 (
$FùInfo
 
as
 
$aù
=>
$x
) {

2786 
$FùName
 = 
$Suff
.'_'.
$aù
;

2787 ià(
	`m‘hod_exi¡s
(
$ObjRef
,
$FùName
)) {

2788 
$FùInfo
[
$aù
] = 
	`¬¿y
(&
$ObjRef
,
$FùName
);

2790 
$E¼Msg
 = 'Ex´essiÚ \''.
$FùSŒ
.'\' i šv®id beÿu£ m‘hod '.
$FùName
.' is‚ot found.';

2791  
çl£
;

2794 
$FùInfo
['type'] = 4;

2795 ià(
	`is£t
(
$this
->
RecheckObj
è
ªd
 $this->RecheckObjè
$Save
 = 
çl£
;

2797 
$FùInfo
 = 
	`¬¿y
(&
$ObjRef
,
$x
);

2799 } 
	`–£if
 (
$IsD©a
) {

2801 
$IsObj
 = (
$FùC©
==='o');

2803 ià(
$IsObj
 
ªd
 
	`m‘hod_exi¡s
(
$FùObj
,'tbsdb_İ’'è
	`ªd
 (!method_exists($FctObj,'+'))) {

2805 ià(!
	`m‘hod_exi¡s
(
$FùObj
,'tbsdb_fetch')) {

2806 
$E¼Msg
 = 'thex³ùed m‘hod \'tbsdb_ãtch\' i nÙ found fÜhşas '.
$Cls
.'.';

2807  
çl£
;

2809 ià(!
	`m‘hod_exi¡s
(
$FùObj
,'tbsdb_close')) {

2810 
$E¼Msg
 = 'thex³ùed m‘hod \'tbsdb_şo£\' i nÙ found fÜhşas '.
$Cls
.'.';

2811  
çl£
;

2813 
$FùInfo
 = 
	`¬¿y
('type'=>5);

2817 ià(
$FùC©
==='r') {

2818 
$x
 = 
	`¡¹Şow”
(
$FùSŒ
);

2819 
$x
 = 
	`¡r_»¶aû
('-','_',$x);

2820 
$Key
 = '';

2821 
$i
 = 0;

2822 
$iMax
 = 
	`¡¾’
(
$x
);

2823 
$i
<
$iMax
) {

2824 ià((
$x
[
$i
]==='_'è
	`Ü
 (($x[$i]>='a'è
	`ªd
 ($x[$i]<='z')) or (($x[$i]>='0')‡nd ($x[$i]<='9'))) {

2825 
$Key
 .ğ
$x
[
$i
];

2826 
$i
++;

2828 
$i
 = 
$iMax
;

2832 
$Key
 = 
$FùSŒ
;

2835 
$FùInfo
 = 
	`¬¿y
('open'=>'','fetch'=>'','close'=>'');

2836 
	`fÜ—ch
 (
$FùInfo
 
as
 
$aù
=>
$x
) {

2837 
$FùName
 = 'tbsdb_'.
$Key
.'_'.
$aù
;

2838 ià(
	`funùiÚ_exi¡s
(
$FùName
)) {

2839 
$FùInfo
[
$aù
] = 
$FùName
;

2841 
$”r
 = 
Œue
;

2842 ià(
$aù
==='open') {

2843 
$p
 = 
	`¡½os
(
$Key
,'_');

2844 ià(
$p
!==
çl£
) {

2845 
$Key2
 = 
	`sub¡r
(
$Key
,0,
$p
);

2846 
$FùName2
 = 'tbsdb_'.
$Key2
.'_'.
$aù
;

2847 ià(
	`funùiÚ_exi¡s
(
$FùName2
)) {

2848 
$”r
 = 
çl£
;

2849 
$Key
 = 
$Key2
;

2850 
$FùInfo
[
$aù
] = 
$FùName2
;

2854 ià(
$”r
) {

2855 
$E¼Msg
 = 'D©¨sourû Id \''.
$FùSŒ
.'\' i unsuµÜ‹d beÿu£ funùiÚ \''.
$FùName
.'\' is‚ot found.';

2856  
çl£
;

2861 
$FùInfo
['type'] = 3;

2866 iàĞ
$FùCheck
 && (
$this
->
FùP»fix
!==''è&& (
	`¡ºcmp
($this->FùP»fix,
$FùSŒ
,
	`¡¾’
($this->FctPrefix))!==0) ) {

2867 
$E¼Msg
 = 'u£¸funùiÚ \''.
$FùSŒ
.'\' dÛ nÙ m©chh®lowed…»fix.';  
çl£
;

2868 } ià(!
	`funùiÚ_exi¡s
(
$FùSŒ
)) {

2869 
$x
 = 
	`ex¶ode
('.',
$FùSŒ
);

2870 ià(
	`couÁ
(
$x
)==2) {

2871 ià(
	`şass_exi¡s
(
$x
[0])) {

2872 
$FùInfo
 = 
$x
;

2874 
$E¼Msg
 = 'u£¸funùiÚ \''.
$FùSŒ
.'\' i nÙ cÜ»ù beÿu£ \''.
$x
[0].'\' i nÙ‡ cÏs Çme.';  
çl£
;

2877 
$E¼Msg
 = 'u£¸funùiÚ \''.
$FùSŒ
.'\' i nÙ found.';  
çl£
;

2882 ià(
$Save
è
$this
->
_U£rFùL¡
[
$FùId
] = 
$FùInfo
;

2883  
Œue
;

2885 
	}
}

2887 
funùiÚ
 
	$m‘h_Misc_RunSubsüt
(&
$Cu¼V®
,
$Cu¼Prm
) {

2889  @
	`šşude
(
$this
->
_Subsüt
);

2890 
	}
}

2892 
funùiÚ
 
	$m‘h_Misc_Ch¬£t
(
$Ch¬£t
) {

2893 ià(
$Ch¬£t
==='+') ;

2894 
$this
->
_Ch¬£tFù
 = 
çl£
;

2895 ià(
	`is_¡ršg
(
$Ch¬£t
)) {

2896 ià((
$Ch¬£t
!==''è
	`ªd
 ($Charset[0]==='=')) {

2897 
$E¼Msg
 = 
çl£
;

2898 
$Ch¬£t
 = 
	`sub¡r
($Charset,1);

2899 ià(
$this
->
	`m‘h_Misc_U£rFùCheck
(
$Ch¬£t
,'f',
$E¼Msg
,$E¼Msg,
çl£
)) {

2900 
$this
->
_Ch¬£tFù
 = 
Œue
;

2902 
$this
->
	`m‘h_Misc_AË¹
('w™h ch¬£ˆİtiÚ',
$E¼Msg
);

2903 
$Ch¬£t
 = '';

2906 } 
	`–£if
 (
	`is_¬¿y
(
$Ch¬£t
)) {

2907 
$this
->
_Ch¬£tFù
 = 
Œue
;

2908 } 
	`–£if
 (
$Ch¬£t
===
çl£
) {

2909 
$this
->
PrÙeù
 = 
çl£
;

2911 
$this
->
	`m‘h_Misc_AË¹
('with charset option','the option value is‚ot‡ string‚or‡n‡rray.');

2912 
$Ch¬£t
 = '';

2914 
$this
->
Ch¬£t
 = 
$Ch¬£t
;

2915 
	}
}

2917 
funùiÚ
 
	$m‘h_PlugIn_RunAÎ
(&
$FùBªk
,&
$ArgL¡
) {

2918 
$OkAÎ
 = 
Œue
;

2919 
	`fÜ—ch
 (
$FùBªk
 
as
 
$FùInfo
) {

2920 
$Ok
 = 
	`ÿÎ_u£r_func_¬¿y
(
$FùInfo
,
$ArgL¡
);

2921 ià(!
	`is_nuÎ
(
$Ok
)è
$OkAÎ
 = ($OkAÎ 
ªd
 $Ok);

2923  
$OkAÎ
;

2924 
	}
}

2926 
funùiÚ
 
	$m‘h_PlugIn_In¡®l
(
$PlugInId
,
$ArgL¡
,
$Auto
) {

2928 
$E¼Msg
 = 'w™h…lug-š \''.
$PlugInId
.'\'';

2930 ià(
	`şass_exi¡s
(
$PlugInId
)) {

2932 
$IsObj
 = 
Œue
;

2933 
$PiRef
 = 
Ãw
 
$PlugInId
;

2934 
$PiRef
->
TBS
 = &
$this
;

2935 ià(!
	`m‘hod_exi¡s
(
$PiRef
,'OnIn¡®l')è 
$this
->
	`m‘h_Misc_AË¹
(
$E¼Msg
,'OnInstall() method is‚ot found.');

2936 
$FùRef
 = 
	`¬¿y
(&
$PiRef
,'OnInstall');

2938 
$FùRef
 = 'tb¥i_'.
$PlugInId
.'_OnInstall';

2939 if(
	`funùiÚ_exi¡s
(
$FùRef
)) {

2940 
$IsObj
 = 
çl£
;

2941 
$PiRef
 = 
Œue
;

2943  
$this
->
	`m‘h_Misc_AË¹
(
$E¼Msg
,'nØşas Çmed \''.
$PlugInId
.'\' i found,‡nd‚ØfunùiÚ‚amed \''.
$FùRef
.'\' is found.');

2947 
$this
->
_PlugIns
[
$PlugInId
] = &
$PiRef
;

2949 
$Ev’tL¡
 = 
	`ÿÎ_u£r_func_¬¿y
(
$FùRef
,
$ArgL¡
);

2950 ià(
	`is_¡ršg
(
$Ev’tL¡
)è$Ev’tL¡ = 
	`ex¶ode
(',',$EventLst);

2951 ià(!
	`is_¬¿y
(
$Ev’tL¡
)è 
$this
->
	`m‘h_Misc_AË¹
(
$E¼Msg
,'OnInstall() method does‚ot„eturn‡n‡rray.');

2954 
	`fÜ—ch
 (
$Ev’tL¡
 
as
 
$Ev’t
) {

2955 
$Ev’t
 = 
	`Œim
($Event);

2956 ià(!
$this
->
	`m‘h_PlugIn_S‘Ev’t
(
$PlugInId
, 
$Ev’t
)è 
çl£
;

2959  
Œue
;

2961 
	}
}

2963 
funùiÚ
 
m‘h_PlugIn_S‘Ev’t
(
$PlugInId
, 
$Ev’t
, 
$NewRef
='') {

2967 ià(
¡½os
(',OnCommªd,BefÜeLßdTem¶©e,Aá”LßdTem¶©e,BefÜeShow,Aá”Show,OnD©a,OnFÜm©,OnO³¿tiÚ,BefÜeM”geBlock,OnM”geSeùiÚ,OnM”geGroup,Aá”M”geBlock,OnS³cŸlV¬,OnM”geF›ld,OnCacheF›ld,', ','.
$Ev’t
.',')===
çl£
è 
$this
->
m‘h_Misc_AË¹
('w™h…lug-š \''.
$PlugInId
.'\'','The…lug-inƒvent‚amed \''.$Event.'\' is‚ot supported by TinyButStrong (case-sensitive). Thisƒvent may come fromhe OnInstall() method.');

2969 
	g$PrİName
 = '_pi'.
$Ev’t
;

2971 ià(
	g$NewRef
===
çl£
) {

2973 ià(!
is£t
(
$this
->
$PrİName
)è 
çl£
;

2974 
	g$PrİRef
 = &
$this
->
$PrİName
;

2975 
un£t
(
$PrİRef
[
$PlugInId
]);

2976  
	gŒue
;

2980 
	g$PiRef
 = &
$this
->
_PlugIns
[
$PlugInId
];

2981 ià(
is_objeù
(
$PiRef
)) {

2982 ià(
	g$NewRef
===''è
$NewRef
 = 
$Ev’t
;

2983 ià(!
m‘hod_exi¡s
(
$PiRef
, 
$NewRef
)è 
	g$this
->
m‘h_Misc_AË¹
('w™h…lug-š \''.
$PlugInId
.'\'','Th¶ug-šƒv’ˆÇmed \''.
$Ev’t
.'\' is declared but its corresponding method \''.$NewRef.'\' is found.');

2984 
	g$FùRef
 = 
¬¿y
(&
$PiRef
, 
$NewRef
);

2986 
	g$FùRef
 = (
$NewRef
===''è? 'tb¥i_'.
$PlugInId
.'_'.
$Ev’t
 : $NewRef;

2987 ià(!
funùiÚ_exi¡s
(
$FùRef
)è 
	g$this
->
m‘h_Misc_AË¹
('w™h…lug-š \''.
$PlugInId
.'\'','Theƒxpected function \''.$FctRef.'\' is‚ot found.');

2991 ià(!
is£t
(
$this
->
$PrİName
)è
	g$this
->
	g$PrİName
 = 
¬¿y
();

2992 
	g$PrİRef
 = &
$this
->
$PrİName
;

2993 
	g$PrİRef
[
$PlugInId
] = 
$FùRef
;

2996 
	g$Ev’t
) {

3000 'OnFÜm©': 
$this
->
_piOnFrm_Ok
 = 
Œue
; ;

3001 : 
$this
->
_PlugIns_Ok
 = 
Œue
; ;

3004  
	gŒue
;

3008 
funùiÚ
 
	$m‘h_Misc_FÜm©
(&
$V®ue
,&
$PrmL¡
) {

3011 
$FrmSŒ
 = 
$PrmL¡
['frm'];

3012 
$CheckNum”ic
 = 
Œue
;

3013 ià(
	`is_¡ršg
(
$V®ue
)è$V®uğ
	`Œim
($Value);

3015 ià(
$FrmSŒ
==='')  '';

3016 
$Frm
 = 
£lf
::
	`f_Misc_FÜm©Save
(
$FrmSŒ
);

3019 ià(
$Frm
['type']=='multi') {

3022 ià(
	`is_num”ic
(
$V®ue
)) {

3023 ià(
	`is_¡ršg
(
$V®ue
)) $Value = 0.0 + $Value;

3024 ià(
$V®ue
>0) {

3025 
$FrmSŒ
 = &
$Frm
[0];

3026 } 
	`–£if
 (
$V®ue
<0) {

3027 
$FrmSŒ
 = &
$Frm
[1];

3028 ià(
$Frm
['abs']è
$V®ue
 = 
	`abs
($Value);

3030 
$FrmSŒ
 = &
$Frm
[2];

3031 
$Mšus
 = '';

3033 
$CheckNum”ic
 = 
çl£
;

3035 
$V®ue
 = ''.$Value;

3036 ià(
$V®ue
==='') {

3037  
$Frm
[3];

3039 
$t
 = 
	`¡¹Ùime
(
$V®ue
);

3040 ià((
$t
===-1è
	`Ü
 ($t===
çl£
)) {

3041  
$Frm
[1];

3042 } 
	`–£if
 (
$t
===943916400) {

3043  
$Frm
[2];

3045 
$V®ue
 = 
$t
;

3046 
$FrmSŒ
 = &
$Frm
[0];

3052 ià(
$FrmSŒ
==='')  '';

3053 
$Frm
 = 
£lf
::
	`f_Misc_FÜm©Save
(
$FrmSŒ
);

3057 
$Frm
['type']) {

3060 ià(
$CheckNum”ic
) {

3061 ià(
	`is_num”ic
(
$V®ue
)) {

3062 ià(
	`is_¡ršg
(
$V®ue
)) $Value = 0.0 + $Value;

3064  ''.
$V®ue
;

3067 ià(
$Frm
['P”C’t']è
$V®ue
 = $Value * 100;

3068 
$V®ue
 = 
	`numb”_fÜm©
($V®ue,
$Frm
['DecNbr'],$Frm['DecSep'],$Frm['ThsSep']);

3069 ià(
$Frm
['ThsR¶']!==
çl£
è
$V®ue
 = 
	`¡r_»¶aû
($Frm['ThsSep'], $Frm['ThsRpl'], $Value);

3070 
$V®ue
 = 
	`sub¡r_»¶aû
(
$Frm
['Str'],$Value,$Frm['Pos'],$Frm['Len']);

3071 ià(
$Frm
['Pad']!==
çl£
è
$V®ue
 = 
	`¡r_·d
($V®ue, $Frm['Pad'], '0', 
STR_PAD_LEFT
);

3072  
$V®ue
;

3076 ià(
	`is_¡ršg
(
$V®ue
)) {

3077 ià(
$V®ue
==='')  '';

3078 
$x
 = 
	`¡¹Ùime
(
$V®ue
);

3079 ià((
$x
===-1è
	`Ü
 ($x===
çl£
)) {

3080 ià(!
	`is_num”ic
(
$V®ue
)) $Value = 0;

3082 
$V®ue
 = &
$x
;

3085 ià(!
	`is_num”ic
(
$V®ue
))  ''.$Value;

3087 ià(
$Frm
['loc'] 
Ü
 
	`is£t
(
$PrmL¡
['locale'])) {

3088 
$x
 = 
	`¡ráime
(
$Frm
['¡r_loc'],
$V®ue
);

3089 
$this
->
	`m‘h_CÚv_SŒ
(
$x
,
çl£
);

3090  
$x
;

3092  
	`d©e
(
$Frm
['¡r_us'],
$V®ue
);

3096  
$Frm
['string'];

3100 
	}
}

3103 
funùiÚ
 
	$f_Misc_Upd©eA¼ay
(&
$¬¿y
, 
$num”iÿl
, 
$v
, 
$d
) {

3104 ià(!
	`is_¬¿y
(
$v
)) {

3105 ià(
	`is_nuÎ
(
$v
)) {

3106 
$¬¿y
 = 
	`¬¿y
();

3109 
$v
 = 
	`¬¿y
($v=>
$d
);

3112 
	`fÜ—ch
 (
$v
 
as
 
$p
=>
$a
) {

3113 ià(
$num”iÿl
===
Œue
) {

3114 ià(
	`is_¡ršg
(
$p
)) {

3116 
$i
 = 
	`¬¿y_£¬ch
(
$p
, 
$¬¿y
, 
Œue
);

3117 ià(
$i
===
çl£
) {

3118 ià(!
	`is_nuÎ
(
$a
)è
$¬¿y
[] = 
$p
;

3120 ià(
	`is_nuÎ
(
$a
)è
	`¬¿y_¥liû
(
$¬¿y
, 
$i
, 1);

3124 
$i
 = 
	`¬¿y_£¬ch
(
$a
, 
$¬¿y
, 
Œue
);

3125 ià(
$i
==
çl£
è
$¬¿y
[] = 
$a
;

3128 ià(
	`is_nuÎ
(
$a
)) {

3129 
	`un£t
(
$¬¿y
[
$p
]);

3130 } 
	`–£if
 (
$num”iÿl
==='frm') {

3131 
£lf
::
	`f_Misc_FÜm©Save
(
$a
, 
$p
);

3133 
$¬¿y
[
$p
] = 
$a
;

3137 
	}
}

3139 
funùiÚ
 
f_Misc_FÜm©Save
(&
$FrmSŒ
,
$AlŸs
='') {

3141 
$FÜm©L¡
 = &
$GLOBALS
['_TBS_FormatLst'];

3143 ià(
is£t
(
$FÜm©L¡
[
$FrmSŒ
])) {

3144 ià(
	g$AlŸs
!=''è
$FÜm©L¡
[
$AlŸs
] = &$FÜm©L¡[
$FrmSŒ
];

3145  
	g$FÜm©L¡
[
$FrmSŒ
];

3148 ià(
¡½os
(
$FrmSŒ
,'|')!==
çl£
) {

3151 
$Frm
 = 
ex¶ode
('|',
$FrmSŒ
);

3152 
	g$FrmNbr
 = 
couÁ
(
$Frm
);

3153 
	g$Frm
['abs'] = (
$FrmNbr
>1);

3154 ià(
	g$FrmNbr
<3è
	g$Frm
[2] = &
$Frm
[0];

3155 ià(
	g$FrmNbr
<4è
	g$Frm
[3] = '';

3156 
	g$Frm
['type'] = 'multi';

3157 
	g$FÜm©L¡
[
$FrmSŒ
] = 
$Frm
;

3159 } 
–£if
 ((
$nPosEnd
 = 
¡¼pos
(
$FrmSŒ
,'0'))!==
çl£
) {

3162 
$nDecS•
 = '.';

3163 
	g$nDecNbr
 = 0;

3164 
	g$nDecOk
 = 
Œue
;

3165 
	g$nPad
 = 
çl£
;

3166 
	g$nPadZ
 = 0;

3168 ià(
sub¡r
(
$FrmSŒ
,
$nPosEnd
+1,1)==='.') {

3169 
$nPosEnd
++;

3170 
	g$nPos
 = 
$nPosEnd
;

3171 
	g$nPadZ
 = 1;

3173 
	g$nPos
 = 
$nPosEnd
 - 1;

3174 (
	g$nPos
>=0è
ªd
 (
$FrmSŒ
[
$nPos
]==='0')) {

3175 
$nPos
--;

3177 ià((
	g$nPos
>=1è
ªd
 (
$FrmSŒ
[
$nPos
-1]==='0')) {

3178 
$nDecS•
 = 
$FrmSŒ
[
$nPos
];

3179 
	g$nDecNbr
 = 
$nPosEnd
 - 
$nPos
;

3181 
	g$nDecOk
 = 
çl£
;

3186 
	g$nThsS•
 = '';

3187 
	g$nThsR¶
 = 
çl£
;

3188 ià((
	g$nDecOk
è
ªd
 (
$nPos
>=5)) {

3189 ià((
sub¡r
(
$FrmSŒ
,
$nPos
-3,3)==='000'è
ªd
 ($FrmStr[$nPos-4]!=='0')) {

3190 
$p
 = 
¡¼pos
(
sub¡r
(
$FrmSŒ
,0,
$nPos
-4), '0');

3191 ià(
	g$p
!==
çl£
) {

3192 
$Ën
 = 
$nPos
-4-
$p
;

3193 
	g$x
 = 
sub¡r
(
$FrmSŒ
, 
$p
+1, 
$Ën
);

3194 ià(
	g$Ën
>1) {

3196 
	g$nThsS•
 = (
$nDecS•
=='*') ? '.' : '*';

3197 
	g$nThsR¶
 = 
$x
;

3199 
	g$nThsS•
 = 
$x
;

3201 
	g$nPos
 = 
$p
+1;

3207 ià(
	g$nDecOk
è
	g$nPos
--;

3208 (
	g$nPos
>=0è
ªd
 (
$FrmSŒ
[
$nPos
]==='0')) {

3209 
$nPos
--;

3212 
	g$nL’
 = 
$nPosEnd
-
$nPos
;

3213 iàĞ(
	g$nThsS•
===''è
ªd
 (
$nL’
>(
$nDecNbr
+
$nPadZ
+1)èè
$nPad
 = $nLen - $nPadZ;

3216 
	g$nP”C’t
 = (
¡½os
(
$FrmSŒ
,'%')===
çl£
è? f®£ : 
Œue
;

3218 
	g$FÜm©L¡
[
$FrmSŒ
] = 
¬¿y
('ty³'=>'num','SŒ'=>$FrmSŒ,'Pos'=>(
$nPos
+1),'L’'=>
$nL’
,'ThsS•'=>
$nThsS•
,'ThsR¶'=>
$nThsR¶
,'DecS•'=>
$nDecS•
,'DecNbr'=>
$nDecNbr
,'P”C’t'=>
$nP”C’t
,'Pad'=>
$nPad
);

3223 
	g$x
 = 
$FrmSŒ
;

3224 
	g$FrmPHP
 = '';

3225 
	g$FrmLOC
 = '';

3226 
	g$SŒIn
 = 
çl£
;

3227 
	g$CÁ
 = 0;

3228 
	g$i
 = 
¡½os
(
$FrmSŒ
,'(locale)');

3229 
	g$LoÿË
 = (
$i
!==
çl£
);

3230 ià(
	g$LoÿË
è
	g$x
 = 
sub¡r_»¶aû
(
$x
,'',
$i
,8);

3232 
	g$iEnd
 = 
¡¾’
(
$x
);

3233 
	g$i
=0;$i<
	g$iEnd
;$i++) {

3235 ià(
	g$SŒIn
) {

3237 ià(
	g$x
[
$i
]==='"') {

3238 ià(
sub¡r
(
$x
,
$i
+1,1)==='"') {

3239 
$FrmPHP
 .= '\\"';

3240 
	g$FrmLOC
 .ğ
$x
[
$i
];

3241 
	g$i
++;

3243 
	g$SŒIn
 = 
çl£
;

3246 
	g$FrmPHP
 .ğ'\\'.
$x
[
$i
];

3247 
	g$FrmLOC
 .ğ
$x
[
$i
];

3250 ià(
	g$x
[
$i
]==='"') {

3251 
$SŒIn
 = 
Œue
;

3253 
	g$CÁ
++;

3254 ià(
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,2),'hh' )===0è{ 
$FrmPHP
 .ğ'H'; 
	g$FrmLOC
 .ğ'%H'; 
	g$i
 += 1;}

3255 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,2),'hm' )===0è{ 
$FrmPHP
 .ğ'h'; 
	g$FrmLOC
 .ğ'%I'; 
	g$i
 += 1;}

3256 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,1),'h' )===0è{ 
$FrmPHP
 .ğ'G'; 
	g$FrmLOC
 .= '%H';}

3257 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,2),'¼' )===0è{ 
$FrmPHP
 .ğ'h'; 
	g$FrmLOC
 .ğ'%I'; 
	g$i
 += 1;}

3258 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,1),'r' )===0è{ 
$FrmPHP
 .ğ'g'; 
	g$FrmLOC
 .= '%I';}

3259 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,4),'ampm')===0è{ 
$FrmPHP
 .ğsub¡r($x,$i,1); 
	g$FrmLOC
 .ğ'%p'; 
	g$i
 += 3;}

3260 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,2),'Â' )===0è{ 
$FrmPHP
 .ğ'i'; 
	g$FrmLOC
 .ğ'%M'; 
	g$i
 += 1;}

3261 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,2),'ss' )===0è{ 
$FrmPHP
 .ğ's'; 
	g$FrmLOC
 .ğ'%S'; 
	g$i
 += 1;}

3262 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,2),'xx' )===0è{ 
$FrmPHP
 .ğ'S'; 
	g$FrmLOC
 .ğ'' ; 
	g$i
 += 1;}

3263 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,4),'yyyy')===0è{ 
$FrmPHP
 .ğ'Y'; 
	g$FrmLOC
 .ğ'%Y'; 
	g$i
 += 3;}

3264 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,2),'yy' )===0è{ 
$FrmPHP
 .ğ'y'; 
	g$FrmLOC
 .ğ'%y'; 
	g$i
 += 1;}

3265 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,4),'mmmm')===0è{ 
$FrmPHP
 .ğ'F'; 
	g$FrmLOC
 .ğ'%B'; 
	g$i
 += 3;}

3266 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,3),'mmm' )===0è{ 
$FrmPHP
 .ğ'M'; 
	g$FrmLOC
 .ğ'%b'; 
	g$i
 += 2;}

3267 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,2),'mm' )===0è{ 
$FrmPHP
 .ğ'm'; 
	g$FrmLOC
 .ğ'%m'; 
	g$i
 += 1;}

3268 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,1),'m' )===0è{ 
$FrmPHP
 .ğ'n'; 
	g$FrmLOC
 .= '%m';}

3269 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,4),'wwww')===0è{ 
$FrmPHP
 .ğ'l'; 
	g$FrmLOC
 .ğ'%A'; 
	g$i
 += 3;}

3270 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,3),'www' )===0è{ 
$FrmPHP
 .ğ'D'; 
	g$FrmLOC
 .ğ'%a'; 
	g$i
 += 2;}

3271 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,1),'w' )===0è{ 
$FrmPHP
 .ğ'w'; 
	g$FrmLOC
 .= '%u';}

3272 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,4),'dddd')===0è{ 
$FrmPHP
 .ğ'l'; 
	g$FrmLOC
 .ğ'%A'; 
	g$i
 += 3;}

3273 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,3),'ddd' )===0è{ 
$FrmPHP
 .ğ'D'; 
	g$FrmLOC
 .ğ'%a'; 
	g$i
 += 2;}

3274 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,2),'dd' )===0è{ 
$FrmPHP
 .ğ'd'; 
	g$FrmLOC
 .ğ'%d'; 
	g$i
 += 1;}

3275 
–£if
 (
¡rÿ£cmp
(
sub¡r
(
$x
,
$i
,1),'d' )===0è{ 
$FrmPHP
 .ğ'j'; 
	g$FrmLOC
 .= '%d';}

3277 
	g$FrmPHP
 .ğ'\\'.
$x
[
$i
];

3278 
	g$FrmLOC
 .ğ
$x
[
$i
];

3279 
	g$CÁ
--;

3286 ià(
	g$CÁ
>0) {

3287 
	g$FÜm©L¡
[
$FrmSŒ
] = 
¬¿y
('ty³'=>'d©e','¡r_us'=>
$FrmPHP
,'¡r_loc'=>
$FrmLOC
,'loc'=>
$LoÿË
);

3289 
	g$FÜm©L¡
[
$FrmSŒ
] = 
¬¿y
('type'=>'else','string'=>$FrmStr);

3294 ià(
	g$AlŸs
!=''è
$FÜm©L¡
[
$AlŸs
] = &$FÜm©L¡[
$FrmSŒ
];

3296  
	g$FÜm©L¡
[
$FrmSŒ
];

3300 
funùiÚ
 
	$f_Misc_CÚvS³
(&
$Loc
) {

3301 ià(
$Loc
->
CÚvMode
!==2) {

3302 
$Loc
->
CÚvMode
 = 2;

3303 
$Loc
->
CÚvEsc
 = 
çl£
;

3304 
$Loc
->
CÚvWS
 = 
çl£
;

3305 
$Loc
->
CÚvJS
 = 
çl£
;

3306 
$Loc
->
CÚvU¾
 = 
çl£
;

3307 
$Loc
->
CÚvUtf8
 = 
çl£
;

3309 
	}
}

3311 
funùiÚ
 
	$f_Misc_CheckArgL¡
(&
$SŒ
) {

3312 
$ArgL¡
 = 
	`¬¿y
();

3313 ià(
	`sub¡r
(
$SŒ
,-1,1)===')') {

3314 
$pos
 = 
	`¡½os
(
$SŒ
,'(');

3315 ià(
$pos
!==
çl£
) {

3316 
$ArgL¡
 = 
	`ex¶ode
(',',
	`sub¡r
(
$SŒ
,
$pos
+1,
	`¡¾’
($Str)-$pos-2));

3317 
$SŒ
 = 
	`sub¡r
($SŒ,0,
$pos
);

3320  
$ArgL¡
;

3321 
	}
}

3323 
funùiÚ
 
	$f_Misc_CheckCÚd™iÚ
(
$SŒ
) {

3326 
$SŒZ
 = 
$SŒ
;

3327 
$Max
 = 
	`¡¾’
(
$SŒ
)-1;

3328 
$p
 = 
	`¡½os
(
$SŒ
,'\'');

3329 ià(
$Esc
=(
$p
!==
çl£
)) {

3330 
$In
 = 
Œue
;

3331 
$p
=$p+1;$p<=
$Max
;$p++) {

3332 ià(
$SŒZ
[
$p
]==='\'') {

3333 
$In
 = !$In;

3334 } 
	`–£if
 (
$In
) {

3335 
$SŒZ
[
$p
] = 'z';

3341 
$O³
 = '=';

3342 
$L’
 = 1;

3343 
$p
 = 
	`¡½os
(
$SŒZ
,
$O³
);

3344 ià(
$p
===
çl£
) {

3345 
$O³
 = '+';

3346 
$p
 = 
	`¡½os
(
$SŒZ
,
$O³
);

3347 ià(
$p
===
çl£
)  false;

3348 ià((
$p
>0è
	`ªd
 (
$SŒZ
[$p-1]==='-')) {

3349 
$O³
 = '-+'; 
$p
--; 
$L’
=2;

3350 } 
	`–£if
 ((
$p
<
$Max
è
	`ªd
 (
$SŒZ
[$p+1]==='-')) {

3351 
$O³
 = '+-'; 
$L’
=2;

3353  
çl£
;

3356 ià(
$p
>0) {

3357 
$x
 = 
$SŒZ
[
$p
-1];

3358 ià(
$x
==='!') {

3359 
$O³
 = '!='; 
$p
--; 
$L’
=2;

3360 } 
	`–£if
 (
$x
==='~') {

3361 
$O³
 = '~='; 
$p
--; 
$L’
=2;

3362 } 
	`–£if
 (
$p
<
$Max
) {

3363 
$y
 = 
$SŒZ
[
$p
+1];

3364 ià(
$y
==='=') {

3365 
$L’
=2;

3366 } 
	`–£if
 ((
$x
==='+'è
	`ªd
 (
$y
==='-')) {

3367 
$O³
 = '+=-'; 
$p
--; 
$L’
=3;

3368 } 
	`–£if
 ((
$x
==='-'è
	`ªd
 (
$y
==='+')) {

3369 
$O³
 = '-=+'; 
$p
--; 
$L’
=3;

3377 
$V®1
 = 
	`Œim
(
	`sub¡r
(
$SŒ
,0,
$p
));

3378 
$V®2
 = 
	`Œim
(
	`sub¡r
(
$SŒ
,
$p
+
$L’
));

3379 ià(
$Esc
) {

3380 
$Nude1
 = 
£lf
::
	`f_Misc_D–D–im™”
(
$V®1
,'\'');

3381 
$Nude2
 = 
£lf
::
	`f_Misc_D–D–im™”
(
$V®2
,'\'');

3383 
$Nude1
 = 
$Nude2
 = 
çl£
;

3387 ià(
$O³
==='=') {

3388  (
	`¡rÿ£cmp
(
$V®1
,
$V®2
)==0);

3389 } 
	`–£if
 (
$O³
==='!=') {

3390  (
	`¡rÿ£cmp
(
$V®1
,
$V®2
)!=0);

3391 } 
	`–£if
 (
$O³
==='~=') {

3392  (
	`´eg_m©ch
(
$V®2
,
$V®1
)>0);

3394 ià(
$Nude1
è
$V®1
='0'+$Val1;

3395 ià(
$Nude2
è
$V®2
='0'+$Val2;

3396 ià(
$O³
==='+-') {

3397  (
$V®1
>
$V®2
);

3398 } 
	`–£if
 (
$O³
==='-+') {

3399  (
$V®1
 < 
$V®2
);

3400 } 
	`–£if
 (
$O³
==='+=-') {

3401  (
$V®1
 >ğ
$V®2
);

3402 } 
	`–£if
 (
$O³
==='-=+') {

3403  (
$V®1
<=
$V®2
);

3405  
çl£
;

3409 
	}
}

3411 
funùiÚ
 
	$f_Misc_D–D–im™”
(&
$Txt
,
$D–im
) {

3413 
$Ën
 = 
	`¡¾’
(
$Txt
);

3414 ià((
$Ën
>1è
	`ªd
 (
$Txt
[0]===
$D–im
)) {

3415 ià(
$Txt
[
$Ën
-1]===
$D–im
è$Txˆğ
	`sub¡r
($Txt,1,$len-2);

3416  
çl£
;

3418  
Œue
;

3420 
	}
}

3422 
funùiÚ
 
f_Misc_G‘Fe
(&
$Res
, &
$Fe
, 
$La¡Fe
='', 
$InşudeP©h
=
çl£
, 
$CÚ‹Ás
=
Œue
) {

3425 
$Res
 = '';

3426 
	g$fd
 = 
£lf
::
f_Misc_TryFe
(
$Fe
, 
çl£
);

3427 ià(
	g$fd
===
çl£
) {

3428 ià(
is_¬¿y
(
$InşudeP©h
)) {

3429 
fÜ—ch
 (
$InşudeP©h
 
as
 
$d
) {

3430 
$fd
 = 
£lf
::
f_Misc_TryFe
(
$Fe
, 
$d
);

3431 ià(
	g$fd
!==
çl£
) ;

3434 ià((
	g$fd
===
çl£
è&& (
$La¡Fe
!='')è
$fd
 = 
£lf
::
f_Misc_TryFe
(
$Fe
, 
dœÇme
($LastFile));

3435 ià(
	g$fd
===
çl£
)  false;

3438 
	g$fs
 = 
f¡©
(
$fd
);

3439 ià(
	g$CÚ‹Ás
) {

3441 ià(
is£t
(
$fs
['size'])) {

3442 ià(
	g$fs
['size']>0è
	g$Res
 = 
ä—d
(
$fd
,
$fs
['size']);

3444 !
ãof
(
$fd
)è
	g$Res
 .ğ
ä—d
($fd,4096);

3448 
	g$Res
 = 
$fs
;

3451 
fşo£
(
$fd
);

3452  
	gŒue
;

3456 
funùiÚ
 
	$f_Misc_TryFe
(&
$Fe
, 
$Dœ
) {

3457 ià(
$Dœ
===''è 
çl£
;

3458 
$FeS—rch
 = (
$Dœ
===
çl£
è? 
$Fe
 : $Dir.'/'.$File;

3460 
$f
 = @
	`fİ’
(
$FeS—rch
, 'r', 
Œue
);

3461 ià(
$f
!==
çl£
è
$Fe
 = 
$FeS—rch
;

3462  
$f
;

3463 
	}
}

3465 
funùiÚ
 
	$f_Loc_PrmR—d
(&
$Txt
,
$Pos
,
$XmlTag
,
$D–imChrs
,
$BegSŒ
,
$EndSŒ
,&
$Loc
,&
$PosEnd
,
$W™hPos
=
çl£
) {

3467 
$BegL’
 = 
	`¡¾’
(
$BegSŒ
);

3468 
$BegChr
 = 
$BegSŒ
[0];

3469 
$BegIs1
 = (
$BegL’
===1);

3471 
$D–imIdx
 = 
çl£
;

3472 
$D–imCÁ
 = 0;

3473 
$D–imChr
 = '';

3474 
$BegCÁ
 = 0;

3475 
$SubName
 = 
$Loc
->
SubOk
;

3477 
$Stus
 = 0;

3478 
$PosName
 = 0;

3479 
$PosN’d
 = 0;

3480 
$PosV®
 = 0;

3483 
$PosEnd
 = 
	`¡½os
(
$Txt
,
$EndSŒ
,
$Pos
);

3484 ià(
$PosEnd
===
çl£
) ;

3485 
$CÚtšue
 = (
$Pos
<
$PosEnd
);

3487 
$CÚtšue
) {

3489 
$Chr
 = 
$Txt
[
$Pos
];

3491 ià(
$D–imIdx
) {

3493 ià(
$Chr
===
$D–imChr
) {

3494 ià(
$Chr
===
$Txt
[
$Pos
+1]) {

3495 
$Pos
++;

3497 
$D–imIdx
 = 
çl£
;

3503 ià(
$BegCÁ
===0) {

3506 
$CheckChr
 = 
çl£
;

3507 ià((
$Chr
===' 'è
	`Ü
 ($Chr==="\r") or ($Chr==="\n")) {

3508 ià(
$Stus
===1) {

3509 ià(
$SubName
 
	`ªd
 (
$XmlTag
===
çl£
)) {

3512 
$Stus
 = 2;

3513 
$PosN’d
 = 
$Pos
;

3515 } 
	`–£if
 (
$XmlTag
 
	`ªd
 (
$Stus
===4)) {

3516 
£lf
::
	`f_Loc_PrmCompu‹
(
$Txt
,
$Loc
,
$SubName
,
$Stus
,
$XmlTag
,
$D–imChr
,
$D–imCÁ
,
$PosName
,
$PosN’d
,
$PosV®
,
$Pos
,
$W™hPos
);

3517 
$Stus
 = 0;

3519 } 
	`–£if
 ((
$XmlTag
===
çl£
è
	`ªd
 (
$Chr
===';')) {

3520 
£lf
::
	`f_Loc_PrmCompu‹
(
$Txt
,
$Loc
,
$SubName
,
$Stus
,
$XmlTag
,
$D–imChr
,
$D–imCÁ
,
$PosName
,
$PosN’d
,
$PosV®
,
$Pos
,
$W™hPos
);

3521 
$Stus
 = 0;

3522 } 
	`–£if
 (
$Stus
===4) {

3523 
$CheckChr
 = 
Œue
;

3524 } 
	`–£if
 (
$Stus
===3) {

3525 
$Stus
 = 4;

3526 
$D–imCÁ
 = 0;

3527 
$PosV®
 = 
$Pos
;

3528 
$CheckChr
 = 
Œue
;

3529 } 
	`–£if
 (
$Stus
===2) {

3530 ià(
$Chr
==='=') {

3531 
$Stus
 = 3;

3532 } 
	`–£if
 (
$XmlTag
) {

3533 
£lf
::
	`f_Loc_PrmCompu‹
(
$Txt
,
$Loc
,
$SubName
,
$Stus
,
$XmlTag
,
$D–imChr
,
$D–imCÁ
,
$PosName
,
$PosN’d
,
$PosV®
,
$Pos
,
$W™hPos
);

3534 
$Stus
 = 1;

3535 
$PosName
 = 
$Pos
;

3536 
$CheckChr
 = 
Œue
;

3538 
$Stus
 = 4;

3539 
$D–imCÁ
 = 0;

3540 
$PosV®
 = 
$Pos
;

3541 
$CheckChr
 = 
Œue
;

3543 } 
	`–£if
 (
$Stus
===1) {

3544 ià(
$Chr
==='=') {

3545 
$Stus
 = 3;

3546 
$PosN’d
 = 
$Pos
;

3548 
$CheckChr
 = 
Œue
;

3551 
$Stus
 = 1;

3552 
$PosName
 = 
$Pos
;

3553 
$CheckChr
 = 
Œue
;

3556 ià(
$CheckChr
) {

3557 
$D–imIdx
 = 
	`¡½os
(
$D–imChrs
,
$Chr
);

3558 ià(
$D–imIdx
===
çl£
) {

3559 ià(
$Chr
===
$BegChr
) {

3560 ià(
$BegIs1
) {

3561 
$BegCÁ
++;

3562 } 
	`–£if
(
	`sub¡r
(
$Txt
,
$Pos
,
$BegL’
)===
$BegSŒ
) {

3563 
$BegCÁ
++;

3567 
$D–imChr
 = 
$D–imChrs
[
$D–imIdx
];

3568 
$D–imCÁ
++;

3569 
$D–imIdx
 = 
Œue
;

3574 ià(
$Chr
===
$BegChr
) {

3575 ià(
$BegIs1
) {

3576 
$BegCÁ
++;

3577 } 
	`–£if
(
	`sub¡r
(
$Txt
,
$Pos
,
$BegL’
)===
$BegSŒ
) {

3578 
$BegCÁ
++;

3586 
$Pos
++;

3589 ià(
$Pos
===
$PosEnd
) {

3590 ià(
$XmlTag
) {

3591 
$CÚtšue
 = 
çl£
;

3592 } 
	`–£if
 (
$D–imIdx
===
çl£
) {

3593 ià(
$BegCÁ
>0) {

3594 
$BegCÁ
--;

3596 
$CÚtšue
 = 
çl£
;

3599 ià(
$CÚtšue
) {

3600 
$PosEnd
 = 
	`¡½os
(
$Txt
,
$EndSŒ
,$PosEnd+1);

3601 ià(
$PosEnd
===
çl£
) ;

3603 ià(
$XmlTag
 
	`ªd
 (
$Txt
[
$Pos
-1]==='/')) $Pos--;

3604 
£lf
::
	`f_Loc_PrmCompu‹
(
$Txt
,
$Loc
,
$SubName
,
$Stus
,
$XmlTag
,
$D–imChr
,
$D–imCÁ
,
$PosName
,
$PosN’d
,
$PosV®
,
$Pos
,
$W™hPos
);

3610 
$PosEnd
 = $PosEnd + (
	`¡¾’
(
$EndSŒ
)-1);

3612 
	}
}

3614 
funùiÚ
 
	$f_Loc_PrmCompu‹
(&
$Txt
,&
$Loc
,&
$SubName
,
$Stus
,
$XmlTag
,
$D–imChr
,
$D–imCÁ
,
$PosName
,
$PosN’d
,
$PosV®
,
$Pos
,
$W™hPos
) {

3616 ià(
$Stus
===0) {

3617 
$SubName
 = 
çl£
;

3619 ià(
$Stus
===1) {

3620 
$x
 = 
	`sub¡r
(
$Txt
,
$PosName
,
$Pos
-$PosName);

3622 
$x
 = 
	`sub¡r
(
$Txt
,
$PosName
,
$PosN’d
-$PosName);

3624 ià(
$XmlTag
è
$x
 = 
	`¡¹Şow”
($x);

3625 ià(
$SubName
) {

3626 
$Loc
->
SubName
 = 
	`Œim
(
$x
);

3627 
$SubName
 = 
çl£
;

3629 ià(
$Stus
===4) {

3630 
$v
 = 
	`Œim
(
	`sub¡r
(
$Txt
,
$PosV®
,
$Pos
-$PosVal));

3631 ià(
$D–imCÁ
===1) {

3632 ià(
$v
[0]===
$D–imChr
) {

3633 
$Ën
 = 
	`¡¾’
(
$v
);

3634 ià(
$v
[
$Ën
-1]===
$D–imChr
) {

3635 
$v
 = 
	`sub¡r
($v,1,
$Ën
-2);

3636 
$v
 = 
	`¡r_»¶aû
(
$D–imChr
.$DelimChr,$DelimChr,$v);

3641 
$v
 = 
Œue
;

3643 ià(
$x
==='if') {

3644 
£lf
::
	`f_Loc_PrmIfTh’
(
$Loc
,
Œue
,
$v
);

3645 } 
	`–£if
 (
$x
==='then') {

3646 
£lf
::
	`f_Loc_PrmIfTh’
(
$Loc
,
çl£
,
$v
);

3648 
$Loc
->
PrmL¡
[
$x
] = 
$v
;

3649 ià(
$W™hPos
è
$Loc
->
PrmPos
[
$x
] = 
	`¬¿y
(
$PosName
,
$PosN’d
,
$PosV®
,
$Pos
,
$D–imChr
,
$D–imCÁ
);

3654 
	}
}

3656 
funùiÚ
 
	$f_Loc_PrmIfTh’
(&
$Loc
,
$IsIf
,
$V®
) {

3657 
$nbr
 = &
$Loc
->
PrmIfNbr
;

3658 ià(
$nbr
===
çl£
) {

3659 
$nbr
 = 0;

3660 
$Loc
->
PrmIf
 = 
	`¬¿y
();

3661 
$Loc
->
PrmIfV¬
 = 
	`¬¿y
();

3662 
$Loc
->
PrmTh’
 = 
	`¬¿y
();

3663 
$Loc
->
PrmTh’V¬
 = 
	`¬¿y
();

3664 
$Loc
->
PrmEl£V¬
 = 
Œue
;

3666 ià(
$IsIf
) {

3667 
$nbr
++;

3668 
$Loc
->
PrmIf
[
$nbr
] = 
$V®
;

3669 
$Loc
->
PrmIfV¬
[
$nbr
] = 
Œue
;

3671 
$nbr2
 = 
$nbr
;

3672 ià(
$nbr2
===
çl£
) $nbr2 = 1;

3673 
$Loc
->
PrmTh’
[
$nbr2
] = 
$V®
;

3674 
$Loc
->
PrmTh’V¬
[
$nbr2
] = 
Œue
;

3676 
	}
}

3678 
funùiÚ
 
	$f_Loc_EÆ¬geToSŒ
(&
$Txt
,&
$Loc
,
$SŒBeg
,
$SŒEnd
) {

3686 
$Pos
 = 
$Loc
->
PosBeg
;

3687 
$Ok
 = 
çl£
;

3689 
$Pos
 = 
	`¡¼pos
(
	`sub¡r
(
$Txt
,0,$Pos),
$SŒBeg
[0]);

3690 ià(
$Pos
!==
çl£
) {

3691 ià(
	`sub¡r
(
$Txt
,
$Pos
,
	`¡¾’
(
$SŒBeg
))===$SŒBegè
$Ok
 = 
Œue
;

3693 }  (!
$Ok
è
	`ªd
 (
$Pos
!==
çl£
) );

3695 ià(
$Ok
) {

3696 
$PosEnd
 = 
	`¡½os
(
$Txt
,
$SŒEnd
,
$Loc
->
PosEnd
 + 1);

3697 ià(
$PosEnd
===
çl£
) {

3698 
$Ok
 = 
çl£
;

3700 
$Loc
->
PosBeg
 = 
$Pos
;

3701 
$Loc
->
PosEnd
 = 
$PosEnd
 + 
	`¡¾’
(
$SŒEnd
) - 1;

3705  
$Ok
;

3707 
	}
}

3709 
funùiÚ
 
	$f_Loc_EÆ¬geToTag
(&
$Txt
,&
$Loc
,
$TagSŒ
,
$R‘IÂ”Src
) {

3712 
$AlŸsL¡
 = &
$GLOBALS
['_TBS_BlockAlias'];

3715 
$Ref
 = 0;

3716 
$Lev–Stİ
 = 0;

3717 
$i
 = 0;

3718 
$TagFù
 = 
	`¬¿y
();

3719 
$TagL¡
 = 
	`¬¿y
();

3720 
$TagSŒ
!=='') {

3722 
$p
 = 
	`¡½os
(
$TagSŒ
, '+');

3723 ià(
$p
===
çl£
) {

3724 
$t
 = 
$TagSŒ
;

3725 
$TagSŒ
 = '';

3727 
$t
 = 
	`sub¡r
(
$TagSŒ
,0,
$p
);

3728 
$TagSŒ
 = 
	`sub¡r
($TagSŒ,
$p
+1);

3731 
$t
 = 
	`Œim
($t);

3732 
$e
 = 
	`¡¾’
(
$t
) - 1;

3733 ià((
$e
>1è
	`ªd
 (
$t
[0]==='(')‡nd ($t[$e]===')')) {

3734 ià(
$Ref
===0è$Reàğ
$i
;

3735 ià(
$Ref
===
$i
è
$Lev–Stİ
++;

3736 
$t
 = 
	`sub¡r
($t,1,
$e
-1);

3738 ià((
$e
>=0è
	`ªd
 (
$t
[$e]==='/')è$ˆğ
	`sub¡r
($t,0,$e);

3739 
$e
 = 
çl£
;

3741 } 
$e
!==
çl£
);

3742 ià(
	`is£t
(
$AlŸsL¡
[
$t
])) {

3743 
$a
 = 
$AlŸsL¡
[
$t
];

3744 ià(
	`is_¡ršg
(
$a
)) {

3745 ià(
$i
>999è 
çl£
;

3746 
$TagSŒ
 = ($TagSŒ===''è? 
$a
 : $a.'+'.$TagStr;

3748 
$TagL¡
[
$i
] = 
$t
;

3749 
$TagFù
[
$i
] = 
$a
;

3750 
$i
++;

3753 
$TagL¡
[
$i
] = 
$t
;

3754 
$TagFù
[
$i
] = 
çl£
;

3755 
$i
++;

3759 
$TagMax
 = 
$i
-1;

3762 ià(
$Lev–Stİ
===0) $LevelStop = 1;

3765 
$TagO
 = 
£lf
::
	`f_Loc_EÆ¬ge_Fšd
(
$Txt
,
$TagL¡
[
$Ref
],
$TagFù
[$Ref],
$Loc
->
PosBeg
-1,
çl£
,
$Lev–Stİ
);

3766 ià(
$TagO
===
çl£
)  false;

3767 
$PosBeg
 = 
$TagO
->
PosBeg
;

3768 
$Lev–Stİ
 +ğ-
$TagO
->
RightLev–
;

3769 ià(
$Lev–Stİ
>0) {

3770 
$TagC
 = 
£lf
::
	`f_Loc_EÆ¬ge_Fšd
(
$Txt
,
$TagL¡
[
$Ref
],
$TagFù
[$Ref],
$Loc
->
PosEnd
+1,
Œue
,-
$Lev–Stİ
);

3771 ià(
$TagC
==
çl£
)  false;

3772 
$PosEnd
 = 
$TagC
->
PosEnd
;

3773 
$IÂ”Lim
 = 
$TagC
->
PosBeg
;

3775 
$PosEnd
 = 
$TagO
->
PosEnd
;

3776 
$IÂ”Lim
 = 
$PosEnd
 + 1;

3779 
$R‘V®
 = 
Œue
;

3780 ià(
$R‘IÂ”Src
) {

3781 
$R‘V®
 = '';

3782 ià(
$Loc
->
PosBeg
>
$TagO
->
PosEnd
è
$R‘V®
 .ğ
	`sub¡r
(
$Txt
,$TagO->PosEnd+1,
	`mš
($Loc->PosBeg,
$IÂ”Lim
)-$TagO->PosEnd-1);

3783 ià(
$Loc
->
PosEnd
<
$IÂ”Lim
è
$R‘V®
 .ğ
	`sub¡r
(
$Txt
,
	`max
($Loc->PosEnd,
$TagO
->PosEnd)+1,$InnerLim-max($Loc->PosEnd,$TagO->PosEnd)-1);

3787 
$TagC
 = 
Œue
;

3788 
$i
=
$Ref
+1;$i<=
$TagMax
;$i++) {

3789 
$x
 = 
$TagL¡
[
$i
];

3790 ià((
$x
!==''è
	`ªd
 (
$TagC
!==
çl£
)) {

3791 
$TagC
 = 
£lf
::
	`f_Loc_EÆ¬ge_Fšd
(
$Txt
,
$x
,
$TagFù
[
$i
],
$PosEnd
+1,
Œue
,0);

3792 ià(
$TagC
!==
çl£
è
$PosEnd
 = $TagC->
PosEnd
;

3797 
$TagO
 = 
Œue
;

3798 
$i
=
$Ref
-1;$i>=0;$i--) {

3799 
$x
 = 
$TagL¡
[
$i
];

3800 ià((
$x
!==''è
	`ªd
 (
$TagO
!==
çl£
)) {

3801 
$TagO
 = 
£lf
::
	`f_Loc_EÆ¬ge_Fšd
(
$Txt
,
$x
,
$TagFù
[
$i
],
$PosBeg
-1,
çl£
,0);

3802 ià(
$TagO
!==
çl£
è
$PosBeg
 = $TagO->
PosBeg
;

3806 
$Loc
->
PosBeg
 = 
$PosBeg
;

3807 
$Loc
->
PosEnd
 = 
$PosEnd
;

3808  
$R‘V®
;

3810 
	}
}

3812 
funùiÚ
 
	$f_Loc_EÆ¬ge_Fšd
(
$Txt
, 
$Tag
, 
$Fù
, 
$Pos
, 
$FÜw¬d
, 
$Lev–Stİ
) {

3813 ià(
$Fù
===
çl£
) {

3814  
£lf
::
	`f_Xml_FšdTag
(
$Txt
,
$Tag
,(!
$FÜw¬d
),
$Pos
,$FÜw¬d,
$Lev–Stİ
,
çl£
);

3816 
$p
 = 
	`ÿÎ_u£r_func_¬¿y
(
$Fù
,
	`¬¿y
(
$Tag
,
$Txt
,
$Pos
,
$FÜw¬d
,
$Lev–Stİ
));

3817 ià(
$p
===
çl£
) {

3818  
çl£
;

3820  (
objeù
è
	`¬¿y
('PosBeg'=>
$p
, 'PosEnd'=>$p, 'RightLevel'=> 0);

3823 
	}
}

3825 
funùiÚ
 
	$f_Loc_A‰BoŞ—n
(
$Cu¼V®
, 
$A‰True
, 
$A‰Name
) {

3827 ià(
$A‰True
===
Œue
) {

3828 ià(@(
¡ršg
)
$Cu¼V®
==='') {

3831  
$A‰Name
;

3833 } 
	`–£if
 (@(
¡ršg
)
$Cu¼V®
===
$A‰True
) {

3834  
$A‰Name
;

3838 
	}
}

3840 
funùiÚ
 
	$f_Xml_A‰Fšd
(&
$Txt
,&
$Loc
,
$Move
=
çl£
,
$A‰D–im
=false) {

3843 
$A‰
 = 
$Loc
->
PrmL¡
['att'];

3844 
$p
 = 
	`¡¼pos
(
$A‰
,'#');

3845 ià(
$p
===
çl£
) {

3846 
$TagL¡
 = '';

3848 
$TagL¡
 = 
	`sub¡r
(
$A‰
,0,
$p
);

3849 
$A‰
 = 
	`sub¡r
($A‰,
$p
+1);

3852 
$FÜw¬d
 = (
	`sub¡r
(
$TagL¡
,0,1)==='+');

3853 ià(
$FÜw¬d
è
$TagL¡
 = 
	`sub¡r
($TagLst,1);

3854 
$TagL¡
 = 
	`ex¶ode
('+',$TagLst);

3856 
$iMax
 = 
	`couÁ
(
$TagL¡
)-1;

3857 
$W™hPrm
 = 
çl£
;

3858 
$LocO
 = &
$Loc
;

3859 
	`fÜ—ch
 (
$TagL¡
 
as
 
$i
=>
$Tag
) {

3860 
$Lev–Stİ
 = 
çl£
;

3861 (
	`¡¾’
(
$Tag
)>1è
	`ªd
 (
	`sub¡r
($Tag,0,1)==='(')‡nd (substr($Tag,-1,1)===')')) {

3862 ià(
$Lev–Stİ
===
çl£
) $LevelStop = 0;

3863 
$Lev–Stİ
++;

3864 
$Tag
 = 
	`Œim
(
	`sub¡r
($Tag,1,
	`¡¾’
($Tag)-2));

3866 ià(
$i
==
$iMax
è
$W™hPrm
 = 
Œue
;

3867 
$Pos
 = (
$FÜw¬d
è? 
$LocO
->
PosEnd
+1 : $LocO->
PosBeg
-1;

3868 
	`un£t
(
$LocO
);

3869 
$LocO
 = 
£lf
::
	`f_Xml_FšdTag
(
$Txt
,
$Tag
,
Œue
,
$Pos
,
$FÜw¬d
,
$Lev–Stİ
,
$W™hPrm
,$WithPrm);

3870 ià(
$LocO
===
çl£
)  false;

3873 
$Loc
->
A‰FÜw¬d
 = 
$FÜw¬d
;

3874 
$Loc
->
A‰TagBeg
 = 
$LocO
->
PosBeg
;

3875 
$Loc
->
A‰TagEnd
 = 
$LocO
->
PosEnd
;

3876 
$Loc
->
A‰D–imChr
 = 
çl£
;

3878 ià(
$A‰
==='.') {

3880 
	`fÜ—ch
 (
$LocO
->
PrmPos
 
as
 
$a
=>
$p
 ) {

3881 iàĞ(
$p
[0]<
$Loc
->
PosBeg
è&& ($Loc->
PosEnd
<$p[3]èè
$A‰
 = 
$a
;

3883 ià(
$A‰
==='.'è 
çl£
;

3886 
$A‰LC
 = 
	`¡¹Şow”
(
$A‰
);

3887 ià(
	`is£t
(
$LocO
->
PrmL¡
[
$A‰LC
])) {

3889 
$p
 = 
$LocO
->
PrmPos
[
$A‰LC
];

3890 
$Loc
->
A‰Beg
 = 
$p
[0];

3891 
$p
[3]--; 
$Txt
[$p[3]]===' ') $p[3]--;

3892 
$Loc
->
A‰End
 = 
$p
[3];

3893 
$Loc
->
A‰D–imCÁ
 = 
$p
[5];

3894 
$Loc
->
A‰D–imChr
 = 
$p
[4];

3895 ià((
$p
[1]>$p[0]è
	`ªd
 ($p[2]>$p[1])) {

3897 
$Loc
->
A‰V®Beg
 = 
$p
[2];

3900 
$Loc
->
A‰V®Beg
 = 
çl£
;

3904 
$Loc
->
A‰D–imCÁ
 = 0;

3905 
$Loc
->
A‰Beg
 = 
çl£
;

3906 
$Loc
->
A‰Name
 = 
$A‰
;

3910 ià((
$Loc
->
A‰D–imCÁ
==0è
	`ªd
 (
	`is£t
(
$LocO
->
PrmPos
))) {

3911 
	`fÜ—ch
 (
$LocO
->
PrmPos
 
as
 
$p
) {

3912 ià(
$p
[5]>0è
$Loc
->
A‰D–imChr
 = $p[4];

3916 ià(
$Move
è 
£lf
::
	`f_Xml_A‰Move
(
$Txt
,
$Loc
,
$A‰D–im
);

3918  
Œue
;

3920 
	}
}

3922 
funùiÚ
 
	$f_Xml_A‰Move
(&
$Txt
, &
$Loc
, 
$A‰D–im
=
çl£
) {

3924 ià(
$A‰D–im
===
çl£
è$A‰D–im = 
$Loc
->
A‰D–imChr
;

3925 ià(
$A‰D–im
===
çl£
) $AttDelim = '"';

3927 
$sz
 = 
$Loc
->
PosEnd
 - $Loc->
PosBeg
 + 1;

3928 
$Txt
 = 
	`sub¡r_»¶aû
($Txt,'',
$Loc
->
PosBeg
,
$sz
);

3929 ià(
$Loc
->
A‰FÜw¬d
) {

3930 
$Loc
->
A‰TagBeg
 +ğ-
$sz
;

3931 
$Loc
->
A‰TagEnd
 +ğ-
$sz
;

3932 } 
	`–£if
 (
$Loc
->
PosBeg
<$Loc->
A‰TagEnd
) {

3933 
$Loc
->
A‰TagEnd
 +ğ-
$sz
;

3936 
$InsPos
 = 
çl£
;

3937 ià(
$Loc
->
A‰Beg
===
çl£
) {

3938 
$InsPos
 = 
$Loc
->
A‰TagEnd
;

3939 ià(
$Txt
[
$InsPos
-1]==='/') $InsPos--;

3940 ià(
$Txt
[
$InsPos
-1]===' ') $InsPos--;

3941 
$Ins1
 = ' '.
$Loc
->
A‰Name
.'='.
$A‰D–im
;

3942 
$Ins2
 = 
$A‰D–im
;

3943 
$Loc
->
A‰Beg
 = 
$InsPos
 + 1;

3944 
$Loc
->
A‰V®Beg
 = 
$InsPos
 + 
	`¡¾’
(
$Ins1
) - 1;

3946 ià(
$Loc
->
PosEnd
<$Loc->
A‰Beg
è$Loc->A‰Beg +ğ-
$sz
;

3947 ià(
$Loc
->
PosEnd
<$Loc->
A‰End
è$Loc->A‰End +ğ-
$sz
;

3948 ià(
$Loc
->
A‰V®Beg
===
çl£
) {

3949 
$InsPos
 = 
$Loc
->
A‰End
+1;

3950 
$Ins1
 = '='.
$A‰D–im
;

3951 
$Ins2
 = 
$A‰D–im
;

3952 
$Loc
->
A‰V®Beg
 = 
$InsPos
+1;

3953 } 
	`–£if
 (
	`is£t
(
$Loc
->
PrmL¡
['attadd'])) {

3954 
$InsPos
 = 
$Loc
->
A‰End
;

3955 
$Ins1
 = ' ';

3956 
$Ins2
 = '';

3959 ià(
$Loc
->
PosEnd
<$Loc->
A‰V®Beg
è$Loc->A‰V®Beg +ğ-
$sz
;

3960 
$PosBeg
 = 
$Loc
->
A‰V®Beg
;

3961 
$PosEnd
 = 
$Loc
->
A‰End
;

3962 ià(
$Loc
->
A‰D–imCÁ
>0è{
$PosBeg
++; 
$PosEnd
--;}

3966 ià(
$InsPos
===
çl£
) {

3967 
$InsL’
 = 0;

3969 
$InsTxt
 = 
$Ins1
.'[]'.
$Ins2
;

3970 
$InsL’
 = 
	`¡¾’
(
$InsTxt
);

3971 
$PosBeg
 = 
$InsPos
 + 
	`¡¾’
(
$Ins1
);

3972 
$PosEnd
 = 
$PosBeg
 + 1;

3973 
$Txt
 = 
	`sub¡r_»¶aû
($Txt,
$InsTxt
,
$InsPos
,0);

3974 
$Loc
->
A‰End
 = 
$InsPos
 + 
$InsL’
 - 1;

3975 
$Loc
->
A‰TagEnd
 +ğ
$InsL’
;

3978 
$Loc
->
P»vPosBeg
 = $Loc->
PosBeg
;

3979 
$Loc
->
P»vPosEnd
 = $Loc->
PosEnd
;

3980 
$Loc
->
PosBeg
 = 
$PosBeg
;

3981 
$Loc
->
PosEnd
 = 
$PosEnd
;

3982 
$Loc
->
A‰BegM
 = (
$Txt
[$Loc->
A‰Beg
-1]===' ') ? $Loc->AttBeg-1 : $Loc->AttBeg;

3983 
$Loc
->
A‰InsL’
 = 
$InsL’
;

3985  
	`mš
(
$Loc
->
P»vPosEnd
,$Loc->
PosEnd
);

3987 
	}
}

3989 
funùiÚ
 
	$f_Xml_Max
(&
$Txt
,&
$Nbr
,
$MaxEnd
) {

3992 
$pMax
 = 
	`¡¾’
(
$Txt
)-1;

3993 
$p
=0;

3994 
$n
=0;

3995 
$š
 = 
çl£
;

3996 
$ok
 = 
Œue
;

3998 
$ok
) {

3999 ià(
$š
) {

4000 ià(
$Txt
[
$p
]===';') {

4001 
$š
 = 
çl£
;

4002 
$n
++;

4005 ià(
$Txt
[
$p
]==='&') {

4006 
$š
 = 
Œue
;

4008 
$n
++;

4011 ià((
$n
>=
$Nbr
è
	`Ü
 (
$p
>=
$pMax
)) {

4012 
$ok
 = 
çl£
;

4014 
$p
++;

4018 ià((
$n
>=
$Nbr
è
	`ªd
 (
$p
<
$pMax
)è
$Txt
 = 
	`sub¡r
($Txt,0,$p).
$MaxEnd
;

4020 
	}
}

4022 
funùiÚ
 
	$f_Xml_G‘P¬t
(&
$Txt
, 
$TagL¡
, 
$AÎIfNÙhšg
=
çl£
) {

4025 ià((
$TagL¡
===
Œue
è
	`Ü
 ($TagLst==='')) $TagLst = 'body';

4027 
$x
 = '';

4028 
$nÙhšg
 = 
Œue
;

4029 
$TagL¡
 = 
	`ex¶ode
('+',$TagLst);

4032 
	`fÜ—ch
 (
$TagL¡
 
as
 
$i
=>
$t
) {

4033 ià((
	`sub¡r
(
$t
,0,1)=='('è
	`ªd
 (substr($t,-1,1)==')')) {

4034 
$t
 = 
	`sub¡r
($t,1,
	`¡¾’
($t)-2);

4035 
$K“p
 = 
Œue
;

4037 
$K“p
 = 
çl£
;

4039 
$TagL¡
[
$i
] = 
	`¬¿y
('t'=>
$t
, 'k'=>
$K“p
, 'b'=>-1, 'e'=>-1, 's'=>
çl£
);

4042 
$PosOut
 = 
	`¡¾’
(
$Txt
);

4043 
$Pos
 = 0;

4049 
$TagMš
 = 
çl£
;

4050 
$PosMš
 = 
$PosOut
;

4051 
	`fÜ—ch
 (
$TagL¡
 
as
 
$i
=>
$Tag
) {

4052 ià(
$Tag
['b']<
$Pos
) {

4053 
$Loc
 = 
£lf
::
	`f_Xml_FšdTag
(
$Txt
,
$Tag
['t'],
Œue
,
$Pos
,Œue,
çl£
,false);

4054 ià(
$Loc
===
çl£
) {

4055 
$Tag
['b'] = 
$PosOut
;

4057 
$Tag
['b'] = 
$Loc
->
PosBeg
;

4058 
$Tag
['e'] = 
$Loc
->
PosEnd
;

4059 
$Tag
['s'] = (
	`sub¡r
(
$Txt
,
$Loc
->
PosEnd
-1,1)==='/');

4061 
$TagL¡
[
$i
] = 
$Tag
;

4063 ià(
$Tag
['b']<
$PosMš
) {

4064 
$TagMš
 = 
$i
;

4065 
$PosMš
 = 
$Tag
['b'];

4070 ià(
$TagMš
!==
çl£
) {

4071 
$Tag
 = &
$TagL¡
[
$TagMš
];

4072 
$Pos
 = 
$Tag
['e']+1;

4073 ià(
$Tag
['s']) {

4075 ià(
$Tag
['k']è
$x
 .ğ
	`sub¡r
(
$Txt
,$Tag['b'] ,$Tag['e'] - $Tag['b'] + 1);

4078 
$Loc
 = 
£lf
::
	`f_Xml_FšdTag
(
$Txt
,
$Tag
['t'],
çl£
,
$Pos
,
Œue
,false,false);

4079 ià(
$Loc
===
çl£
) {

4080 
$Tag
['b'] = 
$PosOut
;

4082 
$nÙhšg
 = 
çl£
;

4083 ià(
$Tag
['k']) {

4084 
$x
 .ğ
	`sub¡r
(
$Txt
,
$Tag
['b'] ,
$Loc
->
PosEnd
 - $Tag['b'] + 1);

4086 
$x
 .ğ
	`sub¡r
(
$Txt
,
$Tag
['e']+1,
$Loc
->
PosBeg
 - $Tag['e'] - 1);

4088 
$Pos
 = 
$Loc
->
PosEnd
 + 1;

4093 } 
$TagMš
!==
çl£
);

4095 ià(
$AÎIfNÙhšg
 
ªd
 
$nÙhšg
è 
$Txt
;

4096  
$x
;

4098 
	}
}

4100 
funùiÚ
 
	$f_Xml_FšdTagS¹
(&
$Txt
,
$Tag
,
$O³nšg
,
$PosBeg
,
$FÜw¬d
,
$Ca£
=
Œue
) {

4108 ià(
$Txt
===''è 
çl£
;

4110 
$x
 = '<'.((
$O³nšg
è? '' : '/').
$Tag
;

4111 
$xl
 = 
	`¡¾’
(
$x
);

4113 
$p
 = 
$PosBeg
 - ((
$FÜw¬d
) ? 1 : -1);

4115 ià(
$Ca£
) {

4117 ià(
$FÜw¬d
è
$p
 = 
	`¡½os
(
$Txt
,
$x
,$p+1); $°ğ
	`¡¼pos
(
	`sub¡r
($Txt,0,$p+1),$x);

4118 ià(
$p
===
çl£
)  false;

4119 ià(
	`sub¡r
(
$Txt
,
$p
,
$xl
)!==
$x
) ;

4120 
$z
 = 
	`sub¡r
(
$Txt
,
$p
+
$xl
,1);

4121 }  (
$z
!==' 'è&& ($z!=="\r"è&& ($z!=="\n"è&& ($z!=='>'è&& ($z!=='/'è&& (
$Tag
!=='/') && ($Tag!=='') );

4124 ià(
$FÜw¬d
è
$p
 = 
	`¡ros
(
$Txt
,
$x
,$p+1); $°ğ
	`¡¼os
(
	`sub¡r
($Txt,0,$p+1),$x);

4125 ià(
$p
===
çl£
)  false;

4126 
$z
 = 
	`sub¡r
(
$Txt
,
$p
+
$xl
,1);

4127 }  (
$z
!==' 'è&& ($z!=="\r"è&& ($z!=="\n"è&& ($z!=='>'è&& ($z!=='/'è&& (
$Tag
!=='/') && ($Tag!=='') );

4130  
$p
;

4132 
	}
}

4134 
funùiÚ
 
	$f_Xml_FšdTag
(&
$Txt
,
$Tag
,
$O³nšg
,
$PosBeg
,
$FÜw¬d
,
$Lev–Stİ
,
$W™hPrm
,
$W™hPos
=
çl£
) {

4142 ià(
$Tag
==='_') {

4143 
$p
 = 
£lf
::
	`f_Xml_FšdNewLše
(
$Txt
,
$PosBeg
,
$FÜw¬d
,(
$Lev–Stİ
!==0));

4144 
$Loc
 = 
Ãw
 
şsTbsLoÿtÜ
;

4145 
$Loc
->
PosBeg
 = (
$FÜw¬d
è? 
$PosBeg
 : 
$p
;

4146 
$Loc
->
PosEnd
 = (
$FÜw¬d
è? 
$p
 : 
$PosBeg
;

4147 
$Loc
->
RightLev–
 = 0;

4148  
$Loc
;

4151 
$Pos
 = 
$PosBeg
 + ((
$FÜw¬d
) ? -1 : +1);

4152 
$TagIsO³nšg
 = 
çl£
;

4153 
$TagClosšg
 = '/'.
$Tag
;

4154 
$Lev–Num
 = 0;

4155 
$TagOk
 = 
çl£
;

4156 
$PosEnd
 = 
çl£
;

4157 
$TagL
 = 
	`¡¾’
(
$Tag
);

4158 
$TagClosšgL
 = 
	`¡¾’
(
$TagClosšg
);

4159 
$RightLev–
 = 0;

4164 ià(
$FÜw¬d
) {

4165 
$Pos
 = 
	`¡½os
(
$Txt
,'<',$Pos+1);

4167 ià(
$Pos
<=0) {

4168 
$Pos
 = 
çl£
;

4170 
$Pos
 = 
	`¡¼pos
(
	`sub¡r
(
$Txt
,0,$Pos - 1),'<');

4174 ià(
$Pos
!==
çl£
) {

4177 ià(
	`¡rÿ£cmp
(
	`sub¡r
(
$Txt
,
$Pos
+1,
$TagL
),
$Tag
)==0) {

4178 
$PosX
 = 
$Pos
 + 1 + 
$TagL
;

4179 
$TagOk
 = 
Œue
;

4180 
$TagIsO³nšg
 = 
Œue
;

4181 } 
	`–£if
 (
	`¡rÿ£cmp
(
	`sub¡r
(
$Txt
,
$Pos
+1,
$TagClosšgL
),
$TagClosšg
)==0) {

4182 
$PosX
 = 
$Pos
 + 1 + 
$TagClosšgL
;

4183 
$TagOk
 = 
Œue
;

4184 
$TagIsO³nšg
 = 
çl£
;

4187 ià(
$TagOk
) {

4189 
$x
 = 
$Txt
[
$PosX
];

4190 ià((
$x
===' 'è
	`Ü
 ($x==="\r"èÜ ($x==="\n"èÜ ($x==='>'èÜ (
$Tag
==='/') or ($Tag==='')) {

4192 ià(
$Lev–Stİ
===
çl£
) {

4193 ià(
$TagIsO³nšg
!==
$O³nšg
è
$TagOk
 = 
çl£
;

4195 ià(
$TagIsO³nšg
) {

4196 
$PosEnd
 = 
	`¡½os
(
$Txt
,'>',
$PosX
);

4197 ià(
$PosEnd
!==
çl£
) {

4198 ià(
$Txt
[
$PosEnd
-1]==='/') {

4199 ià((
$Pos
<
$PosBeg
è
	`ªd
 (
$PosEnd
>$PosBeg)è{
$RightLev–
=1; 
$Lev–Num
++;}

4201 
$Lev–Num
++;

4205 
$Lev–Num
--;

4208 ià(
$Lev–Num
!=
$Lev–Stİ
) {

4209 
$TagOk
 = 
çl£
;

4210 
$PosEnd
 = 
çl£
;

4214 
$TagOk
 = 
çl£
;

4219 } (
$Pos
!==
çl£
è
	`ªd
 (
$TagOk
===false));

4222 ià(
$TagOk
) {

4223 
$Loc
 = 
Ãw
 
şsTbsLoÿtÜ
;

4224 ià(
$W™hPrm
) {

4225 
£lf
::
	`f_Loc_PrmR—d
(
$Txt
,
$PosX
,
Œue
,'\'"','<','>',
$Loc
,
$PosEnd
,
$W™hPos
);

4226 } 
	`–£if
 (
$PosEnd
===
çl£
) {

4227 
$PosEnd
 = 
	`¡½os
(
$Txt
,'>',
$PosX
);

4228 ià(
$PosEnd
===
çl£
) {

4229 
$TagOk
 = 
çl£
;

4235 ià(
$TagOk
) {

4236 
$Loc
->
PosBeg
 = 
$Pos
;

4237 
$Loc
->
PosEnd
 = 
$PosEnd
;

4238 
$Loc
->
RightLev–
 = 
$RightLev–
;

4239  
$Loc
;

4241  
çl£
;

4244 
	}
}

4246 
funùiÚ
 
	$f_Xml_FšdNewLše
(&
$Txt
,
$PosBeg
,
$FÜw¬d
,
$IsRef
) {

4248 
$p
 = 
$PosBeg
;

4249 ià(
$FÜw¬d
) {

4250 
$Inc
 = 1;

4251 
$Inf
 = &
$p
;

4252 
$Sup
 = 
	`¡¾’
(
$Txt
)-1;

4254 
$Inc
 = -1;

4255 
$Inf
 = 0;

4256 
$Sup
 = &
$p
;

4260 ià(
$Inf
>
$Sup
è 
	`max
($Sup,0);

4261 
$x
 = 
$Txt
[
$p
];

4262 ià((
$x
==="\r"è
	`Ü
 ($x==="\n")) {

4263 
$x2
 = (
$x
==="\n") ? "\r" : "\n";

4264 
$p0
 = 
$p
;

4265 ià((
$Inf
<
$Sup
è
	`ªd
 (
$Txt
[
$p
+
$Inc
]===
$x2
)) $p += $Inc;

4266 ià(
$FÜw¬d
è 
$p
;

4267 ià(
$IsRef
 
	`Ü
 (
$p0
!=
$PosBeg
))  $p0+1;

4269 
$p
 +ğ
$Inc
;

4270 } 
Œue
);

4272 
	}
}

	@F:\Site\stew\1\local\zh_cn.lang.php

1 <?
php


2 
	g$GLOBALS
['Ïnguage']['zh_ú'] = 
¬¿y


	@F:\Site\stew\1\model\user.function.php

1 <?
php


2 
funùiÚ
 
	$g‘_u£r_šfo_by_id
Ğ
$uid
 )

4  
	`g‘_lše
Ğ"SELECT 'Çme' ,'ema' , 'bod' FROM 'u£r' WHERE 'uid' = " . 
	`štv®
(
$uid
) . " LIMIT 1 " )

	@F:\Site\stew\1\test\firephp-test.php

2 <!
DOCTYPE
 
	gHTML
>

3 <
html
 
	gÏng
="zh-CN">

4 <
h—d
>

5 <
m‘a
 
ch¬£t
="UTF-8">

6 <
t™Ë
></title>

7 </
h—d
>

8 <
body
>

9 <?
php


10 
šşude_Úû
('FirePHPCore/fb.php');

11 
	gFB
::
log
('hello world !');

12 
	gFB
::
group
('Test Group A');

14 
	gFB
::
log
('Plain Message');

15 
	gFB
::
šfo
('Info Message');

16 
	gFB
::
w¬n
('Warn Message');

17 
	gFB
::
”rÜ
('Error Message');

18 
	gFB
::
log
('Message','Optional Label');

19 
	gFB
::
groupEnd
();

20 
	gFB
::
group
('Test Group B');

21 
	gFB
::
log
('Hello World B');

22 
	gFB
::
log
('Plain Message');

23 
	gFB
::
šfo
('Info Message');

24 
	gFB
::
w¬n
('Warn Message');

25 
	gFB
::
”rÜ
('Error Message');

26 
	gFB
::
log
('Message','Optional Label');

27 
	gFB
::
groupEnd
();

29 
	g$bË
[] = 
¬¿y
('Col 1 Heading','Col 2 Heading','Col 2 Heading');

30 
	g$bË
[] = 
¬¿y
('Row 1 Col 1','Row 1 Col 2','Row 1 Col 2');

31 
	g$bË
[] = 
¬¿y
('Row 2 Col 1','Row 2 Col 2');

32 
	g$bË
[] = 
¬¿y
('Row 3 Col 1','Row 3 Col 2');

33 
	gFB
::
bË
('TabË Lab–', 
$bË
);

35 şas 
	cMyExû±iÚ
 
ex‹nds
 
	mExû±iÚ
{

37 
public
 
funùiÚ
 
	$__cÚ¡ruù
(
$mes§ge
, 
$code
) {

38 
·»Á
::
	`__cÚ¡ruù
(
$mes§ge
, 
$code
);

41 
public
 
funùiÚ
 
	$log
(){

42 
FB
::
	`log
(
$this
->
	`g‘Mes§ge
());

43 
	}
}

46 
	gŒy
{

47 
	gecho
 'MoXie';

48 
throw
 
Ãw
 
MyExû±iÚ
('some description',1);

49 }
	$ÿtch
(
MyExû±iÚ
 
$e
){

50 
$e
->
	`log
();

51 
	}
}

53 </
	gbody
>

54 </
	ghtml
>

	@F:\Site\stew\1\test\index.php

1 <?
php


5 
defše
Ğ'DS' , 
DIRECTORY_SEPARATOR
 );

6 
defše
Ğ'AROOT' , 
dœÇme
Ğ
__FILE__
 ) . 
DS
 . '..' . DS );

9 
šşude_Úû
Ğ'..'.
DS
.'_lp'.DS .'st.init.php' );

	@F:\Site\stew\1\test\phptest\core.test.php

2 
defše
Ğ'SITE_URL' , 'h‰p://'.
c
('site_domain') . '/' );

4 şas 
	cTe¡OfCÜefunùiÚ
 
ex‹nds
 
	mWebTe¡Ca£


7 
funùiÚ
 
	$‹¡_ajax_echo
()

9 
	`ob_¡¬t
();

10 
	`ajax_echo
('test');

11 
$out1
 = 
	`ob_g‘_cÚ‹Ás
();

12 
	`ob_’d_ş—n
();

14 
$this
->
	`as£¹Equ®
Ğ
$out1
 , 'test' );

18 
funùiÚ
 
	$‹¡_šfo_·ge
()

20 
	`ob_¡¬t
();

21 
	`šfo_·ge
('hello kitty');

22 
$out1
 = 
	`ob_g‘_cÚ‹Ás
();

23 
	`ob_’d_ş—n
();

25 
$this
->
	`as£¹True
Ğ
	`¡½os
Ğ
$out1
 , 'ç³»ç»Ÿæ¶ˆæ¯' ) );

26 
$this
->
	`as£¹True
Ğ
	`¡½os
Ğ
$out1
 , 'hello kitty' ) );

27 
	}
}

29 
funùiÚ
 
	$‹¡_§ã_check
()

31 ifĞ
	`fe_exi¡s
Ğ
AROOT
 . 'cÚŒŞËr' . 
DS
 . 'default.class.php' ) )

32 
$this
->
	`as£¹Equ®
Ğ'bad„eque¡' , $this->
	`g‘
Ğ
SITE_URL
 . 'controller/default.class.php' ) );

35 ifĞ
	`fe_exi¡s
Ğ
AROOT
 . 'cÚŒŞËr' . 
DS
 . 'app.class.php' ) )

36 
$this
->
	`as£¹Equ®
Ğ'bad„eque¡' , $this->
	`g‘
Ğ
SITE_URL
 . 'controller/app.class.php' ) );

38 
	}
}

	@F:\Site\stew\1\test\phptest\fast.test.php

2 şas 
	cTe¡OfFa¡funùiÚ
 
ex‹nds
 
	mUn™Te¡Ca£


6 
public
 
funùiÚ
 
	$‹¡_v
()

9 
$_REQUEST
['name'] = 'oldtimes';

10 
$this
->
	`as£¹Equ®
Ğ
	`v
('name') , 'oldtimes' );

13 
	`un£t
(
$_REQUEST
['name']) ;

14 
$this
->
	`as£¹Equ®
Ğ
	`v
('Çme'è, 
çl£
 );

18 
public
 
funùiÚ
 
	$‹¡_z
()

20 
$tmp
 = '<a href="http://news.com">news</a>';

21 
$this
->
	`as£¹Equ®
Ğ
	`z
(
$tmp
) , 'news' );

22 
	}
}

24 
public
 
funùiÚ
 
	$‹¡_c
()

26 
$GLOBALS
['config']['unittest'] = 'ing';

27 
$this
->
	`as£¹Equ®
Ğ
	`c
('unittest') , 'ing' );

29 
	`un£t
Ğ
$GLOBALS
['config']['unittest'] );

30 
$this
->
	`as£¹F®£
Ğ
	`c
('unittest') );

31 
	}
}

33 
public
 
funùiÚ
 
	$‹¡_g
()

35 
	`un£t
Ğ
$GLOBALS
['test'] );

36 
$this
->
	`as£¹F®£
Ğ
	`g
('test') );

38 
$GLOBALS
['test'] = 'im';

39 
$this
->
	`as£¹Equ®
Ğ
	`g
('test') , 'im' );

40 
	}
}

42 
public
 
funùiÚ
 
	$‹¡_u
()

44 
$this
->
	`as£¹Equ®
Ğ
	`u
('?c=user&a=login') , '%3Fc%3Duser%26a%3Dlogin' );

45 
	}
}

47 
public
 
funùiÚ
 
	$‹¡_‹xt
()

49 
$this
->
	`as£¹Equ®
Ğ
	`_
('login') , 'ç™»å…¥' );

50 
$this
->
	`as£¹Equ®
Ğ
	`_
('hello%s' , 'Aoi') , 'ä½ å¥½Aoi' );

51 
$this
->
	`as£¹Equ®
Ğ
	`_
('Notƒxists' ) , 'Notƒxists' );

52 
$this
->
	`as£¹Equ®
Ğ
	`_
('Notƒxists %s' , 'Money' ) , 'Notƒxists Money' );

54 
	}
}

	@F:\Site\stew\1\test\phptest\sae.test.php

3 ifĞ
defšed
('SAE_APPNAME') )

5 şas 
	cTe¡OfSAEfunùiÚ
 
ex‹nds
 
	gUn™Te¡Ca£


9 
funùiÚ
 
‹¡_§e_db
()

11 
	g$db
 = 
db
();

12 
	g$d©a
ğ
»£t
(
g‘_d©a
Ğ"show glob® v¬ŸbË lik'»ad_Úly';" , 
$db
 ));

13 
	g$this
->
as£¹Equ®
Ğ
$d©a
['Value'] , 'OFF' );

15 
	g$dbr
 = 
db_»ad
();

16 
	g$d©a2
ğ
»£t
(
g‘_d©a
Ğ"show glob® v¬ŸbË lik'»ad_Úly';" , 
$dbr
 ));

17 
	g$this
->
as£¹Equ®
Ğ
$d©a2
['Value'] , 'ON' );

20 
	g$d©a3
ğ
»£t
(
g‘_d©a
( "show global variables†ike 'read_only';" ));

21 
	g$this
->
as£¹Equ®
Ğ
$d©a2
['Value'] , 'ON' );

	@
1
.
0
66
2819
F:\Site\stew\1\_lp\core\config\core.config.php
F:\Site\stew\1\_lp\core\controller\core.class.php
F:\Site\stew\1\_lp\core\lib\core.function.php
F:\Site\stew\1\_lp\core\lib\db.function.php
F:\Site\stew\1\_lp\core\lib\db.sae.function.php
F:\Site\stew\1\_lp\lp.init.php
F:\Site\stew\1\_lp\simpletest\arguments.php
F:\Site\stew\1\_lp\simpletest\authentication.php
F:\Site\stew\1\_lp\simpletest\autorun.php
F:\Site\stew\1\_lp\simpletest\browser.php
F:\Site\stew\1\_lp\simpletest\collector.php
F:\Site\stew\1\_lp\simpletest\compatibility.php
F:\Site\stew\1\_lp\simpletest\cookies.php
F:\Site\stew\1\_lp\simpletest\default_reporter.php
F:\Site\stew\1\_lp\simpletest\detached.php
F:\Site\stew\1\_lp\simpletest\dumper.php
F:\Site\stew\1\_lp\simpletest\eclipse.php
F:\Site\stew\1\_lp\simpletest\encoding.php
F:\Site\stew\1\_lp\simpletest\errors.php
F:\Site\stew\1\_lp\simpletest\exceptions.php
F:\Site\stew\1\_lp\simpletest\expectation.php
F:\Site\stew\1\_lp\simpletest\extensions\pear_test_case.php
F:\Site\stew\1\_lp\simpletest\extensions\testdox.php
F:\Site\stew\1\_lp\simpletest\extensions\testdox\test.php
F:\Site\stew\1\_lp\simpletest\form.php
F:\Site\stew\1\_lp\simpletest\frames.php
F:\Site\stew\1\_lp\simpletest\http.php
F:\Site\stew\1\_lp\simpletest\invoker.php
F:\Site\stew\1\_lp\simpletest\mock_objects.php
F:\Site\stew\1\_lp\simpletest\page.php
F:\Site\stew\1\_lp\simpletest\php_parser.php
F:\Site\stew\1\_lp\simpletest\recorder.php
F:\Site\stew\1\_lp\simpletest\reflection_php4.php
F:\Site\stew\1\_lp\simpletest\reflection_php5.php
F:\Site\stew\1\_lp\simpletest\remote.php
F:\Site\stew\1\_lp\simpletest\reporter.php
F:\Site\stew\1\_lp\simpletest\scorer.php
F:\Site\stew\1\_lp\simpletest\selector.php
F:\Site\stew\1\_lp\simpletest\shell_tester.php
F:\Site\stew\1\_lp\simpletest\simpletest.php
F:\Site\stew\1\_lp\simpletest\socket.php
F:\Site\stew\1\_lp\simpletest\tag.php
F:\Site\stew\1\_lp\simpletest\test_case.php
F:\Site\stew\1\_lp\simpletest\tidy_parser.php
F:\Site\stew\1\_lp\simpletest\unit_tester.php
F:\Site\stew\1\_lp\simpletest\url.php
F:\Site\stew\1\_lp\simpletest\user_agent.php
F:\Site\stew\1\_lp\simpletest\web_tester.php
F:\Site\stew\1\_lp\simpletest\xml.php
F:\Site\stew\1\_lp\st.init.php
F:\Site\stew\1\config\app.config.php
F:\Site\stew\1\config\db.config.php
F:\Site\stew\1\controller\app.class.php
F:\Site\stew\1\controller\default.class.php
F:\Site\stew\1\controller\show.class.php
F:\Site\stew\1\controller\user.class.php
F:\Site\stew\1\index.php
F:\Site\stew\1\lib\app.function.php
F:\Site\stew\1\lib\tiny_but_strong.class.php
F:\Site\stew\1\local\zh_cn.lang.php
F:\Site\stew\1\model\user.function.php
F:\Site\stew\1\test\firephp-test.php
F:\Site\stew\1\test\index.php
F:\Site\stew\1\test\phptest\core.test.php
F:\Site\stew\1\test\phptest\fast.test.php
F:\Site\stew\1\test\phptest\sae.test.php
